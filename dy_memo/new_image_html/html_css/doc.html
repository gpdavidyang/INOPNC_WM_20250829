<!doctype html>
<html lang="ko" data-theme="light">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<title>INOPNC · Work Log</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;600;800;900&display=swap" rel="stylesheet">
<style>
  :root{
    --font:'Noto Sans KR',system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
    --bg:#f5f7fb; --card:#ffffff; --text:#101828; --muted:#667085; --line:#e6eaf2;
    --header-h:56px; --nav-h:64px; --nav-bg:#ffffff; --nav-border:#e5e7eb; --nav-text:#6b7280; --nav-text-active:#2563eb;
    --brand:#1A254F; --num:#0068FE; /* 브랜드 색상 및 번호 컬러 */
    --label-fz:16px; --label-fw:800; --label-lh:1.2; --label-track:-0.2px;
    
    /* 모바일 뷰포트 대응 */
    --vh: 1vh;
    --dvh: 100dvh;
    --svh: 100svh;
    
    /* 기존 토큰 유지 */
    --ink:#1A254F; --ok:#2563eb; --ok-bg:#e6efff; --ok-ink:#0b3fcc;
    --warn:#9aa3b2; --radius:16px; --shadow:0 6px 20px rgba(16,24,40,.06);
  }
  [data-theme="dark"]{
    --bg:#0f172a; --surface:#11151B; --card:#0f172a; --overlay:#0f172aCC; --line:#4A5568; --line-soft:#3A4048;
    --text:#E9EEF5; --text-muted:#A8B0BB; --icon:#B9C2CE;
    --accent:#2F6BFF; --accent-weak:#1E4EDC; --accent-ghost:#2F6BFF1A;
    --success:#22C55E; --warn:#F59E0B; --danger:#EF4444;
    --shadow:0 10px 26px rgba(0,0,0,.35); --radius:8px;
    --nav-bg:#11151B; --nav-border:#3A4048; --nav-text:#A8B0BB; --nav-text-active:#2F6BFF;
    
    /* 기존 다크모드 토큰 유지 */
    --soft:#0f172a; --ink:#E6E9F1; --muted:#94A3B8;
    --ok:#5b8cff; --ok-bg:#223358; --ok-ink:#8fb3ff;
  }
  /* 다크모드에서 탭 폰트 색상 - 하이라이트라인만 파란색 */
  [data-theme="dark"] .tab {
    color: var(--ink) !important;
  }
  [data-theme="dark"] .tab.active {
    color: var(--ink) !important; /* 활성 탭도 기본 텍스트 색상으로 강제 설정 */
  }
  [data-theme="dark"] .tab:hover {
    color: var(--ink) !important; /* 호버 시에도 기본 텍스트 색상 */
  }
  /* 더 강력한 선택자로 확실히 덮어쓰기 */
  [data-theme="dark"] .tabs .tab.active {
    color: var(--ink) !important;
  }
  [data-theme="dark"] .tab.active::after {
    background: #2F6BFF !important;
  }
  [data-theme="dark"] .tabs {
    border-bottom-color: var(--line);
  }
  
  /* 다크모드 제목 스타일 */
  [data-theme="dark"] .section-title, 
  [data-theme="dark"] .card-title, 
  [data-theme="dark"] .form-title, 
  [data-theme="dark"] .q {
    color: var(--text);
  }
  *{ box-sizing:border-box; }
  html { -webkit-text-size-adjust: 100%; }
  body{ 
    margin:0; 
    background:#f5f7fb; 
    color:var(--text); 
    font-family:var(--font); 
    font-size:15px; 
    line-height:1.6; 
    transition: font-size 0.3s ease; 
    overscroll-behavior: contain;
  }
  
  /* 모바일 입력 필드 최적화 */
  input, select, textarea { 
    font-size: 16px !important; 
    -webkit-appearance: none;
    appearance: none;
    border-radius: 0;
  }
  
  /* iOS 자동 줌 방지 */
  input[type="text"], 
  input[type="password"], 
  input[type="email"], 
  input[type="tel"], 
  input[type="url"], 
  input[type="search"], 
  textarea, 
  select { 
    font-size: 16px !important; 
  }
  .wrap{max-width:480px;margin:0 auto;padding:16px}
  .h1{font-weight:900;font-size:18px}
  /* 제목 스타일 통일 */
  .section-title, .card-title, .form-title, .q {
    font-family: "Noto Sans KR", system-ui, sans-serif;
    font-weight: 700;
    font-size: 17px;
    line-height: 1.4;
    color: #1A254F;
  }
  .tabs{display:grid;grid-template-columns:1fr 1fr;border-bottom:2px solid #E5EAF3;background:transparent;width:100%;max-width:400px;margin:0 auto}
  .tab{
    position:relative; display:flex; align-items:center; justify-content:center;
    padding:12px 16px; 
    font-size: 17px !important;        /* 워크로그와 동일한 폰트 크기 */
    font-weight: 600 !important;       /* 워크로그와 동일한 폰트 굵기 */
    color: #1A254F !important;         /* 워크로그와 동일한 색상 */
    font-family: "Noto Sans KR", system-ui, sans-serif;
    transition: all .3s cubic-bezier(0.4, 0, 0.2, 1);
    cursor:pointer;user-select:none;
    min-height:48px;
  }
  .tab::after{
    content:""; position:absolute; left:0; right:0; bottom:0; height:2px; background:transparent;
  }
  .tab.active{ color:var(--ink); }
  .tab.active::after{ background:#1A254F; }
  .card{ background:var(--card); border:1px solid #E6ECF4; border-radius:14px; padding:14px; box-shadow:0 2px 10px rgba(2,6,23,.04); }
  [data-theme="dark"] .card{ border-color:var(--line) !important; }
  .item{display:flex;align-items:center;gap:10px;padding:14px;border:1px solid var(--line);border-radius:12px;background:#fff}
  .item + .item{margin-top:10px}
  .item.active{outline:2px solid var(--ok); background:#f7fbff}
  .title{font-weight:800}
  .ghost{color:var(--muted);font-weight:700}
  .pill{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--line);border-radius:9999px;padding:4px 10px;font-size:13px;font-weight:800;background:#fff;color:var(--ink)}
  .btn{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    gap:8px;
    min-height:48px;
    padding:0 16px;
    border-radius:12px;
    border:1px solid transparent;
    font:700 15px/1 var(--font);
    cursor:pointer;
    transition:all .3s cubic-bezier(0.4,0,0.2,1);
    user-select:none;
    flex:1;
  }
  .btn-ghost{
    background:#fff;
    color:#99A4BE;
    border-color:#99A4BE;
  }
  .btn-ghost:hover{
    background:#99A4BE;
    color:#fff;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }
  
  /* 저장하기 버튼 반전 컬러 */
  .btn-save{
    background:#99A4BE;
    color:#fff;
    border-color:#99A4BE;
  }
  .btn-save:hover{
    background:#fff;
    color:#99A4BE;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }
  .btn-primary{
    background:#1A254F;
    color:#fff;
  }
  .btn-primary:hover{
    filter:brightness(.95);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }
  .btn:active{
    transform: translateY(0);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    transition: all 0.1s ease;
  }
  .meta{margin-left:auto;display:flex;align-items:center;gap:10px}
  .icon{width:20px;height:20px;color:var(--muted)}
  .badge-ok{width:26px;height:26px;border-radius:999px;background:var(--ok-bg);color:var(--ok-ink);display:grid;place-items:center;font-weight:900}
  .badge-pending{width:26px;height:26px;border-radius:999px;background:#f1f5f9;color:var(--warn);display:grid;place-items:center;font-weight:900}
  .foot{display:flex;gap:10px;padding:12px}
  

  /* 문서 카드 스타일 (홈 페이지 CSS 기반) */
  .document-cards {
    display: flex;
    flex-direction: column;
    gap: 8px;
    padding: 12px;
  }

  .doc-card {
    background: var(--card);
    border: 1px solid #E6ECF4;
    border-radius: 14px;
    padding: 16px;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    user-select: none;
    position: relative;
    overflow: hidden;
    min-height: 60px;
  }

  .doc-card:hover {
    background: #f8fafc;
    border-color: #cbd5e1;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  .doc-card.active {
    background: #EFF6FF;
    border-color: #BBD7FF;
    box-shadow: 0 2px 8px rgba(26, 86, 219, 0.2);
  }

  .doc-card-content {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .doc-title {
    font-family: "Noto Sans KR", system-ui, sans-serif;
    font-weight: 700;
    font-size: 17px;
    line-height: 1.4;
    color: #1A254F;
    margin-bottom: 0;
  }


  /* 다크모드 문서 카드 스타일 */
  [data-theme="dark"] .doc-card {
    background: var(--card);
    border-color: var(--line);
  }

  [data-theme="dark"] .doc-card:hover {
    background: var(--line-soft);
    border-color: var(--line);
  }

  [data-theme="dark"] .doc-card.active {
    background: var(--accent-ghost);
    border-color: var(--accent);
  }

  [data-theme="dark"] .doc-title {
    color: var(--text);
  }

  [data-theme="dark"] .doc-subtitle {
    color: var(--text-muted);
  }

  /* 다크모드 배경색 (홈 페이지와 동일) */
  [data-theme="dark"] body {
    background: #0f172a;
  }

  /* 다크모드 버튼 스타일 */
  [data-theme="dark"] .btn-ghost {
    background: var(--card);
    color: var(--text-muted);
    border-color: var(--line);
  }
  [data-theme="dark"] .btn-ghost:hover {
    background: var(--line);
    color: var(--text);
  }
  
  /* 다크모드 저장하기 버튼 반전 컬러 */
  [data-theme="dark"] .btn-save {
    background: var(--line);
    color: var(--text);
    border-color: var(--line);
  }
  [data-theme="dark"] .btn-save:hover {
    background: var(--card);
    color: var(--text-muted);
  }
  [data-theme="dark"] .btn-primary {
    background: #2F6BFF;
    color: #fff;
  }
  [data-theme="dark"] .btn-primary:hover {
    background: #1E40AF;
  }

  /* 버튼 클릭 애니메이션 */
  .btn.clicked {
    animation: buttonRipple 0.6s ease-out;
  }

  @keyframes buttonRipple {
    0% {
      transform: scale(1);
      box-shadow: 0 0 0 0 rgba(26, 37, 79, 0.4);
    }
    50% {
      transform: scale(1.05);
      box-shadow: 0 0 0 10px rgba(26, 37, 79, 0.1);
    }
    100% {
      transform: scale(1);
      box-shadow: 0 0 0 0 rgba(26, 37, 79, 0);
    }
  }

  /* 새로운 검색 섹션 스타일 */
  .search-section {
    margin: 12px;
    margin-bottom: 16px;
    width: 100%;
    position: relative;
    z-index: 10;
    background: transparent;
    flex-shrink: 0;
    min-height: 48px;
    max-height: 48px;
  }

  .search-container {
    display: flex;
    align-items: center;
    gap: 12px;
    width: 100%;
    max-width: 100%;
    flex-wrap: nowrap;
    overflow: hidden;
    height: 48px;
    min-height: 48px;
    max-height: 48px;
  }

  .search-input-wrapper {
    flex: 1;
    position: relative;
    display: flex;
    align-items: center;
    background: #ffffff;
    border-radius: 24px;
    border: 1px solid #e5e7eb;
    padding: 12px 20px;
    height: 48px;
    min-height: 48px;
    max-height: 48px;
    min-width: 0; /* flex item이 축소될 수 있도록 */
    flex-shrink: 1;
    overflow: hidden;
    box-sizing: border-box;
    contain: layout;
  }

  .search-icon {
    width: 18px;
    height: 18px;
    color: #6b7280;
    margin-right: 12px;
    flex-shrink: 0;
  }

  .search-input {
    flex: 1;
    border: none;
    background: transparent;
    outline: none;
    font: 400 15px 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
    color: #1f2937;
    width: 100%;
    min-width: 0; /* flex item이 축소될 수 있도록 */
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    height: 24px;
    line-height: 24px;
    padding: 0;
    margin: 0;
    box-sizing: border-box;
    resize: none;
    vertical-align: top;
  }

  .search-input::placeholder {
    color: #9ca3af;
    font-weight: 400;
  }

  .cancel-btn {
    background: none;
    border: none;
    color: #9ca3af;
    font-family: "Noto Sans KR", system-ui, sans-serif;
    font-size: 15px;
    font-weight: 400;
    cursor: pointer;
    padding: 12px 16px;
    transition: all 0.2s ease;
    white-space: nowrap; /* 텍스트 줄바꿈 방지 */
    flex-shrink: 0; /* 버튼 크기 고정 */
    min-width: fit-content;
    height: 48px;
    min-height: 48px;
    max-height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-sizing: border-box;
  }

  .cancel-btn:hover {
    color: #6b7280;
  }

  /* 다크모드 검색 스타일 (배경색은 흰색 유지) */
  [data-theme="dark"] .search-input-wrapper {
    background: #ffffff;
    border-color: #e5e7eb;
  }

  [data-theme="dark"] .search-icon {
    color: #6b7280;
  }

  [data-theme="dark"] .search-input {
    color: #1f2937;
  }

  [data-theme="dark"] .search-input::placeholder {
    color: #9ca3af;
  }

  [data-theme="dark"] .cancel-btn {
    color: #9ca3af;
  }

  [data-theme="dark"] .cancel-btn:hover {
    color: #6b7280;
  }

  /* 체크박스 스타일 */
  .doc-checkbox {
    position: relative;
    margin-right: 12px;
  }

  .doc-check {
    display: none;
  }

  .checkmark {
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 2px solid #d1d5db;
    border-radius: 50%;
    background: #ffffff;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
  }

  .checkmark::after {
    content: '';
    position: absolute;
    left: 6px;
    top: 2px;
    width: 6px;
    height: 10px;
    border: solid white;
    border-width: 0 2px 2px 0;
    transform: rotate(45deg);
    opacity: 0;
    transition: opacity 0.2s ease;
  }

  .doc-check:checked + .checkmark {
    background: #3b82f6;
    border-color: #3b82f6;
  }

  .doc-check:checked + .checkmark::after {
    opacity: 1;
  }

  .doc-check:checked + .checkmark:hover {
    background: #2563eb;
    border-color: #2563eb;
  }

  .checkmark:hover {
    border-color: #9ca3af;
  }

  /* 다크모드 체크박스 */
  [data-theme="dark"] .checkmark {
    background: #374151;
    border-color: #6b7280;
  }

  [data-theme="dark"] .doc-check:checked + .checkmark {
    background: #3b82f6;
    border-color: #3b82f6;
  }

  [data-theme="dark"] .checkmark:hover {
    border-color: #9ca3af;
  }

  /* 문서 카드 레이아웃 수정 */
  .doc-card {
    display: flex;
    align-items: center;
    padding: 16px;
    min-height: 60px;
  }

  .doc-card-content {
    flex: 1;
  }


  /* 선택 카드 스타일 (홈 페이지 스타일 기반) */
  .doc-selection-card {
    background: #ffffff;
    border: 1px solid #e5e7eb;
    border-radius: 12px;
    padding: 16px 20px;
    cursor: pointer;
    transition: all 0.2s ease;
    user-select: none;
    position: relative;
    margin-bottom: 8px;
    min-height: 70px;
    display: flex;
    align-items: center;
  }

  .doc-selection-card:hover {
    background: #f8fafc;
    border-color: #cbd5e1;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  }

  .doc-selection-card.active {
    background: #EFF6FF;
    border-color: #BBD7FF;
    box-shadow: 0 2px 8px rgba(26, 86, 219, 0.2);
  }

  .doc-selection-actions {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-left: auto;
  }

  .doc-selection-checkbox {
    display: flex;
    align-items: center;
  }

  .preview-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 6px 12px;
    background: rgba(59, 130, 246, 0.1);
    color: #3b82f6;
    border: 1px solid rgba(59, 130, 246, 0.2);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 13px;
    font-weight: 500;
    white-space: nowrap;
  }

  .upload-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 6px 12px;
    background: rgba(0, 188, 212, 0.1);
    color: #00BCD4;
    border: 1px solid rgba(0, 188, 212, 0.2);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 13px;
    font-weight: 500;
    white-space: nowrap;
    margin-right: 8px;
  }

  .preview-btn:hover {
    background: rgba(59, 130, 246, 0.2);
    border-color: rgba(59, 130, 246, 0.3);
    transform: translateY(-1px);
  }

  .upload-btn:hover {
    background: rgba(0, 188, 212, 0.2);
    border-color: rgba(0, 188, 212, 0.3);
    transform: translateY(-1px);
  }
  
  /* 보기 버튼이 삭제 모드일 때 스타일 */
  .preview-btn.delete-mode {
    background: #ef4444;
    color: white;
    border-color: #ef4444;
  }
  
  .preview-btn.delete-mode:hover {
    background: #dc2626;
    border-color: #dc2626;
  }

  .selection-checkmark {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: #e5e7eb;
    border: 2px solid #e5e7eb;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .selection-checkmark.active {
    background: #3b82f6;
    border-color: #3b82f6;
  }

  .selection-checkmark svg {
    color: white;
    opacity: 0;
    transition: opacity 0.2s ease;
  }

  .selection-checkmark.active svg {
    opacity: 1;
  }

  .doc-selection-content {
    flex: 1;
    display: flex;
    align-items: center;
  }

  .doc-selection-title {
    font-family: "Noto Sans KR", system-ui, -apple-system, "Segoe UI", Roboto, "Apple SD Gothic Neo", "Malgun Gothic", sans-serif;
    font-weight: 600;
    font-size: 16px;
    line-height: 1.4;
    color: #1A254F;
    margin: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  /* 배치전 검진만 16px 폰트 크기 */
  .doc-selection-card[data-id="A"] .doc-selection-title {
    font-size: 16px !important;
  }

  .doc-selection-title.expanded {
    white-space: normal;
    overflow: visible;
    text-overflow: unset;
  }

  /* 다크모드 선택 카드 스타일 */
  [data-theme="dark"] .doc-selection-card {
    background: var(--card);
    border-color: var(--line);
  }

  [data-theme="dark"] .doc-selection-card:hover {
    background: var(--line-soft);
    border-color: var(--line);
  }

  [data-theme="dark"] .doc-selection-card.active {
    background: var(--accent-ghost);
    border-color: var(--accent);
  }

  [data-theme="dark"] .doc-selection-title {
    color: var(--text);
  }

  /* 다크모드 선택 체크마크 스타일 */
  [data-theme="dark"] .selection-checkmark {
    background: #374151;
    border-color: #374151;
  }

  [data-theme="dark"] .selection-checkmark.active {
    background: #3b82f6;
    border-color: #3b82f6;
  }

  /* 다크모드 보기 버튼 스타일 */
  [data-theme="dark"] .preview-btn {
    background: rgba(59, 130, 246, 0.2);
    color: #60a5fa;
    border-color: rgba(59, 130, 246, 0.3);
  }

  [data-theme="dark"] .preview-btn:hover {
    background: rgba(59, 130, 246, 0.3);
    border-color: rgba(59, 130, 246, 0.4);
  }

  /* 다크모드 업로드 버튼 스타일 */
  [data-theme="dark"] .upload-btn {
    background: rgba(0, 188, 212, 0.2);
    color: #26C6DA;
    border-color: rgba(0, 188, 212, 0.3);
  }

  [data-theme="dark"] .upload-btn:hover {
    background: rgba(0, 188, 212, 0.3);
    border-color: rgba(0, 188, 212, 0.4);
  }
  
  [data-theme="dark"] .preview-btn.delete-mode {
    background: #ef4444;
    color: white;
    border-color: #ef4444;
  }
  
  [data-theme="dark"] .preview-btn.delete-mode:hover {
    background: #dc2626;
    border-color: #dc2626;
  }
  
  /* 삭제 버튼 스타일 (보기 버튼과 같은 디자인, 빨간색) */
  .delete-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 6px 12px;
    background: rgba(239, 68, 68, 0.1);
    color: #ef4444;
    border: 1px solid rgba(239, 68, 68, 0.2);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 13px;
    font-weight: 500;
    white-space: nowrap;
  }
  
  .delete-btn:hover {
    background: rgba(239, 68, 68, 0.2);
    border-color: rgba(239, 68, 68, 0.3);
    transform: translateY(-1px);
  }
  
  /* 다크모드 삭제 버튼 스타일 */
  [data-theme="dark"] .delete-btn {
    background: rgba(239, 68, 68, 0.2);
    color: #f87171;
    border-color: rgba(239, 68, 68, 0.3);
  }
  
  [data-theme="dark"] .delete-btn:hover {
    background: rgba(239, 68, 68, 0.3);
    border-color: rgba(239, 68, 68, 0.4);
  }

  /* 추가 업로드 박스 스타일 */
  .add-upload-box {
    background: #f8fafc;
    border: 2px dashed #cbd5e1;
    border-radius: 12px;
    padding: 16px 20px; /* 고령자 서류박스와 동일한 패딩 */
    cursor: pointer;
    transition: all 0.3s ease;
    margin-top: 8px;
    min-height: 70px; /* 고령자 서류박스와 동일한 높이 */
    display: flex;
    align-items: center;
    justify-content: center;
    box-sizing: border-box; /* 고령자 서류박스와 동일한 박스 모델 */
  }

  .add-upload-box:hover {
    background: #f1f5f9;
    border-color: #94a3b8;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  }

  .add-upload-content {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .add-upload-icon {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: #e2e8f0;
    color: #64748b;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 15px;
    font-weight: 300;
    transition: all 0.3s ease;
  }

  .add-upload-box:hover .add-upload-icon {
    background: #cbd5e1;
    color: #475569;
  }

  .add-upload-text {
    font-size: 15px;
    font-weight: 600;
    color: #64748b;
    font-family: "Noto Sans KR", system-ui, -apple-system, "Segoe UI", Roboto, "Apple SD Gothic Neo", "Malgun Gothic", sans-serif;
    transition: all 0.3s ease;
  }

  .add-upload-box:hover .add-upload-text {
    color: #475569;
  }

  /* 다크모드 추가 업로드 박스 */
  [data-theme="dark"] .add-upload-box {
    background: #1e293b;
    border-color: #475569;
  }

  [data-theme="dark"] .add-upload-box:hover {
    background: #334155;
    border-color: #64748b;
  }

  [data-theme="dark"] .add-upload-icon {
    background: #475569;
    color: #94a3b8;
  }

  [data-theme="dark"] .add-upload-box:hover .add-upload-icon {
    background: #64748b;
    color: #cbd5e1;
  }

  [data-theme="dark"] .add-upload-text {
    color: #94a3b8;
  }

  [data-theme="dark"] .add-upload-box:hover .add-upload-text {
    color: #cbd5e1;
  }
</style>
</head>
<body>
  <div class="wrap">
    <div style="display:flex;justify-content:center;align-items:center;margin-bottom:12px">
      <div class="tabs" role="tablist">
        <div class="tab active" data-tab="mine" role="tab" aria-selected="true">내 문서함</div>
        <div class="tab" data-tab="shared" role="tab" aria-selected="false">공유 문서함</div>
      </div>
    </div>

    <!-- 검색 섹션 -->
    <div class="search-section">
      <div class="search-container">
        <div class="search-input-wrapper">
          <svg viewBox="0 0 24 24" fill="none" class="search-icon"><circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2"/><path d="M21 21l-4.3-4.3" stroke="currentColor" stroke-width="2"/></svg>
          <input id="q" class="search-input" placeholder="문서명 검색"/>
        </div>
        <button class="cancel-btn">취소</button>
      </div>
    </div>

    <!-- 탭 콘텐츠: 내 문서함 -->
    <div id="tab-mine">
      <div class="document-cards">

        <div class="doc-selection-card active" data-id="A">
          <div class="doc-selection-content">
            <div class="doc-selection-title">배치전 검진</div>
          </div>
          <div class="doc-selection-actions">
            <button class="upload-btn" onclick="uploadDocument('A')">업로드</button>
            <button class="preview-btn" onclick="previewDocument('A')">보기</button>
            <button class="delete-btn" onclick="deleteSingleDocument('A')" style="display: none;">삭제</button>
            <div class="doc-selection-checkbox">
              <div class="selection-checkmark active">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20,6 9,17 4,12"></polyline>
                </svg>
              </div>
            </div>
          </div>
        </div>

        <div class="doc-selection-card" data-id="B">
          <div class="doc-selection-content">
            <div class="doc-selection-title">기초안전보건교육</div>
          </div>
          <div class="doc-selection-actions">
            <button class="upload-btn" onclick="uploadDocument('B')">업로드</button>
            <button class="preview-btn" onclick="previewDocument('B')">보기</button>
            <button class="delete-btn" onclick="deleteSingleDocument('B')" style="display: none;">삭제</button>
            <div class="doc-selection-checkbox">
              <div class="selection-checkmark">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20,6 9,17 4,12"></polyline>
                </svg>
              </div>
            </div>
          </div>
        </div>

        <div class="doc-selection-card" data-id="C">
          <div class="doc-selection-content">
            <div class="doc-selection-title">차량보험증</div>
          </div>
          <div class="doc-selection-actions">
            <button class="upload-btn" onclick="uploadDocument('C')">업로드</button>
            <button class="preview-btn" onclick="previewDocument('C')">보기</button>
            <button class="delete-btn" onclick="deleteSingleDocument('C')" style="display: none;">삭제</button>
            <div class="doc-selection-checkbox">
              <div class="selection-checkmark">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20,6 9,17 4,12"></polyline>
                </svg>
              </div>
            </div>
          </div>
        </div>

        <div class="doc-selection-card" data-id="D">
          <div class="doc-selection-content">
            <div class="doc-selection-title">차량등록증</div>
          </div>
          <div class="doc-selection-actions">
            <button class="upload-btn" onclick="uploadDocument('D')">업로드</button>
            <button class="preview-btn" onclick="previewDocument('D')">보기</button>
            <button class="delete-btn" onclick="deleteSingleDocument('D')" style="display: none;">삭제</button>
            <div class="doc-selection-checkbox">
              <div class="selection-checkmark">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20,6 9,17 4,12"></polyline>
                </svg>
              </div>
            </div>
          </div>
        </div>

        <div class="doc-selection-card" data-id="E">
          <div class="doc-selection-content">
            <div class="doc-selection-title">통장사본</div>
          </div>
          <div class="doc-selection-actions">
            <button class="upload-btn" onclick="uploadDocument('E')">업로드</button>
            <button class="preview-btn" onclick="previewDocument('E')">보기</button>
            <button class="card-delete-btn" onclick="deleteSingleDocument('E')" style="display: none;">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3,6 5,6 21,6"></polyline>
                <path d="M19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
              </svg>
            </button>
            <div class="doc-selection-checkbox">
              <div class="selection-checkmark">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20,6 9,17 4,12"></polyline>
                </svg>
              </div>
            </div>
          </div>
        </div>

        <div class="doc-selection-card" data-id="F">
          <div class="doc-selection-content">
            <div class="doc-selection-title">신분증</div>
          </div>
          <div class="doc-selection-actions">
            <button class="upload-btn" onclick="uploadDocument('F')">업로드</button>
            <button class="preview-btn" onclick="previewDocument('F')">보기</button>
            <button class="card-delete-btn" onclick="deleteSingleDocument('F')" style="display: none;">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3,6 5,6 21,6"></polyline>
                <path d="M19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
              </svg>
            </button>
            <div class="doc-selection-checkbox">
              <div class="selection-checkmark">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20,6 9,17 4,12"></polyline>
                </svg>
              </div>
            </div>
          </div>
        </div>

        <div class="doc-selection-card" data-id="G">
          <div class="doc-selection-content">
            <div class="doc-selection-title">고령자 서류</div>
          </div>
          <div class="doc-selection-actions">
            <button class="upload-btn" onclick="uploadDocument('G')">업로드</button>
            <button class="preview-btn" onclick="previewDocument('G')">보기</button>
            <button class="card-delete-btn" onclick="deleteSingleDocument('G')" style="display: none;">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3,6 5,6 21,6"></polyline>
                <path d="M19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
              </svg>
            </button>
            <div class="doc-selection-checkbox">
              <div class="selection-checkmark">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20,6 9,17 4,12"></polyline>
                </svg>
              </div>
            </div>
          </div>
        </div>

        <!-- 추가 업로드 박스 -->
        <div class="add-upload-box" onclick="addNewDocument()">
          <div class="add-upload-content">
            <div class="add-upload-icon">+</div>
            <div class="add-upload-text">항목 추가하기</div>
          </div>
        </div>

      </div>

      <div class="foot">
        <button class="btn btn-save" style="flex:1">저장하기</button>
        <button class="btn btn-primary" style="flex:1">공유하기</button>
      </div>
    </div>

    <!-- 탭 콘텐츠: 공유 문서함 -->
    <div id="tab-shared" style="display:none">
      <div class="document-cards">
        <div class="doc-selection-card" data-id="H">
          <div class="doc-selection-content">
            <div class="doc-selection-title">현장 안전 수칙(공유)</div>
          </div>
          <div class="doc-selection-actions">
            <button class="upload-btn" onclick="uploadDocument('H')">업로드</button>
            <button class="preview-btn" onclick="previewDocument('H')">보기</button>
            <button class="card-delete-btn" onclick="deleteSingleDocument('H')" style="display: none;">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3,6 5,6 21,6"></polyline>
                <path d="M19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
              </svg>
            </button>
            <div class="doc-selection-checkbox">
              <div class="selection-checkmark">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20,6 9,17 4,12"></polyline>
                </svg>
              </div>
            </div>
          </div>
        </div>

        <div class="doc-selection-card" data-id="I">
          <div class="doc-selection-content">
            <div class="doc-selection-title">장비 점검 체크리스트</div>
          </div>
          <div class="doc-selection-actions">
            <button class="upload-btn" onclick="uploadDocument('I')">업로드</button>
            <button class="preview-btn" onclick="previewDocument('I')">보기</button>
            <button class="card-delete-btn" onclick="deleteSingleDocument('I')" style="display: none;">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3,6 5,6 21,6"></polyline>
                <path d="M19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
              </svg>
            </button>
            <div class="doc-selection-checkbox">
              <div class="selection-checkmark">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20,6 9,17 4,12"></polyline>
                </svg>
              </div>
            </div>
          </div>
        </div>

        <!-- 공유문서함 항목 추가 박스 -->
        <div class="add-upload-box" onclick="addNewDocument('shared')">
          <div class="add-upload-content">
            <div class="add-upload-icon">+</div>
            <div class="add-upload-text">항목 추가하기</div>
          </div>
        </div>
      </div>

      <div class="foot">
        <button class="btn btn-save" style="flex:1">저장하기</button>
        <button class="btn btn-primary" style="flex:1">공유하기</button>
      </div>
    </div>
  </div>


<script>
  // 탭 전환
  const tabs=document.querySelectorAll('.tab');
  const panes={ mine:document.getElementById('tab-mine'), shared:document.getElementById('tab-shared') };
  tabs.forEach(t=>{
    t.onclick=()=>{
      tabs.forEach(x=>{x.classList.remove('active'); x.setAttribute('aria-selected','false');});
      t.classList.add('active'); t.setAttribute('aria-selected','true');
      panes.mine.style.display = t.dataset.tab==='mine'?'block':'none';
      panes.shared.style.display = t.dataset.tab==='shared'?'block':'none';
    };
  });

  // 선택 카드 클릭 동작
  document.querySelectorAll('.doc-selection-card').forEach(card => {
    card.addEventListener('click', function(e) {
      // 체크박스나 보기 버튼, 업로드 버튼 클릭 시에는 카드 선택 동작을 하지 않음
      if (e.target.closest('.doc-selection-checkbox') || e.target.closest('.preview-btn') || e.target.closest('.upload-btn')) {
        return;
      }
      
      // 같은 탭 내의 모든 카드에서 active 클래스 제거
      const currentTab = card.closest('[id^="tab-"]');
      currentTab.querySelectorAll('.doc-selection-card').forEach(c => c.classList.remove('active'));
      // 클릭된 카드에 active 클래스 추가
      card.classList.add('active');
    });
  });

  // 체크박스 클릭 동작
  document.querySelectorAll('.selection-checkmark').forEach(checkbox => {
    checkbox.addEventListener('click', function(e) {
      e.stopPropagation(); // 카드 클릭 이벤트 방지
      
      const card = this.closest('.doc-selection-card');
      const isActive = card.classList.contains('active');
      
      if (isActive) {
        // 선택 해제
        card.classList.remove('active');
        this.classList.remove('active');
      } else {
        // 선택
        card.classList.add('active');
        this.classList.add('active');
      }
    });
  });

  // 제목 클릭 시 전체 텍스트 토글
  document.querySelectorAll('.doc-selection-title').forEach(title => {
    title.addEventListener('click', function(e) {
      e.stopPropagation(); // 카드 선택 이벤트 방지
      
      // expanded 클래스 토글
      this.classList.toggle('expanded');
      
      // 다른 모든 제목에서 expanded 클래스 제거
      document.querySelectorAll('.doc-selection-title').forEach(otherTitle => {
        if (otherTitle !== this) {
          otherTitle.classList.remove('expanded');
        }
      });
    });
  });



  // 검색(간단 필터)
  document.getElementById('q').oninput=(e)=>{
    const v=e.target.value.toLowerCase();
    document.querySelectorAll('.document-cards .doc-selection-card').forEach(el=>{
      const title = el.querySelector('.doc-selection-title').textContent.toLowerCase();
      const ok = title.includes(v);
      el.style.display = ok?'block':'none';
    });
  };

  // 버튼 클릭 애니메이션
  document.querySelectorAll('.btn').forEach(button => {
    button.addEventListener('click', function(e) {
      // 클릭된 버튼에 애니메이션 클래스 추가
      this.classList.add('clicked');
      
      // 애니메이션 완료 후 클래스 제거
      setTimeout(() => {
        this.classList.remove('clicked');
      }, 600);
    });
  });

  // DOM이 로드된 후 검색 기능 설정
  document.addEventListener('DOMContentLoaded', function() {
    // 취소 버튼 기능
    const cancelBtn = document.querySelector('.cancel-btn');
    if (cancelBtn) {
      cancelBtn.addEventListener('click', function() {
        const searchInput = document.getElementById('q');
        if (searchInput) {
          searchInput.value = '';
        }
        // 검색 필터 초기화
        document.querySelectorAll('.document-cards .doc-selection-card').forEach(el => {
          el.style.display = 'block';
        });
      });
    }
  });


  // 선택된 문서들 가져오기
  function getSelectedDocuments() {
    const selectedCards = document.querySelectorAll('.doc-selection-card.active');
    return Array.from(selectedCards).map(card => {
      const title = card.querySelector('.doc-selection-title').textContent;
      const id = card.dataset.id;
      return { id, title };
    });
  }


  // 문서 저장 함수
  function saveDocuments(docs) {
    const savedDocs = JSON.parse(localStorage.getItem('savedDocuments') || '[]');
    const newDocs = docs.filter(doc => 
      !savedDocs.some(saved => saved.title === doc.title)
    );
    
    if (newDocs.length > 0) {
      savedDocs.push(...newDocs);
      localStorage.setItem('savedDocuments', JSON.stringify(savedDocs));
      alert(`${newDocs.length}개의 문서가 저장되었습니다.`);
    } else {
      alert('이미 저장된 문서들입니다.');
    }
    
    document.querySelectorAll('.doc-check').forEach(checkbox => {
      checkbox.checked = false;
    });
  }

  // 문서 삭제 함수
  function deleteDocuments(docs) {
    if (confirm(`선택한 ${docs.length}개의 문서를 삭제하시겠습니까?`)) {
      docs.forEach(doc => {
        const card = document.querySelector(`[data-id="${doc.id}"]`);
        if (card) {
          card.remove();
        }
      });
      alert(`${docs.length}개의 문서가 삭제되었습니다.`);
    }
  }

  // DOM이 로드된 후 이벤트 설정
  document.addEventListener('DOMContentLoaded', function() {
    // 기존 문서 카드들에 이벤트 설정
    document.querySelectorAll('.doc-selection-card').forEach(card => {
      setupDocumentCardEvents(card);
    });
    
    // 전역 체크마크 클릭 이벤트 위임 (토글 기능 보완)
    document.addEventListener('click', function(e) {
      if (e.target.closest('.selection-checkmark')) {
        const checkmark = e.target.closest('.selection-checkmark');
        const card = checkmark.closest('.doc-selection-card');
        
        if (checkmark && card) {
          e.stopPropagation();
          
          // 현재 체크마크가 이미 활성화된 상태인지 확인
          const isCheckmarkActive = checkmark.classList.contains('active');
          console.log('전역 체크마크 클릭 - 현재 상태:', isCheckmarkActive ? '활성화됨' : '비활성화됨');
          
          if (isCheckmarkActive) {
            // 이미 활성화된 상태라면 비활성화 (토글 해제)
            console.log('전역 체크마크 비활성화 - 토글 해제');
            checkmark.classList.remove('active');
            card.classList.remove('active');
          } else {
            // 비활성화된 상태라면 활성화 (토글 선택)
            console.log('전역 체크마크 활성화 - 토글 선택');
            // 현재 탭의 모든 카드에서 active 클래스 제거
            const currentTab = card.closest('[id^="tab-"]');
            if (currentTab) {
              currentTab.querySelectorAll('.doc-selection-card').forEach(c => c.classList.remove('active'));
              currentTab.querySelectorAll('.selection-checkmark').forEach(m => m.classList.remove('active'));
            }
            
            // 현재 카드와 체크마크에 active 클래스 추가
            checkmark.classList.add('active');
            card.classList.add('active');
          }
        }
      }
    });
  });

  // DOM이 로드된 후 모든 이벤트 설정
  document.addEventListener('DOMContentLoaded', function() {
    // 기존 저장하기/공유하기 버튼 기능 (하단 버튼들)
    document.querySelectorAll('.btn-save').forEach(btn => {
      btn.addEventListener('click', function() {
        const selectedDocs = getSelectedDocuments();
        if (selectedDocs.length === 0) {
          alert('저장할 문서를 선택해주세요.');
          return;
        }
        saveDocuments(selectedDocs);
      });
    });

    document.querySelectorAll('.btn-primary').forEach(btn => {
      btn.addEventListener('click', function() {
        const selectedDocs = getSelectedDocuments();
        if (selectedDocs.length === 0) {
          alert('공유할 문서를 선택해주세요.');
          return;
        }
        showShareModal(selectedDocs);
      });
    });
    
    // 전역 클릭 이벤트 - 삭제 버튼 외의 영역 클릭 시 삭제 버튼 숨기기
    document.addEventListener('click', function(e) {
      // 삭제 버튼이 표시된 상태인지 확인
      const visibleDeleteBtn = document.querySelector('.delete-btn[style*="inline-flex"]');
      if (visibleDeleteBtn) {
        // 클릭한 요소가 삭제 버튼이 아닌 경우
        if (!e.target.closest('.delete-btn')) {
          hideAllDeleteButtons();
        }
      }
    });
    
    // 터치 이벤트도 추가 (모바일 지원)
    document.addEventListener('touchstart', function(e) {
      // 삭제 버튼이 표시된 상태인지 확인
      const visibleDeleteBtn = document.querySelector('.delete-btn[style*="inline-flex"]');
      if (visibleDeleteBtn) {
        // 터치한 요소가 삭제 버튼이 아닌 경우
        if (!e.target.closest('.delete-btn')) {
          hideAllDeleteButtons();
        }
      }
    });
    
    // ESC 키 이벤트 - 삭제 버튼 숨기기
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        const visibleDeleteBtn = document.querySelector('.delete-btn[style*="inline-flex"]');
        if (visibleDeleteBtn) {
          hideAllDeleteButtons();
        }
      }
    });
    
  });

  // 공유 모달 표시 함수
  function showShareModal(docs) {
    const modal = document.createElement('div');
    modal.className = 'share-modal';
    modal.innerHTML = `
      <div class="share-modal-content">
        <div class="share-modal-header">
          <h3>공유 방법 선택</h3>
          <button class="share-modal-close">×</button>
        </div>
        <div class="share-modal-body">
          <p>선택된 문서: ${docs.length}개</p>
          <div class="share-options">
            <button class="share-option" data-method="email">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                <polyline points="22,6 12,13 2,6"></polyline>
              </svg>
              이메일로 공유
            </button>
            <button class="share-option" data-method="kakao">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 3C6.5 3 2 6.6 2 11c0 2.5 1.4 4.7 3.5 6.2L5 21l4-1.5c1 .3 2.1.5 3 .5 5.5 0 10-3.6 10-8S17.5 3 12 3z"/>
              </svg>
              카카오톡으로 공유
            </button>
          </div>
        </div>
      </div>
    `;

    // 모달 스타일 추가
    const style = document.createElement('style');
    style.textContent = `
      .share-modal {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
      }
      .share-modal-content {
        background: white;
        border-radius: 16px;
        width: 320px;
        max-width: 90vw;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      }
      .share-modal-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 20px 24px;
        border-bottom: 1px solid #e5e7eb;
      }
      .share-modal-header h3 {
        margin: 0;
        font-size: 18px;
        font-weight: 700;
        color: #111827;
      }
      .share-modal-close {
        background: none;
        border: none;
        font-size: 24px;
        color: #6b7280;
        cursor: pointer;
        padding: 0;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .share-modal-body {
        padding: 24px;
      }
      .share-modal-body p {
        margin: 0 0 20px 0;
        color: #6b7280;
        font-size: 14px;
      }
      .share-options {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }
      .share-option {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 16px;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        background: white;
        cursor: pointer;
        transition: all 0.2s ease;
        font-size: 16px;
        font-weight: 500;
        color: #374151;
      }
      .share-option:hover {
        background: #f9fafb;
        border-color: #d1d5db;
      }
      .share-option svg {
        color: #6b7280;
      }
      [data-theme="dark"] .share-modal-content {
        background: #1f2937;
      }
      [data-theme="dark"] .share-modal-header {
        border-bottom-color: #374151;
      }
      [data-theme="dark"] .share-modal-header h3 {
        color: #f9fafb;
      }
      [data-theme="dark"] .share-modal-close {
        color: #9ca3af;
      }
      [data-theme="dark"] .share-modal-body p {
        color: #9ca3af;
      }
      [data-theme="dark"] .share-option {
        background: #374151;
        border-color: #4b5563;
        color: #f9fafb;
      }
      [data-theme="dark"] .share-option:hover {
        background: #4b5563;
        border-color: #6b7280;
      }
    `;
    document.head.appendChild(style);

    document.body.appendChild(modal);

    // 모달 이벤트 리스너
    modal.querySelector('.share-modal-close').addEventListener('click', () => {
      document.body.removeChild(modal);
      document.head.removeChild(style);
    });

    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        document.body.removeChild(modal);
        document.head.removeChild(style);
      }
    });

    // 공유 옵션 클릭 이벤트
    modal.querySelectorAll('.share-option').forEach(option => {
      option.addEventListener('click', () => {
        const method = option.dataset.method;
        shareDocuments(docs, method);
        document.body.removeChild(modal);
        document.head.removeChild(style);
      });
    });
  }

  // 문서 공유 함수
  function shareDocuments(docs, method) {
    const docList = docs.map(doc => `• ${doc.title}`).join('\n');
    const shareText = `문서 공유\n\n${docList}`;

    if (method === 'email') {
      const subject = '문서 공유';
      const body = shareText;
      const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
      window.open(mailtoLink);
    } else if (method === 'kakao') {
      // 카카오톡 공유 (웹 버전)
      if (navigator.share) {
        navigator.share({
          title: '문서 공유',
          text: shareText
        }).catch(err => {
          console.log('공유 실패:', err);
          alert('카카오톡 공유 기능을 사용할 수 없습니다. 텍스트를 복사했습니다.');
          copyToClipboard(shareText);
        });
      } else {
        alert('카카오톡 공유 기능을 사용할 수 없습니다. 텍스트를 복사했습니다.');
        copyToClipboard(shareText);
      }
    }
  }

  // 클립보드 복사 함수
  function copyToClipboard(text) {
    if (navigator.clipboard) {
      navigator.clipboard.writeText(text).then(() => {
        alert('텍스트가 클립보드에 복사되었습니다.');
      });
    } else {
      // 구형 브라우저 지원
      const textArea = document.createElement('textarea');
      textArea.value = text;
      document.body.appendChild(textArea);
      textArea.select();
      document.execCommand('copy');
      document.body.removeChild(textArea);
      alert('텍스트가 클립보드에 복사되었습니다.');
    }
  }

  // 새 문서 항목 추가 함수
  function addNewDocument(tabType = 'mine') {
    const newTitle = prompt('새 문서 항목의 이름을 입력하세요:');
    if (!newTitle || newTitle.trim() === '') {
      return;
    }
    
    // 새로운 ID 생성 (기존 ID들 중 가장 큰 값 + 1)
    const existingIds = Array.from(document.querySelectorAll('.doc-selection-card[data-id]'))
      .map(card => card.dataset.id)
      .filter(id => /^[A-Z]$/.test(id))
      .map(id => id.charCodeAt(0) - 65); // A=0, B=1, ...
    
    const nextId = String.fromCharCode(65 + Math.max(...existingIds, -1) + 1);
    
    // 새 문서 카드 HTML 생성
    const newCardHTML = `
      <div class="doc-selection-card" data-id="${nextId}">
        <div class="doc-selection-content">
          <div class="doc-selection-title">${newTitle.trim()}</div>
        </div>
        <div class="doc-selection-actions">
          <button class="upload-btn" onclick="uploadDocument('${nextId}')">업로드</button>
          <button class="preview-btn" onclick="previewDocument('${nextId}')">보기</button>
          <button class="delete-btn" onclick="deleteSingleDocument('${nextId}')" style="display: none;">삭제</button>
          <div class="doc-selection-checkbox">
            <div class="selection-checkmark">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20,6 9,17 4,12"></polyline>
              </svg>
            </div>
          </div>
        </div>
      </div>
    `;
    
    // 현재 활성 탭에 따라 적절한 위치에 새 카드 삽입
    const targetTab = tabType === 'shared' ? 'tab-shared' : 'tab-mine';
    const addBox = document.querySelector(`#${targetTab} .add-upload-box`);
    
    if (addBox) {
      addBox.insertAdjacentHTML('beforebegin', newCardHTML);
    } else {
      // 만약 해당 탭에 add-upload-box가 없다면 document-cards에 추가
      const documentCards = document.querySelector(`#${targetTab} .document-cards`);
      if (documentCards) {
        documentCards.insertAdjacentHTML('beforeend', newCardHTML);
      }
    }
    
    // 새 카드에 이벤트 리스너 추가
    const newCard = document.querySelector(`[data-id="${nextId}"]`);
    setupDocumentCardEvents(newCard);
    
    alert(`"${newTitle.trim()}" 항목이 추가되었습니다.`);
  }

  // 문서 카드 이벤트 설정 함수
  function setupDocumentCardEvents(card) {
    // 카드 클릭 이벤트 (토글 기능)
    card.addEventListener('click', function(e) {
      // 체크마크, 미리보기 버튼, 업로드 버튼, 삭제 버튼 클릭 시는 카드 클릭 이벤트 무시
      if (e.target.closest('.doc-selection-checkbox') || e.target.closest('.preview-btn') || e.target.closest('.upload-btn') || e.target.closest('.delete-btn')) {
        return;
      }
      
      // 현재 카드가 이미 선택된 상태인지 확인
      const isCurrentlyActive = card.classList.contains('active');
      console.log('카드 클릭 - 현재 상태:', isCurrentlyActive ? '활성화됨' : '비활성화됨');
      
      if (isCurrentlyActive) {
        // 이미 선택된 상태라면 선택 해제 (토글 해제)
        console.log('카드 비활성화 - 토글 해제');
        card.classList.remove('active');
        const checkmark = card.querySelector('.selection-checkmark');
        if (checkmark) {
          checkmark.classList.remove('active');
        }
      } else {
        // 선택되지 않은 상태라면 선택 (토글 선택)
        console.log('카드 활성화 - 토글 선택');
        const currentTab = card.closest('[id^="tab-"]');
        if (currentTab) {
          currentTab.querySelectorAll('.doc-selection-card').forEach(c => c.classList.remove('active'));
          currentTab.querySelectorAll('.selection-checkmark').forEach(m => m.classList.remove('active'));
        }
        
        card.classList.add('active');
        const checkmark = card.querySelector('.selection-checkmark');
        if (checkmark) {
          checkmark.classList.add('active');
        }
      }
    });
    
    // 제목 클릭 이벤트 (전체 텍스트 토글)
    const title = card.querySelector('.doc-selection-title');
    if (title) {
      title.addEventListener('click', function(e) {
        e.stopPropagation();
        this.classList.toggle('expanded');
        
        // 다른 모든 제목에서 expanded 클래스 제거
        document.querySelectorAll('.doc-selection-title').forEach(otherTitle => {
          if (otherTitle !== this) {
            otherTitle.classList.remove('expanded');
          }
        });
      });
    }
    
    // 체크마크 클릭 이벤트는 전역 이벤트 위임으로 처리됨
    // 개별 이벤트는 제거하여 중복 방지
    
    // 길게 누르기 이벤트 (삭제 모드 활성화)
    let longPressTimer;
    let isLongPress = false;
    
    card.addEventListener('mousedown', function(e) {
      isLongPress = false;
      longPressTimer = setTimeout(() => {
        isLongPress = true;
        activateDeleteMode(card);
      }, 800); // 800ms 길게 누르기
    });
    
    card.addEventListener('mouseup', function(e) {
      clearTimeout(longPressTimer);
    });
    
    card.addEventListener('mouseleave', function(e) {
      clearTimeout(longPressTimer);
    });
    
    // 터치 이벤트 (모바일 지원)
    card.addEventListener('touchstart', function(e) {
      isLongPress = false;
      longPressTimer = setTimeout(() => {
        isLongPress = true;
        activateDeleteMode(card);
      }, 800);
    });
    
    card.addEventListener('touchend', function(e) {
      clearTimeout(longPressTimer);
    });
  }

  // 삭제 모드 활성화 함수 (길게 누른 카드에만)
  function activateDeleteMode(targetCard) {
    // 길게 누른 카드의 삭제 버튼만 표시
    const deleteBtn = targetCard.querySelector('.delete-btn');
    if (deleteBtn) {
      deleteBtn.style.display = 'inline-flex';
    }
  }
  
  // 단일 문서 삭제 함수 (전역 함수로 정의)
  window.deleteSingleDocument = function(docId) {
    const card = document.querySelector(`[data-id="${docId}"]`);
    if (!card) return;
    
    const title = card.querySelector('.doc-selection-title').textContent;
    
    if (confirm(`"${title}" 문서를 삭제하시겠습니까?`)) {
      card.remove();
      alert(`"${title}" 문서가 삭제되었습니다.`);
      
      // 모든 삭제 버튼 숨기기
      hideAllDeleteButtons();
    }
  }
  
  // 모든 삭제 버튼 숨기기 함수
  function hideAllDeleteButtons() {
    document.querySelectorAll('.delete-btn').forEach(btn => {
      btn.style.display = 'none';
    });
  }

  // 문서 미리보기 함수
  function previewDocument(docId) {
    const card = document.querySelector(`[data-id="${docId}"]`);
    const title = card.querySelector('.doc-selection-title').textContent;
    
    // 미리보기 모달 표시
    showDocumentPreviewModal(title, docId);
  }

  // 문서 업로드 함수
  function uploadDocument(docId) {
    const card = document.querySelector(`[data-id="${docId}"]`);
    const title = card.querySelector('.doc-selection-title').textContent;
    
    // 업로드 모달 표시
    showDocumentUploadModal(title, docId);
  }

  // 문서 미리보기 모달 표시 함수
  function showDocumentPreviewModal(docTitle, docId) {
    // 기존 모달이 있으면 제거
    const existingModal = document.getElementById('documentPreviewModal');
    if (existingModal) {
      existingModal.remove();
    }
    
    // 모달 HTML 생성
    const modalHTML = `
      <div id="documentPreviewModal" class="document-preview-modal-overlay">
        <div class="document-preview-modal">
          <div class="document-preview-modal-header">
            <h3>${docTitle}</h3>
            <button class="document-preview-modal-close">닫기</button>
          </div>
          <div class="document-preview-modal-body">
            <div class="document-preview-content">
              <div class="document-preview-placeholder">
                <div class="preview-text">
                  <h4>문서 미리보기</h4>
                  <p>${docTitle} 문서의 내용을 미리보기할 수 있습니다.</p>
                </div>
                <div class="preview-actions">
                  <button class="preview-action-btn primary" onclick="downloadDocument('${docId}')">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="7,10 12,15 17,10"></polyline>
                      <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    다운로드
                  </button>
                  <button class="preview-action-btn" onclick="shareDocument('${docId}')">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <circle cx="18" cy="5" r="3"></circle>
                      <circle cx="6" cy="12" r="3"></circle>
                      <circle cx="18" cy="19" r="3"></circle>
                      <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                      <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                    </svg>
                    공유
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    `;
    
    // 모달을 body에 추가
    document.body.insertAdjacentHTML('beforeend', modalHTML);
    
    // 모달 스타일 추가
    if (!document.getElementById('documentPreviewModalStyles')) {
      const styles = `
        <style id="documentPreviewModalStyles">
          .document-preview-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
          }
          
          .document-preview-modal {
            background: white;
            border-radius: 16px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
          }
          
          .document-preview-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid #e5e7eb;
            background: #f8fafc;
          }
          
          .document-preview-modal-header h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
          }
          
          .document-preview-modal-close {
            background: none;
            border: none;
            font-size: 14px;
            color: #6b7280;
            cursor: pointer;
            padding: 8px 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            transition: all 0.2s ease;
            font-weight: 500;
          }
          
          .document-preview-modal-close:hover {
            background: #e5e7eb;
            color: #374151;
          }
          
          .document-preview-modal-body {
            padding: 32px 24px;
            max-height: 60vh;
            overflow-y: auto;
          }
          
          .document-preview-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
          }
          
          .document-preview-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 24px;
            padding: 40px 20px;
            background: #f9fafb;
            border-radius: 12px;
            border: 2px dashed #d1d5db;
            width: 100%;
            max-width: 400px;
          }
          
          .preview-text {
            text-align: center;
          }
          
          .preview-text h4 {
            margin: 0 0 8px 0;
            font-size: 20px;
            font-weight: 600;
            color: #374151;
          }
          
          .preview-text p {
            margin: 0;
            font-size: 14px;
            color: #6b7280;
            line-height: 1.5;
          }
          
          .document-preview-placeholder svg {
            color: #9ca3af;
          }
          
          .document-preview-placeholder h4 {
            margin: 0;
            font-size: 20px;
            font-weight: 600;
            color: #374151;
          }
          
          .document-preview-placeholder p {
            margin: 0;
            font-size: 14px;
            color: #6b7280;
            line-height: 1.5;
          }
          
          .preview-actions {
            display: flex;
            gap: 12px;
            width: 100%;
          }
          
          .preview-action-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 10px 16px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            background: white;
            color: #374151;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            flex: 1;
          }
          
          .preview-action-btn:hover {
            background: #f9fafb;
            border-color: #9ca3af;
          }
          
          .preview-action-btn.primary {
            background: #1A254F;
            color: white;
            border-color: #1A254F;
          }
          
          .preview-action-btn.primary:hover {
            background: #15203D;
            border-color: #15203D;
          }
          
          .preview-action-btn.primary svg {
            stroke: white;
          }
          
          [data-theme="dark"] .document-preview-modal {
            background: #1f2937;
          }
          
          [data-theme="dark"] .document-preview-modal-header {
            background: #374151;
            border-bottom-color: #4b5563;
          }
          
          [data-theme="dark"] .document-preview-modal-header h3 {
            color: #f9fafb;
          }
          
          [data-theme="dark"] .document-preview-modal-close {
            color: #9ca3af;
          }
          
          [data-theme="dark"] .document-preview-modal-close:hover {
            background: #4b5563;
            color: #d1d5db;
          }
          
          [data-theme="dark"] .document-preview-placeholder {
            background: #374151;
            border-color: #4b5563;
          }
          
          [data-theme="dark"] .document-preview-placeholder h4 {
            color: #f9fafb;
          }
          
          [data-theme="dark"] .document-preview-placeholder p {
            color: #9ca3af;
          }
          
          [data-theme="dark"] .preview-text h4 {
            color: #f9fafb;
          }
          
          [data-theme="dark"] .preview-text p {
            color: #9ca3af;
          }
          
          [data-theme="dark"] .preview-action-btn {
            background: #374151;
            color: #f9fafb;
            border-color: #4b5563;
          }
          
          [data-theme="dark"] .preview-action-btn:hover {
            background: #4b5563;
            border-color: #6b7280;
          }
        </style>
      `;
      document.head.insertAdjacentHTML('beforeend', styles);
    }
    
    // 모달 닫기 이벤트
    document.querySelector('.document-preview-modal-close').onclick = () => {
      document.getElementById('documentPreviewModal').remove();
    };
    
    // 배경 클릭 시 모달 닫기
    document.querySelector('.document-preview-modal-overlay').onclick = (e) => {
      if (e.target.classList.contains('document-preview-modal-overlay')) {
        document.getElementById('documentPreviewModal').remove();
      }
    };
  }

  // 문서 업로드 모달 표시 함수
  function showDocumentUploadModal(docTitle, docId) {
    // 기존 모달이 있으면 제거
    const existingModal = document.getElementById('documentUploadModal');
    if (existingModal) {
      existingModal.remove();
    }
    
    // 모달 HTML 생성
    const modalHTML = `
      <div id="documentUploadModal" class="document-upload-modal-overlay">
        <div class="document-upload-modal">
          <div class="document-upload-modal-header">
            <h3>${docTitle} 업로드</h3>
            <button class="document-upload-modal-close">닫기</button>
          </div>
          <div class="document-upload-modal-body">
            <div class="upload-content">
              <div class="file-upload-area" id="fileUploadArea">
                <input type="file" id="fileInput" multiple accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.gif" style="display: none;">
                <div class="file-upload-content">
                  <div class="file-upload-text">
                    <div class="file-upload-main">파일을 선택하거나 드래그하세요</div>
                    <div class="file-upload-sub">PDF, DOC, DOCX, JPG, PNG 파일 지원</div>
                  </div>
                </div>
              </div>
              <div class="file-preview" id="filePreview"></div>
            </div>
          </div>
          <div class="document-upload-modal-footer">
            <button class="upload-action-btn secondary" onclick="closeUploadModal()">취소</button>
            <button class="upload-action-btn primary" onclick="confirmUpload('${docId}')">업로드</button>
          </div>
        </div>
      </div>
    `;
    
    // 모달을 body에 추가
    document.body.insertAdjacentHTML('beforeend', modalHTML);
    
    // 모달 스타일 추가
    if (!document.getElementById('documentUploadModalStyles')) {
      const styles = `
        <style id="documentUploadModalStyles">
          .document-upload-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
          }
          
          .document-upload-modal {
            background: white;
            border-radius: 16px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
          }
          
          .document-upload-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid #e5e7eb;
          }
          
          .document-upload-modal-header h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
          }
          
          .document-upload-modal-close {
            background: none;
            border: none;
            font-size: 16px;
            color: #6b7280;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s ease;
          }
          
          .document-upload-modal-close:hover {
            background: #f3f4f6;
            color: #374151;
          }
          
          .document-upload-modal-body {
            padding: 24px;
          }
          
          .file-upload-area {
            border: 2px dashed #d1d5db;
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            background: #f9fafb;
          }
          
          .file-upload-area:hover {
            border-color: #00BCD4;
            background: #E0FFFF;
          }
          
          .file-upload-area.dragover {
            border-color: #00BCD4;
            background: #E0FFFF;
            transform: scale(1.02);
          }
          
          .file-upload-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
          }
          
          .file-upload-text {
            display: flex;
            flex-direction: column;
            gap: 4px;
          }
          
          .file-upload-main {
            font-size: 16px;
            font-weight: 500;
            color: #374151;
          }
          
          .file-upload-sub {
            font-size: 14px;
            color: #6b7280;
          }
          
          .file-preview {
            margin-top: 20px;
            display: none;
          }
          
          .file-preview-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: #f3f4f6;
            border-radius: 8px;
            margin-bottom: 8px;
          }
          
          .file-preview-icon {
            font-size: 24px;
          }
          
          .file-preview-info {
            flex: 1;
          }
          
          .file-preview-name {
            font-size: 14px;
            font-weight: 500;
            color: #374151;
          }
          
          .file-preview-size {
            font-size: 12px;
            color: #6b7280;
          }
          
          .file-preview-remove {
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 12px;
            cursor: pointer;
          }
          
          .document-upload-modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            padding: 20px 24px;
            border-top: 1px solid #e5e7eb;
          }
          
          .upload-action-btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid transparent;
          }
          
          .upload-action-btn.primary {
            background: #00BCD4;
            color: white;
            border-color: #00BCD4;
          }
          
          .upload-action-btn.primary:hover {
            background: #0096AA;
            border-color: #0096AA;
          }
          
          .upload-action-btn.secondary {
            background: #f3f4f6;
            color: #374151;
            border-color: #d1d5db;
          }
          
          .upload-action-btn.secondary:hover {
            background: #e5e7eb;
            border-color: #9ca3af;
          }
          
          /* 다크모드 스타일 */
          [data-theme="dark"] .document-upload-modal {
            background: #1f2937;
            color: #f9fafb;
          }
          
          [data-theme="dark"] .document-upload-modal-header {
            border-bottom-color: #374151;
          }
          
          [data-theme="dark"] .document-upload-modal-header h3 {
            color: #f9fafb;
          }
          
          [data-theme="dark"] .file-upload-area {
            border-color: #4b5563;
            background: #374151;
          }
          
          [data-theme="dark"] .file-upload-area:hover {
            border-color: #00BCD4;
            background: #1f2937;
          }
          
          [data-theme="dark"] .file-upload-main {
            color: #f9fafb;
          }
          
          [data-theme="dark"] .file-upload-sub {
            color: #9ca3af;
          }
          
          [data-theme="dark"] .file-preview-item {
            background: #374151;
          }
          
          [data-theme="dark"] .file-preview-name {
            color: #f9fafb;
          }
          
          [data-theme="dark"] .file-preview-size {
            color: #9ca3af;
          }
          
          [data-theme="dark"] .document-upload-modal-footer {
            border-top-color: #374151;
          }
        </style>
      `;
      document.head.insertAdjacentHTML('beforeend', styles);
    }
    
    // 파일 업로드 이벤트 설정
    setupFileUpload();
    
    // 모달 닫기 이벤트
    document.querySelector('.document-upload-modal-close').onclick = () => {
      document.getElementById('documentUploadModal').remove();
    };
    
    // 배경 클릭 시 모달 닫기
    document.querySelector('.document-upload-modal-overlay').onclick = (e) => {
      if (e.target.classList.contains('document-upload-modal-overlay')) {
        document.getElementById('documentUploadModal').remove();
      }
    };
  }

  // 파일 업로드 설정 함수
  function setupFileUpload() {
    const fileUploadArea = document.getElementById('fileUploadArea');
    const fileInput = document.getElementById('fileInput');
    const filePreview = document.getElementById('filePreview');
    
    // 클릭으로 파일 선택
    fileUploadArea.addEventListener('click', () => {
      fileInput.click();
    });
    
    // 파일 선택 이벤트
    fileInput.addEventListener('change', (e) => {
      handleFiles(e.target.files);
    });
    
    // 드래그 앤 드롭 이벤트
    fileUploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      fileUploadArea.classList.add('dragover');
    });
    
    fileUploadArea.addEventListener('dragleave', () => {
      fileUploadArea.classList.remove('dragover');
    });
    
    fileUploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      fileUploadArea.classList.remove('dragover');
      handleFiles(e.dataTransfer.files);
    });
  }
  
  // 파일 처리 함수
  function handleFiles(files) {
    const filePreview = document.getElementById('filePreview');
    const fileInput = document.getElementById('fileInput');
    
    // 기존 미리보기 제거
    filePreview.innerHTML = '';
    filePreview.style.display = 'none';
    
    if (files.length > 0) {
      filePreview.style.display = 'block';
      
      Array.from(files).forEach((file, index) => {
        const fileItem = document.createElement('div');
        fileItem.className = 'file-preview-item';
        fileItem.innerHTML = `
          <div class="file-preview-info">
            <div class="file-preview-name">${file.name}</div>
            <div class="file-preview-size">${formatFileSize(file.size)}</div>
          </div>
          <button class="file-preview-remove" onclick="removeFile(${index})">삭제</button>
        `;
        filePreview.appendChild(fileItem);
      });
    }
  }
  
  // 파일 크기 포맷 함수
  function formatFileSize(bytes) {
    if (bytes === 0) return '0 Bytes';
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
  }
  
  // 파일 제거 함수
  function removeFile(index) {
    const filePreview = document.getElementById('filePreview');
    const fileItems = filePreview.querySelectorAll('.file-preview-item');
    if (fileItems[index]) {
      fileItems[index].remove();
    }
    
    // 모든 파일이 제거되면 미리보기 숨기기
    if (filePreview.children.length === 0) {
      filePreview.style.display = 'none';
    }
  }
  
  // 업로드 모달 닫기 함수
  function closeUploadModal() {
    const modal = document.getElementById('documentUploadModal');
    if (modal) {
      modal.remove();
    }
  }
  
  // 업로드 확인 함수
  function confirmUpload(docId) {
    const fileInput = document.getElementById('fileInput');
    const files = fileInput.files;
    
    if (files.length === 0) {
      alert('업로드할 파일을 선택해주세요.');
      return;
    }
    
    // 실제 업로드 로직 (여기서는 시뮬레이션)
    const card = document.querySelector(`[data-id="${docId}"]`);
    const title = card.querySelector('.doc-selection-title').textContent;
    
    alert(`${title}에 ${files.length}개의 파일이 업로드되었습니다.`);
    
    // 모달 닫기
    closeUploadModal();
  }

  // 문서 다운로드 함수
  function downloadDocument(docId) {
    const card = document.querySelector(`[data-id="${docId}"]`);
    const title = card.querySelector('.doc-selection-title').textContent;
    alert(`${title} 문서를 다운로드합니다.`);
  }

  // 문서 공유 함수
  function shareDocument(docId) {
    const card = document.querySelector(`[data-id="${docId}"]`);
    const title = card.querySelector('.doc-selection-title').textContent;
    alert(`${title} 문서를 공유합니다.`);
  }

  // 전역 함수로 노출
  window.addNewDocument = addNewDocument;
  window.previewDocument = previewDocument;
</script>
</body>
</html>
