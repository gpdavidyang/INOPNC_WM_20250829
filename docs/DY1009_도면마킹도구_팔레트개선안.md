# DY1009 · 도면마킹 도구 팔레트 개선안 v2

작성일: 2025-10-09 (v2)
작성자: 시스템관리자 화면/모바일 공통 UX 개선

버전 히스토리

- v1: 드롭다운 기반, 하단 컨텍스트 바 중심의 제안
- v2: 좌측 컨텍스트 패널 중심, 중복 제거 및 단순화(본 문서)

## 1) 배경과 목표

- 현 팔레트는 텍스트/드롭다운 위주로 구성되어 직관성이 낮고, 옵션이 중복 노출되어 혼란을 유발함.
- 모바일/관리자 간 동일한 조작성을 확보하고, “그림판처럼 즉시 이해되는” 아이콘 중심 UX로 개선.
- 색상=업무 의미(고정 매핑)를 어디서나 빠르게 인지·선택 가능하도록 설계.

## 2) 핵심 원칙

- 드롭다운 제거: 상시 보이는 아이콘/칩으로 단일 클릭 선택
- 컨텍스트 우선: 좌측 팔레트 내 “컨텍스트 패널”에서 활성 도구 또는 선택 항목만 노출
- 단일 진실의 위치: 동일 설정은 한 곳에서만 제어(하단 상태바는 읽기 전용)
- 의미 일관성: 색상=업무 의미(작업진행/작업완료/자재구간) 고정 매핑
- 즉시 피드백: 활성 상태 강조, 커서 미리보기 적용(스탬프 등)
- 공용화: 모바일/관리자 동일 구성·동작 유지

## 3) 색상 의미 매핑(공식)

- Red → 작업진행
- Blue → 작업완료
- Gray → 자재구간

참고: types/markup.ts 에 정의되어 있으며, 박스 라벨 자동 세팅과 함께 시스템 전반에서 사용됨.

## 4) 레이아웃(최종, v2)

- 상단 커맨드 바: [되돌리기] [다시하기] [복사] [붙여넣기] [삭제] [줌 -] [100%] [줌 +] [저장] [닫기]
- 좌측 툴스트립: 선택(MousePointer), 이동(Hand), 박스(Square), 텍스트(Type), 펜(Pencil), 스탬프(Stamp)
  - 구현: `components/markup/SharedMarkupEditor.tsx:476`
- 좌측 컨텍스트 패널: 아래 중 하나만 노출(중복 제거)
  - 선택 항목 패널(선택이 있을 때 최우선): 삭제/복사/붙여넣기 + 타입별 최소 속성
    - 구현: `components/markup/SharedMarkupEditor.tsx:515`
  - 활성 도구 패널(선택이 없을 때):
    - 박스: [자재구간(Gray)] [작업진행(Red)] [작업완료(Blue)]
      - 구현: `components/markup/SharedMarkupEditor.tsx:604`
    - 스탬프: 모양 칩(○/△/□/★), 크기 칩(S/M/L), 색상 칩(Gray/Red/Blue)
      - 구현: `components/markup/SharedMarkupEditor.tsx:614`
    - 텍스트: 크기 칩(S/M/L), 색상 칩(Gray/Red/Blue)
      - 구현: `components/markup/SharedMarkupEditor.tsx:637`
    - 펜: 색상 칩(Gray/Red/Blue), 굵기 칩(1/3/5)
      - 구현: `components/markup/SharedMarkupEditor.tsx:652`
- 하단 상태바: 읽기 전용(줌 %, 선택 수, 객체 수)
  - 구현: `components/markup/SharedMarkupEditor.tsx:685`

## 5) 조작 흐름 예시

- 박스 배치: 박스 → [작업진행(Red)] → 드래그 → 라벨 자동 세팅.
- 스탬프 배치: 스탬프 → [○][M][Blue(작업완료)] → 커서 미리보기로 위치 확인 → 클릭 배치.
- 텍스트: 텍스트 → [M][Gray] → 캔버스 클릭 → 인라인 입력 → 엔터.
- 펜: 펜 → [Blue][3px] → 드래그로 그리기.

## 6) 접근성/학습성

- 툴팁에 한글 라벨과 단축키 표기(V=선택, Space=이동(홀드), T=텍스트, P=펜, S=스탬프, R/B=박스 프리셋)
- 마지막 선택 옵션은 로컬 저장하여 재방문 시 유지(선택적)

## 7) 구현 단계(권장 시퀀스, v2)

1. 좌측 컨텍스트 패널 도입(선택 우선 → 도구 순) 및 드롭다운 제거(완료)
2. 하단 상태바 읽기 전용화 및 중복 컨트롤 제거(완료)
3. 툴팁/단축키 연결 및 최근 스탬프 조합(3개) 추가(예정)
4. 선택 근처 미니 툴바(삭제/복제/복사) 및 모바일 시트형 컨트롤(예정)

## 8) 완료 기준(AC)

- 스탬프 관련 드롭다운이 없다(모양/크기/색상 칩만 존재)
- 하단 상태바에는 상호작용 컨트롤이 없다(읽기 전용 상태만)
- 좌측 컨텍스트 패널은 “선택 항목”이 있으면 우선 표시하고, 없으면 활성 도구 설정만 표시한다
- 박스/스탬프/텍스트/펜 기본 작업이 3클릭 이내로 완료된다
- 관리자/모바일 동일 컨벤션과 의미 매핑 유지

## 9) 기술 메모

- 공용 에디터(SharedMarkupEditor)에서 좌측 팔레트 내 컨텍스트 패널을 렌더링(선택/도구 맥락)
  - 기준 코드: `components/markup/SharedMarkupEditor.tsx:515`
- 색=의미 매핑은 `types/markup.ts`의 정의(Gray/Red/Blue ↔ 자재구간/작업진행/작업완료)를 단일 소스로 사용
- 저장 시 blob: URL은 업로드로 영속 URL 확보(서버 프리뷰 업로드 API)

---

이 계획안에 따라 단계적으로 적용하여, 사용자가 추가 학습 없이도 즉시 이해·사용 가능한 팔레트를 제공합니다. 필요 시 실제 아이콘/칩 레이아웃의 시각 시안도 추가 제공 가능합니다.
