# DY0928 작업일지 화면 개선안

목표: 좌측 시안(참조 HTML: `dy_memo/new_image_html_v3.0/inopnc-page/public/raw/task.html`)과 현재 앱 우측 화면(모바일 `작업일지`)의 차이를 해소해 UI/데이터 표현을 일치시킨다.

## 핵심 차이 요약

- 탭: 시안은 단순 탭(밑줄), 현재는 캡슐형 탭 + 수량 표시.
- 기간 필터: 시안 기본값 `전체 기간`, 현재 기본값 `최근 3개월`.
- 목록 서브텍스트: 시안은 “부재명 + 작업공정”(예: `거더 면보수`) 표시, 현재는 공정 없으면 `작업 내용 미입력`으로 단일 라인.
- 현장명 표기: 시안은 현장명 앞에 `[소속]` 접두 표시.
- 기타: 검색바/취소, 현장/기간 선택의 레이아웃은 대체로 유사하나, 라벨/스타일 세부가 일부 상이.

## 수정 대상(파일/위치)

- 작업일지 메인 화면(현재 우측 화면)
  - `modules/worker-site-manager/pages/WorkLogHomePage.tsx`
    - 기간 기본값: 75줄
    - 목록 아이템 서브텍스트 구성: 354줄
    - 현장명 접두어 `[소속]` 추가: 377줄
    - 기간 셀렉트 항목/라벨에 `전체 기간` 추가: 943줄, 947줄, 955줄
    - 탭 수량 뱃지 노출 조정(선택): 531줄(스타일) 또는 893–895줄(마크업 시작점)

- 데이터 매핑(필요 시 점검)
  - `modules/mobile/services/work-log.service.ts`
    - `work_content` → `memberTypes`, `workProcesses`, `workTypes` 파싱 로직 존재(OK). 추가 수정은 불필요하나, 데이터가 비어오는 경우에 대비해 UI 쪽에서 조합 규칙을 보완.

- API (점검만)
  - `app/api/mobile/daily-reports/route.ts` (리스트 조회 경로) – 필터 쿼리 그대로 사용. 변경 불필요.

## 상세 개선 항목(권고 구현 내용)

1. 기간 기본값을 시안과 동일하게 `전체 기간`으로 변경

- 변경: `selectedPeriod` 초기값 `'3m'` → `'all'`
- 위치: `modules/worker-site-manager/pages/WorkLogHomePage.tsx:75`
- 효과: 첫 진입 시 기간 필터가 해제되어 시안과 동일한 초기 화면(전체 기간)이 보임.

2. 기간 셀렉트에 `전체 기간` 옵션 추가 및 라벨 매핑 보완

- 추가: `CustomSelectItem value="all">전체 기간</CustomSelectItem>`
- 라벨 매핑: 선택 값이 `all`일 때 `전체 기간` 표시되도록 매핑 보완
- 위치(두 군데):
  - 라벨 매핑 시작 위치: `modules/worker-site-manager/pages/WorkLogHomePage.tsx:947`
  - 옵션 추가 시작 위치: `modules/worker-site-manager/pages/WorkLogHomePage.tsx:955`
- 참고: 주석의 “only 3,6,12 months per spec”은 갱신 필요(시안 기준으로 변경).

3. 목록 서브텍스트를 “부재명 + 작업공정” 우선으로 구성

- 변경 전: 공정이 없으면 `workLog.notes || '작업 내용 미입력'`로 단일 라인
- 변경 후(권고 로직):
  - `const main = [workLog.memberTypes?.[0], workLog.workProcesses?.[0]].filter(Boolean).join(' ')`
  - `subtitle = main || workLog.workProcesses.join(', ') || workLog.notes || '작업 내용 미입력'`
- 위치: `modules/worker-site-manager/pages/WorkLogHomePage.tsx:354`
- 효과: 시안처럼 `거더 면보수` 등 자연스러운 1줄 요약 제공.

4. 현장명 앞에 `[소속]` 접두 텍스트 추가

- 변경: `workLog.siteName` 렌더링 시 `"[소속] " + workLog.siteName`로 표기
- 위치: `modules/worker-site-manager/pages/WorkLogHomePage.tsx:377`
- 비고: 실제 “소속(부서/본부)” 값 연동 요구 시, 백엔드 또는 매핑 확장 필요. 현재는 시안 시각 일치 목적의 정적 접두.

5. 탭 UI 시안화(선택)

- 차이: 시안은 밑줄형 단순 탭, 현재는 캡슐형 + 수량 뱃지.
- 옵션 A(빠른 일치): 수량 뱃지 숨김 및 밑줄 강조만 유지.
  - 스타일에서 `.worklog-tab .tab-count { display: none; }` 추가(시작 위치: `modules/worker-site-manager/pages/WorkLogHomePage.tsx:531`).
- 옵션 B(정밀 매칭): 캡슐 배경 제거·두께/색상 조정으로 밑줄형 시안 구현(동 파일의 탭 관련 스타일 블록에서 조정).

6. 기간/현장 셀렉트 라벨(시각) 정합성

- 시안: 좌측 `전체 현장`, 우측 `전체 기간`
- 현재 레이아웃 순서 동일. 선택지 문구 및 두께/색상은 `custom-select-trigger` 스타일로 이미 근접. 필요 시 폰트 굵기 600 유지 검증.

## 구현 체크리스트(수용 기준)

- 초기 진입 시 기간 표시가 `전체 기간`으로 보인다.
- 검색바 플레이스홀더가 `작업일지 검색`, 우측 `취소` 동작으로 입력값 초기화.
- 목록 각 행:
  - 상단: `[소속] {현장명}`
  - 하단: `{부재명} {작업공정}` 조합(없을 땐 공정 목록 → 비고 → `작업 내용 미입력` 순으로 대체)
  - 우측: 상태 뱃지 `임시저장`/`작성완료`, 날짜 `YYYY.MM.DD(요일)`
- 탭: `임시저장`/`작성완료` 전환 시 리스트 필터가 연동되고, 스타일이 시안과 시각적으로 충돌하지 않는다(선택적으로 수량 비노출).

## 영향 범위/부작용 점검

- 기간 기본값 변경으로 초기에 표시되는 데이터량 증가 가능성(쿼리: `/api/mobile/daily-reports`).
- `[소속]` 접두는 시각 목적의 정적 텍스트임. 실제 조직/부서 연동은 별도 요구 시 반영.
- 데이터가 비정형일 경우(배열 비어있음)에도 서브텍스트 폴백 체인으로 깨짐 없이 동작해야 함.

## 추후 확장 제안(옵션)

- 실제 부서/소속 필드 연동: `profiles` 또는 `sites` 확장에서 `department`/`organization` 매핑 후 `[소속]` 대체.
- 캘린더/상세뷰(신 UI 컴포넌트) 통합 여부 검토: `app/mobile/worklogs/page.tsx`의 V3 컴포넌트와 경험 일원화.

## 참고 파일(디자인 레퍼런스)

- 시안 HTML: `dy_memo/new_image_html_v3.0/inopnc-page/public/raw/task.html`

---

본 문서는 문서 생성 요청에 따라 추가된 작업 가이드입니다. 코드 반영이 필요하면 위 “수정 대상(파일/위치)”를 기준으로 패치 진행 바랍니다.
