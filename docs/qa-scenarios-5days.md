# INOPNC WM 검수 시나리오 × 5일 일정 매핑

본 문서는 기능 중심의 검수 시나리오를 정의하고, 5일 일정표와 시나리오를 1:1로 매핑합니다. 대상 범위는 웹/모바일(App Router) 전 구간이며, Supabase Auth/RLS와 역할 기반 UI Track을 기준으로 합니다.

## 범위와 역할

- 대상: Next.js(App Router) 웹/모바일, Supabase(DB/Storage/Auth), 관리자 대시보드, 파트너/작업자 플로우
- 환경: Vercel Preview + Staging Supabase
- 역할: 관리자(admin), 파트너(partner), 작업자(worker)

## 표기 규칙

- 시나리오 ID: 영역별 접두사 + 일련번호 (예: AUTH-01, M-WORKLOG-03, ADMIN-USER-02)
- 전제조건(P), 절차(S), 기대결과(E)
- 실패 기준은 P1(치명), P2(중대), P3(경미)로 표기

---

## 시나리오 카탈로그

### 1) 인증/인가(초기 진입, 세션, 역할 적용)

AUTH-01 로그인 성공/실패 처리

- P: 유효/무효 자격증명 계정 준비
- S: 로그인 입력 → 제출
- E: 성공 시 역할별 홈으로 이동, 실패 시 적절 오류 메시지, 속도 제한 정책 적용

AUTH-02 비밀번호 재설정 플로우

- P: 이메일 전송 가능 환경, 재설정 대상 계정
- S: 재설정 요청 → 메일 링크 → 새 비번 설정
- E: 토큰 유효성/만료 처리, 성공 후 재로그인 가능

AUTH-03 세션 만료 및 자동 재인증

- P: 짧은 만료 세션 또는 강제 만료 도구
- S: 만료 상태에서 보호 페이지 접근
- E: 안전한 로그아웃/재인증, 복귀 경로 유지

AUTH-04 역할 변경 즉시 반영(UI Track)

- P: 동일 사용자 역할 전환(admin↔partner 등)
- S: 대시보드/모바일 탭 이동
- E: 하드 리프레시 없이 메뉴/권한 반영, 캐시 불일치 없음

AUTH-05 미들웨어 라우팅 가드

- P: 비로그인/서로 다른 역할 계정
- S: 보호 라우트 접근
- E: 302/403/404 동작 기대값과 일치, 오픈리다이렉트 없음

### 2) 모바일 - 작업 일지

M-WORKLOG-01 일지 작성(필수값 검증)

- P: worker 계정, 활성 현장 존재
- S: 날짜/현장/작업유형 입력 → 저장
- E: 성공 생성, 누락 시 필드별 에러, 중복 제출 방지

M-WORKLOG-02 일지 수정/삭제 권한

- P: 본인이 작성한 일지 1건
- S: 수정 후 저장 / 삭제
- E: 본인만 가능, 타 사용자 접근 시 403

M-WORKLOG-03 첨부 업로드(오프라인→재시도)

- P: 네트워크 토글 가능, 사진 파일 3개
- S: 오프라인 상태 업로드 → 온라인 전환 자동 재시도
- E: 실패 큐 처리, 최종 링크/미리보기 정상

M-WORKLOG-04 목록/상세 동기화

- P: 일지 3건 이상
- S: 생성/수정 후 목록/상세 확인
- E: 최신 데이터 반영, 캐시 무효화 정상

### 3) 모바일 - 문서함

M-DOCS-01 업로드/미리보기/다운로드

- P: 허용 확장자/용량 파일 세트
- S: 파일 업로드 → 미리보기 → 다운로드
- E: MIME 검증/확장자 필터, 미리보기 렌더 정상

M-DOCS-02 Storage ACL/RLS 검증

- P: 서로 다른 파트너/작업자 계정
- S: 타 계정 파일 URL 직접 접근
- E: 403/서명 URL 만료 처리, 우회 불가

M-DOCS-03 폴더/태그/검색

- P: 태그/폴더가 다른 파일 5개
- S: 태그/키워드/폴더 필터링
- E: 기대 결과만 노출, 빈 결과 처리 정상

### 4) 모바일 - 현장 정보

M-SITE-01 목록/검색/필터

- P: 활성 3, 비활성 1 현장
- S: 키워드/상태 필터
- E: 페이징/정렬/필터 조합 일치

M-SITE-02 비활성 현장 접근 차단

- P: 비활성 현장 식별자
- S: 상세 진입 시도
- E: 접근 차단 및 안내 메시지

M-SITE-03 지도/좌표 링크

- P: 좌표가 있는 현장
- S: 지도 열기 링크 클릭
- E: 앱/브라우저 지도로 정상 이동

### 5) 모바일 - 자재 관리

M-MAT-01 입고/출고 기록 및 검증

- P: 재고 0/대량 자재, 단위 혼합
- S: 입고/출고 입력
- E: 음수 재고 방지, 수량/단위 변환 정확

M-MAT-02 CSV/XLSX 임포트

- P: 정상/오류 행 혼합 파일
- S: 임포트 실행
- E: 성공/실패 행 분리 리포트, 부분 반영 정책 준수

M-MAT-03 대시보드/히스토리 일관성

- P: 다양한 거래 기록
- S: 집계/히스토리 비교
- E: 합계/재고 스냅샷 일치

### 6) 모바일 - 급여

M-PAY-01 기간별 급여 집계

- P: 근무/수당/공제 샘플 데이터
- S: 기간 선택 → 집계
- E: 수식/반올림/세전·세후 정확

M-PAY-02 엑셀/PDF 출력

- P: 출력 대상 2건 이상
- S: 엑셀/PDF 내보내기
- E: 레이아웃/컬럼 포맷 일치, 다운로드 성공

### 7) 관리자 대시보드 - 사용자 관리

ADMIN-USER-01 초대/역할 부여/비활성화

- P: admin 계정, 신규 이메일
- S: 초대 → 가입 → 역할 부여/비활성/재활성
- E: 감사 로그 기록, 권한 즉시 반영

ADMIN-USER-02 권한 매트릭스 일관성

- P: 역할별 테스트 계정
- S: 메뉴/API 접근 교차 확인
- E: 정책·UI·API 권한 일관

### 8) 관리자 대시보드 - 현장 관리

ADMIN-SITE-01 생성/수정/종료

- P: 관리자 권한
- S: 현장 생성→수정→종료
- E: 종료 시 관련 입력 차단 규칙 적용

### 9) 관리자 대시보드 - 보고서

ADMIN-RPT-01 필터/집계 정확성

- P: 기간/현장/파트너 조합 데이터
- S: 필터링→합계/평균/추세 확인
- E: 수치 정확, 단위/포맷 일관

ADMIN-RPT-02 내보내기 성능

- P: 데이터 5,000+ 행
- S: 내보내기 실행
- E: 5초 이내 완료, 파일 무결성

### 10) 비기능(성능/보안/접근성)

NFR-01 LCP/TTI 핵심 페이지

- P: 프리뷰 배포 URL
- S: 측정 도구로 LCP/TTI 측정
- E: LCP ≤ 2.5s 목표 충족(프리뷰 기준)

NFR-02 취약점/보안 가드

- P: 공개/비공개 엔드포인트 목록
- S: XSS/CSRF/오픈리다이렉트/API 직접 호출 검증
- E: 우회 불가, 헤더/쿠키 설정 적정

NFR-03 접근성 기본 체크

- P: 주요 플로우 3개
- S: 키보드 내비/명도 대비/레이블 검사
- E: 중요한 저해요소 없음

---

## 5일 실행 계획과 매핑

Day 1 — 환경/스모크/접근 제어

- 목표: 프리뷰 배포/역할 계정 세팅, 라우팅 가드 확인
- 해당 시나리오: AUTH-01, AUTH-05, M-SITE-01 일부(접근), M-WORKLOG-01 스모크, M-DOCS-01 스모크
- 산출물: 스모크 결과, 블로커/리스크 목록
- 종료 기준: 주요 경로 90% 통과, P1 0건

Day 2 — 인증/인가·RLS 집중

- 목표: Auth 플로우 완전 검증, 세션/역할 반영/정책 일관성
- 해당 시나리오: AUTH-02, AUTH-03, AUTH-04, AUTH-05(심화), M-DOCS-02
- 산출물: 정책-UI 매핑표, 재현 스크립트
- 종료 기준: 권한 관련 P1/P2 0건, 정책 커버리지 100%

Day 3 — 모바일(일지/문서/현장)

- 목표: 오프라인/첨부/검색/동기화 등 UX 완성도
- 해당 시나리오: M-WORKLOG-02, M-WORKLOG-03, M-WORKLOG-04, M-DOCS-01, M-DOCS-03, M-SITE-02, M-SITE-03
- 산출물: 기능별 체크리스트 결과, UX 개선 제안
- 종료 기준: P1 0건, P2 이하 대응 계획 수립

Day 4 — 자재/급여·대시보드

- 목표: 자재 흐름/급여 계산 정확/대시보드 집계
- 해당 시나리오: M-MAT-01, M-MAT-02, M-MAT-03, M-PAY-01, M-PAY-02, ADMIN-USER-01, ADMIN-USER-02, ADMIN-SITE-01, ADMIN-RPT-01, ADMIN-RPT-02
- 산출물: 계산 검증 시트, 보고서 스크린샷/지표
- 종료 기준: 계산 오차 0, 보고서 SLA ≤ 5s

Day 5 — 비기능/릴리스 준비/회귀

- 목표: 성능/보안/접근성, 회귀 및 운영 점검
- 해당 시나리오: NFR-01, NFR-02, NFR-03 + 주요 회귀(AUTH-01/05, M-WORKLOG-핵심)
- 산출물: 최종 결함 리스트, 릴리스 노트/체크리스트
- 종료 기준: 블로커 0, 릴리스 게이트 승인

---

## 시나리오 ↔ 일정 매트릭스(Traceability)

- Day 1: AUTH-01, AUTH-05, M-SITE-01(부분), M-WORKLOG-01(스모크), M-DOCS-01(스모크)
- Day 2: AUTH-02, AUTH-03, AUTH-04, AUTH-05, M-DOCS-02
- Day 3: M-WORKLOG-02, M-WORKLOG-03, M-WORKLOG-04, M-DOCS-01, M-DOCS-03, M-SITE-02, M-SITE-03
- Day 4: M-MAT-01, M-MAT-02, M-MAT-03, M-PAY-01, M-PAY-02, ADMIN-USER-01, ADMIN-USER-02, ADMIN-SITE-01, ADMIN-RPT-01, ADMIN-RPT-02
- Day 5: NFR-01, NFR-02, NFR-03, 회귀 핵심 세트

---

## 테스트 데이터/전제조건

- 사용자: admin 1, partner 2(서로 다른 현장), worker 5
- 현장: 활성 3, 비활성 1(좌표 포함/미포함 케이스 혼합)
- 자재: 단위 혼합, 재고 0/대량, 특수문자명
- 일지: 정상/누락/경계값(자정 교대), 대용량 첨부
- 문서: 허용/비허용 확장자, 대용량·특수문자 파일명

## 리스크/우선순위

- P1: 인증/권한 우회, 데이터 손상, 내보내기 실패
- P2: 합계/집계 불일치, 캐시 불일치, 오프라인 실패 큐 유실
- P3: UI 글자 겹침, 접근성 경미 위반

## 종료 체크리스트(릴리스 게이트)

- 정책·UI·API 권한 일치 확인
- 계산/집계/보고서 정확성 검증(샘플 시트 일치)
- 성능(LCP/TTI)/보안(XSS/CSRF)/접근성 기본 충족
- 백업/복구 리허설 및 환경변수/스토리지 권한 재확인
