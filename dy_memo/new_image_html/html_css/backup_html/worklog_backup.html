<!doctype html>
<html lang="ko" data-theme="light">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>INOPNC - 작업일지</title>
<!-- 웹폰트 링크 (CSS보다 먼저) - 강화된 로딩 -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700;800&display=swap" rel="stylesheet" />
<style>
.logo-text{ font-family:'Poppins', system-ui, sans-serif; font-weight:700; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; text-rendering:optimizeLegibility; }
</style>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;600;700;800&display=swap" rel="stylesheet">
<!-- 폰트 로딩 확인 스크립트 -->
<script>
  document.fonts.ready.then(function () {
    console.log('폰트 로딩 완료:', document.fonts.check('16px "Noto Sans KR"'));
  });
</script>
  <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio"></script>
<script>tailwind.config = { darkMode: 'class' };</script>
  <!-- 공통 스타일 -->
<style>
    /* ===== CSS 변수 ===== */
    :root {
      --font: 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
      --bg: #f5f7fb; --card: #ffffff; --text: #101828; --muted: #667085; --line: #e6eaf2;
      --header-h: 56px; --nav-h: 64px; --nav-bg: #ffffff; --nav-border: #e5e7eb; --nav-text: #6b7280; --nav-text-active: #2563eb;
      --brand: #1A254F; --num: #0068FE; /* 브랜드 색상 및 번호 컬러 */
    }
    [data-theme="dark"] {
      --bg: #0f172a; --surface: #11151B; --card: #0f172a; --overlay: #0f172aCC; --line: #4A5568; --line-soft: #3A4048;
      --text: #E9EEF5; --text-muted: #A8B0BB; --icon: #B9C2CE;
      --accent: #2F6BFF; --accent-weak: #1E4EDC; --accent-ghost: #2F6BFF1A;
      --success: #22C55E; --warn: #F59E0B; --danger: #EF4444;
      --shadow: 0 10px 26px rgba(0,0,0,.35); --radius: 8px;
      --nav-bg: #11151B; --nav-border: #3A4048; --nav-text: #A8B0BB; --nav-text-active: #2F6BFF;
      --chip-active: #2F6BFF; --chip-active-line: #3B82F6;
    }
    /* ===== 기본 스타일 ===== */
    * { box-sizing: border-box; }
    body { font-family: var(--font); background: var(--bg); color: var(--text); margin: 0; padding: 0; }

    /* 탭 전환용 기본 유틸 */
    .hidden { display: none !important; }
    /* ===== 라벨 스타일 ===== */
    .label-part{
      font-family: var(--font);
      font-size: 14px; line-height: 1.2; letter-spacing:-0.1px;
      font-weight: 500; color:#6b7280;
    }
    [data-theme="dark"] .label-part{ color: #E9EEF5; }
    /* ===== 상단 헤더 ===== */
    header.appbar{ position:fixed; top:0; left:0; right:0; z-index:100; height:var(--header-h); background:var(--card); border-bottom:1px solid var(--line); }
    .bar{ max-width:960px; margin:0 auto; height:100%; display:flex; align-items:center; justify-content:space-between; padding:0 12px; }
    .brand-logo{ 
      font:800 20px/1 "Poppins",var(--font); 
      color:var(--text); 
      letter-spacing:.2px; 
      text-decoration:none; 
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
      position: relative; 
      transform: translateX(-12px); /* 좌측으로 12px 이동 */ 
      flex-shrink: 0; /* flex로 눌림 방지 */
    }
    .brand-logo img{ 
      height: 24px; 
      max-height: 28px;     /* 상한 */
      width: auto;          /* 비율 유지 */
      aspect-ratio: auto;   /* 실제 비율 유지 */
      object-fit: contain;  /* 비율 유지하며 컨테이너에 맞춤 */
      flex: 0 0 auto;       /* flex로 눌림 방지 */
      image-rendering: auto; /* 이미지 렌더링 최적화 */
      display: block;
    }
    @media(min-width: 768px){ 
      .brand-logo img{ height: 28px; } 
    }
    .brand-logo:hover{ transform: translateX(-12px) translateY(-2px); text-shadow: 0 4px 8px rgba(0,0,0,0.15); }
    .brand-logo:active{ transform: translateX(-12px) translateY(0); }
    .actions{ display:flex; align-items:center; gap:12px; }
    .icon-btn{ 
      background:transparent; 
      border:0; 
      padding:0; 
      border-radius:8px; 
      color:#374151; 
      cursor:pointer; 
      position: relative;
      width: 28px;
      height: 28px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      vertical-align: middle;
      line-height: 0;
      flex-shrink: 0;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
    }
    #btnTheme{ transform: translateX(2.5px); }
    .icon-btn:hover{ color:#1A254F; background:rgba(26, 37, 79, 0.08); }
    .icon-btn:active{ transform:scale(.95); }
    [data-theme="dark"] .icon-btn{ color:#c9d1d9; }
    [data-theme="dark"] .icon-btn:hover{ color:#3182ce; background:rgba(49, 130, 206, 0.1); }
    .appbar .icon-btn:hover{ background:none !important; } /* 헤더 아이콘 호버 시 배경색 제거 */
    [data-theme="dark"] .appbar .icon-btn:hover{ background:none !important; } /* 다크 테마 헤더 아이콘 호버 시 배경색 제거 */
    .btn-plain{ background:none; border:none; padding:0 6px; font-weight:700; font-size:14px; line-height:1; cursor:pointer; color:var(--text); }
    .btn-plain:focus{ outline:none; }
    .notification-badge{ 
      position:absolute; 
      top: -2px; 
      right: -8px; 
      background:#ff0000; 
      color:#fff; 
      font-size:10px; 
      font-weight:700; 
      min-width:16px; 
      height:16px; 
      padding: 0;
      border-radius:50%; 
      display:flex; 
      align-items:center; 
      justify-content:center; 
      border:1px solid #fff; 
      box-shadow: 0 1px 3px rgba(0,0,0,0.3);
      z-index: 2;
    }
    [data-theme="dark"] .notification-badge{ border-color:#fff; }
    .bell-img{ width:26.4px; height:26.4px; object-fit:contain; display:block; }
    
    /* 알림 아이콘 스타일 */
    .icon {
      height: 100%;
      width: 100%;
      object-fit: contain;
      flex-shrink: 0;
      display: block;
    }
    .notif {
      position: relative;
      width: 28px;
      height: 28px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      vertical-align: middle;
      line-height: 0;
      flex-shrink: 0;
      background: transparent;
      border: 0;
      padding: 0;
      border-radius: 8px;
      cursor: pointer;
    }
    .notif::before, .notif::after { content: none !important; }
    .notif, .notif * { list-style: none; }
    /* 알림 벨 애니메이션 */
    @keyframes bellRing{0%{transform:rotate(0deg) scale(1);}10%{transform:rotate(-8deg) scale(1.05);}20%{transform:rotate(8deg) scale(1.05);}30%{transform:rotate(-6deg) scale(1.03);}40%{transform:rotate(6deg) scale(1.03);}50%{transform:rotate(-4deg) scale(1.02);}60%{transform:rotate(4deg) scale(1.02);}70%{transform:rotate(-2deg) scale(1.01);}80%{transform:rotate(2deg) scale(1.01);}90%{transform:rotate(-1deg) scale(1.005);}100%{transform:rotate(0deg) scale(1);} }
    #notificationBtn.bell-ringing{ animation: bellRing 1.2s ease-in-out; }
    /* ===== 검색 전체화면 페이지 ===== */
    .search-page{ position:fixed; inset:0; z-index:9999; background:var(--card); display:none; overflow:auto; }
    .sp-head{ position:sticky; top:0; background:var(--card); padding:16px 20px; border-bottom:1px solid var(--line); display:flex; align-items:center; gap:12px; }
    .sp-back{ background:transparent; border:0; padding:8px; border-radius:8px; cursor:pointer; color:#6b7280; font-size:18px; font-weight:600; }
    .sp-input-wrap{ flex:1; position:relative; }
    .sp-input{ width:100%; height:48px; border-radius:24px; background:#fafafa; border:1px solid #e5e5e5; padding:0 50px 0 20px; font:400 16px 'Noto Sans KR',system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Malgun Gothic,sans-serif; color:#333; outline:none; }
    .sp-input::placeholder{ color:#8a8a8a; font-weight:400; }
    .sp-icon{ position:absolute; right:16px; top:50%; transform:translateY(-50%); opacity:0.7; color:#8a8a8a; }
    .sp-body{ padding:18px 20px 80px; }
    .sp-section-title{ font:700 13px var(--font); color:#98a2b3; margin:8px 0 10px; }
    .sp-list{ display:block; }
    .sp-row{ display:flex; align-items:center; gap:14px; padding:10px 4px; border-bottom:1px solid #f0f2f6; }
    .sp-num{ width:20px; text-align:right; font:800 14px var(--font); color:var(--num); }
    .sp-item{ font:400 15px 'Noto Sans KR',system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Malgun Gothic,sans-serif; color:#3b4658; }
    /* 다크 모드에서 검색 페이지 가독성 */
    [data-theme="dark"] .sp-input{ background:#2a2a2a; border-color:#404040; color:#e6e9f1; }
    [data-theme="dark"] .sp-input::placeholder{ color:#999; }
    [data-theme="dark"] .sp-row{ border-bottom:1px solid var(--line-soft) !important; }
    [data-theme="dark"] .sp-item{ color:#e6e9f1; }
    /* ★ 다크모드에서 뒤로가기/돋보기 아이콘을 화이트로 가독성 향상 */
    [data-theme="dark"] .sp-back{ color:#ffffff; }
    [data-theme="dark"] .sp-icon{ color:#ffffff; opacity:0.8; }
    /* 루사이드가 생성한 SVG에도 직접 적용(안전망) */
    [data-theme="dark"] .sp-head svg{ stroke:#ffffff; }
    /* 알림 배지 펄스 효과 */
    @keyframes notificationPulse {
      0% { transform: scale(1); background-color: #ef4444; }
      50% { transform: scale(1.2); background-color: #dc2626; }
      100% { transform: scale(1); background-color: #ef4444; }
    }
    .notification-badge.pulse {
      animation: notificationPulse 0.6s ease-in-out;
    }
    /* 새로운 알림 추가 시 배지 강조 효과 */
    @keyframes newNotificationGlow {
      0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
      100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
    }
    .notification-badge.glow {
      animation: newNotificationGlow 1s ease-out;
    }
    /* ===== 글씨 크기 스위치 ===== */
    body.fs-100{font-size:15px; font-weight:200; font-family:'Noto Sans KR',system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Malgun Gothic,sans-serif;}
    body.fs-150{
      font-size:27px; /* 15px * 1.8 = 27px */
      font-weight:200; 
      font-family:'Noto Sans KR',system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Malgun Gothic,sans-serif;
    }
    /* 큰글씨 모드에서 컨테이너 너비 조정 */
    body.fs-150 .container{
      max-width: 100%;
      padding-left: 8px;
      padding-right: 8px;
    }
    /* 큰글씨 모드에서 카드 패딩 조정 */
    body.fs-150 .card{
      padding: 8px;
    }
    /* 큰글씨 모드에서 그리드 간격 조정 */
    body.fs-150 .grid{
      gap: 6px;
    }
    /* 큰글씨 모드에서 칩 패딩 조정 */
    body.fs-150 .chip{
      padding: 4px 8px;
      font-size: 18px;
    }
    /* 큰글씨 모드에서 컨트롤 패딩 조정 */
    body.fs-150 .ctl{
      padding: 6px 8px;
      font-size: 18px;
    }
    /* 큰글씨 모드에서 헤더 패딩 조정 */
    body.fs-150 header.appbar{
      padding: 0 6px;
      height: var(--header-h); /* 높이 고정으로 로고 위치 유지 */
    }
    
    /* 큰글씨 모드에서 브랜드 로고 수직 정렬 고정 */
    body.fs-150 .brand-logo{
      line-height: var(--header-h); /* 헤더 높이와 동일하게 설정 */
      vertical-align: middle;
      font-size: 20px !important; /* 폰트 크기 고정으로 쪼개짐 방지 */
      white-space: nowrap; /* 텍스트 줄바꿈 방지 */
      overflow: hidden; /* 넘치는 텍스트 숨김 */
      text-overflow: ellipsis; /* 넘치는 텍스트에 ... 표시 */
      max-width: 120px; /* 최대 너비 제한 */
    }
    /* 큰글씨 모드에서 네비게이션 조정 */
    body.fs-150 .bottom-nav{
      padding: 0 6px;
    }
    /* 큰글씨 모드에서 제목 크기 조정 */
    body.fs-150 .q{
      font-size: 20px;
    }
    /* 큰글씨 모드에서 라벨 크기 조정 */
    body.fs-150 .text-sm{
      font-size: 16px;
    }
    /* 큰글씨 모드에서 요약 박스 조정 */
    body.fs-150 #summary{
      padding: 8px;
    }
    /* 큰글씨 모드에서 수량 컨트롤 조정 */
    body.fs-150 .qty-split3{
      height: 40px;
    }
    /* 큰글씨 모드에서 중앙 텍스트 조정 */
    body.fs-150 .qcenter{
      font-size: 18px;
    }
    /* 큰글씨 모드에서 worklog 특수 요소들 조정 */
    body.fs-150 .select-shell{
      font-size: 1.125rem;
    }
    body.fs-150 .select-shell .box{
      height: 3rem;
      padding: 0 0.875rem;
      font: 600 1.125rem/1.1 'Noto Sans KR', system-ui, sans-serif;
    }
    body.fs-150 .select-shell .arrow{
      right: 0.75rem;
      width: 0.625rem;
      height: 0.625rem;
    }
    body.fs-150 .site-select{
      font: 600 1.125rem/1.1 'Noto Sans KR', system-ui, sans-serif;
      padding: 0.5rem 0.75rem;
    }
    
    /* 기본 site-select 스타일 */
    .site-select {
      font: 600 15px/1.1 'Noto Sans KR', system-ui, sans-serif;
    }
    
    /* 모든 select 요소에 기본 폰트 스타일 적용 */
    select {
      font: 600 15px/1.1 'Noto Sans KR', system-ui, sans-serif;
    }
    /* 큰글씨 모드에서 라인 탭 조정 */
    body.fs-150 .line-tabs{
      border-bottom-width: 2px;
    }
    body.fs-150 .line-tab{
      padding: 0.625rem 0.375rem;
      font-size: 1.0625rem !important;  /* 17px * 1.5 = 25.5px (17px 기준으로 확대) */
    }
    body.fs-150 .line-tab::after{
      height: 2px;
      bottom: 0;
    }
    body.fs-150 .year-input{
      font-size: 1.125rem;
      padding: 0.5rem 0.75rem;
    }
    /* 큰글씨 모드에서 달력 조정 */
    body.fs-150 .cal-wrap{
      border-radius: 0.875rem;
    }
    body.fs-150 .cal-head{
      padding: 0.875rem 1rem;
    }
    body.fs-150 .cal-title{
      font-size: 1.125rem;
    }
    body.fs-150 .cal-grid{
      gap: 0.125rem;
    }
    body.fs-150 .dow{
      font-size: 1rem;
      padding: 0.5rem 0;
    }
    body.fs-150 .cal-day{
      font-size: 1rem;
      min-height: 2.5rem;
    }
    /* 큰글씨 모드에서 통계 조정 */
    body.fs-150 .stat{
      padding: 0.75rem;
      border-radius: 0.75rem;
    }
    body.fs-150 .stat .num{
      font-size: 1.5rem;
    }
    body.fs-150 .stat .label{
      font-size: 1rem;
    }
    /* 큰글씨 모드에서 버튼 조정 */
    body.fs-150 .btn{
      height: 2.625rem;
      padding: 0 0.875rem;
      font-size: 1rem;
      border-radius: 0.625rem;
    }
    /* 큰글씨 모드에서 필터 행 조정 */
    body.fs-150 .filter-row{
      height: 3rem;
      border-radius: 0.875rem;
    }
    body.fs-150 .filter-row .select-shell .box{
      height: 3rem;
      border-radius: 0.875rem;
    }
    body.fs-150 .month-grid{
      gap: 0.5rem;
    }
    /* 큰글씨 모드에서 컨테이너 조정 */
    body.fs-150 .container{
      max-width: 100%;
      padding-left: 0.5rem;
      padding-right: 0.5rem;
      min-height: calc(100vh - var(--header-h) - var(--nav-h));
      padding-top: calc(var(--header-h) + 10px);
      padding-bottom: calc(var(--nav-h) + 1rem);
    }
    /* 큰글씨 모드에서 메인 콘텐츠 조정 */
    body.fs-150 main{
      max-width: 30rem;
      padding-left: 1rem;
      padding-right: 1rem;
      padding-bottom: 1.5rem;
    }
    /* 큰글씨 모드에서 카드 패딩 조정 */
    body.fs-150 .card{
      padding: 0.5rem;
      margin-bottom: 0.5rem;
    }
    /* 큰글씨 모드에서 섹션 제목 조정 */
    body.fs-150 .section-title{
      font-size: 1.125rem;
      margin-bottom: 0.5rem;
    }
    /* 큰글씨 모드에서 아이콘 크기 조정 */
    body.fs-150 .icon-lg{
      width: 1.5rem;
      height: 1.5rem;
    }
    /* 큰글씨 모드에서 텍스트 크기 조정 */
    body.fs-150 .text-sm{
      font-size: 1rem;
    }
    /* 큰글씨 모드에서 마진 조정 */
    body.fs-150 .mb-3\.5{
      margin-bottom: 0.875rem;
    }
    body.fs-150 .mt-3{
      margin-top: 0.75rem;
    }
    body.fs-150 .mt-6{
      margin-top: 1.5rem;
    }
    body.fs-150 .month-item{
      font-size: 1rem;
      padding: 0.75rem 0.5rem;
    }
    /* 큰글씨 모드에서 고정 요소 위치 안정화 */
    body.fs-150 header.appbar{
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      height: var(--header-h); /* 높이 고정으로 로고 위치 유지 */
      background: var(--card);
      border-bottom: 1px solid var(--line);
      padding: 0 0.375rem;
    }
    body.fs-150 .bottom-nav-wrap{
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 50;
      height: calc(var(--nav-h) + 0.5rem);
    }
    body.fs-150 .search-page{
      position: fixed;
      inset: 0;
      z-index: 9999;
      background: var(--card);
      display: none;
      overflow: auto;
    }
    body.fs-150 .panel-body{
      padding: 0.75rem;
    }
    body.fs-150 .panel-body label{
      font-size: 1rem;
    }
    body.fs-150 .sp-input{
      font-size: 1.125rem;
      height: 3rem;
    }
    body.fs-150 .sp-row{
      padding: 0.75rem 0.25rem;
    }
    body.fs-150 .sp-item{
      font-size: 1.125rem;
    }
    body.fs-150 .sp-num{
      font-size: 1rem;
    }
    /* 큰글씨 모드에서 검색 페이지 전체 조정 */
    body.fs-150 .search-page{
      font-size: 1.125rem;
    }
    body.fs-150 .sp-head{
      padding: 1rem 1.25rem;
    }
    body.fs-150 .sp-back{
      padding: 0.75rem;
    }
    body.fs-150 .sp-back i{
      width: 1.75rem;
      height: 1.75rem;
    }
    body.fs-150 .sp-input-wrap{
      gap: 0.75rem;
    }
    body.fs-150 .sp-icon{
      width: 1.25rem;
      height: 1.25rem;
      right: 1rem;
    }
    body.fs-150 .sp-body{
      padding: 1.5rem 1.5rem 6.25rem;
    }
    body.fs-150 .sp-section-title{
      font-size: 1rem;
      margin: 0.75rem 0 1rem;
    }
    body.fs-150 .sp-list{
      gap: 0.5rem;
    }
    .fswitch{ display:inline-flex; align-items:center; gap:4px; height:28px; padding:2px; border-radius:9999px; border:1px solid var(--line); background:var(--card); transform: translateX(5px); }
    .fswitch-btn{ min-width:43px; padding:0 8px; border:0; border-radius:9999px; background:transparent; font-family:'Noto Sans KR',system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Malgun Gothic,sans-serif; font-weight:300; font-size:13px; line-height:24px; color:#475569; cursor:pointer; transition:all .15s ease; }
    .fswitch-btn.active{ background:var(--brand); color:#fff; box-shadow:0 0 0 1px rgba(0,0,0,.06) inset; }
    .fswitch-btn:focus{ outline:none; }
    [data-theme="dark"] .fswitch{ border-color:var(--line) !important; background:#0b1220; }
    [data-theme="dark"] .fswitch-btn{ color:#cbd5e1; }
    [data-theme="dark"] .fswitch-btn.active{ background:#0068FE; color:#fff; box-shadow:0 0 0 1px rgba(255,255,255,.08) inset; }
    /* ===== 하단 네비게이터 ===== */
    .bottom-nav-wrap {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 50;
    }
    .bottom-nav {
      background: var(--nav-bg);
      border-top: 1px solid var(--nav-border);
      box-shadow: 0 -6px 16px rgba(17, 24, 39, .06);
      height: var(--nav-h);
      padding-bottom: env(safe-area-inset-bottom);
    }
    .nav-list {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      max-width: 720px;
      height: 100%;
      margin: 0 auto;
      padding: 0;
      list-style: none;
    }
    .nav-item {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all .3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .nav-item:active {
      transform: scale(.95);
    }
    .nav-link {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      color: var(--nav-text);
      text-decoration: none;
      transition: all .3s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
    }
    .nav-link:hover {
      color: #1A254F;
      transform: translateY(-4px) scale(1.05);
    }
    .nav-link:hover .nav-svg {
      color: #1A254F;
    }
    .nav-link:hover .nav-label {
      color: #1A254F;
    }
    .nav-link.active {
      color: var(--nav-text-active);
    }
    .nav-label {
      font-size: 11px;
      font-weight: 600;
      line-height: 1;
    }
    .nav-ico {
      width: 26px;
      height: 26px;
      display: grid;
      place-items: center;
    }
    .nav-svg {
      width: 22px;
      height: 22px;
      transition: all .3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .nav-item:hover .nav-svg {
      transform: scale(1.2);
    }
    /* 모든 네비게이터 메뉴 기본 상태 - 통일 */
    .nav-link .nav-svg {
      color: #99A4BE;
    }
    .nav-link .nav-label {
      color: #99A4BE;
    }
    [data-theme="dark"] .nav-link:hover .nav-svg {
      color: #3182ce;
    }
    [data-theme="dark"] .nav-link:hover .nav-label {
      color: #3182ce;
    }
    /* ===== 버튼 스타일 ===== */
    .btn { 
        display: inline-flex; 
        align-items: center; 
        justify-content: center; 
        gap: 8px; 
        padding: 10px 16px; 
        border-radius: 8px; 
        font-weight: 600; 
        font-size: 14px; 
        line-height: 1; 
        cursor: pointer; 
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
        text-decoration: none; 
        border: 1px solid transparent;
        position: relative;
        overflow: hidden;
    }
    .btn:focus { outline: none; }
    .btn-primary { background: var(--brand); color: white; border-color: var(--brand); }
    .btn-primary:hover { background: #1d4ed8; border-color: #1d4ed8; }
    .btn-secondary { background: var(--card); color: var(--text); border-color: var(--line); }
    .btn-secondary:hover { background: var(--line-soft); }
    
    /* 버튼 호버 효과 */
    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }
    
    /* 버튼 클릭 효과 */
    .btn:active {
        transform: translateY(0);
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        transition: all 0.1s ease;
    }
    
    /* 버튼 포커스 효과 */
    .btn:focus {
        box-shadow: 0 0 0 3px rgba(26, 37, 79, 0.3);
    }
    
    /* 버튼 리플 효과 */
    .btn.clicked {
        animation: buttonRipple 0.6s ease-out;
    }
    
    /* 버튼 리플 애니메이션 */
    @keyframes buttonRipple {
        0% {
            transform: scale(1);
            box-shadow: 0 0 0 0 rgba(26, 37, 79, 0.4);
        }
        50% {
            transform: scale(1.02);
            box-shadow: 0 0 0 8px rgba(26, 37, 79, 0.1);
        }
        100% {
            transform: scale(1);
            box-shadow: 0 0 0 0 rgba(26, 37, 79, 0);
        }
    }
    
    /* 다크모드 버튼 리플 애니메이션 */
    @keyframes buttonRippleDark {
        0% {
            transform: scale(1);
            box-shadow: 0 0 0 0 rgba(47, 107, 255, 0.4);
        }
        50% {
            transform: scale(1.02);
            box-shadow: 0 0 0 8px rgba(47, 107, 255, 0.1);
        }
        100% {
            transform: scale(1);
            box-shadow: 0 0 0 0 rgba(47, 107, 255, 0);
        }
    }
    
    /* 다크모드 버튼 효과 */
    [data-theme="dark"] .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    
    [data-theme="dark"] .btn:focus {
        box-shadow: 0 0 0 3px rgba(47, 107, 255, 0.3);
    }
    
    [data-theme="dark"] .btn.clicked {
        animation: buttonRippleDark 0.6s ease-out;
    }
    
    /* 리플 이펙트 스타일 */
    .ripple-ink {
        position: absolute;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.35);
        transform: scale(0);
        animation: ripple 0.45s ease-out;
        pointer-events: none;
    }
    
    @keyframes ripple {
        to {
            transform: scale(1);
            opacity: 0;
        }
    }
    /* 다크모드 버튼 스타일 */
    [data-theme="dark"] .btn-primary { 
      background: #2F6BFF; 
      color: white; 
      border-color: #2F6BFF; 
    }
    [data-theme="dark"] .btn-primary:hover { 
      background: #1d4ed8; 
      border-color: #1d4ed8; 
    }
    [data-theme="dark"] .btn-secondary { 
      background: #2F343A; 
      color: white; 
      border-color: #2F343A; 
    }
    [data-theme="dark"] .btn-secondary:hover { 
      background: #3A4047; 
      border-color: #3A4047; 
    }
    /* 다크모드 급여명세서 버튼 스타일 (홈페이지와 동일) */
    [data-theme="dark"] #previewPaySlip {
      background-color: #2A323C !important;
      color: #E9EEF5 !important;
      font-weight: 700 !important;
      font-size: 14px !important;
    }
    [data-theme="dark"] #downloadPaySlip {
      background-color: #2F6BFF !important;
      font-weight: 700 !important;
      font-size: 14px !important;
    }
    /* 라이트모드 급여명세서 버튼 스타일 */
    #previewPaySlip {
      background-color: #99A4BE !important;
      color: #ffffff !important;
      font-weight: 700 !important;
      font-size: 14px !important;
    }
    #downloadPaySlip {
      background-color: #1A254F !important;
      font-weight: 700 !important;
      font-size: 14px !important;
    }
    /* 다크모드 급여 정보 입력 폼 입력박스 스타일 (홈페이지 업로드박스와 동일) */
    [data-theme="dark"] #daysWorked,
    [data-theme="dark"] #daysOff,
    [data-theme="dark"] #baseAdmin,
    [data-theme="dark"] #baseManual,
    [data-theme="dark"] #empRate,
    [data-theme="dark"] #empPercentageRate {
      background-color: #0B1F3A !important;
      color: white !important;
      border-color: #1E3A8A !important;
    }
    /* 다크모드 첨부파일 스타일 */
    [data-theme="dark"] .attachment-info {
      color: #FFFFFF !important;
    }
    [data-theme="dark"] .file-item {
      color: #FFFFFF !important;
    }
    [data-theme="dark"] .file-item span {
      color: #FFFFFF !important;
    }
    /* 다크모드 고대비 텍스트 스타일 - 모든 텍스트를 흰색으로 */
    [data-theme="dark"] .label-part,
    [data-theme="dark"] .text-gray-600,
    [data-theme="dark"] .text-gray-500,
    [data-theme="dark"] .text-gray-400,
    [data-theme="dark"] .text-gray-300,
    [data-theme="dark"] .text-gray-200,
    [data-theme="dark"] .text-gray-100,
    [data-theme="dark"] .text-gray-900,
    [data-theme="dark"] .text-gray-700,
    [data-theme="dark"] .text-gray-800 {
      color: #FFFFFF !important;
    }
    /* 숫자 값들은 기존 색상 유지하되 대비 강화 */
    [data-theme="dark"] .text-red-500 {
      color: #FF6B6B !important; /* 빨간색 강화 */
    }
    [data-theme="dark"] .text-blue-600 {
      color: #60A5FA !important; /* 파란색 강화 */
    }
    [data-theme="dark"] .text-blue-400 {
      color: #60A5FA !important; /* 파란색 강화 */
    }
    /* ===== 카드 스타일 ===== */
    .card { background: #fff; border: 1px solid #E6ECF4; border-radius: 14px; padding: 14px; box-shadow: 0 2px 10px rgba(2,6,23,.04); }
    [data-theme="dark"] .card { background: var(--card); border-color: var(--line) !important; }
    /* 급여명세서 A4 크기 맞춘 카드 컨테이너 */
    .payslip-card{ background:#fff; border:1px solid #E6ECF4; border-radius:14px; padding:14px; box-shadow:0 2px 10px rgba(2,6,23,.04); }
    [data-theme="dark"] .payslip-card{ background:var(--card); border-color:var(--line) !important; }
    .payslip-card .stage{ width:210mm; margin:0 auto; }
    .section-title { font-size: 18px; font-weight: 600; color: #1A254F; }
    [data-theme="dark"] .section-title { color: #E9EEF5; }
    /* ===== 폼 스타일 ===== */
    .form-group { margin-bottom: 16px; }
    .form-label { display: block; font-weight: 600; font-size: 14px; color: var(--text); margin-bottom: 6px; }
    .form-input { width: 100%; padding: 10px 12px; border: 1px solid var(--line); border-radius: 8px; font-size: 14px; background: var(--card); color: var(--text); }
    .form-input:focus { outline: none; border-color: var(--brand); }
    /* ===== 아이콘 스타일 ===== */
    .icon { width: 20px; height: 20px; display: inline-block; }
    .icon-sm { width: 16px; height: 16px; }
    .icon-lg { width: 24px; height: 24px; }
    /* 페이지별 고유 스타일 */
  /* 상단 라인 탭 - 홈 페이지 현장선택과 동일한 스타일 적용 */
  .line-tabs{ display:grid; grid-template-columns:1fr 1fr; border-bottom:2px solid #E5EAF3; }
  .line-tab{
    position:relative; display:flex; align-items:center; justify-content:center;
    padding:10px 6px; 
    font-size: 17px !important;        /* 홈 페이지 현장선택과 동일한 폰트 크기 */
    font-weight: 600 !important;       /* 홈 페이지 현장선택과 동일한 폰트 굵기 */
    color: #1A254F !important;         /* 홈 페이지 현장선택과 동일한 색상 */
    font-family: "Noto Sans KR", system-ui, sans-serif;
    transition: all .3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .line-tab::after{
    content:""; position:absolute; left:0; right:0; bottom:0; height:2px; background:transparent;
  }
  .line-tab.active{ color:var(--brand); }
  .line-tab.active::after{ background:#1A254F; }
  /* 다크모드에서 탭 폰트 색상 - 하이라이트라인만 파란색 */
  [data-theme="dark"] .line-tab {
    color: var(--text) !important;
  }
  [data-theme="dark"] .line-tab.active {
    color: var(--text) !important; /* 활성 탭도 기본 텍스트 색상으로 강제 설정 */
  }
  [data-theme="dark"] .line-tab:hover {
    color: var(--text) !important; /* 호버 시에도 기본 텍스트 색상 */
  }
  /* 더 강력한 선택자로 확실히 덮어쓰기 */
  [data-theme="dark"] .line-tabs .line-tab.active {
    color: var(--text) !important;
  }
  [data-theme="dark"] .line-tab.active::after {
    background: #2F6BFF !important;
  }
  [data-theme="dark"] .line-tabs {
    border-bottom-color: var(--line);
  }
  /* 상단 필터 바 */
  .filter-row{ border:1px solid var(--muted); border-radius:14px; height:48px; display:flex; align-items:center; padding:0; }
  .filter-row .select-shell{ width:100%; margin:0; }
  .filter-row .select-shell .box{ border-radius:14px; height:48px; border:none; }
  /* 달력 */
  .cal-wrap{ border:1px solid #E6ECF4; border-radius:14px; background:#fff; box-shadow:0 2px 10px rgba(2,6,23,.04); }
  [data-theme="dark"] .cal-wrap{ background: var(--card); border-color: var(--line) !important; }
  
  /* 캘린더 셀 내 작업 정보 스타일 */
  .work-info {
    margin-top: 1px;
    width: 100%;
    box-sizing: border-box;
  }
  
  .work-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1px;
    width: 100%;
    box-sizing: border-box;
  }
  
  .work-site {
    font-family: "Noto Sans KR", system-ui, sans-serif;
    font-weight: 700;
    font-size: 10px;
    color: #1A254F;
    line-height: 1.1;
    text-align: center;
    white-space: normal;
    overflow: visible;
    text-overflow: unset;
    max-width: 100%;
    word-break: keep-all;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    min-height: 20px;
    width: 100%;
    box-sizing: border-box;
  }
  
  .work-hours {
    font-family: "Noto Sans KR", system-ui, sans-serif;
    font-weight: 700;
    font-size: 14px;
    color: #0068FE;
    line-height: 1.0;
    text-align: center;
  }
  
  /* 다크모드에서 캘린더 셀 작업 정보 스타일 */
  [data-theme="dark"] .work-site {
    color: #E9EEF5;
  }
  
  [data-theme="dark"] .work-hours {
    color: #0068FE;
  }
  .cal-head{ display:flex; align-items:center; justify-content:space-between; padding:14px 16px; }
  .cal-title{ font-weight:700; color: var(--text); } /* 한단계 얇게 (기존 extrabold -> bold) */
  [data-theme="dark"] .cal-title{ color: white !important; }
  .cal-grid{ display:grid; grid-template-columns:repeat(7, minmax(0,1fr)); gap:8px; padding:12px; }
  .dow{ text-align:center; font-weight:700; color:#64748B; padding:8px 0; font-size:13px; }
  .dow.sun{ color:#EF4444; }
  /* 다크모드 요일 색상 */
  [data-theme="dark"] .dow{ color: var(--text-muted); }
  [data-theme="dark"] .dow.sun{ color: #ff6b6b; }
  .cell{ min-height:70px; border:1px solid #EEF2F7; border-radius:10px; padding:4px; background:#fff; display:flex; flex-direction:column; align-items:flex-start; justify-content:flex-start; text-align:left; margin:0; position:relative; }
  .cell.out{ opacity:.45; }
  .date{ font-weight:700; font-size:14px; color:#111827; text-align:left; margin-bottom:2px; }
  .date.sun{ color:#EF4444; }
  /* 다크모드 날짜 색상 */
  [data-theme="dark"] .date{ color: var(--text); }
  [data-theme="dark"] .date.sun{ color: #ff6b6b; }
  .workday{ background:#1A254F; color:white; padding:2px 4px; border-radius:3px; font-size:11px; font-weight:600; margin-top:auto; width:100%; box-sizing:border-box; text-align:center; line-height:1.2; }
  /* 중앙 데이터 컨테이너 */
  .cell-data{ 
    display:flex; 
    flex-direction:column; 
    align-items:center; 
    justify-content:center; 
    width:100%; 
    height:100%;
    margin-top:2px;
  }
  /* 현장명과 일수 표시 스타일 */
  .site-name{ 
    font-size:12px; 
    font-weight:600; 
    color:#1A254F; 
    text-align:center; 
    margin-bottom:1px; 
    line-height:1.0;
    word-break: keep-all;
  }
  .work-days{ 
    background:#1A254F; 
    color:white; 
    padding:1px 2px; 
    border-radius:3px; 
    font-size:12px; 
    font-weight:600; 
    text-align:center; 
    line-height:1.0;
    width:110%;
  }
  /* 다크모드 캘린더 스타일 */
  [data-theme="dark"] .cell{ background: var(--card); border-color: var(--line); }
  [data-theme="dark"] .date{ color: var(--text); }
  [data-theme="dark"] .date.sun{ color: #ff6b6b; }
  [data-theme="dark"] .workday{ background: #2F6BFF; color: white; }
  /* 다크모드 현장명과 일수 스타일 */
  [data-theme="dark"] .site-name{ color: #E9EEF5; }
  [data-theme="dark"] .work-days{ background: #2F6BFF; color: white; }
  [data-theme="dark"] .cell-data{ color: #E9EEF5; }
  .cell .text-slate-500{ margin:0; }
  /* 날짜는 좌측상단, site(태그)는 아래. 두 요소 묶음 전체는 박스 좌측상단 */
  .cal .day{
    display:flex !important;
    flex-direction:column !important;
    justify-content:flex-start !important;  /* 상단 정렬 */
    align-items:flex-start !important;       /* 좌측 정렬 */
    padding: 8px 4px !important;            /* 좌측상단 여백 */
    /* 기존 .day에 gap/padding이 있어도 좌측상단으로 맞게 강제 */
  }
  .cal .day strong{
    font-size:14px;
    margin:0 0 6px !important;          /* 날짜와 site 사이 간격 */
    align-self:flex-start !important;    /* 날짜를 좌측에 정렬 */
  }
  .cal .day .tag{
    margin:0 !important;                /* 불필요한 여백 제거 */
    align-self:center !important;
  }
  .cal .day .tag + .tag{                 /* site가 여러 개일 때 간격 */
    margin-top:4px !important;
  }
  /* 다크모드 site 현장명 */
  /* 다크모드 site 현장명 */
  [data-theme="dark"] .site-name{ color: white !important; }
  /* 제목 스타일 통일 - 홈의 빠른메뉴 제목타이틀과 동일 */
  .section-title, .stat-title, .card-title, .form-title {
    font-family: "Noto Sans KR", system-ui, sans-serif;
    font-weight: 700;
    font-size: 17px;
    line-height: 1.4;
    color: #1A254F;
  }
  
  [data-theme="dark"] .section-title,
  [data-theme="dark"] .stat-title,
  [data-theme="dark"] .card-title,
  [data-theme="dark"] .form-title {
    color: #E9EEF5;
  }
  .stat{ background:transparent; border-radius:14px; padding:14px 0; text-align:center; border:1px solid currentColor; }
  .stat .num{ font-size:22px; font-weight:900; line-height:1; }
  .stat .label{ font-size:14px; font-weight:600; }
  [data-theme="dark"] .stat .label{ color:white; }
  [data-theme="dark"] .stat .num{ color:white; }
  /* 월간통계 박스별 색상 */
  .stat-workdays{ 
    color: #0068FE; 
    background-color: rgba(0, 104, 254, 0.05); 
    border-color: rgba(0, 104, 254, 0.2);
  }
  .stat-sites{ 
    color: #2934D0; 
    background-color: rgba(41, 52, 208, 0.05); 
    border-color: rgba(41, 52, 208, 0.2);
  }
  .stat-hours{ 
    color: #00BCD4; 
    background-color: rgba(77, 208, 225, 0.12); 
    border-color: #4DD0E1;
  }
  .stat-restdays{ 
    color: #FF6B6B; 
    background-color: rgba(255, 107, 107, 0.05); 
    border-color: rgba(255, 107, 107, 0.2);
  }
  /* 다크모드 월간통계 색상 */
  [data-theme="dark"] .stat-workdays{ 
    color: white !important; 
    background-color: rgba(74, 158, 255, 0.1); 
    border-color: rgba(74, 158, 255, 0.3);
  }
  [data-theme="dark"] .stat-sites{ 
    color: white !important; 
    background-color: rgba(139, 92, 246, 0.1); 
    border-color: rgba(139, 92, 246, 0.3);
  }
  [data-theme="dark"] .stat-hours{ 
    color: white !important; 
    background-color: rgba(6, 182, 212, 0.1); 
    border-color: rgba(6, 182, 212, 0.3);
  }
  [data-theme="dark"] .stat-restdays{ 
    color: white !important; 
    background-color: rgba(248, 113, 113, 0.1); 
    border-color: rgba(248, 113, 113, 0.3);
  }
  /* 하단 네비게이션 */
  .bottom-nav a{ transition: color .2s ease; }
  .bottom-nav a:hover{ color:var(--navy); }
  /* 다크모드 달력 모달 버튼 스타일 */
  [data-theme="dark"] .btn-primary{ 
    background:#2F6BFF; 
    color:#fff; 
  }
  [data-theme="dark"] .btn-ghost{ 
    background:#2F343A; 
    border:1px solid #2F343A; 
    color:#fff; 
  }
  /* 현장선택 스타일 (홈 페이지와 동일) */
  .select-shell {
      position: relative;
      width: 100%;
      min-width: 0;
  }
  .select-shell .box {
      display: block;
      width: 100%;
      height: 48px;
      padding: 0 14px;
      border: 1px solid #E6ECF4;
      border-radius: 12px;
      background: #ffffff;
      font: 600 15px/1.1 'Noto Sans KR', system-ui, sans-serif;
      text-align: center;
      color: #000000;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
  }
  .select-shell .arrow {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      width: 10px;
      height: 10px;
      pointer-events: none;
      background: linear-gradient(45deg, #9aa3b6 50%, transparent 50%) center,
                  linear-gradient(-45deg, #9aa3b6 50%, transparent 50%) center;
      background-size: 8px 8px, 8px 8px;
      background-repeat: no-repeat;
      clip-path: polygon(50% 70%, 0 20%, 100% 20%);
  }
  .select-shell select {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      -webkit-appearance: none;  /* 크롬/사파리 기본 UI 제거 */
      -moz-appearance: none;     /* 파이어폭스 */
      appearance: none;          /* 표준 */
      cursor: pointer;
      box-sizing: border-box;    /* 테두리 포함 크기 계산 */
      border: 1px solid #E6ECF4;   /* 원하는 색상 */
      border-radius: 12px;         /* 기존과 동일한 둥근 모서리 */
      background-color: #fff;
      font: 600 15px/1.1 'Noto Sans KR', system-ui, sans-serif;
      /* 테두리 렌더링 개선 */
      outline: none;
      -webkit-border-radius: 12px;
      -moz-border-radius: 12px;
  }
  .select-shell select:focus {
      outline: none;
      border-color: #2F6BFF;      /* 포커스 시 브랜드 색상 */
  }
  /* 다크모드 select 스타일 */
  [data-theme="dark"] .select-shell select {
      background-color: #111827;
      border-color: var(--line);
      color: var(--text);
      box-sizing: border-box;    /* 테두리 포함 크기 계산 */
      border-radius: 12px;       /* 표준 속성 */
      -webkit-border-radius: 12px;
      -moz-border-radius: 12px;
  }
  [data-theme="dark"] .select-shell select:focus {
      border-color: #2F6BFF;
  }
  /* 다크모드 현장 선택박스 */
  [data-theme="dark"] .select-shell .box {
      background: transparent;
      border-color: var(--line);
      color: var(--text);
  }
  [data-theme="dark"] .select-shell .box:hover {
      background-color: rgba(255,255,255,.04);
      border-color: var(--line);
  }
  [data-theme="dark"] .select-shell .arrow {
      background: linear-gradient(45deg, #9aa3b6 50%, transparent 50%) center,
                  linear-gradient(-45deg, #9aa3b6 50%, transparent 50%) center;
      background-size: 8px 8px, 8px 8px;
      background-repeat: no-repeat;
      clip-path: polygon(50% 70%, 0 20%, 100% 20%);
  }
  [data-theme="dark"] .select-shell .box:hover .arrow {
      background: linear-gradient(45deg, #ffffff 50%, transparent 50%) center,
                  linear-gradient(-45deg, #ffffff 50%, transparent 50%) center;
      background-size: 8px 8px, 8px 8px;
      background-repeat: no-repeat;
      clip-path: polygon(50% 70%, 0 20%, 100% 20%);
  }
  /* 다크모드 현장조회필터 스타일 */
  [data-theme="dark"] .chip[data-role="site"]:active,
  [data-theme="dark"] .chip[data-role="part"]:active,
  [data-theme="dark"] .chip[data-role="proc"]:active,
  [data-theme="dark"] .chip[data-role="area"]:active {
      background-color: #2F6BFF !important;
      color: #ffffff !important;
      transform: scale(0.95) !important;
      box-shadow: 0 2px 8px rgba(47, 107, 255, 0.4) !important;
      border: 2px solid #2F6BFF !important;
  }
  [data-theme="dark"] .chip[data-role="site"]:focus,
  [data-theme="dark"] .chip[data-role="part"]:focus,
  [data-theme="dark"] .chip[data-role="proc"]:focus,
  [data-theme="dark"] .chip[data-role="area"]:focus {
      outline: none !important;
      border-color: #2F6BFF !important;
      box-shadow: 0 0 0 3px rgba(47, 107, 255, 0.3) !important;
  }
  [data-theme="dark"] .chip:hover {
    background-color: rgba(255,255,255,.04) !important;
    border-color: var(--line) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
  }
  /* 다크모드 현장선택 버튼 */
  [data-theme="dark"] [data-role="site"][data-active="true"] {
      background-color: #2F6BFF !important;
      border-color: #2F6BFF !important;
      color: #ffffff !important;
  }
  [data-theme="dark"] [data-role="site"]:not([data-active="true"]):hover {
      background-color: rgba(255,255,255,.04) !important;
      border-color: var(--line) !important;
      transform: translateY(-1px) !important;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
  }
  [data-theme="dark"] [data-role="site"]:active {
      background-color: #2F6BFF !important;
      color: #ffffff !important;
      transform: scale(0.95) !important;
      box-shadow: 0 2px 8px rgba(47, 107, 255, 0.4) !important;
  }
  [data-theme="dark"] [data-role="site"]:focus {
      outline: none !important;
      border-color: #2F6BFF !important;
      box-shadow: 0 0 0 3px rgba(47, 107, 255, 0.3) !important;
  }
  .chip {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 8px 16px;
      border: 1px solid #E5E7EB;
      border-radius: 12px;
      background-color: #ffffff;
      color: #374151;
      font-size: 14px;
      font-weight: 600;
      text-decoration: none;
      cursor: pointer;
      transition: all 0.3s ease;
      user-select: none;
      position: relative;
      overflow: hidden;
      flex: 1;
      min-width: 0;
  }
  /* 칩 버튼 클릭 및 포커스 효과 통합 */
  .chip[data-role="site"]:active,
  .chip[data-role="part"]:active,
  .chip[data-role="proc"]:active,
  .chip[data-role="area"]:active {
      background-color: #40a9ff;
      color: white;
      transform: translateY(0);
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
      border: 2px solid #1890ff;
  }
  .chip[data-role="site"]:focus,
  .chip[data-role="part"]:focus,
  .chip[data-role="proc"]:focus,
  .chip[data-role="area"]:focus {
      outline: none;
      border-color: #1890ff;
      box-shadow: 0 0 0 3px rgba(24, 144, 255, 0.3);
  }
  /* 현장선택 버튼 통합 스타일 */
  [data-role="site"][data-active="true"] {
      background-color: #EFF6FF !important;
      border-color: #BBD7FF !important;
      color: #1A56DB !important;
      transform: none !important;
  }
  [data-role="site"]:not([data-active="true"]):hover {
      background-color: #f8fafc !important;
      border-color: #cbd5e1 !important;
      transform: translateY(-1px) !important;
  }
  [data-role="site"]:focus {
      outline: none !important;
      border-color: #1890ff !important;
      box-shadow: 0 0 0 3px rgba(24, 144, 255, 0.3) !important;
  }
  .chip[data-role="site"] {
      width: 100%;
      min-width: 0;
  }
  /* row-inline과 field 스타일 - 데스크톱에서 한 줄 배치 */
  .row-inline {
      display: flex;
      gap: 16px;
      align-items: stretch; /* 높이 동일하게 맞춤 */
  }
  .field {
      flex: 1;
      min-width: 0;
  }
  /* ===== 급여명세서 관련 스타일 ===== */
  /* 미리보기 줌 컨트롤 스타일 (홈의 사진대지 생성 창과 동일) */
  .preview-zoomgroup {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    background: #fff;
    border: 1px solid #E6ECF4;
    border-radius: 8px;
    padding: 4px 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    height: 40px;
    min-width: 120px;
  }
  
  .preview-iconbtn {
    width: 32px;
    height: 32px;
    border: none;
    background: transparent;
    color: #1A254F;
    border-radius: 6px;
    font-weight: 600;
    cursor: pointer;
    font-size: 16px;
    line-height: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
  }
  
  .preview-iconbtn:hover {
    background: #f1f5f9;
    transform: scale(1.05);
  }
  
  .preview-percent {
    padding: 0 8px;
    font-weight: 700;
    color: #1A254F;
    font-size: 14px;
    min-width: 50px;
    text-align: center;
    background: transparent;
    border: none;
    line-height: 1;
  }
  
  .preview-closebtn {
    height: 36px;
    padding: 0 12px;
    border: none;
    background: #fff;
    color: #1A254F;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    line-height: 34px;
    font-size: 14px;
    border: 1px solid #E6ECF4;
    transition: all 0.2s ease;
  }
  
  .preview-closebtn:hover {
    background: #f8fafc;
  }
  
  /* 다크모드 미리보기 줌 컨트롤 스타일 */
  [data-theme="dark"] .preview-zoomgroup {
    background: var(--card);
    border-color: var(--line);
  }
  
  [data-theme="dark"] .preview-iconbtn {
    background: transparent;
    color: #ffffff;
  }
  
  [data-theme="dark"] .preview-iconbtn:hover {
    background: #374151;
  }
  
  [data-theme="dark"] .preview-percent {
    background: transparent;
    color: #ffffff;
  }
  
  [data-theme="dark"] .preview-closebtn {
    background: var(--card);
    color: #ffffff;
    border-color: var(--line);
  }
  
  [data-theme="dark"] .preview-closebtn:hover {
    background: #1E293B;
  }
  
  /* 미리보기 제목 한 줄 표시 */
  .panel-h .title {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 200px;
  }
  
  .chip {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    height: 48px;
    background-color: #ffffff;
    color: #000000;
    border: 1px solid #E6ECF4;
    border-radius: 12px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    user-select: none;
    position: relative;
    overflow: hidden;
    flex: 1;
    min-width: 0;
    word-break: keep-all;
    overflow-wrap: break-word;
    white-space: normal;
    line-height: 1.3;
    padding: 0 12px;
    font-family: 'Noto Sans KR', system-ui, sans-serif;
  }
  /* 칩 호버 효과 (선택되지 않은 상태에서만) */
  .chip:not([data-active="true"]):hover {
    background-color: #f8fafc !important;
    border-color: #cbd5e1 !important;
    transform: translateY(-1px) !important;
  }
  /* 선택됨 (Selected) 상태 */
  .chip[data-active="true"] {
    background-color: #EFF6FF !important;
    color: #1A56DB !important;
    border-color: #BBD7FF !important;
    transform: none !important;
    box-shadow: 0 2px 4px rgba(26, 86, 219, 0.2) !important;
  }
  /* 칩 클릭 효과 */
  .chip:active {
    background-color: #40a9ff;
    color: white;
    transform: translateY(0);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
    border: 2px solid #1890ff;
  }
  /* 칩 포커스 효과 */
  .chip:focus {
    outline: none;
    border-color: #1890ff;
    box-shadow: 0 0 0 3px rgba(24, 144, 255, 0.3);
  }
  .btn {
    height: 48px;
    border: 1px solid #E6ECF4;
    border-radius: 12px;
    padding: 0 16px;
    background: #ffffff;
    color: #374151;
    font: 600 14px 'Noto Sans KR', system-ui, sans-serif;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .btn:hover {
    background: #F8FAFC;
    border-color: #CBD5E1;
  }
  .btn.primary {
    background: #2563EB;
    border-color: #2563EB;
    color: #ffffff;
  }
  .btn.primary:hover {
    background: #1D4ED8;
    border-color: #1D4ED8;
  }
  .btn.primary:disabled {
    background: #9CA3AF;
    border-color: #9CA3AF;
    cursor: not-allowed;
  }
  /* 다크모드 지원 */
  [data-theme="dark"] .chip {
    background: transparent;
    border-color: var(--line);
    color: var(--text);
  }
  /* 다크모드 칩 호버 효과 (선택되지 않은 상태에서만) */
  [data-theme="dark"] .chip:not([data-active="true"]):hover {
    background-color: rgba(255,255,255,.04) !important;
    border-color: var(--line) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
  }
  /* 다크모드 칩 선택 상태 */
  [data-theme="dark"] .chip[data-active="true"] {
    background-color: transparent !important;
    border-color: var(--chip-active-line) !important;
    color: var(--text) !important;
    transform: none !important;
    box-shadow: 0 0 0 4px color-mix(in srgb, var(--chip-active) 12%, transparent) inset !important;
  }
  /* ===== 칩 스타일 ===== */
  .chip {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    height: 48px;
    background-color: #ffffff;
    color: #000000;
    border: 1px solid #E6ECF4;
    border-radius: 12px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    user-select: none;
    position: relative;
    overflow: hidden;
    flex: 1;
    min-width: 0;
    word-break: keep-all;
    overflow-wrap: break-word;
    white-space: normal;
    line-height: 1.3;
    padding: 0 12px;
    margin: 2px;
  }
  /* 칩 선택됨 상태 */
  .chip.active {
    background-color: #EFF6FF !important;
    color: #1A56DB !important;
    border-color: #BBD7FF !important;
    transform: none !important;
    box-shadow: 0 2px 4px rgba(26, 86, 219, 0.2) !important;
  }
  /* 칩 호버 효과 (선택되지 않은 상태에서만) */
  .chip:not(.active):hover {
    background-color: #f8fafc !important;
    border-color: #cbd5e1 !important;
    transform: translateY(-1px) !important;
  }
  /* 다크모드 칩 스타일 */
  [data-theme="dark"] .chip {
    border-color: var(--line);
    background: transparent;
    color: var(--text);
  }
  /* 다크모드 칩 선택 상태 */
  [data-theme="dark"] .chip.active {
    background-color: transparent !important;
    border-color: var(--chip-active-line) !important;
    color: var(--text) !important;
    transform: none !important;
    box-shadow: 0 0 0 4px color-mix(in srgb, var(--chip-active) 12%, transparent) inset !important;
  }
  /* 다크모드 칩 호버 효과 (선택되지 않은 상태에서만) */
  [data-theme="dark"] .chip:not(.active):hover {
    background-color: rgba(255,255,255,.04) !important;
    border-color: var(--line) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
  }
  /* 고용형태 선택박스 폰트 크기 */
  .chip[contenteditable="true"] {
    outline: none;
    min-width: 80px;
    cursor: text;
  }
  .chip[contenteditable="true"]:focus {
    background-color: #f0f9ff;
    border-color: #0ea5e9;
  }
  .chip[contenteditable="true"]:empty:before {
    content: attr(data-placeholder);
    color: #9ca3af;
  }
  /* 프리, 일용, 상용 버튼에 홈의 보수전/보수후와 동일한 호버 효과 적용 */
  .chip[data-value="freelance"]:hover,
  .chip[data-value="daily"]:hover,
  .chip[data-value="regular"]:hover {
    background-color: rgba(47,107,255,0.05) !important;
  }
  .chip[data-value="freelance"]:active,
  .chip[data-value="daily"]:active,
  .chip[data-value="regular"]:active {
    background-color: rgba(47,107,255,0.1) !important;
  }
  /* 직접입력 버튼의 호버/클릭 효과 제거 */
  .chip[data-value="manual"]:hover {
    background-color: inherit !important;
    border-color: inherit !important;
    transform: none !important;
    box-shadow: none !important;
  }
  .chip[data-value="manual"]:active {
    background-color: inherit !important;
    border-color: inherit !important;
    transform: none !important;
    box-shadow: none !important;
  }
  .chip[data-role="emp"] {
    font-size: 14px;
    white-space: nowrap;
  }
  /* 상용 버튼 텍스트 가운데 정렬 */
  .chip[data-value="regular"] {
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
  }
  /* 상용 % 버튼 스타일 */
  .percentage-input-btn {
    background: var(--primary);
    color: white;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: bold;
    margin-left: 5px;
    cursor: pointer;
    transition: all 0.2s ease;
  }
  .percentage-input-btn:hover {
    background: var(--primary-dark);
    transform: scale(1.1);
  }
  /* absence-reason 컨테이너 스타일 */
  .absence-reason {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    align-items: center;
  }
  [data-theme="dark"] .btn {
    background: #111827;
    border-color: #374151;
    color: #E9EEF5;
  }
  [data-theme="dark"] .btn:hover {
    background: #1F2937;
    border-color: #4B5563;
  }
  [data-theme="dark"] .btn.primary {
    background: #2F6BFF;
    border-color: #2F6BFF;
  }
  [data-theme="dark"] .btn.primary:hover {
    background: #1E4EDC;
    border-color: #1E4EDC;
  }
  /* 중요 태그 버튼 스타일 */
  .important-tag {
      background-color: rgba(0, 104, 254, 0.2); /* #0068FE 20% */
      color: #0068FE; /* #0068FE */
      padding: 6px 12px; /* 내부 여백 */
      border-radius: 8px; /* 둥근 모서리 */
      font-size: 14px; /* 폰트 크기 */
      font-weight: 500; /* 폰트 굵기 */
      display: inline-block; /* 인라인 블록 */
      border: none; /* 테두리 없음 */
      cursor: default; /* 커서 기본 */
      white-space: nowrap; /* 줄바꿈 방지 */
      font-family: 'Noto Sans KR', system-ui, sans-serif;
  }
  /* 다크모드 중요 태그 */
  [data-theme="dark"] .important-tag {
      background-color: rgba(47, 107, 255, 0.25); /* #2F6BFF 25% */
      color: #63B3ED; /* 밝은 파란색 */
  }
  /* 급여명세서 버튼 호버 효과 제거 */
  .preview-btn:hover {
    background: #99A4BE !important;
    transform: none !important;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
  }
  .preview-btn:active {
    transform: none !important;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
  }
  .download-btn:hover {
    background: #1A254F !important;
    transform: none !important;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
  }
  .download-btn:active {
    transform: none !important;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
  }
  /* ===== 인라인 미리보기 도크 ===== */
  .dock{ 
    max-width: 100%; 
    margin: 14px 0; 
    padding: 0; 
    display: none; /* 기본적으로 숨김 */
    opacity: 0;
    transition: opacity 0.3s ease;
  }
  .dock.show {
    display: block !important;
    opacity: 1;
  }
  .panel{
    width: 100%; 
    height: auto;
    min-height: 600px;
    background: #fff; 
    border-radius: 14px; 
    border: 1px solid #E6ECF4;
    box-shadow: 0 2px 10px rgba(2,6,23,.04);
    display: flex; 
    flex-direction: column; 
    overflow: hidden;
    padding: 14px;
  }
  [data-theme="dark"] .panel { 
    background: var(--card); 
    border-color: var(--line) !important; 
  }
  [data-theme="dark"] .panel-h {
    border-bottom-color: var(--line);
  }
  [data-theme="dark"] .title {
    color: #E9EEF5;
  }
  [data-theme="dark"] .btn {
    background: var(--card);
    color: #E9EEF5;
    border: none;
  }
  [data-theme="dark"] .btn:hover {
    background: #1E293B;
  }
  [data-theme="dark"] .percent {
    background: var(--card);
    color: #E9EEF5;
    border-color: var(--line);
  }
  [data-theme="dark"] .viewer {
    background: #0F172A;
    border-color: var(--line);
  }
  .panel-h{
    display: flex; 
    align-items: center; 
    justify-content: space-between;
    padding: 0 0 14px 0; 
    border-bottom: 1px solid #E6ECF4; 
    gap: 6px;
    margin-bottom: 14px;
  }
  .title{ 
    font: 600 18px/1 "Noto Sans KR"; 
    color: #1A254F; 
    margin: 0; 
  }
  .toolbar{ 
    display: flex; 
    align-items: center; 
    gap: 6px; 
  }
  .zoomgroup{ 
    display: inline-flex; 
    align-items: center; 
    gap: 4px; 
  }
  .btn{
    height: 28px; 
    padding: 0 8px; 
    border: none; 
    background: #fff; 
    color: #1A254F;
    border-radius: 8px; 
    font-weight: 600; 
    cursor: pointer; 
    line-height: 26px;
    font-size: 14px;
  }
  .btn:hover{ 
    background: #f8fafc; 
  }
  .iconbtn{ 
    width: 28px; 
    height: 28px; 
    padding: 0; 
    border-radius: 8px; 
    display: inline-flex; 
    align-items: center; 
    justify-content: center; 
  }
  .percent{
    min-width: 56px; 
    height: 28px; 
    padding: 0 6px;
    display: inline-flex; 
    align-items: center; 
    justify-content: center;
    border: 1px solid #E6ECF4; 
    border-radius: 8px; 
    font-weight: 600; 
    color: #1A254F; 
    background: #fff;
    font-variant-numeric: tabular-nums; 
    letter-spacing: 0;
    font-size: 14px;
  }
  /* ===== 뷰어: 가로 화면에 최적화 ===== */
  .viewer{ 
    flex: 1; 
    min-height: 0; 
    background: #f8fafc; 
    padding: 14px; 
    overflow: auto; 
    border-radius: 8px;
    border: 1px solid #E6ECF4;
    display: flex;
    align-items: flex-start;
    justify-content: center;
  }
  /* 급여명세서 미리보기 전용: 새로운 구조에 맞게 수정 */
  #previewDock .viewer{
    background: transparent !important;
    border: 0 !important;
    padding: 0 !important;
  }
  #previewDock .payslip-viewport{
    overflow-x: hidden; /* 가로 스크롤 숨김 */
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    contain: layout paint;
    max-height: 600px; /* 높이 줄임 */
    width: 100%;
    min-width: 100%;
    padding: 0 4px; /* 좌우 여백 줄임 */
    box-sizing: border-box;
  }
  #previewDock .stage{
    width: 100% !important;
    max-width: 100% !important;
    margin: 0 !important;
    padding: 12px !important; /* 패딩 더 줄임 */
    background: #ffffff;
    border: 1px solid #e6ecf4;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    box-sizing: border-box;
  }
  #previewDock .panel{
    background: transparent !important;
    border: 0 !important;
    box-shadow: none !important;
  }
  .stage{ 
    position: relative; 
    width: 100%; 
    min-height: 100%;
    margin: 0; 
    display: flex;
    align-items: flex-start;
    justify-content: center;
    padding: 20px 0;
  }
  .doc-zoom{ 
    transform-origin: center top; 
    max-width: 100%;
    min-height: auto;
  }
  /* ====== ▼ 급여명세서 양식 – 새로운 양식 ▼ ====== */
  @page { size: A4 portrait; margin: 16mm; }
  :root{
    --font:'Noto Sans KR',system-ui,sans-serif;
    --ink:#0F172A;
    --border:#1E2E45;
    --navy:#0E3B66;
    --sky:#E9F2FF;
    --head-fg:#FFFFFF;
    --bg:#f5f7fb; --card:#fff; --text:#101828; --line:#E6ECF4;
    --brand:#1A254F;
  }
  .sheet{ 
    width: 210mm; 
    height: 297mm; 
    margin: 0 auto; 
    background: #ffffff;
    color: #000000;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    padding: 16mm;
    box-sizing: border-box;
  }
  /* 급여명세서 카드 내부 시트도 동일한 둥근모서리 적용 */
  .payslip-card .sheet{
    border-radius: 14px;
    overflow: hidden;
  }
  
  @page{ size: A4; margin: 16mm }
  @media print{ 
    .sheet{ 
      width: 210mm; 
      height: 297mm; 
    } 
    /* 인쇄 모드에서도 제목 영역 좌우 16mm로 시트 패딩과 정렬 */
    .sheet .title-wrap{ padding: 8mm 16mm 0 !important; }
  }
  [data-theme="dark"] .sheet{ 
    background: #ffffff;
    color: #000000;
  }
  
  /* 미리보기용 급여명세서 스타일 (새로운 구조에 맞게 단순화) */
  .payslip {
    width: 100%;
    max-width: 100%;
    margin: 0;
    padding: 0;
  }
  /* 기존 복잡한 스타일 제거 - 새로운 구조에서 불필요 */
  /* 기존 복잡한 테이블 스타일 제거 - 새로운 구조에서 불필요 */
  /* 기존 복잡한 테이블 스타일 제거 - 새로운 구조에서 불필요 */
  /* 기존 복잡한 스타일 제거 - 새로운 구조에서 불필요 */
  
  /* 다크모드에서 급여명세서 양식은 라이트 버전 폰트 컬러 유지 */
  /* 다크모드 규칙 제거 - 급여명세서 양식은 항상 라이트 버전 컬러 유지 */
  
  /* ====== ▲ 원본 CSS 끝 ▲ ====== */
  
  /* ====== ▼ 새로운 급여명세서 스타일 ▼ ====== */
  /* 급여명세서 컨테이너 */
  .payslip-card{
    background:#fff; border:1px solid #E6ECF4; border-radius:14px;
    padding:14px; box-shadow:0 2px 10px rgba(2,6,23,.04);
    max-width:100%; margin:24px auto;
    padding-bottom:max(16px, env(safe-area-inset-bottom));
    width: 100%;
  }

  /* A4 본문은 인쇄 정확도를 위해 고정폭 유지 */
  .payslip-card .stage{
    width:100%;               /* 화면 너비에 맞춤 */
    margin:0 auto;
    max-width: 210mm;         /* 최대 A4 너비 */
  }

  /* 스크롤/축소 담당 */
  .payslip-viewport{
    overflow-x:auto;
    -webkit-overflow-scrolling:touch;
    contain:layout paint;
  }

  /* 모바일 화면폭 맞춤 스케일 */
  @media (max-width:820px){
    .payslip-card{ overflow:visible; }
    .payslip-viewport{
      --ps-scale: min(1, calc((100vw - 32px) / 210mm));
      min-width: calc(210mm * var(--ps-scale));
      padding-bottom:16px;
    }
    .payslip-viewport .stage{
      width:210mm;
      transform:scale(var(--ps-scale));
      transform-origin:top left;
    }
    /* 미리보기 인라인창 모바일 최적화 */
    #previewDock .payslip-viewport{
      max-height: 450px; /* 모바일에서 높이 더 줄임 */
      width: 100%;
      padding: 0 2px; /* 모바일에서 여백 더 줄임 */
    }
    #previewDock .stage{
      width: 100% !important;
      max-width: 100% !important;
      transform: none;
    }
  }

  /* 제목/서브텍스트 */
  .h2{
    font:700 28px/1.2 'Noto Sans KR',system-ui;
    color:#0d2a4a; margin:0 0 4px;
  }
  .payslip-subdate{
    font:700 14px/1 'Noto Sans KR',system-ui;
    color:#1f5dbd; text-decoration:underline; display:inline-block;
    margin:0 0 16px;
  }

  /* 표(예시) */
  .tbl{width:100%;border-collapse:collapse}
  .tbl th,.tbl td{border:1px solid #E6ECF4;padding:10px}
  .tbl thead th{background:#0f3761;color:#fff;text-align:center}
  /* ====== ▲ 새로운 급여명세서 스타일 끝 ▲ ====== */
  
  /* ====== 급여명세서 테이블 스타일 (새로운 구조에 맞춤) ====== */
  .payslip .tbl{
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
    min-width: 100%;
  }
  .payslip .tbl th,
  .payslip .tbl td{
    border: 1px solid #E6ECF4;
    padding: 6px 4px; /* 패딩 줄임 */
    text-align: center;
    word-wrap: break-word;
    overflow-wrap: break-word;
    font-size: 13px; /* 폰트 크기 줄임 */
  }
  .payslip .tbl thead th{
    background: #0f3761;
    color: #fff;
    font-weight: 700;
  }

  @media (max-width: 480px){
    .payslip .tbl th,
    .payslip .tbl td{
      padding: 6px 4px;
      font-size: 12px;
    }
    #previewDock .stage{
      padding: 6px !important; /* 모바일에서 패딩 더 줄임 */
    }
    #previewDock .payslip-viewport{
      max-height: 500px;
    }
  }
  /* ====== 급여명세서 테이블 스타일 끝 ====== */
  
  @media (max-width:840px){ .stage{ width:640px } }
  @media (max-width:680px){ .stage{ width:520px } }
</style>
  <script src="/assets/common.js" defer></script>
  <link rel="preconnect" href="https://postfiles.pstatic.net" crossorigin>
  <link rel="dns-prefetch" href="//postfiles.pstatic.net">
</head>
<body>
  <!-- ===== 상단 헤더 ===== -->
  <header class="appbar">
    <div class="bar">
      <div class="flex items-center gap-3">
        <button class="icon-btn" aria-label="메뉴" id="btnHamburger"><i data-lucide="menu" class="w-5 h-5"></i></button>
        <a href="home.html" class="brand-logo tracking-tight logo-text" id="homeLink" title="홈으로 이동">
          <img src="https://postfiles.pstatic.net/MjAyNTA5MDlfMTY2/MDAxNzU3Mzg1MDM2NjE5.LY9NCqiU7KTydmgbxO9BJRmKTHwOQz60fD0gJQKoxGog.f-406ZRNkxt_9ChiJTCNhIbmQSvgAvDDn0mU_XlIxOgg.PNG/00_%EB%A1%9C%EA%B3%A0-%EC%84%B8%EB%A1%9C%EC%A1%B0%ED%95%A9.png?type=w3840"
               srcset="https://postfiles.pstatic.net/MjAyNTA5MDlfMTY2/MDAxNzU3Mzg1MDM2NjE5.LY9NCqiU7KTydmgbxO9BJRmKTHwOQz60fD0gJQKoxGog.f-406ZRNkxt_9ChiJTCNhIbmQSvgAvDDn0mU_XlIxOgg.PNG/00_%EB%A1%9C%EA%B3%A0-%EC%84%B8%EB%A1%9C%EC%A1%B0%ED%95%A9.png?type=w3840 1x, https://postfiles.pstatic.net/MjAyNTA5MDlfMTY2/MDAxNzU3Mzg1MDM2NjE5.LY9NCqiU7KTydmgbxO9BJRmKTHwOQz60fD0gJQKoxGog.f-406ZRNkxt_9ChiJTCNhIbmQSvgAvDDn0mU_XlIxOgg.PNG/00_%EB%A1%9C%EA%B3%A0-%EC%84%B8%EB%A1%9C%EC%A1%B0%ED%95%A9.png?type=w3840 2x"
               sizes="(max-width: 480px) 120px, 160px"
               alt="INOPNC" 
               referrerpolicy="no-referrer" 
               loading="lazy" 
               decoding="async">
        </a>
      </div>
      <div class="actions">
        <!-- 1) 글씨 크기 스위치 -->
        <div class="fswitch" role="group" aria-label="글씨 크기">
          <button id="fsNormal" class="fswitch-btn active" type="button">일반</button>
          <button id="fsLarge" class="fswitch-btn" type="button">확대</button>
        </div>
        <!-- 2) 다크모드 -->
        <button id="btnTheme" class="icon-btn" aria-label="다크모드"><i data-lucide="moon" class="w-5 h-5" id="themeIcon"></i></button>
        <!-- 3) 검색 -->
        <button id="btnSearch" class="icon-btn" aria-label="검색"><i data-lucide="search" class="w-5 h-5"></i></button>
        <!-- 4) 알림 -->
        <button class="notif" aria-label="알림" id="notificationBtn">
          <img src="https://postfiles.pstatic.net/MjAyNTA5MDlfMTI4/MDAxNzU3MzczOTIzNjY1.cz65rYnLgXusuSn6OTKRtzcS3bVGqAdkQY-0GgOfW0Ug.A8e6_KKQ-P1GI4h_lx7pP4O-dqCinve_Un8_A7tVghkg.PNG/bell.png?type=w3840"
               alt="알림"
               class="icon"
               width="24"
               height="24"
               referrerpolicy="no-referrer"
               crossorigin="anonymous"
               loading="lazy"
               decoding="async"
               onerror="
                 if(!this.dataset.step){ 
                   this.dataset.step='proxy'; 
                   this.src='https://images.weserv.nl/?url=postfiles.pstatic.net%2FMjAyNTA5MDlfMTI4%2FMDAxNzU3MzczOTIzNjY1.cz65rYnLgXusuSn6OTKRtzcS3bVGqAdkQY-0GgOfW0Ug.A8e6_KKQ-P1GI4h_lx7pP4O-dqCinve_Un8_A7tVghkg.PNG%2Fbell.png%3Ftype%3Dw3840';
                 } else if(this.dataset.step==='proxy'){ 
                   this.dataset.step='fallback'; 
                   this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE4IDhBNiA2IDAgMCAwIDYgOEM2IDE1IDMgMTcgMyAxN0gyMUMyMSAxNyAxOCAxNSAxOCA4WiIgc3Ryb2tlPSIjNjc0NzUxIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8cGF0aCBkPSJNMTMgMjFWN0E1IDUgMCAwIDAgMTEgN1YyMSIgc3Ryb2tlPSIjNjc0NzUxIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8L3N2Zz4K';
                 } else { 
                   this.onerror=null; 
                 }
               "/>
          <span class="notification-badge" id="notificationBadge">3</span>
        </button>
      </div>
    </div>
  </header>
  <!-- 검색 전체화면 페이지 -->
  <div id="searchPage" class="search-page" role="dialog" aria-modal="true">
    <div class="sp-head">
      <button id="spBack" class="sp-back" aria-label="뒤로"><i data-lucide="chevron-left" class="w-6 h-6"></i></button>
      <div class="sp-input-wrap">
        <input id="spInput" class="sp-input" type="search" placeholder="현장명을 검색하세요." />
        <i data-lucide="search" class="sp-icon"></i>
      </div>
    </div>
    <div class="sp-body">
      <div class="sp-section-title">최근 검색어</div>
      <div class="sp-list" id="spList"><!-- JS 렌더 --></div>
    </div>
  </div>
  <div class="min-h-screen flex flex-col items-center" style="padding-top: calc(var(--header-h) + 10px); padding-bottom: var(--nav-h);">
    <main class="w-full max-w-[480px] mx-auto px-4 pb-6">
      <!-- 상단 라인 탭 -->
      <nav class="line-tabs rounded-t-xl overflow-hidden mb-3.5">
        <button class="line-tab active" data-tab="work">출력현황</button>
        <button class="line-tab" data-tab="pay">급여현황</button>
      </nav>
      <!-- 출력현황 콘텐츠 -->
      <div id="workView">
        <!-- 현장조회필터 -->
        <div class="mb-3.5 site-filter-section">
          <label class="select-shell" aria-label="현장 선택">
            <div class="box text-gray-900 dark:text-white" id="selectDisplay" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-weight: 600;">전체 현장</div>
            <span class="arrow" aria-hidden="true"></span>
            <select id="siteSelect">
              <option selected value="">전체 현장</option>
              <option>Site A</option><option>Site B</option><option>Site C</option>
            </select>
          </label>
        </div>
      <section class="mt-3 cal-wrap" id="calCard">
        <div class="cal-head">
          <button id="btnPrev" class="p-2 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700" aria-label="이전 달"><i data-lucide="chevron-left" class="w-5 h-5 text-gray-600 dark:text-white"></i></button>
          <button id="ymBtn" class="cal-title text-[18px] font-bold hover:text-[color:var(--brand)]"></button>
          <button id="btnNext" class="p-2 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700" aria-label="다음 달"><i data-lucide="chevron-right" class="w-5 h-5 text-gray-600 dark:text-white"></i></button>
        </div>
        <!-- 요일 -->
        <div class="cal-grid pt-0 pb-2">
          <div class="dow sun">일</div><div class="dow">월</div><div class="dow">화</div><div class="dow">수</div><div class="dow">목</div><div class="dow">금</div><div class="dow">토</div>
        </div>
        <!-- 날짜 그리드 -->
        <div class="cal-grid pb-4" id="calGrid" aria-live="polite"></div>
      </section>
      <!-- 월간 통계 -->
      <section class="mt-3.5 monthly-stats-section">
        <div class="stat-head flex items-center gap-2">
          <img
            id="iconMonthly"
            src="https://postfiles.pstatic.net/MjAyNTA5MDlfNyAg/MDAxNzU3MzczOTIzODU0.BFZq2N-z_TfqaHHXHagPVOzloVF1Pc88XGJNMFUYQ-Eg.J20ua1uJqCne8_2abHUnX6O98ITuEomvcaogesHWIsgg.PNG/%EC%9B%94%EA%B0%84%ED%86%B5%EA%B3%84.png?type=w3840"
            alt="월간 통계"
            width="27" height="27"
            decoding="async" loading="eager"
            referrerpolicy="no-referrer"
            class="w-[27px] h-[27px]"
          />
          <span class="stat-title">월간 통계</span>
        </div>
        <div class="grid grid-cols-3 gap-3 mt-3">
          <!-- 출근(일) 통계 -->
          <div class="stat stat-workdays">
            <div class="num" id="workDays">0</div>
            <div class="label">출근(일)</div>
          </div>
          <!-- 현장수 통계 -->
          <div class="stat stat-sites">
            <div class="num" id="siteCount">0</div>
            <div class="label">현장수</div>
          </div>
          <!-- 총공수 통계 -->
          <div class="stat stat-hours">
            <div class="num" id="totalManDays">0</div>
            <div class="label">총공수</div>
          </div>
        </div>
      </section>
      </div>
      <!-- 급여현황 콘텐츠 -->
      <div id="payView" class="hidden">
        <!-- 급여 필터 (한 행 구성) -->
        <div class="mt-3.5 pay-filter-section">
          <div class="flex gap-3">
            <!-- 현장 선택 -->
            <label class="select-shell flex-1" aria-label="급여 현장 선택">
              <div class="box text-gray-900 dark:text-white" id="paySiteSelectDisplay" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-weight: 600;">전체 현장</div>
              <span class="arrow" aria-hidden="true"></span>
              <select id="paySiteSelect">
                <option selected value="">전체 현장</option>
                <option>Site A</option><option>Site B</option><option>Site C</option>
              </select>
            </label>
            <!-- 기간 선택 -->
            <label class="select-shell flex-1" aria-label="급여 기간 선택">
              <div class="box text-gray-900 dark:text-white" id="payPeriodSelectDisplay" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-weight: 600;">최근 3개월</div>
              <span class="arrow" aria-hidden="true"></span>
              <select id="payPeriodSelect">
                <option selected value="3">최근 3개월</option>
                <option value="6">최근 6개월</option>
                <option value="12">최근 12개월</option>
                <option value="24">최근 24개월</option>
              </select>
            </label>
          </div>
        </div>
        <!-- 급여 통계 카드 (월간 통계 디자인 참고) -->
        <section class="mt-3.5 pay-stats-section">
          <div class="stat-head">
          </div>
          <div class="grid grid-cols-3 gap-3 mt-3">
            <!-- 출근(일) 통계 -->
            <div class="stat stat-workdays">
              <div class="num" id="payWorkDays">0</div>
              <div class="label">출근(일)</div>
            </div>
            <!-- 휴무일 통계 -->
            <div class="stat stat-restdays">
              <div class="num" id="payRestDays">0</div>
              <div class="label">휴무일</div>
            </div>
            <!-- 총공수 통계 -->
            <div class="stat stat-hours">
              <div class="num" id="payTotalHours">0</div>
              <div class="label">총공수</div>
            </div>
          </div>
        </section>
        <!-- 급여명세서 -->
        <section class="mt-3.5 pay-slip-section">
          <!-- 급여명세서 입력 폼 카드 -->
          <div class="mt-3">
            <div class="card">
              <div class="stat-head">
                <div class="flex items-center justify-between w-full">
                  <span class="text-[17px] font-semibold text-[#1A254F] dark:text-white stat-title" style="font-family: 'Noto Sans KR', system-ui, sans-serif;">급여 정보 입력</span>
                  <button id="payFormToggle" class="flex items-center gap-2 text-sm text-gray-600 dark:text-white hover:text-[color:var(--brand)] transition-colors" style="font-family: 'Noto Sans KR', system-ui, sans-serif;">
                    <span id="payFormToggleText">펼치기</span>
                    <i data-lucide="chevron-down" class="w-4 h-4" id="payFormToggleIcon"></i>
                  </button>
                </div>
              </div>
              <div id="payFormContent" class="mt-3">
                <div class="grid grid-cols-2 gap-3 mb-3">
                  <div>
                     <label class="label-part block mb-1 text-[14px] font-normal text-gray-600 dark:text-white" style="font-family: 'Noto Sans KR', system-ui, sans-serif;">공수(자동)</label>
                    <input id="daysWorked" class="w-full h-12 px-3 border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-[#0f172a] text-gray-900 dark:text-white" type="number" value="0" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-size: 15px; border-radius: 12px;"/>
                  </div>
                  <div>
                    <label class="label-part block mb-1 text-[14px] font-normal text-gray-600 dark:text-white" style="font-family: 'Noto Sans KR', system-ui, sans-serif;">휴무일(자동)</label>
                    <input id="daysOff" class="w-full h-12 px-3 border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-[#0f172a] text-gray-900 dark:text-white" type="number" value="0" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-size: 15px; border-radius: 12px;"/>
                  </div>
                </div>
                <div class="grid grid-cols-2 gap-3 mb-3">
                  <div>
                    <label class="label-part block mb-1 text-[14px] font-normal text-gray-600 dark:text-white" style="font-family: 'Noto Sans KR', system-ui, sans-serif;">기본급(자동)</label>
                    <input id="baseAdmin" class="w-full h-12 px-3 border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-[#0f172a] text-gray-900 dark:text-white" type="text" value="220,000" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-size: 15px; border-radius: 12px;"/>
                  </div>
                  <div>
                    <label class="label-part block mb-1 text-[14px] font-normal text-gray-600 dark:text-white" style="font-family: 'Noto Sans KR', system-ui, sans-serif;">기본급(직접입력)</label>
                    <input id="baseManual" class="w-full h-12 px-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-[#0f172a] text-gray-900 dark:text-white" type="text" placeholder="기본급을 직접입력하세요" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-size: 15px; border-radius: 12px;"/>
                  </div>
                </div>
                <div class="mb-3">
                  <label class="label-part block mb-2 text-[14px] font-normal text-gray-600 dark:text-white" style="font-family: 'Noto Sans KR', system-ui, sans-serif;">고용형태</label>
                  <div class="absence-reason">
                    <button class="chip active" data-role="emp" data-value="freelance">프리</button>
                    <button class="chip" data-role="emp" data-value="daily">일용</button>
                    <button class="chip" data-role="emp" data-value="regular">상용</button>
                    <button class="chip hidden" data-role="emp" data-value="manual" contenteditable="true" data-placeholder="직접입력">15.42</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- 급여 명세서 요약 카드 -->
          <div class="mt-3">
            <div class="card">
              <div class="stat-head">
              </div>
              <div class="mt-3">
                <div class="space-y-3">
                  <!-- 기본급 -->
                  <div class="flex justify-between items-center">
                    <span class="text-gray-600 dark:text-white" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-size: 15px; font-weight: 600;">기본급</span>
                    <span class="text-gray-900 dark:text-white font-medium" id="summaryBasePay" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-size: 15px; font-weight: 600;">0원</span>
                  </div>
                  <!-- 출근(일) -->
                  <div class="flex justify-between items-center">
                    <span class="text-gray-600 dark:text-white" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-size: 15px; font-weight: 600;">출근(일)</span>
                    <span class="text-gray-900 dark:text-white font-medium" id="summaryWorkDays" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-size: 15px; font-weight: 600;">0일</span>
                  </div>
                  <!-- 휴무 -->
                  <div class="flex justify-between items-center">
                    <span class="text-gray-600 dark:text-white" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-size: 15px; font-weight: 600;">휴무</span>
                    <span class="text-red-500 dark:text-white font-medium" id="summaryRestDays" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-size: 15px; font-weight: 600;">0일</span>
                  </div>
                  <!-- 실제 공수 -->
                  <div class="flex justify-between items-center">
                    <span class="text-gray-600 dark:text-white" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-size: 15px; font-weight: 600;">실제 공수</span>
                    <span class="text-blue-600 dark:text-white font-medium" id="summaryActualWorkDays" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-size: 15px; font-weight: 600;">0일</span>
                  </div>
                  <!-- 구분선 -->
                  <hr class="border-gray-200 dark:border-gray-600">
                  <!-- 소득세 -->
                  <div class="flex justify-between items-center">
                    <span class="text-gray-600 dark:text-white" id="summaryIncomeTaxLabel" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-size: 15px; font-weight: 600;">소득세(3%)</span>
                    <span class="text-gray-900 dark:text-white" id="summaryIncomeTax" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-size: 15px; font-weight: 600;">0원</span>
                  </div>
                  <!-- 지방소득세 -->
                  <div class="flex justify-between items-center">
                    <span class="text-gray-600 dark:text-white" id="summaryLocalTaxLabel" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-size: 15px; font-weight: 600;">지방소득세(0.3%)</span>
                    <span class="text-gray-900 dark:text-white" id="summaryLocalTax" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-size: 15px; font-weight: 600;">0원</span>
                  </div>
                  <!-- 구분선 -->
                  <hr class="border-gray-200 dark:border-gray-600">
                  <!-- 실 수령액 -->
                  <div class="flex justify-between items-center">
                    <span class="text-gray-900 dark:text-white" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-size: 17px !important; font-weight: 600 !important;">실 수령액</span>
                    <span class="text-blue-600 dark:text-blue-400 font-bold" id="summaryNetPay" style="font-family: 'Noto Sans KR', system-ui, sans-serif; font-size: 16px;">0원</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- 급여명세서 버튼들 -->
          <div class="mt-4">
            <div class="flex gap-2">
              <!-- 급여명세서 미리보기 버튼 -->
              <button id="previewPaySlip" class="flex-1 h-[48px] rounded-xl text-white preview-btn" style="background: #99A4BE; border: none; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: all 0.3s ease;">급여명세서 미리보기</button>
              <!-- PDF 다운로드 버튼 -->
              <button id="downloadPaySlip" class="flex-1 h-[48px] rounded-xl text-white download-btn" style="background: #1A254F; border: none; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: all 0.3s ease;">PDF 다운로드</button>
            </div>
          </div>
          <!-- 인라인 미리보기 창 (급여명세서 카드 박스 래핑) -->
          <div class="dock payslip-card" id="previewDock" style="display: none;">
            <div class="panel">
              <header class="panel-h">
                <h2 class="title"></h2>
                <div class="toolbar" style="display: flex; align-items: center; gap: 8px; width: 100%; flex-wrap: nowrap; justify-content: flex-end;">
                  <!-- 홈의 사진대지 생성 창과 동일한 줌 컨트롤 (닫기 버튼 좌측으로 이동) -->
                  <div class="preview-zoomgroup">
                    <button class="preview-iconbtn" id="zoomOutBtn" title="축소">−</button>
                    <div class="preview-percent" id="zoomPct">100%</div>
                    <button class="preview-iconbtn" id="zoomInBtn" title="확대">＋</button>
                  </div>
                  <!-- 닫기 버튼을 같은 형태의 박스에 "닫기"로 표현 -->
                  <button class="preview-closebtn" id="closeBtn" title="닫기">닫기</button>
                </div>
              </header>
              <div class="viewer" id="viewer">
                <div class="payslip-viewport">
                  <div class="stage" id="stage">
                    <!-- ===== 급여명세서 본문 ===== -->
                    <article class="payslip">
                      <h2 class="h2">급여 명세서</h2>
                      <!-- ⬇️ 제목 아래 줄: 오늘 기준 직전월 자동 표기 -->
                      <div id="payslipSubdate" class="payslip-subdate">0000.00월</div>

                      <!-- 기본 정보 -->
                      <table class="tbl" style="margin-top:8px">
                        <colgroup><col style="width:20%"><col style="width:30%"><col style="width:20%"><col style="width:30%"></colgroup>
                        <tbody>
                          <tr>
                            <th>성명</th><td>이노피앤씨</td>
                            <th>지급일</th><td>2025.08.12</td>
                          </tr>
                        </tbody>
                      </table>

                      <div style="height:16px"></div>

                      <!-- 지급/공제 내역 -->
                      <table class="tbl">
                        <colgroup><col style="width:25%"><col style="width:25%"><col style="width:25%"><col style="width:25%"></colgroup>
                        <thead>
                          <tr>
                            <th>임금지급내역</th><th>지급금액(원)</th><th>공제내역</th><th>지급금액(원)</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>기본급</td><td style="text-align:right">5,500,000</td>
                            <td>소득세</td><td style="text-align:right">165,000</td>
                          </tr>
                          <tr>
                            <td style="text-align:right;font-weight:700">지급액 계</td>
                            <td style="text-align:right;font-weight:700">5,500,000</td>
                            <td>지방소득세</td><td style="text-align:right">16,500</td>
                          </tr>
                          <tr>
                            <td>실지급액</td><td></td>
                            <td style="text-align:right;font-weight:700">공제액 계</td>
                            <td style="text-align:right;font-weight:700">181,500</td>
                          </tr>
                        </tbody>
                      </table>

                      <div style="height:18px"></div>

                      <!-- 계산 방법 -->
                      <table class="tbl">
                        <colgroup><col style="width:20%"><col style="width:60%"><col style="width:20%"></colgroup>
                        <thead>
                          <tr><th>구분</th><th>산출식 또는 산출방법</th><th>지급액(원)</th></tr>
                        </thead>
                        <tbody>
                          <tr><td>기본급</td><td>25 × 220,000</td><td style="text-align:right">5,500,000</td></tr>
                        </tbody>
                      </table>
                    </article>
                    <!-- ===== /본문 ===== -->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>
</main>
  </div>
<script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script>
    // 페이지별 고유 JavaScript
    console.log('Initializing worklog page');
    // Lucide 아이콘 초기화 함수
    function initLucideIcons() {
      if (window.lucide && window.lucide.createIcons) {
        window.lucide.createIcons();
      }
    }
    // 페이지 로드 시 Lucide 아이콘 초기화
    document.addEventListener('DOMContentLoaded', function() {
      initLucideIcons();
      initButtonClickEffects();
      // 급여 정보 요약 초기화
      setTimeout(() => {
        updatePayFormFields(); // 급여 정보입력 필드 자동 업데이트
        updatePaySummary();
          }, 100);
      
      // 월간 통계 아이콘은 인라인 데이터 URL 사용으로 오류 가능성 제거
    });
    
    /* ===== 버튼 클릭 효과 초기화 ===== */
    function initButtonClickEffects() {
      // 모든 버튼에 클릭 효과 추가
      document.querySelectorAll('.btn').forEach(button => {
        button.addEventListener('click', function(e) {
          // 클릭된 버튼에 애니메이션 클래스 추가
          this.classList.add('clicked');
          
          // 애니메이션 완료 후 클래스 제거
          setTimeout(() => {
            this.classList.remove('clicked');
          }, 600);
          
          // 리플 효과 생성
          createButtonRippleEffect(e, this);
        });
      });
    }

    /* ===== 버튼 리플 효과 생성 함수 ===== */
    function createButtonRippleEffect(event, element) {
      const ripple = document.createElement('span');
      const rect = element.getBoundingClientRect();
      const size = Math.max(rect.width, rect.height);
      const x = event.clientX - rect.left - size / 2;
      const y = event.clientY - rect.top - size / 2;
      
      ripple.style.width = ripple.style.height = size + 'px';
      ripple.style.left = x + 'px';
      ripple.style.top = y + 'px';
      ripple.classList.add('ripple-ink');
      
      element.appendChild(ripple);
      
      // 애니메이션 완료 후 리플 요소 제거
      setTimeout(() => {
        ripple.remove();
      }, 450);
    }
    
    // 숫자 파싱 함수 (콤마 제거)
    function parseNumber(value) {
      if (!value) return 0;
      // 콤마와 공백 제거 후 숫자로 변환
      const cleanValue = String(value).replace(/[,\s]/g, '');
      const parsed = parseFloat(cleanValue);
      return isNaN(parsed) ? 0 : parsed;
    }
    
    // 숫자 포맷팅 함수 (콤마 추가)
    function formatNumber(value) {
      if (!value || value === 0) return '';
      return value.toLocaleString('ko-KR');
    }
    
    // 입력 필드 포맷팅 함수
    function formatInputField(input) {
      const value = input.value;
      const cursorPosition = input.selectionStart;
      const formattedValue = formatNumber(parseNumber(value));
      
      // 포맷팅된 값이 다르면 업데이트
      if (value !== formattedValue) {
        input.value = formattedValue;
        // 커서 위치 조정
        const newCursorPosition = cursorPosition + (formattedValue.length - value.length);
        input.setSelectionRange(newCursorPosition, newCursorPosition);
      }
    }
    
    // 관리자콘솔에서 작업자별 기본급 설정 함수 (예시)
    function setWorkerBasePay(workerId, basePay) {
      console.log(`작업자 ${workerId}의 기본급을 ${basePay}원으로 설정`);
      localStorage.setItem('workerBasePay', basePay.toString());
      // 급여 정보입력 필드 즉시 업데이트
      updatePayFormFields();
    }
    
    // 급여 정보입력 필드 자동 업데이트 함수
    function updatePayFormFields() {
      console.log('급여 정보입력 필드 자동 업데이트 시작');
      try {
        // 홈에서 입력한 공수일 데이터 가져오기
        const workLogData = JSON.parse(localStorage.getItem('workLogData') || '[]');
        const totalWorkDays = workLogData.length;
        
        // 홈에서 입력한 공수 입력값 합산
        const totalWorkHours = workLogData.reduce((sum, item) => {
          return sum + (parseInt(item.men) || 1); // men 필드가 없으면 1로 기본값
        }, 0);
        
        // 관리자콘솔에서 작업자별 기본급 데이터 가져오기 (예시: localStorage에서 가져오는 방식)
        const workerBasePay = localStorage.getItem('workerBasePay') || '220000';
        const formattedBasePay = parseInt(workerBasePay).toLocaleString();
        
        // 해당 월의 총 일수 계산
        const now = new Date();
        const prevMonth = new Date(now.getFullYear(), now.getMonth() - 1);
        const daysInMonth = new Date(prevMonth.getFullYear(), prevMonth.getMonth() + 1, 0).getDate();
        const restDays = daysInMonth - totalWorkDays;
        
        // 급여 정보입력 필드 업데이트
        const daysWorkedEl = document.getElementById('daysWorked');
        const daysOffEl = document.getElementById('daysOff');
        const baseAdminEl = document.getElementById('baseAdmin');
        
        if (daysWorkedEl) {
          daysWorkedEl.value = totalWorkHours; // 공수 합산값으로 변경
        }
        if (daysOffEl) {
          daysOffEl.value = restDays;
        }
        if (baseAdminEl) {
          baseAdminEl.value = formattedBasePay;
        }
        
        console.log('급여 정보입력 필드 업데이트 완료:', {
          totalWorkDays,
          totalWorkHours,
          restDays,
          formattedBasePay
        });
      } catch(error) {
        console.error('급여 정보입력 필드 업데이트 중 오류 발생:', error);
      }
    }
    
    // 급여 정보 요약 업데이트 함수
    function updatePaySummary() {
      console.log('급여 정보 요약 업데이트 시작');
      try {
        // 홈에서 입력한 공수일 데이터 가져오기
        const workLogData = JSON.parse(localStorage.getItem('workLogData') || '[]');
        const totalWorkDays = workLogData.length;
        
        // 홈에서 입력한 공수 입력값 합산
        const totalWorkHours = workLogData.reduce((sum, item) => {
          return sum + (parseInt(item.men) || 1); // men 필드가 없으면 1로 기본값
        }, 0);
        
        // 기본급 가져오기 (개선된 파싱 함수 사용)
        const baseAdminEl = document.getElementById('baseAdmin');
        const baseManualEl = document.getElementById('baseManual');
        const baseAdmin = baseAdminEl ? parseNumber(baseAdminEl.value) : 0;
        const baseManual = baseManualEl ? parseNumber(baseManualEl.value) : 0;
        const basePay = baseManual > 0 ? baseManual : baseAdmin;
        
        console.log('기본급 파싱 결과:', {
          baseAdminElValue: baseAdminEl ? baseAdminEl.value : 'null',
          baseManualElValue: baseManualEl ? baseManualEl.value : 'null',
          baseAdmin: baseAdmin,
          baseManual: baseManual,
          basePay: basePay
        });
        
        // 고용형태에 따른 세율 설정
        const activeEmpChip = document.querySelector('[data-role="emp"].active');
        let incomeTaxRate = 0.03; // 기본값: 프리(3%)
        let localTaxRate = 0.003; // 기본값: 프리(0.3%)
        
        if(activeEmpChip) {
          const empType = activeEmpChip.dataset.value || 'freelance';
          switch(empType) {
            case 'freelance':
              incomeTaxRate = 0.03;  // 소득세 3%
              localTaxRate = 0.003;  // 지방소득세 0.3%
              break;
            case 'daily':
              incomeTaxRate = 0.06;  // 소득세 6%
              localTaxRate = 0.006;  // 지방소득세 0.6%
              break;
            case 'regular':
              // 상용의 경우 직접입력 버튼 텍스트에서 값 가져오기
              const manualChip = document.querySelector('[data-role="emp"][data-value="manual"]');
              const regularRate = manualChip ? parseFloat(manualChip.textContent.replace(/[^0-9.]/g, '')) || 15.42 : 15.42;
              incomeTaxRate = regularRate / 100;  // 소득세
              localTaxRate = incomeTaxRate * 0.1; // 지방소득세 (소득세의 10%)
              break;
            case 'manual':
              // 직접입력의 경우 현재 입력된 값 사용
              const manualRateEl = document.querySelector('[data-role="emp"][data-value="manual"]');
              if(manualRateEl) {
                const manualRate = parseFloat(manualRateEl.textContent.replace(/[^0-9.]/g, '')) || 0;
                incomeTaxRate = manualRate / 100;
                localTaxRate = 0;
              }
              break;
          }
        }
        
        // 계산 (실시간 공수 사용)
        const totalGross = totalWorkHours * basePay;
        const incomeTax = Math.round(totalGross * incomeTaxRate);
        const localTax = Math.round(totalGross * localTaxRate);
        const totalDeduction = incomeTax + localTax;
        const netPay = totalGross - totalDeduction;
        
        // 휴무일 계산 (해당 월의 총 일수 - 출근일)
        const now = new Date();
        const prevMonth = new Date(now.getFullYear(), now.getMonth() - 1);
        const daysInMonth = new Date(prevMonth.getFullYear(), prevMonth.getMonth() + 1, 0).getDate();
        const restDays = daysInMonth - totalWorkDays;
        
        // 급여 정보 요약 업데이트
        const summaryBasePay = document.getElementById('summaryBasePay');
        const summaryWorkDays = document.getElementById('summaryWorkDays');
        const summaryRestDays = document.getElementById('summaryRestDays');
        const summaryActualWorkDays = document.getElementById('summaryActualWorkDays');
        const summaryIncomeTax = document.getElementById('summaryIncomeTax');
        const summaryLocalTax = document.getElementById('summaryLocalTax');
        const summaryNetPay = document.getElementById('summaryNetPay');
        const summaryIncomeTaxLabel = document.getElementById('summaryIncomeTaxLabel');
        const summaryLocalTaxLabel = document.getElementById('summaryLocalTaxLabel');
        
        if(summaryBasePay) summaryBasePay.textContent = basePay.toLocaleString() + '원';
        if(summaryWorkDays) summaryWorkDays.textContent = totalWorkDays + '일';
        if(summaryRestDays) summaryRestDays.textContent = restDays + '일';
        if(summaryActualWorkDays) summaryActualWorkDays.textContent = totalWorkHours + '일';
        if(summaryIncomeTax) summaryIncomeTax.textContent = '-' + incomeTax.toLocaleString() + '원';
        if(summaryLocalTax) summaryLocalTax.textContent = '-' + localTax.toLocaleString() + '원';
        if(summaryNetPay) summaryNetPay.textContent = netPay.toLocaleString() + '원';
        
        // 세율 라벨 업데이트
        if(summaryIncomeTaxLabel) summaryIncomeTaxLabel.textContent = `소득세(${(incomeTaxRate * 100).toFixed(1)}%)`;
        if(summaryLocalTaxLabel) summaryLocalTaxLabel.textContent = `지방소득세(${(localTaxRate * 100).toFixed(1)}%)`;
        
        // 급여현황 통계 카드 업데이트 (출력현황 데이터와 연동)
        const payWorkDays = document.getElementById('payWorkDays');
        const payRestDays = document.getElementById('payRestDays');
        const payTotalHours = document.getElementById('payTotalHours');
        
        if(payWorkDays) payWorkDays.textContent = totalWorkDays; // 출근일 수로 변경
        if(payRestDays) payRestDays.textContent = restDays;
        if(payTotalHours) payTotalHours.textContent = totalWorkHours; // 총공수는 공수 합산값과 동일
        
        console.log('급여 정보 요약 업데이트 완료:', {
          totalWorkDays,
          totalWorkHours,
          restDays,
          daysInMonth,
          basePay,
          totalGross,
          incomeTax,
          localTax,
          totalDeduction,
          netPay
        });
      } catch(error) {
        console.error('급여 정보 요약 업데이트 중 오류 발생:', error);
      }
    }
    
    // 급여명세서 미리보기 기능
    function updatePreviewData() {
      console.log('미리보기 데이터 업데이트 시작');
      try {
        // 월 표시 업데이트 (직전월) - 새로운 HTML 구조에 맞게 수정
        const payslipSubdate = document.getElementById('payslipSubdate');
        if(payslipSubdate) {
          const now = new Date();
          // 직전 월 계산 (1월이면 전년도 12월)
          const y = now.getMonth() === 0 ? now.getFullYear() - 1 : now.getFullYear();
          const m = now.getMonth() === 0 ? 12 : now.getMonth(); // 1~12
          const mm = String(m).padStart(2,'0');
          payslipSubdate.textContent = `${y}.${mm}월`;
          console.log('월 표시 업데이트:', `${y}.${mm}월`);
        }
        
        // 급여 정보 요약 업데이트
        updatePaySummary();
        
        // 작성자명 업데이트 (홈의 작성자 데이터 우선) - 새로운 HTML 구조에 맞게 수정
        const employeeNameTd = document.querySelector('.payslip table.tbl tbody tr td:nth-child(2)');
        if(employeeNameTd) {
          const homeAuthor = localStorage.getItem('homeAuthorName');
          const employeeNameEl = document.getElementById('employeeName');
          const fallback = employeeNameEl ? employeeNameEl.value : '이노피앤씨';
          employeeNameTd.textContent = homeAuthor && homeAuthor.trim().length > 0 ? homeAuthor : fallback;
        }
        // 지급일 업데이트 (해당 월 10일) - 새로운 HTML 구조에 맞게 수정
        const payDateTd = document.querySelector('.payslip table.tbl tbody tr td:nth-child(4)');
        if(payDateTd) {
          const now = new Date();
          const year = now.getFullYear();
          const month = String(now.getMonth() + 1).padStart(2, '0');
          payDateTd.textContent = `${year}.${month}.10`;
        }
        // 홈에서 입력한 공수 데이터 가져오기
        const workLogData = JSON.parse(localStorage.getItem('workLogData') || '[]');
        const totalWorkDays = workLogData.length;
        const totalWorkHours = workLogData.reduce((sum, item) => {
          return sum + (parseInt(item.men) || 1);
        }, 0);
        
        // 기본급 계산 (개선된 파싱 함수 사용)
        const baseAdminEl = document.getElementById('baseAdmin');
        const baseManualEl = document.getElementById('baseManual');
        const baseAdmin = baseAdminEl ? parseNumber(baseAdminEl.value) : 0;
        const baseManual = baseManualEl ? parseNumber(baseManualEl.value) : 0;
        // 기본급 결정 (직접입력이 있으면 그것을 사용, 없으면 설정값 사용)
        const basePay = baseManual > 0 ? baseManual : baseAdmin;
        
        console.log('미리보기 기본급 파싱 결과:', {
          baseAdminElValue: baseAdminEl ? baseAdminEl.value : 'null',
          baseManualElValue: baseManualEl ? baseManualEl.value : 'null',
          baseAdmin: baseAdmin,
          baseManual: baseManual,
          basePay: basePay,
          totalWorkDays: totalWorkDays
        });
        const totalGross = basePay * totalWorkHours; // 공수 합산값으로 계산
        // 고용형태에 따른 세율 적용
        const activeEmpChip = document.querySelector('[data-role="emp"].active');
        let empType = 'freelance';
        let incomeTaxRate = 0.03;
        let localTaxRate = 0.003;
        if(activeEmpChip) {
          empType = activeEmpChip.dataset.value || 'freelance';
          switch(empType) {
            case 'freelance':
              incomeTaxRate = 0.03;  // 소득세 3%
              localTaxRate = 0.003;  // 지방소득세 0.3%
              break;
            case 'daily':
              incomeTaxRate = 0.06;  // 소득세 6%
              localTaxRate = 0.006;  // 지방소득세 0.6%
              break;
            case 'regular':
              // 상용의 경우 직접입력 버튼 텍스트에서 값 가져오기
              const manualChip = document.querySelector('[data-role="emp"][data-value="manual"]');
              const regularRate = manualChip ? parseFloat(manualChip.textContent.replace(/[^0-9.]/g, '')) || 15.42 : 15.42;
              incomeTaxRate = regularRate / 100;  // 소득세
              localTaxRate = incomeTaxRate * 0.1; // 지방소득세 (소득세의 10%)
              break;
            case 'manual':
              // 직접입력의 경우 현재 입력된 값 사용
              const manualRateEl = document.querySelector('[data-role="emp"][data-value="manual"]');
              if(manualRateEl) {
                const manualRate = parseFloat(manualRateEl.textContent.replace(/[^0-9.]/g, '')) || 0;
                incomeTaxRate = manualRate / 100;
                localTaxRate = 0;
              }
              break;
          }
        }
        const incomeTax = Math.round(totalGross * incomeTaxRate);
        const localTax = Math.round(totalGross * localTaxRate);
        const totalDeduction = incomeTax + localTax;
        const netPay = totalGross - totalDeduction;
        // 미리보기 업데이트 (새로운 HTML 구조에 맞게 수정)
        // 기본급 업데이트
        const basicPayTd = document.querySelector('.payslip table.tbl tbody tr:nth-child(1) td:nth-child(2)');
        if(basicPayTd) basicPayTd.textContent = totalGross.toLocaleString();
        
        // 지급액 계 업데이트
        const totalPayTd = document.querySelector('.payslip table.tbl tbody tr:nth-child(2) td:nth-child(2)');
        if(totalPayTd) totalPayTd.textContent = totalGross.toLocaleString();
        
        // 소득세 업데이트
        const incomeTaxTd = document.querySelector('.payslip table.tbl tbody tr:nth-child(1) td:nth-child(4)');
        if(incomeTaxTd) incomeTaxTd.textContent = incomeTax.toLocaleString();
        
        // 지방소득세 업데이트
        const localTaxTd = document.querySelector('.payslip table.tbl tbody tr:nth-child(2) td:nth-child(4)');
        if(localTaxTd) localTaxTd.textContent = localTax.toLocaleString();
        
        // 공제액 계 업데이트
        const totalDeductionTd = document.querySelector('.payslip table.tbl tbody tr:nth-child(3) td:nth-child(4)');
        if(totalDeductionTd) totalDeductionTd.textContent = totalDeduction.toLocaleString();
        
        // 실지급액 업데이트
        const netPayTd = document.querySelector('.payslip table.tbl tbody tr:nth-child(3) td:nth-child(2)');
        if(netPayTd) netPayTd.textContent = netPay.toLocaleString();
        
        // 계산방법 업데이트
        const calcMethodTd = document.querySelector('.payslip table.tbl:last-child tbody tr td:nth-child(2)');
        if(calcMethodTd) calcMethodTd.textContent = `${totalWorkHours} × ${basePay.toLocaleString()}`;
        
        const calcAmountTd = document.querySelector('.payslip table.tbl:last-child tbody tr td:nth-child(3)');
        if(calcAmountTd) calcAmountTd.textContent = totalGross.toLocaleString();
        console.log('미리보기 데이터 업데이트 완료:', {
          totalGross,
          incomeTax,
          localTax,
          totalDeduction,
          netPay,
          empType
        });
      } catch(error) {
        console.error('미리보기 데이터 업데이트 중 오류 발생:', error);
      }
    }
    // 급여 정보 입력 폼 아코디언 기능
    const payFormToggle = document.getElementById('payFormToggle');
    const payFormContent = document.getElementById('payFormContent');
    const payFormToggleText = document.getElementById('payFormToggleText');
    const payFormToggleIcon = document.getElementById('payFormToggleIcon');
    
    if (payFormToggle && payFormContent && payFormToggleText && payFormToggleIcon) {
      let isCollapsed = true; // 초기 상태를 접힌 상태로 설정
      
      // 초기 상태 설정: 폼을 접힌 상태로 시작
      payFormContent.style.maxHeight = '0';
      payFormContent.style.opacity = '0';
      payFormContent.style.overflow = 'hidden';
      
      // CSS 전환 효과 추가
      payFormContent.style.transition = 'max-height 0.3s ease-in-out, opacity 0.3s ease-in-out';
      
      payFormToggle.addEventListener('click', function(e) {
        e.preventDefault();
        console.log('급여 정보 입력 폼 토글 버튼 클릭됨');
        
        isCollapsed = !isCollapsed;
        
        if (isCollapsed) {
          // 폼 숨기기
          payFormContent.style.maxHeight = payFormContent.scrollHeight + 'px';
          payFormContent.offsetHeight; // 리플로우 강제 실행
          payFormContent.style.maxHeight = '0';
          payFormContent.style.opacity = '0';
          payFormContent.style.overflow = 'hidden';
          
          // 버튼 텍스트와 아이콘 변경
          payFormToggleText.textContent = '펼치기';
          payFormToggleIcon.setAttribute('data-lucide', 'chevron-down');
          
          console.log('급여 정보 입력 폼 숨김');
        } else {
          // 폼 보이기
          payFormContent.style.overflow = 'hidden';
          payFormContent.style.maxHeight = payFormContent.scrollHeight + 'px';
          payFormContent.style.opacity = '1';
          
          // 애니메이션 완료 후 maxHeight 제거
          setTimeout(() => {
            payFormContent.style.maxHeight = '';
            payFormContent.style.overflow = '';
          }, 300);
          
          // 버튼 텍스트와 아이콘 변경
          payFormToggleText.textContent = '접기';
          payFormToggleIcon.setAttribute('data-lucide', 'chevron-up');
          
          console.log('급여 정보 입력 폼 표시');
        }
        
        // Lucide 아이콘 다시 렌더링
        if (typeof lucide !== 'undefined' && lucide.createIcons) {
          lucide.createIcons();
        }
      });
      
      console.log('급여 정보 입력 폼 아코디언 기능 초기화 완료 (접힌 상태로 시작)');
    } else {
      console.error('급여 정보 입력 폼 아코디언 관련 요소를 찾을 수 없습니다:', {
        payFormToggle: !!payFormToggle,
        payFormContent: !!payFormContent,
        payFormToggleText: !!payFormToggleText,
        payFormToggleIcon: !!payFormToggleIcon
      });
    }

    // 급여명세서 미리보기 버튼 이벤트 리스너
    const previewPaySlip = document.getElementById('previewPaySlip');
    if(previewPaySlip && !previewPaySlip.hasAttribute('data-listener-added')) {
      previewPaySlip.setAttribute('data-listener-added', 'true');
      previewPaySlip.addEventListener('click', (e) => {
        e.preventDefault();
        console.log('미리보기 버튼 클릭됨');
        try {
          updatePreviewData();
          const previewDock = document.getElementById('previewDock');
          if(previewDock) {
            previewDock.style.display = 'block';
            previewDock.classList.add('show');
            // 초기 스케일은 전역 미리보기 로직(맞춤=100%)에 맡김

            console.log('미리보기 창 표시됨');
          } else {
            console.error('previewDock 요소를 찾을 수 없습니다');
          }
        } catch(error) {
          console.error('미리보기 버튼 클릭 처리 중 오류:', error);
        }
      });
      console.log('미리보기 버튼 이벤트 리스너 등록 완료');
    }
    // 닫기 버튼 이벤트 리스너
    const closeBtn = document.getElementById('closeBtn');
    if(closeBtn) {
      closeBtn.addEventListener('click', () => {
        const previewDock = document.getElementById('previewDock');
        if(previewDock) {
          previewDock.style.display = 'none';
          previewDock.classList.remove('show');
          console.log('미리보기 창 닫힘');
        }
      });
    }
    // 폼 입력 이벤트 리스너
    const baseAdminEl = document.getElementById('baseAdmin');
    const baseManualEl = document.getElementById('baseManual');
    const daysWorkedEl = document.getElementById('daysWorked');
    const employeeNameEl = document.getElementById('employeeName');
    const empChips = document.querySelectorAll('[data-role="emp"]');
    if(baseAdminEl) {
      baseAdminEl.addEventListener('input', (e) => {
        formatInputField(e.target);
        updatePreviewData();
      });
    }
    if(baseManualEl) {
      baseManualEl.addEventListener('input', (e) => {
        formatInputField(e.target);
        updatePreviewData();
      });
    }
    if(daysWorkedEl) daysWorkedEl.addEventListener('input', updatePreviewData);
    if(employeeNameEl) employeeNameEl.addEventListener('input', updatePreviewData);
    
    // 고용형태 버튼 이벤트 리스너
    empChips.forEach(chip => {
      chip.addEventListener('click', (e) => {
        // 직접입력 버튼 클릭 시에는 이벤트 처리하지 않음
        if (chip.dataset.value === 'manual') {
          return;
        }
        
        // 모든 버튼의 active 클래스 제거
        empChips.forEach(c => c.classList.remove('active'));
        // 클릭된 버튼에 active 클래스 추가
        chip.classList.add('active');
        
        // 상용 버튼 클릭 시 직접입력 버튼 표시/숨김
        const manualChip = document.querySelector('[data-role="emp"][data-value="manual"]');
        if (chip.dataset.value === 'regular') {
          if (manualChip) {
            manualChip.classList.remove('hidden');
            manualChip.textContent = '15.42';
            manualChip.contentEditable = 'true';
            manualChip.focus();
            // 텍스트 선택
            const range = document.createRange();
            range.selectNodeContents(manualChip);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
          }
        } else {
          if (manualChip) {
            manualChip.classList.add('hidden');
            manualChip.contentEditable = 'false';
          }
        }
        
        updatePreviewData();
      });
    });
    // 직접입력 버튼의 텍스트 입력 처리
    const manualChip = document.querySelector('[data-role="emp"][data-value="manual"]');
    
    if(manualChip) {
      // 직접입력 버튼 클릭 시 편집 모드 활성화
      manualChip.addEventListener('click', (e) => {
        e.stopPropagation(); // 이벤트 버블링 방지
        manualChip.contentEditable = 'true';
        manualChip.focus();
        // 텍스트 선택
        const range = document.createRange();
        range.selectNodeContents(manualChip);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
      });
      
      manualChip.addEventListener('blur', () => {
        const text = manualChip.textContent.trim();
        if(text && !isNaN(parseFloat(text))) {
          const rate = parseFloat(text);
          manualChip.textContent = `${rate}`;
        } else if(text === '') {
          manualChip.textContent = '15.42';
        }
        updatePreviewData();
      });
      
      manualChip.addEventListener('keydown', (e) => {
        if(e.key === 'Enter') {
          e.preventDefault();
          manualChip.blur();
        }
      });
    }
    // PDF 다운로드 기능
    function checkAdminApproval() {
      const adminApproval = localStorage.getItem('adminApproval');
      if(adminApproval === 'true') {
        return true;
      } else if(adminApproval === 'false') {
        return false;
        } else {
        return false; // Default: not approved
      }
    }
    function setAdminApproval(approved) {
      localStorage.setItem('adminApproval', approved.toString());
      console.log('관리자 승인 상태 변경:', approved ? '승인됨' : '승인되지 않음');
    }
    function downloadPaySlipPDF() {
      try {
        console.log('PDF 다운로드 시작');
        if(!checkAdminApproval()) {
          alert('관리자 승인이 필요합니다.');
          return;
        }
        updatePreviewData();
        // A4 최적화 스타일 적용
        clonedContent.style.cssText = `
          width: 210mm !important;
          height: 297mm !important;
          margin: 0 auto !important;
          background: #fff !important;
          font-family: 'Noto Sans KR', system-ui, sans-serif !important;
          color: #0F172A !important;
          font-size: 15px !important;
          font-weight: 700 !important;
          padding: 16mm !important;
          box-sizing: border-box !important;
          box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important;
        `;
        // 테이블 스타일 적용
        const tables = clonedContent.querySelectorAll('table');
        tables.forEach(table => {
          table.style.cssText = `
            border-collapse: collapse !important;
            width: 100% !important;
            max-width: 100% !important;
            margin: 0 !important;
            font-size: 15px !important;
            background: #fff !important;
            font-family: 'Noto Sans KR', sans-serif !important;
          `;
          const cells = table.querySelectorAll('th, td');
          cells.forEach(cell => {
            cell.style.cssText = `
            border: 1px solid #1E2E45 !important;
            height: 34px !important;
            font: 700 14px/1 'Noto Sans KR', system-ui, sans-serif !important;
            text-align: center !important;
            vertical-align: middle !important;
            padding: 0 !important;
            background: #fff !important;
            color: #1A254F !important;
            `;
          });
          // 헤더 스타일 적용
          const bandHeaders = table.querySelectorAll('.band th');
          bandHeaders.forEach(header => {
            header.style.cssText = `
            background: #0E3B66 !important;
            color: #FFFFFF !important;
            font-weight: 700 !important;
            font-size: 14px !important;
            height: 38px !important;
            border: 1px solid #1E2E45 !important;
            text-align: center !important;
            vertical-align: middle !important;
            padding: 0 !important;
            margin: 0 !important;
            line-height: 1 !important;
            `;
          });
          const labelHeaders = table.querySelectorAll('.label-row th');
          labelHeaders.forEach(header => {
            header.style.cssText = `
            background: #E9F2FF !important;
            color: #0F172A !important;
            font-weight: 700 !important;
            font-size: 14px !important;
            border: 1px solid #1E2E45 !important;
            text-align: center !important;
            vertical-align: middle !important;
            padding: 0 !important;
            margin: 0 !important;
            line-height: 1 !important;
            `;
          });
        });
        tempContainer.appendChild(clonedContent);
        document.body.appendChild(tempContainer);
        // html2pdf 옵션 설정
        const opt = {
          margin: 0,
          filename: '급여명세서.pdf',
          image: { type: 'jpeg', quality: 0.98 },
          html2canvas: { 
            scale: 2,
            useCORS: true,
            letterRendering: true,
            allowTaint: true
          },
          jsPDF: { 
            unit: 'mm', 
            format: 'a4', 
            orientation: 'portrait',
            compress: true
          }
        };
        // PDF 생성 및 다운로드
        html2pdf().set(opt).from(tempContainer).save().then(() => {
          console.log('PDF 다운로드 완료');
          document.body.removeChild(tempContainer);
        }).catch(error => {
          console.error('PDF 생성 오류:', error);
          document.body.removeChild(tempContainer);
          alert('PDF 생성 중 오류가 발생했습니다: ' + error.message);
        });
      } catch(error) {
        console.error('PDF 다운로드 함수 오류:', error);
        alert('PDF 다운로드 중 오류가 발생했습니다: ' + error.message);
      }
    }
    // PDF 다운로드 버튼 이벤트 리스너
    const downloadBtn = document.getElementById('downloadPaySlip');
    if(downloadBtn) {
      downloadBtn.addEventListener('click', downloadPaySlipPDF);
    }
    // 전역 함수로 노출 (디버깅용)
    window.setAdminApproval = setAdminApproval;
    window.checkAdminApproval = checkAdminApproval;
    console.log('급여명세서 기능 초기화 완료');
</script>
  <!-- ===== 하단 네비게이터 ===== -->
  <nav class="bottom-nav-wrap">
    <div class="bottom-nav">
      <ul class="nav-list">
        <li class="nav-item"><a class="nav-link" data-route="home" href="home.html"><span class="nav-ico"><i data-lucide="home" class="nav-svg"></i></span><span class="nav-label">홈</span></a></li>
        <li class="nav-item"><a class="nav-link" data-route="worklog" href="worklog.html"><span class="nav-ico"><i data-lucide="calculator" class="nav-svg"></i></span><span class="nav-label">출력현황</span></a></li>
        <li class="nav-item"><a class="nav-link active" data-route="worklog" href="worklog.html"><span class="nav-ico"><i data-lucide="clipboard-list" class="nav-svg"></i></span><span class="nav-label">작업일지</span></a></li>
        <li class="nav-item"><a class="nav-link" data-route="sites" href="#sites"><span class="nav-ico"><i data-lucide="map" class="nav-svg"></i></span><span class="nav-label">현장정보</span></a></li>
        <li class="nav-item"><a class="nav-link" data-route="docs" href="#docs"><span class="nav-ico"><i data-lucide="folder" class="nav-svg"></i></span><span class="nav-label">문서함</span></a></li>
      </ul>
    </div>
  </nav>
  <script>
    // Lucide 아이콘 초기화 함수
    function initLucideIcons() {
      if (window.lucide && window.lucide.createIcons) {
        window.lucide.createIcons();
      }
    }
    // Theme toggle
    const root = document.documentElement;
    const themeBtn = document.getElementById('btnTheme');
    const themeIcon = document.getElementById('themeIcon');
    const THEME_KEY = 'inopnc_theme';
    function setTheme(mode){
      root.setAttribute('data-theme', mode);
      try{ localStorage.setItem(THEME_KEY, mode); }catch(e){}
      themeIcon && themeIcon.setAttribute('data-lucide', mode === 'dark' ? 'sun' : 'moon');
      if(typeof initLucideIcons === 'function') {
        initLucideIcons();
    }
      console.log('테마 변경:', mode);
    }
    // 초기 테마 설정
    setTheme(localStorage.getItem(THEME_KEY) || 'light');
    // 테마 버튼 이벤트 리스너
    themeBtn && themeBtn.addEventListener('click', ()=>{
      setTheme(root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark');
    });
    // ===== 글씨 크기 스위치 =====
    document.addEventListener('DOMContentLoaded', () => {
      const FS_KEY = 'inopnc_fontscale';
      const fsNormal = document.getElementById('fsNormal');
      const fsLarge  = document.getElementById('fsLarge');
      function applyFontScale(mode){
        document.body.classList.remove('fs-100','fs-150');
        document.body.classList.add(mode);
        fsNormal?.classList.toggle('active', mode === 'fs-100');
        fsLarge?.classList.toggle('active',  mode === 'fs-150');
        try{ localStorage.setItem(FS_KEY, mode); }catch(e){}
        console.log('글씨 크기 변경:', mode);
      }
      // 초기 글씨 크기 설정
      applyFontScale(localStorage.getItem(FS_KEY) || 'fs-100');
      // 글씨 크기 버튼 이벤트 리스너
      fsNormal?.addEventListener('click', ()=>applyFontScale('fs-100'));
      fsLarge?.addEventListener('click', ()=>applyFontScale('fs-150'));
      // 프리 기본 선택 설정
      const freelanceChip = document.querySelector('[data-role="emp"][data-value="freelance"]');
      if(freelanceChip && !freelanceChip.classList.contains('active')) {
        // 모든 버튼의 active 클래스 제거
        document.querySelectorAll('[data-role="emp"]').forEach(chip => {
          chip.classList.remove('active');
        });
        // 프리 버튼에 active 클래스 추가
        freelanceChip.classList.add('active');
        // 프리에 해당하는 세율 적용
        const rateDeduct = document.getElementById('rateDeduct');
        const rateLocal = document.getElementById('rateLocal');
        if(rateDeduct) rateDeduct.textContent = '3.0%';
        if(rateLocal) rateLocal.textContent = '0.3%';
        console.log('프리 기본 선택됨');
      }
    });
    // ===== 검색 페이지 (현장명) =====
    document.addEventListener('DOMContentLoaded', () => {
      const btnSearch = document.getElementById('btnSearch');
      const page = document.getElementById('searchPage');
      const back = document.getElementById('spBack');
      const input = document.getElementById('spInput');
      const list = document.getElementById('spList');
      // 최근 검색어 예시(현장명)
      const keywords = [
        "포항환호1BL","포항환호2BL","디에이치방배","위례자이더시티","과천지식정보타운","송도더샵프라임뷰","검단신도시AA10"
      ];
      function renderList(){
        list.innerHTML = '';
        keywords.forEach((k, idx) => {
            const row = document.createElement('div');
            row.className = 'sp-row';
            row.innerHTML = `<span class="sp-num">${idx+1}</span><span class="sp-item">${k}</span>`;
          list.appendChild(row);
          });
      }
      renderList();
      function openPage(){
        page.style.display = 'block';
        setTimeout(()=> input.focus(), 30);
        console.log('검색 페이지 열림');
      }
      function closePage(){
        page.style.display = 'none';
        console.log('검색 페이지 닫힘');
        }
      btnSearch?.addEventListener('click', openPage);
      back?.addEventListener('click', closePage);
      document.addEventListener('keydown', (e)=>{
        if(e.key === 'Escape') closePage();
      });
    });
    // 알림 벨 애니메이션
    const notificationBtn = document.getElementById('notificationBtn');
    notificationBtn && notificationBtn.addEventListener('click', ()=>{
      notificationBtn.classList.remove('bell-ringing');
      notificationBtn.classList.add('bell-ringing');
      setTimeout(() => {
        notificationBtn.classList.remove('bell-ringing');
      }, 1000);
      console.log('알림 버튼 클릭됨');
    });
    // 하단 네비 active 동기화
    function syncNav() {
      // 현재 페이지에 따라 활성 탭 설정
      const currentPage = window.location.pathname;
      let activeRoute = 'home'; // 기본값
      if (currentPage.includes('worklog.html')) {
        activeRoute = 'worklog';
      } else if (currentPage.includes('home.html')) {
        activeRoute = 'home';
      } else if (currentPage.includes('output')) {
        activeRoute = 'output';
      } else if (currentPage.includes('sites')) {
        activeRoute = 'sites';
      } else if (currentPage.includes('docs')) {
        activeRoute = 'docs';
      }
      // 모든 네비게이터 링크를 순회하며, 현재 페이지와 일치하는 링크에 'active' 클래스를 부여합니다.
      document.querySelectorAll('.nav-link').forEach(a => {
        a.classList.toggle('active', a.dataset.route === activeRoute);
      });
      console.log('네비게이션 동기화 완료:', activeRoute);
    }
    // 페이지 로드 시 실행
    syncNav();
    // URL 해시가 변경될 때마다 실행 (예: 사용자가 다른 탭을 클릭할 때)
    window.addEventListener('hashchange', syncNav);
  </script>
  <script>
    // ===== 급여명세서 미리보기 기능 =====
    document.addEventListener('DOMContentLoaded', function() {
      console.log('급여명세서 미리보기 기능 초기화 시작');
      // ===== 100% 기준(가로에 딱 맞춤), - 100% + 형태로 표시, 확대 시 100% 이상 가능 =====
      const previewDock = document.getElementById('previewDock');
      const viewer  = document.getElementById('viewer');
      const stage   = document.getElementById('stage');   // 스케일 1 기준 폭
      const payslip = document.querySelector('.payslip'); // transform 적용 대상 (새로운 구조)
      const pctEl   = document.getElementById('zoomPct');
      const zInBtn  = document.getElementById('zoomInBtn');
      const zOutBtn = document.getElementById('zoomOutBtn');
      const closeBtn= document.getElementById('closeBtn');
      let fitScale = 1; // 창에 딱 맞는 배율(=100%)
      let scale = 1;    // 현재 배율(절대)
      let MIN = 0.5;    // 50% ~
      let MAX = 3.0;    // ~ 300%
      const STEP = 0.1;
      
      // 초기 퍼센트 표시를 100%로 설정
      if (pctEl) {
        pctEl.textContent = '100%';
      }
      // 문서 스케일1 기준 크기
      let baseW=0, baseH=0;
      function measureBase(){
        if(payslip) {
          const prev = payslip.style.transform;
          payslip.style.transform = 'scale(1)';
          baseW = payslip.offsetWidth;
          baseH = payslip.offsetHeight;
          payslip.style.transform = prev || '';
        }
      }
      // 가로에 딱 맞는 배율 계산 (세로는 제한하지 않음)
      function computeFit(keepRelative=true){
        if(getComputedStyle(previewDock).display === 'none') return;
        if(!baseW || !baseH) measureBase();
        const vw = viewer.clientWidth - 16; // 여백을 더 크게 설정
        // 세로 값은 무시하고, 가로 기준 배율만 사용
        const newFit = vw / baseW;
        const rel = keepRelative ? (scale / fitScale) : 1;
        
        // 현재 크기보다 5% 작게 100% 기준 설정
        const adjustedFit = newFit * 0.95; // 5% 축소
        fitScale = Math.max(0.1, adjustedFit); // 최소값 보장
        
        MIN = 0.5 * fitScale;
        MAX = 3.0 * fitScale;
        setScale(fitScale * rel);
      }
      function setScale(abs){
        const clamped = Math.max(MIN, Math.min(MAX, abs));
        scale = clamped;
        if(payslip) {
          payslip.style.transform = `scale(${scale})`;
          payslip.style.transformOrigin = 'top left';
        }
        // 퍼센트는 fitScale(0.9) 기준 100% (NaN 방지)
        const pct = fitScale > 0 ? Math.round((scale / fitScale) * 100) : 100;
        if(pctEl) pctEl.textContent = pct + '%';
      }
      // 버튼
      zInBtn.addEventListener('click', ()=> setScale(scale + STEP * fitScale));
      zOutBtn.addEventListener('click', ()=> setScale(scale - STEP * fitScale));
      // Ctrl+휠 확대/축소
      viewer.addEventListener('wheel', (e)=>{
        if(!e.ctrlKey) return;
        e.preventDefault();
        const dir = -Math.sign(e.deltaY);
        setScale(scale + dir * STEP * fitScale);
      }, { passive:false });
      // 확대 시 드래그 패닝
      let dragging=false, startX=0, startY=0, sL=0, sT=0;
      viewer.addEventListener('mousedown', (e)=>{
        if(scale <= fitScale) return;
        dragging = true;
        startX = e.pageX;
        startY = e.pageY;
        sL = viewer.scrollLeft;
        sT = viewer.scrollTop;
        viewer.style.cursor = 'grabbing';
      });
      window.addEventListener('mousemove', (e)=>{
        if(!dragging) return;
        viewer.scrollLeft = sL - (e.pageX - startX);
        viewer.scrollTop = sT - (e.pageY - startY);
      });
      window.addEventListener('mouseup', ()=>{
        dragging=false;
        viewer.style.cursor='';
      });
      // 닫기(인라인 도크 숨김)
      closeBtn.addEventListener('click', ()=> { 
        previewDock.style.display='none'; 
        previewDock.classList.remove('show');
        console.log('미리보기 창 닫힘');
      });
      // 리사이즈 시 100% 기준 유지
      new ResizeObserver(()=> computeFit(true)).observe(viewer);
      // 초기: 보이는 상태에서 정확히 100%로 맞춤
      previewDock.style.display = 'block';
      measureBase();
      
      // 모바일과 데스크톱에 따라 적절한 크기로 설정
      computeFit(false); // 초기 설정에서는 상대값 유지하지 않음
      
      // 확실히 100%로 설정
      setTimeout(() => {
        if (pctEl) {
          pctEl.textContent = '100%';
        }
        scale = fitScale; // 계산된 fitScale을 100%로 사용
        if(payslip) {
          payslip.style.transform = `scale(${scale})`;
          payslip.style.transformOrigin = 'top left';
        }
      }, 100);
      
      console.log('급여명세서 미리보기 기능 초기화 완료');
    });
  </script>
  
  <script>
    // ===== 라인 탭 전환 =====
    document.addEventListener('DOMContentLoaded', function() {
      console.log('탭 전환 기능 초기화 시작');
      
      const tabBtns  = document.querySelectorAll('.line-tab');
      const workView = document.getElementById('workView');
      const payView  = document.getElementById('payView');

      console.log('탭 버튼들:', tabBtns.length);
      console.log('출력현황 뷰:', workView);
      console.log('급여현황 뷰:', payView);

      if (tabBtns.length === 0) {
        console.error('탭 버튼을 찾을 수 없습니다!');
        return;
      }

      tabBtns.forEach((btn, index) => {
        console.log(`탭 버튼 ${index} 등록:`, btn.dataset.tab);
        
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          console.log('탭 클릭됨:', btn.dataset.tab);
          
          try {
            // 버튼 active 토글
            tabBtns.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            // 어떤 탭인지 판별
            const isPay = btn.dataset.tab === 'pay';
            console.log('급여 탭 여부:', isPay);

            // 콘텐츠 전환
            if (workView) {
              if (isPay) {
                workView.classList.add('hidden');
              } else {
                workView.classList.remove('hidden');
              }
              console.log('출력현황 뷰 표시:', !isPay);
            }
            if (payView) {
              if (isPay) {
                payView.classList.remove('hidden');
              } else {
                payView.classList.add('hidden');
              }
              console.log('급여현황 뷰 표시:', isPay);
            }

            // 급여 탭이면 계산·동기화 호출
            if (isPay) {
              console.log('급여현황 탭 활성화');
              // 급여 관련 함수들이 정의되어 있다면 호출
              setTimeout(() => {
                try {
                  if (typeof updatePayFormFields === 'function') {
                    updatePayFormFields();
                    console.log('급여 폼 필드 업데이트 완료');
                  }
                  if (typeof updatePaySummary === 'function') {
                    updatePaySummary();
                    console.log('급여 요약 업데이트 완료');
                  }
                  if (typeof updatePreviewData === 'function') {
                    updatePreviewData();
                    console.log('미리보기 데이터 업데이트 완료');
                  }
                } catch (error) {
                  console.error('급여 데이터 업데이트 중 오류:', error);
                }
              }, 100);
            } else {
              console.log('출력현황 탭 활성화');
            }
          } catch (error) {
            console.error('탭 전환 중 오류:', error);
          }
        });
      });
      
      // 초기 표시(마크업 초기 상태가 올바르면 아래는 생략 가능)
      (function syncInitialState(){
        console.log('초기 탭 상태 동기화');
        const active = document.querySelector('.line-tab.active');
        const isPay = active && active.dataset.tab === 'pay';
        
        console.log('활성 탭:', active?.dataset.tab);
        console.log('초기 상태 - 급여 탭 여부:', isPay);
        
        if (workView) {
          if (isPay) {
            workView.classList.add('hidden');
          } else {
            workView.classList.remove('hidden');
          }
          console.log('출력현황 뷰 초기 표시:', !isPay);
        }
        if (payView) {
          if (isPay) {
            payView.classList.remove('hidden');
          } else {
            payView.classList.add('hidden');
          }
          console.log('급여현황 뷰 초기 표시:', isPay);
        }
      })();
      
      console.log('탭 전환 기능 초기화 완료');
    });
  </script>
  
  <script>
    // ===== 달력 기능 =====
    document.addEventListener('DOMContentLoaded', function() {
      const btnPrev = document.getElementById('btnPrev');
      const btnNext = document.getElementById('btnNext');
      const ymBtn = document.getElementById('ymBtn');
      const calGrid = document.getElementById('calGrid');
      
      if (!btnPrev || !btnNext || !ymBtn || !calGrid) return;
      
      // 현재 날짜 상태 (현재 월로 설정)
      let currentDate = new Date();
      
      // 달력 렌더링 함수
      function renderCalendar() {
        try {
          const year = currentDate.getFullYear();
          const month = currentDate.getMonth();
          
          // 달력 제목 업데이트
          if (ymBtn) {
            ymBtn.textContent = `${year}년 ${month + 1}월`;
          }
          
          // 홈에서 저장된 데이터 확인
          const workLogData = JSON.parse(localStorage.getItem('workLogData') || '[]');
          console.log('달력 렌더링 - 저장된 작업일지 데이터:', workLogData);
          console.log('현재 렌더링 월:', `${year}년 ${month + 1}월`);
          
          // 월간통계 업데이트
          if (typeof updateMonthlyStats === 'function') {
            updateMonthlyStats(year, month, workLogData);
          }
        
        // 달의 첫 번째 날과 마지막 날
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);
        const firstDayOfWeek = firstDay.getDay(); // 0: 일요일, 1: 월요일, ...
        const daysInMonth = lastDay.getDate();
        
        // 이전 달의 마지막 날들
        const prevMonth = new Date(year, month, 0);
        const prevMonthDays = prevMonth.getDate();
        
        // 달력 그리드 초기화
        calGrid.innerHTML = '';
        
        // 이전 달의 날짜들 (빈 칸 채우기)
        for (let i = firstDayOfWeek - 1; i >= 0; i--) {
          const day = prevMonthDays - i;
          const cell = createDateCell(day, true);
          calGrid.appendChild(cell);
        }
        
        // 현재 달의 날짜들
        for (let day = 1; day <= daysInMonth; day++) {
          const cell = createDateCell(day, false);
          calGrid.appendChild(cell);
        }
        
        // 다음 달의 날짜들 (빈 칸 채우기)
        const totalCells = calGrid.children.length;
        const remainingCells = 42 - totalCells; // 6주 * 7일 = 42
        for (let day = 1; day <= remainingCells; day++) {
          const cell = createDateCell(day, true);
          calGrid.appendChild(cell);
        }
        } catch (error) {
          console.error('캘린더 렌더링 오류:', error);
        }
      }
      
      // 날짜 셀 생성 함수
      function createDateCell(day, isOtherMonth) {
        const cell = document.createElement('div');
        cell.className = 'cell';
        if (isOtherMonth) {
          cell.classList.add('out');
        }
        
        // 날짜 표시 (항상 표시)
        const dateSpan = document.createElement('div');
        dateSpan.className = 'date';
        dateSpan.textContent = day;
        
        // 일요일인지 확인 (현재 달의 날짜만)
        if (!isOtherMonth) {
          const currentYear = currentDate.getFullYear();
          const currentMonth = currentDate.getMonth();
          const dayOfWeek = new Date(currentYear, currentMonth, day).getDay();
          if (dayOfWeek === 0) {
            dateSpan.classList.add('sun');
          }
        }
        
        cell.appendChild(dateSpan);
        
        // 현재 달의 날짜에만 데이터 표시
        if (!isOtherMonth) {
          const currentYear = currentDate.getFullYear();
          const currentMonth = currentDate.getMonth();
          
          // 홈에서 저장된 작업일지 데이터 확인
          const workLogData = JSON.parse(localStorage.getItem('workLogData') || '[]');
          const currentDateStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
          const workData = workLogData.find(item => item.date === currentDateStr);
          
          // 디버깅 로그
          if (day <= 5) { // 처음 5일만 로그 출력
            console.log(`날짜 ${day}일 체크:`, currentDateStr, workData);
          }
          
          if (workData) {
            // 현장명을 2글자씩 2행으로 표기
            function getSiteName(siteName) {
              if (!siteName) return '현장';
              if (siteName.length <= 2) return siteName;
              if (siteName.length <= 4) {
                // 3-4글자인 경우 2글자씩 나누어 표시
                const first = siteName.substring(0, 2);
                const second = siteName.substring(2, 4);
                return `${first}<br>${second}`;
              }
              // 5글자 이상인 경우 앞 4글자만 2글자씩 나누어 표시
              const first = siteName.substring(0, 2);
              const second = siteName.substring(2, 4);
              return `${first}<br>${second}`;
            }
            
            // 작업 데이터가 있는 경우 표시
            const workInfo = document.createElement('div');
            workInfo.className = 'work-info';
            workInfo.innerHTML = `
              <div class="work-item">
                <div class="work-site">${getSiteName(workData.site)}</div>
                <span class="work-hours">${workData.men || 1}</span>
              </div>
            `;
            cell.appendChild(workInfo);
            cell.classList.add('has-work');
          }
        }
        
        return cell;
      }
      
      // 월간통계 업데이트 함수
      function updateMonthlyStats(year, month, workLogData) {
        console.log('월간통계 업데이트 시작:', workLogData);
        
        // 해당 월의 데이터 필터링
        const currentMonthStr = `${year}-${String(month + 1).padStart(2, '0')}`;
        const monthlyData = workLogData.filter(item => item.date && item.date.startsWith(currentMonthStr));
        
        console.log('해당 월 데이터:', monthlyData);
        
        // 출근(일) 계산 - 해당 월에 입력된 날짜 수
        const workDays = monthlyData.length;
        
        // 현장별 종류 수 계산 - 중복 제거된 현장명 개수
        const uniqueSites = [...new Set(monthlyData.map(item => item.site).filter(site => site))];
        const siteCount = uniqueSites.length;
        
        // 총 공수 계산 - 각 날짜의 공수 수치 합산
        const totalManDays = monthlyData.reduce((sum, item) => {
          const men = parseInt(item.men) || 1;
          return sum + men;
        }, 0);
        
        console.log('월간통계 계산 결과:', {
          workDays,
          siteCount,
          totalManDays,
          uniqueSites
        });
        
        // DOM 요소 업데이트
        const workDaysEl = document.getElementById('workDays');
        const siteCountEl = document.getElementById('siteCount');
        const totalManDaysEl = document.getElementById('totalManDays');
        
        if (workDaysEl) workDaysEl.textContent = workDays;
        if (siteCountEl) siteCountEl.textContent = siteCount;
        if (totalManDaysEl) totalManDaysEl.textContent = totalManDays;
        
        // 급여현황 통계도 함께 업데이트 (출력현황 데이터와 연동)
        const payWorkDays = document.getElementById('payWorkDays');
        const payRestDays = document.getElementById('payRestDays');
        const payTotalHours = document.getElementById('payTotalHours');
        
        // 홈에서 입력한 공수 입력값 합산
        const totalWorkHours = workLogData.reduce((sum, item) => {
          return sum + (parseInt(item.men) || 1); // men 필드가 없으면 1로 기본값
        }, 0);
        
        if (payWorkDays) payWorkDays.textContent = workDays; // 출근일 수로 변경
        if (payTotalHours) payTotalHours.textContent = totalWorkHours; // 총공수는 공수 합산값과 동일
        
        // 휴무일 계산 (해당 월의 총 일수 - 출근일)
        const now = new Date();
        const prevMonth = new Date(now.getFullYear(), now.getMonth() - 1);
        const daysInMonth = new Date(prevMonth.getFullYear(), prevMonth.getMonth() + 1, 0).getDate();
        const restDays = daysInMonth - workDays;
        
        if (payRestDays) payRestDays.textContent = restDays;
        
        // 급여 정보입력 필드도 함께 업데이트
        updatePayFormFields();
      }
      
      // 현장명 축약 함수 (4글자로 축약)
      function abbreviateSiteName(siteName) {
        if (!siteName) return '';
        
        // 한글과 영문이 섞인 경우 처리
        const koreanChars = siteName.match(/[가-힣]/g) || [];
        const englishChars = siteName.match(/[a-zA-Z]/g) || [];
        const numbers = siteName.match(/[0-9]/g) || [];
        
        // 한글이 있으면 한글 우선, 없으면 영문+숫자 조합
        if (koreanChars.length > 0) {
          // 한글 2글자 + 숫자 2자리 (예: 포항환호1BL -> 포항환호)
          if (koreanChars.length >= 2) {
            return koreanChars.slice(0, 2).join('') + (numbers.slice(0, 2).join('') || '');
          } else {
            return koreanChars.join('') + (englishChars.slice(0, 3).join('') || '');
          }
        } else if (englishChars.length > 0) {
          // 영문 4글자 (예: Site A -> Site)
          return englishChars.slice(0, 4).join('');
        } else if (numbers.length > 0) {
          // 숫자 4자리
          return numbers.slice(0, 4).join('');
        } else {
          // 기타 문자 4글자
          return siteName.slice(0, 4);
        }
      }
      
      // 이전 달 버튼
      btnPrev.addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() - 1);
        renderCalendar();
        console.log('이전 달로 이동:', currentDate.getFullYear(), currentDate.getMonth() + 1);
      });
      
      // 다음 달 버튼
      btnNext.addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() + 1);
        renderCalendar();
        console.log('다음 달로 이동:', currentDate.getFullYear(), currentDate.getMonth() + 1);
      });
      
      // 년월 버튼 클릭 (모달 열기)
      ymBtn.addEventListener('click', () => {
        // 모달 기능은 나중에 구현
        console.log('년월 선택 모달 열기');
      });
      
      // 초기 달력 렌더링
      renderCalendar();
      
      // 테스트용 데이터 추가 (개발 중에만 사용)
      if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
        const now = new Date();
        const currentYear = now.getFullYear();
        const currentMonth = now.getMonth() + 1;
        
        const testData = [
          {
            date: `${currentYear}-${String(currentMonth).padStart(2, '0')}-15`,
            site: '포항환호1BL',
            writer: '테스트작성자',
            men: 1
          },
          {
            date: `${currentYear}-${String(currentMonth).padStart(2, '0')}-20`,
            site: 'Site A',
            writer: '테스트작성자2',
            men: 2
          }
        ];
        localStorage.setItem('workLogData', JSON.stringify(testData));
        console.log('테스트 데이터 추가됨:', testData);
        // 테스트 데이터 추가 후 달력 다시 렌더링
        setTimeout(() => renderCalendar(), 100);
      }
      
      // 데이터 변경 감지를 위한 이벤트 리스너 추가
      window.addEventListener('storage', (e) => {
        if (e.key === 'workLogData') {
          console.log('workLogData 변경 감지, 달력 다시 렌더링');
          renderCalendar();
        }
      });
      
      // 페이지 포커스 시 통계 업데이트
      window.addEventListener('focus', () => {
        console.log('페이지 포커스. 통계를 업데이트합니다.');
        const workLogData = JSON.parse(localStorage.getItem('workLogData') || '[]');
        updateMonthlyStats(currentDate.getFullYear(), currentDate.getMonth(), workLogData);
      });
    });
    
    // ===== 현장 선택 드롭다운 기능 =====
    document.addEventListener('DOMContentLoaded', function() {
      const siteSelect = document.getElementById('siteSelect');
      const selectDisplay = document.getElementById('selectDisplay');
      
      if (siteSelect && selectDisplay) {
        siteSelect.addEventListener('change', function() {
          const selectedOption = this.options[this.selectedIndex];
          selectDisplay.textContent = selectedOption.text;
          console.log('선택된 현장:', selectedOption.text);
        });
      }
    });
  </script>

  <!-- ========== 햄버거 드로어 ========== -->
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@500;600;700;800&display=swap');
    .drawer-scrim{position:fixed; inset:0; background:rgba(0,0,0,.35); display:none; z-index:1400;}
    .drawer-scrim.show{display:block}
    .drawer{position:fixed; top:0; left:-320px; width:320px; max-width:86vw; height:100%; background:#fff; box-shadow:4px 0 24px rgba(0,0,0,.18); z-index:1500; display:flex; flex-direction:column; transition:left .28s ease-out; font-family:'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif; overflow:visible; contain:layout paint; isolation:isolate; padding:calc(12px + env(safe-area-inset-top, 0px)) 12px calc(16px + env(safe-area-inset-bottom, 0px));}
    [data-theme="dark"] .drawer{background:#0F172A}
    .drawer.show{left:0}
    .drawer-head{display:none}
    .drawer-body{padding:0; flex:1; overflow:visible;}
    .drawer-scale{transform-origin:top center; will-change:transform; padding:20px 16px;}
    .greet-wrap{display:flex; flex-direction:column; gap:6px; margin-bottom:18px}
    .greet-hello{font-family:'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif; font-size:21px; font-weight:600; line-height:1.2; color:#1A254F}
    .greet-email{font:500 13px/1.3 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif; color:#9CA3AF}
    .coupon-sec{margin:10px 0 16px}
    .coupon-title{font:700 12px/1 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif; color:#6B7280; margin-bottom:8px}
    .coupon-row{display:flex; align-items:center; justify-content:space-between; padding:12px 0; border-bottom:1px solid #E5E7EB; color:#111827; font-family:'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif}
    [data-theme="dark"] .coupon-row{border-color:#1E293B; color:#E5E7EB}
    .chev{color:#9CA3AF}
    .menu-list{margin:8px 0 0; padding:0; list-style:none; border-top:1px solid #E5E7EB}
    [data-theme="dark"] .menu-list{border-color:#1E293B}
    .menu-item{display:block; padding:12px 0; border-bottom:1px solid #E5E7EB; color:var(--text); text-decoration:none;}
    [data-theme="dark"] .menu-item{border-color:#1E293B}
    .menu-item:hover{background:transparent}
    .menu-label{font-family:'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif; font-size:15px; font-weight:600; line-height:1.2; color:#1A254F; transform: translateX(30px);}
    [data-theme="dark"] .menu-label{color:#FFFFFF;}
    .menu-item-with-btn{display:flex; align-items:center; justify-content:space-between; padding:12px 0; border-bottom:1px solid #E5E7EB;}
    .menu-item-with-btn .menu-item{padding:0; border-bottom:none;}
    [data-theme="dark"] .menu-item-with-btn{border-color:#1E293B; background-color:#FFFFFF;}
    .close-btn{background-color:#ffffff; color:#000000; border:1px solid #e0e0e0; border-radius:6px; padding:8px 16px; font-family:'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif; font-size:14px; font-weight:500; cursor:pointer; transition:all 0.3s ease; box-shadow:0 1px 3px rgba(0,0,0,0.1);}
    .close-btn:hover{background-color:#f5f5f5; border-color:#d0d0d0;}
    [data-theme="dark"] .close-btn{background-color:#2a2a2a; color:#ffffff; border-color:#404040;}
    [data-theme="dark"] .close-btn:hover{background-color:#3a3a3a; border-color:#505050;}
    .account-manage-btn{background-color:#ffffff; color:#000000; border:1px solid #e0e0e0; border-radius:6px; padding:8px 16px; font-family:'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif; font-size:14px; font-weight:500; cursor:pointer; transition:all 0.3s ease; box-shadow:0 1px 3px rgba(0,0,0,0.1);}
    .account-manage-btn:hover{background-color:#f5f5f5; border-color:#d0d0d0;}
    [data-theme="dark"] .account-manage-btn{background-color:#2a2a2a; color:#ffffff; border-color:#404040;}
    [data-theme="dark"] .account-manage-btn:hover{background-color:#3a3a3a; border-color:#505050;}
    .account-info{padding:12px 0; border-bottom:1px solid #E5E7EB;}
    [data-theme="dark"] .account-info{border-color:#1E293B}
    .account-info-item{display:flex; justify-content:space-between; align-items:center; padding:6px 0; font-family:'Noto Sans KR', system-ui, sans-serif; font-size:15px; font-weight:600;}
    .account-label{color:#6B7280;}
    .account-value{color:#1A254F; font-weight:600;}
    .change-password-btn{color:#0068FE !important; cursor:pointer; transition:color 0.3s ease;}
    .change-password-btn:hover{color:#0056CC !important;}
    [data-theme="dark"] .account-label{color:#9CA3AF;}
    [data-theme="dark"] .account-value{color:#F9FAFB;}
    [data-theme="dark"] .change-password-btn{color:#63B3ED !important;}
    [data-theme="dark"] .change-password-btn:hover{color:#90CDF4 !important;}
    
    /* 비밀번호 변경 폼 스타일 (홈 디자인 CSS 반영) */
    .password-change-form{padding:16px; border-bottom:none; opacity:1; transform:translateY(0); transition:opacity 0.3s ease, transform 0.3s ease;}
    [data-theme="dark"] .password-change-form{border-color:#1E293B}
    .password-form-container{padding:0;}
    .form-group{margin-bottom:12px;}
    .form-label{display:block; margin-bottom:8px; font-family:'Noto Sans KR', system-ui, sans-serif; font-size:15px; font-weight:600; color:#6B7280;}
    [data-theme="dark"] .form-label{color:#D1D5DB;}
    .form-input{width:100%; height:48px; padding:0 16px; border:1px solid #D1D5DB; border-radius:12px; font-family:'Noto Sans KR', system-ui, sans-serif; font-size:15px; background:#FFFFFF; color:#111827; transition:border-color 0.3s ease; box-sizing:border-box;}
    .form-group{position:relative;}
    .password-toggle{position:absolute; right:12px; top:50%; transform:translateY(-50%); background:none; border:none; cursor:pointer; padding:4px; color:#6B7280; font-size:14px; font-weight:600; transition:color 0.3s ease; font-family:'Noto Sans KR', system-ui, sans-serif;}
    .password-toggle:hover{color:#374151;}
    [data-theme="dark"] .password-toggle{color:#FFFFFF;}
    [data-theme="dark"] .password-toggle:hover{color:#FFFFFF;}
    .form-input:focus{outline:none; border-color:#0068FE;}
    [data-theme="dark"] .form-input{border-color:#4B5563; background:#1F2937; color:#F9FAFB;}
    [data-theme="dark"] .form-input:focus{border-color:#63B3ED;}
    .form-actions{display:flex; gap:12px; margin-top:16px; width:100%;}
    .cancel-btn{flex:1; height:48px; border:1px solid #D1D5DB; border-radius:12px; background:#FFFFFF; color:#374151; font-family:'Noto Sans KR', system-ui, sans-serif; font-size:15px; font-weight:600; cursor:pointer; transition:all 0.3s ease; min-width:0;}
    .cancel-btn:hover{background:#F9FAFB; border-color:#9CA3AF;}
    [data-theme="dark"] .cancel-btn{border-color:#4B5563; background:#1F2937; color:#D1D5DB;}
    [data-theme="dark"] .cancel-btn:hover{background:#374151; border-color:#6B7280;}
    .save-btn{flex:1; height:48px; border:none; border-radius:12px; background:#0068FE; color:#FFFFFF; font-family:'Noto Sans KR', system-ui, sans-serif; font-size:15px; font-weight:600; cursor:pointer; transition:all 0.3s ease; min-width:0;}
    .save-btn:hover{background:#0056CC;}
    [data-theme="dark"] .save-btn{background:#63B3ED;}
    [data-theme="dark"] .save-btn:hover{background:#90CDF4;}
    .drawer-foot{margin-top:auto; padding:16px; border-top:1px solid var(--nav-border); padding-bottom:max(16px, env(safe-area-inset-bottom, 0px));}
    .logout-btn{width:100%; height:48px; border-radius:12px; border:1px solid #1A254F; background:#1A254F; font-family:'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif; font-size:14px; font-weight:700; line-height:1.2; color:#FFFFFF;}
    .logout-btn:hover{background:#162043; border-color:#162043; color:#FFFFFF}
    [data-theme="dark"] .logout-btn{background:#1A254F; border-color:#1A254F; color:#FFFFFF}
    [data-theme="dark"] .logout-btn:hover{background:#162043; border-color:#162043; color:#FFFFFF}
    .drawer-name{font:inherit}
    .drawer-email{font:inherit}
    .drawer-role{font:600 14px/1.1 'Noto Sans KR', system-ui, -apple-system, Segoe UI, Roboto, sans-serif; color:#000000}
    [data-theme="dark"] .drawer-role{ color: var(--text); }
    .profile-sec{display:flex; flex-direction:column; margin:10px 0 16px; gap:8px;}
    .profile-header{display:flex; align-items:center; justify-content:space-between; width:100%;}
    .profile-left{display:flex; align-items:center; gap:12px}
    .profile-text{display:flex; flex-direction:column; gap:2px}
    .avatar{width:48px; height:48px; border-radius:12px; object-fit:cover; border:1px solid #E5E7EB; background:#f3f4f6}
    .profile-name{font:600 18px/1.2 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif; color:#1A254F}
    .profile-email{font:400 13px 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif; color:#64748B; text-align:left;}
    #avatarUpload{display:none}
    [data-theme="dark"] .avatar{border-color:#1E293B; background:#0b1220}
  </style>

  <div id="drawerScrim" class="drawer-scrim" aria-hidden="true"></div>
  <aside id="drawer" class="drawer" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="drawer-body">
      <div class="drawer-scale">
      <a href="#" id="drawerClose" class="account-manage" aria-label="닫기"></a>
      
      <div class="profile-sec">
        <div class="profile-header">
          <div class="profile-name" id="profileUserName">이현수 <span class="important-tag" style="position: relative; top: 0; right: 0; margin-left: 8px;">현장관리자</span></div>
          <button class="close-btn" id="drawerCloseBtn">닫기</button>
        </div>
        <div class="profile-email" id="profileUserEmail">manager@inopnc.com</div>
      </div>
      <input type="file" id="avatarUpload" accept="image/*" aria-hidden="true" />
      <ul class="menu-list">
        <li><a class="menu-item" href="home.html"><span class="menu-label">홈</span></a></li>
        <li><a class="menu-item" href="worklog.html"><span class="menu-label">출력현황</span></a></li>
        <li><a class="menu-item" href="home.html"><span class="menu-label">작업일지</span></a></li>
        <li><a class="menu-item" href="현장정보.html"><span class="menu-label">현장정보</span></a></li>
        <li><a class="menu-item" href="home.html"><span class="menu-label">문서함</span></a></li>
        <li class="menu-item-with-btn">
          <a class="menu-item" href="home.html"><span class="menu-label">내정보</span></a>
          <button class="account-manage-btn" id="accountManageBtn">계정관리</button>
        </li>
        <li class="account-info" id="accountInfo" style="display: none;">
          <div class="account-info-item">
            <span class="account-label">연락처</span>
            <span class="account-value">010-1234-5678</span>
          </div>
          <div class="account-info-item">
            <span class="account-label">가입일</span>
            <span class="account-value">2024.01.15</span>
          </div>
          <div class="account-info-item">
            <span class="account-label">비밀번호 변경</span>
            <span class="account-value change-password-btn" id="changePasswordBtn">변경하기</span>
          </div>
        </li>
        <li class="password-change-form" id="passwordChangeForm" style="display: none;">
          <div class="password-form-container">
            <div class="form-group">
              <input type="password" class="form-input" id="currentPassword" placeholder="현재 비밀번호를 입력">
            </div>
            <div class="form-group">
              <input type="password" class="form-input" id="newPassword" placeholder="새 비밀번호 입력(최소 6자)">
            </div>
            <div class="form-group">
              <input type="password" class="form-input" id="confirmPassword" placeholder="새 비밀번호를 다시 입력">
            </div>
            <div class="form-actions">
              <button class="cancel-btn" id="cancelPasswordChange">취소</button>
              <button class="save-btn" id="savePasswordChange">저장</button>
            </div>
          </div>
        </li>
      </ul>
      </div>
    </div>
    <div class="drawer-foot">
      <button class="logout-btn" type="button" id="drawerLogout">로그아웃</button>
    </div>
  </aside>

  <script>
    (function(){
      const btn = document.getElementById('btnHamburger');
      const scrim = document.getElementById('drawerScrim');
      const drawer = document.getElementById('drawer');
      const drawerScale = document.querySelector('.drawer-scale');
      const closeBtn = document.getElementById('drawerClose');
      
      function lockScroll(lock){ document.body.classList.toggle('modal-open', !!lock); }
      
      function fitDrawer(){
        if(!drawer || !drawerScale) return;
        // 가용 높이(패널 패딩/안전영역 감안)
        const style = getComputedStyle(drawer);
        const padTop = parseFloat(style.paddingTop);
        const padBottom = parseFloat(style.paddingBottom);
        const avail = window.innerHeight - padTop - padBottom;

        // 실제 콘텐츠 전체 높이
        const contentH = drawerScale.scrollHeight;

        // 축소 비율 계산 (최소 0.85 유지)
        const s = Math.max(0.85, Math.min(1, avail / contentH));
        drawerScale.style.transform = `scale(${s})`;
      }
      
      function open(){ 
        scrim.classList.add('show'); 
        drawer.classList.add('show'); 
        drawer.setAttribute('aria-hidden','false'); 
        lockScroll(true);
        // 열릴 때 자동 축소 적용
        setTimeout(fitDrawer, 50);
      }
      function close(){ scrim.classList.remove('show'); drawer.classList.remove('show'); drawer.setAttribute('aria-hidden','true'); lockScroll(false); }
      btn?.addEventListener('click', open);
      closeBtn?.addEventListener('click', close);
      scrim?.addEventListener('click', close);
      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && drawer.classList.contains('show')) close(); });
      
      // 뷰포트 변동에 대응
      window.addEventListener('resize', fitDrawer);
      window.visualViewport?.addEventListener('resize', fitDrawer);
      window.visualViewport?.addEventListener('scroll', fitDrawer);
      
      // 비밀번호 토글 함수
      window.togglePassword = function(inputId, button) {
        const input = document.getElementById(inputId);
        if (input.type === 'password') {
          input.type = 'text';
          button.textContent = '숨기기';
        } else {
          input.type = 'password';
          button.textContent = '보기';
        }
      };
      
      // 닫기 버튼 이벤트 리스너 추가
      const drawerCloseBtn = document.getElementById('drawerCloseBtn');
      drawerCloseBtn?.addEventListener('click', close);
      
      // 계정관리 버튼 이벤트 리스너 추가
      const accountManageBtn = document.getElementById('accountManageBtn');
      const accountInfo = document.getElementById('accountInfo');
      accountManageBtn?.addEventListener('click', () => {
        if (accountInfo) {
          const isVisible = accountInfo.style.display !== 'none';
          accountInfo.style.display = isVisible ? 'none' : 'block';
        }
      });
      
      // 비밀번호 변경 관련 이벤트 리스너
      const changePasswordBtn = document.getElementById('changePasswordBtn');
      const passwordChangeForm = document.getElementById('passwordChangeForm');
      const cancelPasswordChange = document.getElementById('cancelPasswordChange');
      const savePasswordChange = document.getElementById('savePasswordChange');
      
      changePasswordBtn?.addEventListener('click', () => {
        if (passwordChangeForm) {
          const isHidden = passwordChangeForm.style.display === 'none' || passwordChangeForm.style.display === '';
          
          if (isHidden) {
            // 폼 표시
            passwordChangeForm.style.display = 'block';
            passwordChangeForm.style.opacity = '0';
            passwordChangeForm.style.transform = 'translateY(-10px)';
            passwordChangeForm.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
            
            // 애니메이션 시작
            setTimeout(() => {
              passwordChangeForm.style.opacity = '1';
              passwordChangeForm.style.transform = 'translateY(0)';
            }, 10);
          } else {
            // 폼 숨기기
            passwordChangeForm.style.opacity = '0';
            passwordChangeForm.style.transform = 'translateY(-10px)';
            
            setTimeout(() => {
              passwordChangeForm.style.display = 'none';
            }, 300);
          }
        }
      });
      
      cancelPasswordChange?.addEventListener('click', () => {
        if (passwordChangeForm) {
          // 애니메이션과 함께 폼 숨기기
          passwordChangeForm.style.opacity = '0';
          passwordChangeForm.style.transform = 'translateY(-10px)';
          
          setTimeout(() => {
            passwordChangeForm.style.display = 'none';
            // 폼 초기화
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
          }, 300);
        }
      });
      
      savePasswordChange?.addEventListener('click', () => {
        const currentPassword = document.getElementById('currentPassword').value;
        const newPassword = document.getElementById('newPassword').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        
        if (!currentPassword || !newPassword || !confirmPassword) {
          alert('모든 필드를 입력해주세요.');
          return;
        }
        
        if (newPassword !== confirmPassword) {
          alert('새 비밀번호가 일치하지 않습니다.');
          return;
        }
        
        if (newPassword.length < 8) {
          alert('비밀번호는 8자 이상이어야 합니다.');
          return;
        }
        
        // 비밀번호 변경 로직 (실제 구현 시 서버 API 호출)
        alert('비밀번호가 성공적으로 변경되었습니다.');
        
        // 애니메이션과 함께 폼 숨기기
        passwordChangeForm.style.opacity = '0';
        passwordChangeForm.style.transform = 'translateY(-10px)';
        
        setTimeout(() => {
          passwordChangeForm.style.display = 'none';
          // 폼 초기화
          document.getElementById('currentPassword').value = '';
          document.getElementById('newPassword').value = '';
          document.getElementById('confirmPassword').value = '';
        }, 300);
      });

      const avatarInput = document.getElementById('avatarUpload');
      const avatarImg = document.getElementById('drawerAvatar');
      avatarInput?.addEventListener('change', (event)=>{
        const file = event.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (e) => {
            if (avatarImg) avatarImg.src = e.target.result;
          };
          reader.readAsDataURL(file);
        }
      });
      
      // 로그아웃 기능
      const logoutBtn = document.getElementById('drawerLogout');
      logoutBtn?.addEventListener('click', () => {
        // 로컬 스토리지와 세션 스토리지 클리어
        localStorage.clear();
        sessionStorage.clear();
        
        // 홈페이지로 리다이렉트
        window.location.href = './';
      });
    })();
  </script>
</body>
</html>