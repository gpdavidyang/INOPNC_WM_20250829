<!DOCTYPE html>

<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no" name="viewport"/>
<title>메인 - INOPNC</title>
<link href="assets/css/common-ui.css" rel="stylesheet"/>
<link href="assets/header-nav.css" rel="stylesheet"/>
<link href="ino.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@700&amp;display=swap" rel="stylesheet"/>
<style>
        /* 폰트 로딩 최적화 및 안전한 fallback 설정 */
        @font-face {
            font-family: 'Noto Sans KR';
            src: url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap');
            font-display: swap;
        }
        @font-face {
            font-family: 'Poppins';
            src: url('https://fonts.googleapis.com/css2?family=Poppins:wght@700&display=swap');
            font-display: swap;
        }
        
        /* 폰트 로딩 실패 시 대비 */
        .font-loading-fallback {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
        }

        /* ===== ino.css 변수 정의 ===== */
        :root {
            --bg: #F6F9FF;
            --surface: #FFFFFF;
            --surface-2: #F8FAFC;
            --line: #E6ECF4;
            --card: #FFFFFF;
            --text: #1A1A1A;
            --ink: #1A1A1A;
            --muted-ink: #6B7280;
            --tag-blue: #31a3fa;
            --tag-blue-20: rgba(49, 163, 250, 0.2);
        }

        [data-theme="dark"] {
            --bg: #0F172A;
            --surface: #111A2E;
            --surface-2: #0B1324;
            --line: color-mix(in srgb, #E6ECF4 12%, transparent);
            --card: #111827;
            --text: #E5E7EB;
            --ink: #E6ECF4;
            --muted-ink: #A8B0C2;
            --tag-blue: #31a3fa;
            --tag-blue-20: rgba(0, 188, 212, 0.2);
        }

        [data-theme="dark"] .header-content {
            border-bottom: 1px solid var(--line);
        }


        /* ===== 배경색 설정 ===== */
        body {
            background: var(--bg);
            color: var(--ink);
        }

        .app-container {
            background: var(--bg);
            min-height: 100vh;
            width: 100%;
            max-width: 100%;
            overflow-x: hidden;
        }

        .main-content {
            background: var(--bg);
            width: 100%;
            max-width: 1200px;
            height: 1500px;
            margin: 0 auto !important;
            overflow-x: hidden;
            box-sizing: border-box;
            padding: 135px 18px 91px 18px !important; /* 상단 135px, 좌우 18px, 하단 91px */
        }


        /* ===== 탭 메뉴 스타일 ===== */
        .tab-navigation {
            position: fixed;
            top: 80px; /* 헤더 높이만큼 아래 */
            left: 0;
            right: 0;
            z-index: 999;
            background: var(--surface);
            border-bottom: 1px solid var(--line);
            display: flex;
            justify-content: center;
            padding: 0 16px;
            margin-bottom: 0;
            height: 42px;
        }

        .tab-container {
            display: flex;
            gap: 0;
            max-width: 400px;
            width: 100%;
        }

        .tab-button {
            flex: 1;
            padding: 8px !important;
            background: none;
            border: none;
            font-family: 'Noto Sans KR', system-ui, sans-serif;
            font-size: 20px !important;
            font-weight: 600; /* Semi-Bold */
            color: #99a4be;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            border-bottom: 2px solid transparent;
        }

        .tab-button.active {
            color: #31a3fa;
            border-bottom-color: #31a3fa;
        }

        .tab-button:hover {
            color: #31a3fa;
            background: none;
        }

        /* 다크모드 탭 스타일 */
        [data-theme="dark"] .tab-navigation {
            background: var(--surface);
            border-bottom-color: var(--line);
        }

        [data-theme="dark"] .tab-button {
            color: #99a4be;
            font-weight: 600; /* Semi-Bold */
        }

        [data-theme="dark"] .tab-button.active {
            color: #31a3fa;
            border-bottom-color: #31a3fa;
        }

        [data-theme="dark"] .tab-button:hover {
            color: #31a3fa;
            background: none;
        }

        /* ===== 현장/년월일 선택 스타일 ===== */
        .site-filter-section {
            display: flex;
            gap: 8px;
            margin-bottom: 0;
            text-align: center;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
            position: static;
            z-index: 10;
            background: none;
            border-bottom: none;
            padding: 0;
        }

        .select-shell {
            flex: 1 !important;
            min-width: 0 !important;
            position: relative;
            margin: 0;
        }

        .select-shell .box {
            height: 40px;
            border: 0.5px solid #D1D5DB;
            border-radius: 10px;
            background: #FFFFFF;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Noto Sans KR', system-ui, sans-serif;
            font-size: 16px;
            font-weight: 600;
            color: #1F2937;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }


        .select-shell select {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 40px;
            opacity: 0;
            cursor: pointer;
        }

        /* siteSelect 폰트 스타일 - 메인 페이지 form-select와 동일 */
        .select-shell #siteSelect,
        .select-shell #yearMonthSelect {
            width: 100% !important;
            height: 40px !important;
            padding: 0 16px !important;
            border: 1px solid #D1D5DB !important;
            border-radius: 10px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            background: #FFFFFF !important;
            font-family: "Noto Sans KR", system-ui, sans-serif !important;
            font-size: 16px !important;
            font-weight: 600 !important;
            color: #1F2937 !important;
            cursor: pointer !important;
            box-sizing: border-box !important;
            transition: border-color 0.2s ease !important;
        }

        .select-shell #siteSelect:hover,
        .select-shell #yearMonthSelect:hover {
            border-color: var(--brand, #2F6BFF);
        }

        .select-shell #siteSelect:focus,
        .select-shell #yearMonthSelect:focus {
            outline: none;
            border-color: var(--brand, #2F6BFF);
            box-shadow: 0 0 0 3px rgba(47, 107, 255, 0.1);
        }

        [data-theme="dark"] .select-shell #siteSelect,
        [data-theme="dark"] .select-shell #yearMonthSelect {
            background: #374151 !important;
            border-color: #4B5563 !important;
            color: #FFFFFF !important;
        }

        [data-theme="dark"] .select-shell #siteSelect option,
        [data-theme="dark"] .select-shell #yearMonthSelect option {
            background: #374151 !important;
            color: #FFFFFF !important;
        }

        /* 두 선택 박스 너비 동일하게 설정 */
        .select-shell:first-child,
        .select-shell:last-child {
            flex: 1 !important;
            width: 50% !important;
            min-width: 0 !important;
        }

        /* 필터 화살표 스타일 */
        .filter-arrow {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            display: none;
            align-items: center;
            justify-content: center;
            width: 16px;
            height: 16px;
            pointer-events: none;
        }

        .filter-arrow svg {
            color: #31a3fa;
            transition: color 0.2s ease;
        }

        /* 다크모드 화살표 스타일 */
        [data-theme="dark"] .select-shell .box {
            background: #374151;
            border-color: #4B5563;
            color: #FFFFFF;
        }

        [data-theme="dark"] .filter-arrow svg {
            color: #31a3fa;
        }

        /* ===== 캘린더 스타일 ===== */
        .cal-wrap {
            position: static;
            margin: 18px 0 0 0;
            left: 0;
            right: 0;
            transform: none;
            border: 1px solid #E6ECF4;
            border-radius: 10px;
            background: var(--surface);
            box-shadow: 0 2px 10px rgba(2,6,23,.04);
            width: 100%;
            max-width: 100%;
            text-align: center !important;
            padding: 18px;
            box-sizing: border-box;
        }

        .cal-head {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 16px;
        }

        /* 캘린더 헤드 화살표 컬러 */
        .cal-head button i[data-lucide="chevron-left"],
        .cal-head button i[data-lucide="chevron-right"] {
            color: #1A254F !important;
        }

        [data-theme="dark"] .cal-head button i[data-lucide="chevron-left"],
        [data-theme="dark"] .cal-head button i[data-lucide="chevron-right"] {
            color: #31a3fa !important;
        }

        .cal-title {
            font-family: var(--font-sans);
            font-weight: 600; /* Semi-Bold */
            font-size: 20px;
            line-height: 1.4;
            color: #1A254F;
        }

        .cal-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            padding: 0 2px;
            gap: 1px;
        }

        .dow {
            text-align: center;
            font-family: var(--font-sans);
            font-weight: 600; /* Semi-Bold */
            font-size: 16px;
            line-height: 1.4;
            color: #1A254F;
            padding: 12px 0;
            border-bottom: 1px solid #E6ECF4;
        }

        .dow.sun {
            color: #FF6B6B;
        }

        .cell {
            min-height: 60px;
            border-top: 1px solid #E6ECF4;
            padding: 8px 4px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            position: relative;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .cell:hover {
            background-color: rgba(47, 107, 255, 0.05);
        }

        .cell.out {
            color: #D1D5DB;
            background-color: #F9FAFB;
        }

        .cell .date {
            font-family: var(--font-sans);
            font-weight: 600; /* Semi-Bold */
            font-size: 16px;
            line-height: 1.4;
            color: #1A254F;
            margin-bottom: 4px;
        }

        .cell.out .date {
            color: #D1D5DB;
        }

        .cell .date.sun {
            color: #FF6B6B;
        }

        .cell .site-name {
            font-family: var(--font-sans);
            font-weight: 400; /* Regular */
            font-size: 10px;
            line-height: 1.2;
            color: #6B7280;
            margin-bottom: 2px;
            width: 100%;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .cell .work-hours {
            font-family: var(--font-sans);
            font-weight: 600; /* Semi-Bold */
            font-size: 12px;
            line-height: 1.4;
            color: #31a3fa;
        }

        /* 다크모드 캘린더 스타일 */
        [data-theme="dark"] .cal-wrap {
            background: var(--surface);
            border-color: var(--line);
        }

        [data-theme="dark"] .cal-title {
            color: #1A254F;
        }

        [data-theme="dark"] .dow {
            color: var(--muted-ink);
        }

        [data-theme="dark"] .cell {
            border-top-color: var(--line);
        }

        [data-theme="dark"] .cell .date {
            color: #1A254F;
        }

        [data-theme="dark"] .cell.out {
            background-color: #374151;
        }

        [data-theme="dark"] .cell.out .date {
            color: #6B7280;
        }

        [data-theme="dark"] .cell .site-name {
            color: #9CA3AF;
        }

        /* 큰글씨 모드에서 site-name 크기 조정 */
        .main-page-content.fs-150 .cell .site-name {
            font-size: 11px !important;
            line-height: 1.1 !important;
        }

        /* ===== 통계 섹션 스타일 ===== */
        .stats {
            width: 100% !important;
            max-width: 1200px !important;
            margin: 0 auto 18px auto !important;
            box-sizing: border-box !important;
            position: static !important;
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
            gap: 15px !important;
            padding: 18px 4px 0 4px !important;
            text-align: center !important;
        }


        .stat {
            flex: 1;
            min-width: 106px;
            box-sizing: border-box;
            border: 1px solid currentColor;
            border-radius: 12px;
            text-align: center;
            padding: 14px 0;
        }

        .stat .num {
            font-family: var(--font-sans);
            font-size: 22px;
            font-weight: 700; /* Bold */
            line-height: 1.4;
        }

        .stat .label {
            font-family: var(--font-sans);
            font-size: 16px;
            font-weight: 600; /* Semi-Bold */
            line-height: 1.4;
        }

        /* 각 통계 카드의 라벨 컬러를 메인 컬러와 동일하게 */
        .stat-workdays .label {
            color: #99a4be;
        }

        .stat-sites .label {
            color: #31a3fa;
        }

        .stat-hours .label {
            color: #1A254F;
        }

        .stat-workdays {
            color: #99a4be;
            background: rgba(153, 164, 190, .05);
        }

        .stat-sites {
            color: #31a3fa;
            background: rgba(49, 163, 250, .05);
        }

        .stat-hours {
            color: #1A254F;
            background: rgba(26, 37, 79, .05);
        }

        /* 다크모드 통계 스타일 */
        [data-theme="dark"] .stat {
            border-color: var(--line);
        }

        [data-theme="dark"] .stat .num {
            color: var(--ink);
        }

        [data-theme="dark"] .stat .label {
            color: var(--muted-ink);
        }

        /* 다크모드 CSS 변수 적용 */
        [data-theme="dark"] {
            --bg: #0F172A;
            --surface: #111A2E;
            --surface-2: #0B1324;
            --line: color-mix(in srgb, #E6ECF4 12%, transparent);
            --card: #111827;
            --text: #E5E7EB;
            --ink: #E6ECF4;
            --muted-ink: #A8B0C2;
            --tag-blue: #31a3fa;
            --tag-blue-20: rgba(49, 163, 250, 0.2);
        }

        /* 다크모드 요약카드 스타일 - p-site와 동일 */
        [data-theme="dark"] .stat {
            color: #99A4BE !important;
            background: rgba(153, 164, 190, .1) !important;
            border: 1px solid currentColor !important;
        }

        [data-theme="dark"] .stat.stat-sites {
            color: #63B3ED !important;
            background: rgba(99, 179, 237, .1) !important;
            border: 1px solid currentColor !important;
        }

        [data-theme="dark"] .stat.stat-hours {
            color: #FFFFFF !important;
            background: rgba(255, 255, 255, .1) !important;
            border: 1px solid currentColor !important;
        }

        [data-theme="dark"] .stat .num {
            color: inherit !important;
        }

        [data-theme="dark"] .stat .label {
            color: inherit !important;
        }

        /* 다크모드에서 특정 요소들 컬러만 화이트 */
        [data-theme="dark"] .date,
        [data-theme="dark"] .cal-title,
        [data-theme="dark"] .lucide-chevron-right,
        [data-theme="dark"] .lucide-chevron-left,
        [data-theme="dark"] svg[data-lucide="chevron-right"],
        [data-theme="dark"] svg[data-lucide="chevron-left"],
        [data-theme="dark"] .title,
        [data-theme="dark"] label {
            color: #FFFFFF !important;
        }

        /* 다크모드 스타일 적용 */
        /* 1. header-right 아이콘 폰트 컬러 : 99A4BE - 강제 적용 */
        [data-theme="dark"] .header-right,
        [data-theme="dark"] .header-right *,
        [data-theme="dark"] .header-right svg,
        [data-theme="dark"] .header-right .icon-text,
        [data-theme="dark"] .header-icon-btn,
        [data-theme="dark"] .header-icon-btn svg,
        [data-theme="dark"] .header-icon-btn .icon-text {
            color: #99A4BE !important;
        }

        /* 2. 빠른메뉴 아이콘 밑에 폰트 컬러 : 99A4BE */
        [data-theme="dark"] #quick-menu .quick-item span {
            color: #99A4BE !important;
        }

        /* 5. 요일라벨 컬러 : 99A4BE */
        [data-theme="dark"] .day-label {
            color: #99A4BE !important;
        }

        /* 6. 요일라벨과 위크데이 사이에있는 구분선 컬러 : 99A4BE */
        [data-theme="dark"] .week-dates {
            border-top-color: #99A4BE !important;
        }

        /* 7. class="sp-section-title" 최근 검색어 화이트 */
        [data-theme="dark"] .sp-section-title {
            color: #FFFFFF;
        }

        /* 8. id="savePasswordChange" 저장 컬러 31a3fa */
        [data-theme="dark"] #savePasswordChange {
            background: #31a3fa !important;
            border-color: #31a3fa !important;
            color: #FFFFFF !important;
        }

        /* 9. class="drawer-foot", 로그아웃버튼 위에 구분선 #E5E7EB를 99A4BE */
        [data-theme="dark"] .drawer-foot {
            border-top-color: #99A4BE !important;
        }

        /* 10. class="site-detail-content" 구분선 #E5E7EB를 99A4BE */
        [data-theme="dark"] .site-detail-content {
            border-top-color: #99A4BE !important;
        }

        /* 11. class="work-info-grid" 구분선 #E5E7EB를 99A4BE */
        [data-theme="dark"] .work-info-grid {
            border-top: none !important;
        }

        /* 12. contact-name 클릭시 컬러변화 없음 */
        .contact-name {
            transition: none !important;
        }
        .contact-name:active, .contact-name:focus, .contact-name:hover {
            color: inherit !important;
            background: inherit !important;
        }

        /* 13. update-btn과 detail-date 큰글씨 효과 적용 안함 */
        .update-btn, .detail-date {
            font-size: 16px !important;
        }
        .main-page-content.fs-150 .update-btn, .main-page-content.fs-150 .detail-date {
            font-size: 16px !important;
        }

        /* 14. siteSearchInput 큰글씨 효과 적용 안함 */
        .search-input-new {
            font-size: 16px !important;
            line-height: 1.4 !important;
            padding: 12px 16px !important;
        }
        #siteSearchInput {
            padding-left: 45px !important;
        }
        #siteSearchInput::placeholder {
            font-size: 16px !important;
        }
        .main-page-content.fs-150 .search-input-new {
            font-size: 16px !important;
            font-weight: 500 !important;
            padding: 0 16px 0 45px !important;
        }
        .main-page-content.fs-150 #siteSearchInput {
            padding-left: 45px !important;
        }
        .main-page-content.fs-150 #siteSearchInput::placeholder {
            font-size: 16px !important;
        }
        .main-page-content.fs-150 .search-input-new::placeholder {
            font-size: 16px !important;
        }

        /* 24. 다크모드 버튼컬러 #1A254F !important는 #0F3460로 변경 */
        [data-theme="dark"] .btn-primary {
            background: #0F3460 !important;
            color: #FFFFFF !important;
        }
        [data-theme="dark"] .btn-primary:hover {
            background: color-mix(in srgb, #0F3460 85%, white) !important;
        }
        [data-theme="dark"] .close-btn {
            background: #0F3460;
        }
        [data-theme="dark"] .close-btn:hover {
            background: color-mix(in srgb, #0F3460 85%, white);
        }

        /* 26. 다크모드 #4B5563 !important 버튼은 테두리 없음 */
        [data-theme="dark"] button.btn.btn-secondary#progressDrawingBtn {
            background: #4B5563 !important;
            border: none !important;
            color: #E5E7EB !important;
        }
        [data-theme="dark"] button.btn.btn-secondary#progressDrawingBtn:hover {
            background: #4B5563 !important;
            border: none !important;
        }

        /* 37. logout-btn 다크모드에서 0F3460로 변경 */
        [data-theme="dark"] .logout-btn {
            background: #0F3460 !important;
            border-color: #0F3460 !important;
            color: #FFFFFF !important;
        }
        [data-theme="dark"] .logout-btn:hover {
            background: color-mix(in srgb, #0F3460 85%, white) !important;
            border-color: color-mix(in srgb, #0F3460 85%, white) !important;
            color: #FFFFFF !important;
        }

        /* 38. progressDrawingBtn 다크모드에서만 컬러 #374151 폰트는 화이트 */
        [data-theme="dark"] .btn-secondary {
            background: #374151 !important;
            color: #E5E7EB !important;
            border-color: #4B5563 !important;
        }
        [data-theme="dark"] .btn-secondary:hover {
            background: #4B5563 !important;
            border-color: #6B7280 !important;
        }

        /* 다크모드에서 각 통계 카드의 라벨 컬러를 메인 컬러와 동일하게 */
        [data-theme="dark"] .stat-workdays .label {
            color: #99a4be;
        }

        [data-theme="dark"] .stat-sites .label {
            color: #31a3fa;
        }

        [data-theme="dark"] .stat-hours .label {
            color: #1A254F;
        }

        [data-theme="dark"] .stat-sites {
            color: #31a3fa;
            background: rgba(49, 163, 250, .05);
        }

        [data-theme="dark"] .stat-workdays {
            color: #99a4be;
            background: rgba(153, 164, 190, .05);
        }

        [data-theme="dark"] .stat-hours {
            color: #1A254F;
            background: rgba(26, 37, 79, .05);
        }

        [data-theme="dark"] .cell .work-hours {
            color: #31a3fa;
        }

        /* ===== 급여현황 탭 스타일 ===== */
        .payroll-container {
            max-width: 480px;
            margin: 0 auto !important;
            padding: 0 !important;
            height: auto !important;
            min-height: auto !important;
            overflow: visible !important;
            overflow-y: visible !important;
            overflow-x: hidden !important;
        }

        /* 급여현황탭 topBadges 상하 여백 완전 제거 및 가운데 정렬 */
        #payView .top-badges,
        #payView #topBadges {
            margin: 0 auto !important;
            padding: 0 !important;
            margin-right: 0 !important;
            padding-right: 0 !important;
            width: 100% !important;
            max-width: 100% !important;
            justify-content: center !important;
            display: flex !important;
            gap: 16px !important;
        }

        #payView .payroll-container {
            margin: 0 auto !important;
            padding: 0 !important;
        }

        .section-title {
            font-weight: 600;
            font-size: 20px;
            color: var(--ink);
            margin: 0 0 12px;
        }

        .card {
            background: var(--card);
            border: 1px solid var(--line);
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 18px;
            margin: 0 0 18px;
        }

        .row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #EEF2F7;
        }

        .row:last-child {
            border-bottom: 0 !important;
        }

        [data-theme="dark"] .row {
            border-bottom: 1px solid var(--line);
        }

        [data-theme="dark"] .row:last-child {
            border-bottom: 0 !important;
        }

        .left {
            font-size: 16px;
            font-weight: 500;
            color: #6B7280;
        }

        .right {
            font-size: 16px;
            font-weight: 600;
            color: #374151;
        }

        .right.primary {
            color: #31a3fa;
        }

        .top-badges {
            display: flex !important;
            gap: 16px !important;
            margin: 0 auto !important;
            padding: 0 !important;
            text-align: center !important;
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box !important;
            position: static !important;
            z-index: 10 !important;
            background: none !important;
            justify-content: center !important;
            border-bottom: none !important;
            padding: 0 !important;
        }

        .badge {
            width: 106px;
            border: 1px solid currentColor;
            border-radius: 12px;
            text-align: center;
            padding: 14px 0;
        }

        .badge .num {
            font-family: var(--font-sans);
            font-size: 22px;
            font-weight: 700; /* Bold */
            line-height: 1.4;
        }

        .badge .label {
            font-family: var(--font-sans);
            font-size: 14px;
            font-weight: 600; /* Semi-Bold */
            line-height: 1.4;
        }

        /* 급여현황탭 배지 컬러 - 출력현황탭 stats와 동일 */
        .badge:nth-child(1) {
            color: #99a4be;
            background: rgba(153, 164, 190, .05);
        }

        .badge:nth-child(2) {
            color: #31a3fa;
            background: rgba(49, 163, 250, .05);
        }

        .badge:nth-child(3) {
            color: #1A254F;
            background: rgba(26, 37, 79, .05);
        }

        .badge:nth-child(1) .label {
            color: #99a4be;
        }

        .badge:nth-child(2) .label {
            color: #31a3fa;
        }

        .badge:nth-child(3) .label {
            color: #1A254F;
        }

        [data-theme="dark"] .badge .label {
            color: var(--muted-ink);
        }

        /* 다크모드 급여현황탭 배지 컬러 - 출력현황탭 stats와 동일 */
        [data-theme="dark"] .badge:nth-child(1),
        [data-theme="dark"] .top-badges .badge:nth-child(1),
        [data-theme="dark"] #topBadges .badge:nth-child(1),
        [data-theme="dark"] #payView .badge:nth-child(1),
        [data-theme="dark"] #payView .top-badges .badge:nth-child(1),
        [data-theme="dark"] #payView #topBadges .badge:nth-child(1) {
            color: #99A4BE !important;
            background: rgba(153, 164, 190, .1) !important;
            border: 1px solid currentColor !important;
        }

        [data-theme="dark"] .badge:nth-child(2),
        [data-theme="dark"] .top-badges .badge:nth-child(2),
        [data-theme="dark"] #topBadges .badge:nth-child(2),
        [data-theme="dark"] #payView .badge:nth-child(2),
        [data-theme="dark"] #payView .top-badges .badge:nth-child(2),
        [data-theme="dark"] #payView #topBadges .badge:nth-child(2) {
            color: #63B3ED !important;
            background: rgba(99, 179, 237, .1) !important;
            border: 1px solid currentColor !important;
        }

        [data-theme="dark"] .badge:nth-child(3),
        [data-theme="dark"] .top-badges .badge:nth-child(3),
        [data-theme="dark"] #topBadges .badge:nth-child(3),
        [data-theme="dark"] #payView .badge:nth-child(3),
        [data-theme="dark"] #payView .top-badges .badge:nth-child(3),
        [data-theme="dark"] #payView #topBadges .badge:nth-child(3) {
            color: #FFFFFF !important;
            background: rgba(255, 255, 255, .1) !important;
            border: 1px solid currentColor !important;
        }

        [data-theme="dark"] .badge:nth-child(1) .label,
        [data-theme="dark"] .top-badges .badge:nth-child(1) .label,
        [data-theme="dark"] #topBadges .badge:nth-child(1) .label,
        [data-theme="dark"] #payView .badge:nth-child(1) .label,
        [data-theme="dark"] #payView .top-badges .badge:nth-child(1) .label,
        [data-theme="dark"] #payView #topBadges .badge:nth-child(1) .label {
            color: #99A4BE !important;
        }

        [data-theme="dark"] .badge:nth-child(2) .label,
        [data-theme="dark"] .top-badges .badge:nth-child(2) .label,
        [data-theme="dark"] #topBadges .badge:nth-child(2) .label,
        [data-theme="dark"] #payView .badge:nth-child(2) .label,
        [data-theme="dark"] #payView .top-badges .badge:nth-child(2) .label,
        [data-theme="dark"] #payView #topBadges .badge:nth-child(2) .label {
            color: #63B3ED !important;
        }

        [data-theme="dark"] .badge:nth-child(3) .label,
        [data-theme="dark"] .top-badges .badge:nth-child(3) .label,
        [data-theme="dark"] #topBadges .badge:nth-child(3) .label,
        [data-theme="dark"] #payView .badge:nth-child(3) .label,
        [data-theme="dark"] #payView .top-badges .badge:nth-child(3) .label,
        [data-theme="dark"] #payView #topBadges .badge:nth-child(3) .label {
            color: #FFFFFF !important;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        /* 급여현황탭 첫 번째 grid-2 하단 마진 16px */
        .payroll-container .grid-2:first-child {
            margin-bottom: 16px !important;
        }

        /* 급여현황탭 두 번째 grid-2 하단 마진 16px */
        .payroll-container .grid-2:nth-child(2) {
            margin-bottom: 16px !important;
        }

        /* sr-only 스타일 - 워크로그와 동일 */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* 급여현황탭 세율 직접입력 라벨 하단 마진 8px */
        .payroll-container #customRateField label {
            margin-bottom: 8px !important;
        }

        .field {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .field label {
            display: block;
            font-family: 'Noto Sans KR', system-ui, -apple-system, sans-serif;
            font-weight: 400; /* Regular */
            font-size: 16px;
            line-height: 1.4;
            color: #374151;
            padding-top: 0;
            padding-bottom: 0;
            margin: 0;
        }

        [data-theme="dark"] .field label {
            font-family: 'Noto Sans KR', system-ui, -apple-system, sans-serif;
            font-weight: 400; /* Regular */
            font-size: 16px;
            line-height: 1.4;
            color: #374151;
            padding-top: 0;
            padding-bottom: 0;
            margin: 0;
        }

        .input {
            width: 100%;
            height: 44px;
            border: 1px solid var(--line);
            border-radius: 8px;
            padding: 0 12px;
            background: var(--surface);
            font-family: 'Noto Sans KR', system-ui, -apple-system, sans-serif;
            font-weight: 600;
            font-size: 16px;
            line-height: 1.4;
            color: var(--ink);
            box-sizing: border-box;
        }

        .input::placeholder {
            color: #6B7280;
        }

        .input:focus {
            outline: none;
            border-color: #31a3fa;
            box-shadow: 0 0 0 3px rgba(49, 163, 250, 0.1);
        }

        [data-theme="dark"] .input:focus {
            border-color: #2F6BFF;
            box-shadow: 0 0 0 3px rgba(47, 107, 255, 0.1);
        }

        [data-theme="dark"] .input::placeholder {
            color: #6B7280;
        }

        .selected-site {
            height: 40px;
            padding: 10px 12px;
            border: 1px solid #E5E7EB;
            border-radius: 10px;
            background: #F9FAFB;
            font-size: 16px;
            font-weight: 600;
            color: #6B7280;
            display: flex;
            align-items: center;
        }

        [data-theme="dark"] .selected-site {
            background: #374151;
            border-color: #4B5563;
            color: #9CA3AF;
        }

        .chips {
            display: flex;
            gap: 8px;
            margin-top: 0;
        }

        .chip {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            height: 40px;
            padding: 8px 16px;
            border: 1px solid var(--line);
            border-radius: 8px;
            background: var(--card);
            color: var(--text);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: .12s;
            box-sizing: border-box;
            font-family: 'Noto Sans KR', system-ui, sans-serif;
            flex: 1;
        }

        .chip:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .chip[data-active="true"] {
            background: var(--tag-blue-20, rgba(0, 104, 254, 0.2));
            color: var(--tag-blue, #0068FE);
            border-color: var(--tag-blue, #0068FE);
        }

        [data-theme="dark"] .chip {
            background: var(--card, #111827);
            border-color: var(--line, #3A4048);
            color: var(--text, #E5E7EB);
        }

        [data-theme="dark"] .chip:hover {
            background: var(--card, #111827);
            border-color: var(--line, #3A4048);
        }

        [data-theme="dark"] .chip[data-active="true"] {
            background: rgba(0, 188, 212, 0.2) !important;
            color: #31a3fa !important;
            border-color: #31a3fa !important;
        }

        .payslip-buttons {
            display: flex;
            gap: 12px;
            justify-content: space-between;
            margin: 12px 0;
        }

        .btn {
            flex: 1;
            height: 40px;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: .2s;
            border: 1px solid #6B7280;
            background: #6B7280;
            color: #fff;
        }

        .btn:hover {
            background: #4B5563;
        }

        .btn.dark {
            background: #1A254F;
            border-color: #1A254F;
        }

        .btn.btn-outline {
            background: #fff;
            border: 1px solid #D1D5DB;
            color: #374151;
        }

        .btn.btn-outline:hover {
            background: #F3F4F6;
            border-color: #9CA3AF;
        }


        .panel {
            background: var(--card);
            border: 1px solid var(--line);
            border-radius: 14px;
            padding: 18px 4px;
            width: 100%;
            max-width: 100%;
            margin: 0 auto 16px auto;
            box-sizing: border-box;
            box-shadow: 0 2px 10px rgba(2, 6, 23, .04);
            font-family: 'Noto Sans KR', system-ui, -apple-system, sans-serif;
            font-weight: 600; /* Semi-Bold */
            font-size: 16px;
            line-height: 1.4;
        }

        .panel-h {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding-top: 18px;
            margin-bottom: 12px;
        }

        .panel-h .title {
            font-family: 'Noto Sans KR', system-ui, -apple-system, sans-serif;
            font-weight: 600; /* Semi-Bold */
            font-size: 20px;
            line-height: 1.4;
            color: #1A254F;
        }

        [data-theme="dark"] .panel-h .title {
            font-family: 'Noto Sans KR', system-ui, -apple-system, sans-serif;
            font-weight: 600; /* Semi-Bold */
            font-size: 20px;
            line-height: 1.4;
            color: #1A254F;
        }

        .small {
            font-family: 'Noto Sans KR', system-ui, -apple-system, sans-serif;
            font-weight: 400; /* Regular */
            font-size: 16px;
            color: #99A4BE;
            height: 32px;
            padding: 6px 10px;
            border-radius: 8px;
            border: 1px solid #D1D5DB;
            background: #fff;
            cursor: pointer;
        }

        /* 다크모드 패널 스타일 */
        [data-theme="dark"] .panel {
            font-family: 'Noto Sans KR', system-ui, -apple-system, sans-serif;
            font-weight: 600; /* Semi-Bold */
            font-size: 16px;
            line-height: 1.4;
            background: var(--card);
            border-color: var(--line);
        }







        /* 패널 스타일 */
        .panel {
            background: var(--card);
            border: 1px solid var(--line);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 12px;
            box-shadow: var(--shadow-card);
        }


        /* 급여현황탭 전용 formPanel 패딩 */
        .payroll-container #formPanel {
            height: auto !important;
            min-height: 46px !important;
            padding: 5px 18px 18px 18px !important;
            margin: 18px auto 0 auto !important;
            display: block !important;
            position: relative !important;
            width: 100% !important;
        }

        /* 급여현황탭 formPanel 내부 panel-h 스타일 - 강력한 적용 */
        #payView .payroll-container #formPanel .panel-h,
        #payView #formPanel .panel-h,
        .payroll-container #formPanel .panel-h {
            margin-bottom: 8px !important;
            height: 100% !important;
            display: flex !important;
            align-items: center !important;
            justify-content: space-between !important;
            gap: 0 !important;
            width: 100% !important;
        }

        /* 급여현황탭 formPanel 내부 title 스타일 - 강력한 적용 */
        #payView .payroll-container #formPanel .panel-h .title,
        #payView #formPanel .panel-h .title,
        .payroll-container #formPanel .panel-h .title {
            flex: 0 0 auto !important;
            margin: 0 !important;
        }

        /* 급여현황탭 formPanel 내부 toggleForm 버튼 스타일 - 강력한 적용 */
        #payView .payroll-container #formPanel .panel-h #toggleForm,
        #payView #formPanel .panel-h #toggleForm,
        .payroll-container #formPanel .panel-h #toggleForm {
            flex: 0 0 auto !important;
            margin-left: auto !important;
            margin-right: 0 !important;
            order: 2 !important;
        }

        /* 급여현황탭 formPanel 내부 title 스타일 - 강력한 적용 */
        #payView .payroll-container #formPanel .panel-h .title,
        #payView #formPanel .panel-h .title,
        .payroll-container #formPanel .panel-h .title {
            flex: 0 0 auto !important;
            margin: 0 !important;
            order: 1 !important;
        }

        /* 급여현황탭 formBody 접은 상태로 시작 */
        .payroll-container #formBody {
            display: none;
            position: relative !important;
            width: 100% !important;
            margin-top: 0 !important;
            padding-top: 0 !important;
        }

        /* 급여현황탭 formBody 열린 상태 */
        .payroll-container #formBody[style*="block"] {
            display: block !important;
            position: relative !important;
            width: 100% !important;
            margin-top: 0 !important;
            padding-top: 0 !important;
        }

        /* 급여현황탭 전용 요약카드 상단 패딩 18px - 강력한 적용 */
        .payroll-container .card,
        #payView .payroll-container .card,
        #payView .card,
        .payroll-container .card[style*="padding"],
        #payView .payroll-container .card[style*="padding"],
        #payView .card[style*="padding"],
        section#payView .payroll-container .card,
        section#payView .card,
        .payroll-container .card:not([style*="padding-top"]),
        #payView .payroll-container .card:not([style*="padding-top"]),
        #payView .card:not([style*="padding-top"]) {
            padding-top: 18px !important;
        }

        /* 급여현황탭 요약카드 상단 마진 18px - 강력한 적용 */
        .payroll-container .card,
        #payView .payroll-container .card,
        #payView .card,
        section#payView .payroll-container .card,
        section#payView .card {
            margin-top: 18px !important;
            margin-bottom: 18px !important;
        }

        /* 급여현황탭 요약카드 폰트 스타일 - [메인] 써머리그리드와 동일 */
        .payroll-container .left {
            font-size: 16px !important;
            font-weight: 500;
            color: #6B7280;
            font-family: "Noto Sans KR", sans-serif;
        }

        .payroll-container .right {
            font-size: 16px !important;
            font-weight: 600;
            color: #374151;
            font-family: "Noto Sans KR", sans-serif;
        }

        /* 급여현황탭 요약카드 primary 색상 변경 */
        .payroll-container .right.primary {
            color: #31a3fa;
        }

        /* 급여현황탭 전용 접기 버튼 스타일 */
        .payroll-container .small {
            font-family: 'Noto Sans KR', system-ui, -apple-system, sans-serif;
            font-weight: 400; /* Regular */
            font-size: 16px;
            color: #99A4BE;
        }

        /* toggleForm 버튼 특별 스타일 */
        #toggleForm,
        .payroll-container #toggleForm,
        #payView #toggleForm {
            padding: 0 !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            height: 32px !important;
            border-radius: 8px !important;
            border: none !important;
            background: transparent !important;
            cursor: pointer !important;
            transition: all 0.2s ease !important;
            margin-left: auto !important;
        }

        #toggleForm:hover {
            background: #F3F4F6 !important;
            border: none !important;
        }

        /* 급여현황탭 전용 버튼 스타일 - [메인] 액션버튼과 100% 동일 */
        .payroll-container .btn {
            height: 40px;
            padding: 8px 16px;
            border-radius: 8px;
            font-family: 'Noto Sans KR', system-ui, -apple-system, sans-serif;
            font-size: 16px;
            font-weight: 600;
            line-height: 1.4;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            box-sizing: border-box;
        }

        /* 급여현황탭 버튼 스타일 - [메인] 액션버튼과 100% 동일 */
        .payroll-container .btn-secondary {
            background: #F3F4F6;
            color: #374151;
            border: 1px solid #D1D5DB;
        }

        .payroll-container .btn-secondary:hover {
            background: #E5E7EB;
            border-color: #9CA3AF;
        }

        .payroll-container .btn-primary {
            background: #1A254F;
            color: #FFFFFF;
        }

        .payroll-container .btn-primary:hover {
            background: color-mix(in srgb, #1A254F 85%, white);
        }

        /* 다크모드 급여현황탭 버튼 - [메인] 액션버튼과 100% 동일 */
        [data-theme="dark"] .payroll-container .btn-secondary {
            background: #374151 !important;
            color: #E5E7EB !important;
            border-color: #4B5563 !important;
        }

        [data-theme="dark"] .payroll-container .btn-secondary:hover {
            background: #4B5563 !important;
            border-color: #6B7280 !important;
        }

        [data-theme="dark"] .payroll-container .btn-primary {
            background: #1A254F !important;
            color: #FFFFFF !important;
        }

        [data-theme="dark"] .payroll-container .btn-primary:hover {
            background: color-mix(in srgb, #1A254F 85%, white) !important;
        }

        /* 급여현황탭 전용 formPanel 패딩 - 다크모드 */
        [data-theme="dark"] .payroll-container #formPanel {
            height: auto !important;
            min-height: 46px !important;
            padding: 5px 18px 18px 18px !important;
            margin: 18px auto 0 auto !important;
            display: block !important;
            position: relative !important;
            width: 100% !important;
        }

        /* 급여현황탭 기본급 row 상단 패딩 0 */
        .payroll-container .card .row:first-child {
            padding-top: 0 !important;
        }

        /* 급여현황탭 실수령액 row 하단 패딩 0 */
        .payroll-container .card .row:last-child {
            padding-bottom: 0 !important;
        }


        /* 급여현황탭 급여명세서 버튼 컨테이너 스타일 */
        .payroll-container .payslip-buttons {
            margin-top: 18px !important; /* 상단 마진 18px로 변경 */
            margin-bottom: 0 !important;
            padding-top: 0 !important;
            padding-bottom: 0 !important;
        }

        /* 급여명세서 버튼 컨테이너 (payslip-buttons payslip-preview-container) 상단 마진 */
        .payslip-buttons.payslip-preview-container {
            margin-top: 18px !important; /* 상단 마진 18px 강제 적용 */
        }

        /* 급여현황탭 컨테이너 자연스러운 높이 */
        .payroll-container {
            height: auto;
            min-height: auto;
            overflow: visible;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
        }

        /* 급여현황탭 급여명세서 버튼 컨테이너 하단 여백 추가 */
        .payroll-container .payslip-buttons,
        #payView .payroll-container .payslip-buttons,
        #payView .payslip-buttons {
            margin-bottom: 0 !important;
        }

        /* 급여현황탭 반응형 너비 설정 */
        .payroll-container,
        .payroll-container #formPanel,
        .payroll-container .card,
        .payroll-container .payslip-buttons,
        #payView .payroll-container,
        #payView .payroll-container .card,
        #payView .card {
            max-width: 1200px !important;
            width: 100% !important;
            margin-left: auto !important;
            margin-right: auto !important;
            box-sizing: border-box !important;
        }

        /* 급여현황탭 반응형 미디어 쿼리 */
        @media (max-width: 1200px) {
            .payroll-container,
            .payroll-container #formPanel,
            .payroll-container .card,
            .payroll-container .payslip-buttons,
            #payView .payroll-container,
            #payView .payroll-container .card,
            #payView .card {
                max-width: 100% !important;
                padding-left: 18px !important;
                padding-right: 18px !important;
            }
        }

        @media (max-width: 768px) {
            .payroll-container,
            .payroll-container #formPanel,
            .payroll-container .card,
            .payroll-container .payslip-buttons,
            #payView .payroll-container,
            #payView .payroll-container .card,
            #payView .card {
                max-width: 100% !important;
                padding-left: 12px !important;
                padding-right: 12px !important;
            }
        }

        @media (max-width: 480px) {
            .payroll-container,
            .payroll-container #formPanel,
            .payroll-container .card,
            .payroll-container .payslip-buttons,
            #payView .payroll-container,
            #payView .payroll-container .card,
            #payView .card {
                max-width: 100% !important;
                padding-left: 8px !important;
                padding-right: 8px !important;
            }
        }

        /* 출력현황탭 하단 여백 추가 */
        #workView .work-stats,
        .tab-content:not(#payView) .work-stats {
            margin-bottom: 50px !important;
        }

        /* 급여현황탭 formPanel 내부 panel-h 스타일 - 다크모드 강력한 적용 */
        [data-theme="dark"] #payView .payroll-container #formPanel .panel-h,
        [data-theme="dark"] #payView #formPanel .panel-h,
        [data-theme="dark"] .payroll-container #formPanel .panel-h {
            margin-bottom: 8px !important;
            height: 100% !important;
            display: flex !important;
            align-items: center !important;
            justify-content: space-between !important;
            gap: 0 !important;
            width: 100% !important;
        }

        /* 급여현황탭 formPanel 내부 title 스타일 - 다크모드 강력한 적용 */
        [data-theme="dark"] #payView .payroll-container #formPanel .panel-h .title,
        [data-theme="dark"] #payView #formPanel .panel-h .title,
        [data-theme="dark"] .payroll-container #formPanel .panel-h .title {
            flex: 0 0 auto !important;
            margin: 0 !important;
        }

        /* 급여현황탭 formPanel 내부 toggleForm 버튼 스타일 - 다크모드 강력한 적용 */
        [data-theme="dark"] #payView .payroll-container #formPanel .panel-h #toggleForm,
        [data-theme="dark"] #payView #formPanel .panel-h #toggleForm,
        [data-theme="dark"] .payroll-container #formPanel .panel-h #toggleForm {
            flex: 0 0 auto !important;
            margin-left: auto !important;
            margin-right: 0 !important;
            order: 2 !important;
        }

        /* 급여현황탭 formPanel 내부 title 스타일 - 다크모드 강력한 적용 */
        [data-theme="dark"] #payView .payroll-container #formPanel .panel-h .title,
        [data-theme="dark"] #payView #formPanel .panel-h .title,
        [data-theme="dark"] .payroll-container #formPanel .panel-h .title {
            flex: 0 0 auto !important;
            margin: 0 !important;
            order: 1 !important;
        }

        /* 급여현황탭 전용 요약카드 상단 패딩 18px - 다크모드 강력한 적용 */
        [data-theme="dark"] .payroll-container .card,
        [data-theme="dark"] #payView .payroll-container .card,
        [data-theme="dark"] #payView .card,
        [data-theme="dark"] section#payView .payroll-container .card,
        [data-theme="dark"] section#payView .card {
            padding-top: 18px !important;
        }

        /* 급여현황탭 요약카드 상단 마진 18px - 다크모드 강력한 적용 */
        [data-theme="dark"] .payroll-container .card,
        [data-theme="dark"] #payView .payroll-container .card,
        [data-theme="dark"] #payView .card,
        [data-theme="dark"] section#payView .payroll-container .card,
        [data-theme="dark"] section#payView .card {
            margin-top: 18px !important;
            margin-bottom: 18px !important;
        }

        /* 급여현황탭 전용 접기 버튼 스타일 - 다크모드 */
        [data-theme="dark"] .payroll-container .small {
            font-family: 'Noto Sans KR', system-ui, -apple-system, sans-serif;
            font-weight: 400; /* Regular */
            font-size: 16px;
            color: #99A4BE;
        }

        /* toggleForm 버튼 다크모드 스타일 */
        [data-theme="dark"] #toggleForm,
        [data-theme="dark"] .payroll-container #toggleForm,
        [data-theme="dark"] #payView #toggleForm {
            background: transparent !important;
            border: none !important;
            color: #E5E7EB !important;
            margin-left: auto !important;
        }

        [data-theme="dark"] #toggleForm:hover,
        [data-theme="dark"] .payroll-container #toggleForm:hover,
        [data-theme="dark"] #payView #toggleForm:hover {
            background: #4B5563 !important;
            border: none !important;
        }

        /* 급여현황탭 요약카드 폰트 스타일 - 다크모드 */
        [data-theme="dark"] .payroll-container .left {
            color: #9CA3AF;
            font-family: "Noto Sans KR", sans-serif;
        }

        [data-theme="dark"] .payroll-container .right {
            color: #E5E7EB;
            font-family: "Noto Sans KR", sans-serif;
        }

        /* 급여현황탭 요약카드 primary 색상 변경 - 다크모드 */
        [data-theme="dark"] .payroll-container .right.primary {
            color: #31a3fa;
        }

        /* 급여현황탭 요약카드 특정 항목 색상 변경 */
        .payroll-container #rowPresent,
        .payroll-container #rowOff,
        .payroll-container #rowIncomeTax,
        .payroll-container #rowLocalTax {
            color: #99A4BE !important;
        }

        .payroll-container #rowUnits {
            color: #374151 !important;
        }

        [data-theme="dark"] .payroll-container #rowPresent,
        [data-theme="dark"] .payroll-container #rowOff,
        [data-theme="dark"] .payroll-container #rowIncomeTax,
        [data-theme="dark"] .payroll-container #rowLocalTax {
            color: #99A4BE !important;
        }

        [data-theme="dark"] .payroll-container #rowUnits {
            color: #374151 !important;
        }

        /* ===== 급여명세서 버튼 스타일 (form-actions와 동일) ===== */
        .payslip-buttons {
            display: flex;
            gap: 12px;
            justify-content: space-between;
            margin: 18px auto 12px auto !important; /* 상단 마진 18px로 변경 */
            padding: 0 4px !important;
            border: none !important;
            background: none !important;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }

        .payslip-buttons .btn {
            flex: 1 1 0 !important;
            min-width: 0 !important;
            max-width: none !important;
            width: 100% !important;
            height: 40px;
            padding: 8px 16px;
            border-radius: 8px;
            font-family: 'Noto Sans KR', system-ui, -apple-system, sans-serif;
            font-size: 16px;
            font-weight: 600;
            line-height: 1.4;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid #6B7280;
            background: #6B7280;
            color: #FFFFFF;
        }

        .payslip-buttons .btn:hover {
            background: #4B5563;
        }

        .payslip-buttons .btn.dark {
            background: #1A254F;
            color: #FFFFFF;
            border-color: #1A254F;
        }

        .payslip-buttons .btn.dark:hover {
            background: #0F1A3A;
        }

        /* 급여명세서 버튼 아웃라인 스타일 */
        .payslip-buttons .btn.btn-outline {
            background: #FFFFFF !important;
            border: 1px solid #D1D5DB !important;
            color: #374151 !important;
        }

        .payslip-buttons .btn.btn-outline:hover {
            background: #F3F4F6 !important;
            border-color: #9CA3AF !important;
        }

        /* 다크모드 급여명세서 버튼 */
        [data-theme="dark"] .payslip-buttons {
            border: none !important;
            margin-top: 0 !important;
            padding-top: 0 !important;
        }

        /* 급여현황 탭에서 payslip-buttons 하단 마진 */
        #payView .payslip-buttons {
            margin-bottom: 12px !important;
        }

        /* 급여현황 탭에서 main-content-wrapper 하단 마진 */
        #payView .main-content-wrapper {
            margin-bottom: 12px !important;
        }

        /* 급여현황 탭에서 main-content 하단 패딩 조정 */
        #payView .main-content {
            padding-bottom: 0px !important; /* 하단 패딩 0으로 설정 */
            margin-bottom: 12px !important; /* 하단 마진 12px 설정 */
        }

        /* 급여현황 탭에서 payslip-preview-container 잘림 방지 */
        #payView .payslip-preview-container {
            margin-bottom: 0 !important; /* 하단 마진 0 강제 적용 */
            overflow: visible !important; /* 오버플로우 허용 */
            position: relative !important; /* 위치 지정 */
            z-index: 10 !important; /* 다른 요소들 위에 표시 */
        }

        /* 다크모드 급여명세서 버튼 아웃라인 스타일 */
        [data-theme="dark"] .payslip-buttons .btn.btn-outline {
            background: #374151 !important;
            border-color: #4B5563 !important;
            color: #E5E7EB !important;
        }

        [data-theme="dark"] .payslip-buttons .btn.btn-outline:hover {
            background: #4B5563 !important;
            border-color: #6B7280 !important;
        }

        /* 급여현황 탭 모바일 대응 */
        @media (max-width: 768px) {
            .payroll-container {
                padding: 0 0 0 0; /* 상단 패딩 0, 좌우 패딩 0, 하단 패딩 0 */
                margin: 0 auto 0 auto;
                height: 550px;
            }
        }

        @media (max-width: 480px) {
            .payroll-container {
                padding: 0 0 0 0; /* 상단 패딩 0, 좌우 패딩 0, 하단 패딩 0 */
                margin: 0 auto 0 auto;
                height: 550px;
            }
        }

        /* 반응형 캘린더 가로폭 */
        @media (max-width: 768px) {
            .cal-wrap {
                width: 100%;
                max-width: 100%;
                margin: 18px 0 0 0;
                padding: 16px;
            }
        }

        @media (max-width: 480px) {
            .cal-wrap {
                width: 100%;
                max-width: 100%;
                margin: 18px 0 0 0;
                padding: 12px;
            }
        }

        @media (min-width: 1200px) {
            .cal-wrap {
                width: 100%;
                max-width: 100%;
                margin: 18px 0 0 0;
                padding: 18px;
            }
        }

        /* 반응형 통계 섹션 */
        @media (max-width: 768px) {
            .stats {
                width: 100% !important;
                max-width: 1200px !important;
                margin: 0 auto !important;
                padding: 18px 8px 0 8px !important;
                gap: 12px !important;
                justify-content: space-between !important;
            }
            .stat {
                flex: 1 !important;
                min-width: 90px !important;
                padding: 12px 6px !important;
            }
        }

        @media (max-width: 480px) {
            .stats {
                width: 100% !important;
                max-width: 1200px !important;
                margin: 0 auto !important;
                padding: 18px 4px 0 4px !important;
                gap: 8px !important;
                justify-content: space-between !important;
            }
            .stat {
                flex: 1 !important;
                min-width: 80px !important;
                padding: 10px 4px !important;
            }
        }

        /* 다크모드 현장/년월일 선택 스타일 */
        [data-theme="dark"] .site-filter-section {
            background: none;
            border-bottom: none;
        }

        [data-theme="dark"] .select-shell .box {
            background: var(--surface);
            border-color: var(--line);
            color: var(--ink);
        }

        /* ===== 빠른메뉴 및 공지사항 스타일 ===== */
        
        /* 공통 섹션 */
        .section {
            margin-bottom: 24px !important;
            padding-top: 0 !important;
            padding-bottom: 0 !important;
        }

        /* 카드 스타일 */
        .card {
            background: var(--surface);
            border: 1px solid var(--line);
            border-radius: 12px;
            padding: 18px !important;
            box-shadow: 0 2px 10px rgba(2,6,23,.04);
            margin-bottom: 12px !important;
            overflow: hidden;
        }

        [data-theme="dark"] .card {
            border-color: var(--line) !important;
        }

        /* 섹션 타이틀 */
        .section-title {
            font-family: "Noto Sans KR", system-ui, sans-serif;
            font-weight: 600;
            font-size: 20px !important;
            line-height: 1.4;
            color: var(--ink);
        }

        [data-theme="dark"] .section-title {
            color: var(--ink);
        }

        /* 빠른메뉴 그리드 */
        #quick-menu.quick-grid {
            display: grid !important;
            grid-template-columns: repeat(6, minmax(0, 1fr)) !important;
            gap: 1px !important;
            margin: 0 !important;
            margin-bottom: 0 !important;
            padding: 0 !important;
            list-style: none !important;
            justify-items: center !important;
            align-items: start !important;
        }

        /* 빠른메뉴 아이템 */
        #quick-menu .quick-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1px;
            width: 100%;
            text-decoration: none;
            color: inherit;
            border-radius: 10px;
            transition: all 0.2s ease;
            padding: 4px;
        }

        /* 빠른메뉴 아이콘 - 하단네비게이터와 동일한 호버 효과 (컬러 변경 없음) */
        #quick-menu .quick-item {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform-origin: center;
        }

        /* 하단네비게이터와 동일한 호버 효과 */
        #quick-menu .quick-item:is(:hover, :active, :focus-visible),
        #quick-menu .quick-item.pressed {
            transform: translateY(-2px) scale(1.05);
        }

        #quick-menu .quick-item:is(:hover, :active, :focus-visible) img,
        #quick-menu .quick-item:is(:hover, :active, :focus-visible) span,
        #quick-menu .quick-item.pressed img,
        #quick-menu .quick-item.pressed span {
            transform: scale(1.05);
        }

        /* 빠른메뉴 아이콘 크기 */
        #quick-menu .quick-item img {
            width: 46px !important;
            height: 46px !important;
            object-fit: contain !important;
            display: block !important;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 10px;
        }


        /* 이미지 로딩 실패 시 대체 아이콘 표시 */
        #quick-menu .quick-item img:not([src]),
        #quick-menu .quick-item img[src=""],
        #quick-menu .quick-item img[src*="error"] {
            background: #f8f9fa url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgMCA0OCA0OCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjQ4IiBoZWlnaHQ9IjQ4IiByeD0iOCIgZmlsbD0iI0Y4RjlGQSIvPgo8cGF0aCBkPSJNMjQgMTJMMzYgMjRMMjQgMzZMMTIgMjRMMjQgMTJaIiBmaWxsPSIjOUNBQUFGIi8+CjxwYXRoIGQ9Ik0yNCAyMEwyOCAyNEwyNCAyOEwyMCAyNEwyNCAyMFoiIGZpbGw9IiNGRkZGRkYiLz4KPC9zdmc+') no-repeat center;
            background-size: 24px 24px;
        }

        /* 작업일지 폼 스타일 - 강제 적용 */
        .work-form-container {
            background: var(--card);
            border: 1px solid #E6ECF4;
            border-radius: 10px;
            padding: 18px; /* 상하좌우 18px */
            box-shadow: 0 2px 10px rgba(2,6,23,.04);
            margin: 18px 0 0 0 !important; /* 상단 18px, 하단 0px */
            /* 강제 적용을 위한 추가 속성 */
            box-sizing: border-box;
        }

        /* 큰글씨 모드에서 work-form-container 패딩 조정 */
        .main-page-content.fs-150 .work-form-container {
            padding: 18px !important; /* 상하좌우 18px */
        }

        /* 큰글씨 모드에서 form-section 패딩 조정 */
        .main-page-content.fs-150 .form-section {
            margin-bottom: 12px !important;
            padding-bottom: 0 !important;
        }

        /* 큰글씨 모드에서 form-section 헤더 간격 조정 */
        .main-page-content.fs-150 .form-section .section-header {
            margin-bottom: 8px !important;
        }

        /* 큰글씨 모드에서 form-group 마진 조정 */
        .main-page-content.fs-150 .form-section .form-group {
            margin-bottom: 18px !important;
        }

        [data-theme="dark"] .work-form-container {
            border-color: var(--line) !important;
        }

        [data-theme="dark"] .notice-card {
            border-color: var(--line) !important;
        }

        .form-section {
            margin-bottom: 12px !important;
            padding-bottom: 0 !important;
            border-bottom: 1px solid #F3F4F6;
            overflow: visible !important;
            position: relative !important;
            z-index: 1 !important;
        }
        
        /* 작업구간 섹션 내부 간격 조정 */
        .form-section .form-group {
            margin-bottom: 16px;
        }
        
        /* 블럭/동/호수 폼그룹 마진 제거 */
        .block-dong-ho-group {
            margin-bottom: 0 !important;
        }
        
        /* 작성자, 공수 폼-로우 높이 조정 */
        .author-manpower-row {
            height: auto !important;
            min-height: 40px !important;
        }
        
        
        /* 작업구간 섹션 마진 복원 (카드섹션 표시) */
        .work-section {
            margin-bottom: 12px !important;
            padding-bottom: 0 !important;
            border-bottom: 1px solid #F3F4F6 !important;
        }
        
        /* 공수(일) 섹션 아래 마진 16px */
        .manpower-section {
            margin-bottom: 12px !important;
            padding-bottom: 0 !important;
            border-bottom: 1px solid #F3F4F6 !important;
        }
        
        /* 작업구간 섹션과 액션 버튼 사이의 간격 제거 */
        .form-section:last-of-type {
            margin-bottom: 0 !important;
            padding-bottom: 0 !important;
            border-bottom: none !important;
        }

        .form-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        /* 기존 도면 섹션 스타일은 위의 새로운 스타일로 대체됨 */

        #summary-section {
            margin-bottom: 0 !important;
            padding-bottom: 0 !important;
        }

        #summary-section .work-form-container {
            margin-bottom: 0 !important;
        }

        #summary-section         .form-section {
            margin-bottom: 12px !important;
            padding-bottom: 0 !important;
            border-bottom: 1px solid #F3F4F6;
        }

        #summary-section .form-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        [data-theme="dark"] #summary-section .form-section {
            border-bottom-color: #374151;
        }

        [data-theme="dark"] .form-section {
            border-bottom-color: #374151;
        }
        
        [data-theme="dark"] .work-section {
            border-bottom-color: #374151 !important;
        }
        
        [data-theme="dark"] .manpower-section {
            border-bottom-color: #374151 !important;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 0 0 8px 0;
            padding: 0 0 0 0;
        }
        
        /* 작업구간 섹션 헤더 간격 조정 */
        .form-section .section-header {
            margin-bottom: 8px;
        }
        
        /* 공수(일) 섹션헤더 마진 조정 */
        .form-group .section-title {
            margin-bottom: 16px;
        }
        
        /* 빠른메뉴 섹션 헤더만 좌측 정렬 */
        #home-quick .section-header {
            justify-content: flex-start;
            gap: 8px;
            margin: 0 0 0 0 !important;
            height: 42px;
        }
        
        /* 빠른메뉴 섹션 타이틀 마진 */
        #home-quick .section-title {
            margin: 12px 0;
            margin-left: -5px;
        }

        .section-title {
            font-family: "Noto Sans KR", system-ui, sans-serif;
            font-weight: 600;
            font-size: 20px;
            line-height: 1.4;
            color: #1A254F;
            margin: 0;
        }

        [data-theme="dark"] .section-title {
            color: #E5E7EB;
        }

        [data-theme="dark"] .required {
            color: #EF4444 !important;
        }

        [data-theme="dark"] .author-info {
            color: #31a3fa !important;
        }

        [data-theme="dark"] .form-note {
            color: #31a3fa !important;
        }

        [data-theme="dark"] .form-note .required {
            color: #EF4444 !important;
        }

        .required {
            color: #EF4444;
            font-weight: 700;
            font-size: 14px;
        }

        .form-note {
            font-size: 16px;
            color: #31a3fa;
            font-weight: 600;
        }

        .author-info {
            font-size: 16px;
            color: #31a3fa !important;
            font-weight: 500;
        }


        .add-btn {
            height: 32px;
            background: rgba(153, 164, 190, 0.15);
            border: 1.5px solid #99a4be;
            border-radius: 16px;
            padding: 8px 16px;
            font-size: 16px;
            font-weight: 500;
            color: #99a4be;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 60px;
        }

        .add-btn:hover {
            background: rgba(153, 164, 190, 0.25);
            border-color: #99a4be;
            color: rgba(153, 164, 190, 0.9);
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }


        [data-theme="dark"] .add-btn {
            background: rgba(153, 164, 190, 0.15) !important;
            border-color: #99a4be !important;
            color: #99a4be !important;
        }

        [data-theme="dark"] .add-btn:hover {
            background: rgba(153, 164, 190, 0.25) !important;
            border-color: #99a4be !important;
            color: #99a4be !important;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        /* addWorkContentBtn 특별 스타일 */
        #addWorkContentBtn {
            background: rgba(153, 164, 190, 0.15) !important;
            border: 1.5px solid #99a4be !important;
            color: #99a4be !important;
        }

        #addWorkContentBtn:hover {
            background: rgba(153, 164, 190, 0.25) !important;
            border-color: #99a4be !important;
            color: rgba(153, 164, 190, 0.9) !important;
        }

        [data-theme="dark"] #addWorkContentBtn {
            background: rgba(153, 164, 190, 0.15) !important;
            border-color: #99a4be !important;
            color: #99a4be !important;
        }

        [data-theme="dark"] #addWorkContentBtn:hover {
            background: rgba(153, 164, 190, 0.25) !important;
            border-color: #99a4be !important;
            color: #99a4be !important;
        }

        .form-row {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
            text-align: center;
        }

        .form-row .form-group {
            flex: 1 !important;
            min-width: 0 !important;
        }

        /* 작성 정보 입력 폼 박스 가로너비 꼭 맞춤 */
        .form-section .form-row .form-group {
            flex: 1 !important; /* 모든 박스가 가로너비에 꼭 맞춤 */
            width: 100% !important;
        }

        /* 작업일자 박스는 가로너비에 딱 맞춤 */
        .form-section .form-row:first-child .form-group .date-input-wrapper {
            width: 100% !important;
            max-width: 100% !important;
        }

        /* 작업일자 폼-로우 마진 0px */
        .form-section .form-row:first-child {
            margin-bottom: 0px !important;
        }

        /* 워크데이터폼 마진 0px */
        .work-data-form-row {
            margin-bottom: 0px !important;
        }

        /* 워크데이터폼 행 스타일 */
        .work-data-form-row {
            display: flex !important;
            gap: 16px !important;
            align-items: flex-end !important;
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box !important;
            margin-bottom: 0px !important;
        }

        .work-data-form-row .form-group {
            flex: 1 !important;
            min-width: 0 !important;
            max-width: 100% !important;
        }

        /* 년-월-일 폰트 크기 16px */
        .work-data-form-row .date-input-wrapper .form-input {
            font-size: 16px !important;
        }

        /* 헤더 액션 버튼들 스타일 */
        .header-actions {
            display: flex !important;
            gap: 8px !important;
            align-items: center !important;
        }

        /* 추가된 섹션들의 가로폭을 카드박스에 딱 맞춤 */
        .additional-work-row {
            width: 100% !important;
            max-width: 100% !important;
            margin-bottom: 12px !important;
            padding: 12px !important;
            border: 1px solid #E5E7EB !important;
            border-radius: 12px !important;
            background: var(--card) !important;
            box-sizing: border-box !important;
            overflow: hidden !important;
            word-wrap: break-word !important;
            overflow-wrap: break-word !important;
        }

        .additional-manpower-section {
            width: 100% !important;
            max-width: 100% !important;
            margin-bottom: 12px !important;
            padding: 8px !important;
            border: 1px solid #E5E7EB !important;
            border-radius: 12px !important;
            background: var(--card) !important;
            box-sizing: border-box !important;
            overflow: hidden !important;
            word-wrap: break-word !important;
            overflow-wrap: break-word !important;
        }

        [data-theme="dark"] .additional-work-row,
        [data-theme="dark"] .additional-manpower-section {
            border-color: #374151 !important;
            background: var(--card) !important;
        }

        /* 추가된 섹션 내부 form-row 가로폭 조정 */
        .additional-work-row .form-row,
        .additional-manpower-section .form-row {
            width: 100% !important;
            max-width: 100% !important;
            margin-bottom: 0 !important;
            box-sizing: border-box !important;
            overflow: hidden !important;
            word-wrap: break-word !important;
            overflow-wrap: break-word !important;
        }

        .additional-work-row .form-group,
        .additional-manpower-section .form-group {
            flex: 1 !important;
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box !important;
            overflow: hidden !important;
            word-wrap: break-word !important;
            overflow-wrap: break-word !important;
        }

        .form-row:last-child {
            margin-bottom: 0;
        }

        .form-group {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .form-label {
            font-family: "Noto Sans KR", system-ui, sans-serif !important;
            font-size: 16px !important;
            font-weight: 400 !important;
            color: #374151 !important;
            margin-bottom: 8px !important;
        }

        [data-theme="dark"] .form-label {
            color: #D1D5DB !important;
            background: transparent !important;
        }

        .form-select {
            width: 100% !important;
            height: 40px !important;
            padding: 0 16px !important;
            border: 1px solid #D1D5DB !important;
            border-radius: 10px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            background: #FFFFFF !important;
            font-family: "Noto Sans KR", system-ui, sans-serif !important;
            font-size: 16px !important;
            font-weight: 600 !important;
            color: #374151 !important;
            line-height: 1.4 !important;
            cursor: pointer !important;
            transition: all 0.2s ease !important;
            appearance: none !important;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%236B7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e") !important;
            background-repeat: no-repeat !important;
            background-position: right 15px center !important;
            background-size: 16px !important;
            padding-right: 40px !important;
            position: relative !important;
            z-index: 10 !important;
            line-height: 1.4 !important;
            box-sizing: border-box !important;
        }

        .form-select:hover {
            border-color: var(--brand, #2F6BFF);
        }

        .form-select:focus {
            outline: none;
            border-color: var(--brand, #2F6BFF);
            box-shadow: 0 0 0 3px rgba(47, 107, 255, 0.1);
        }

        [data-theme="dark"] .form-select {
            background: #374151 !important;
            border-color: #4B5563 !important;
            color: #FFFFFF !important;
        }

        [data-theme="dark"] .form-select option {
            background: #374151 !important;
            color: #FFFFFF !important;
        }

        .form-input {
            width: 100% !important;
            height: 40px !important;
            padding: 0 16px !important;
            border: 1px solid #D1D5DB !important;
            border-radius: 8px !important;
            background: #FFFFFF !important;
            font-family: "Noto Sans KR", system-ui, sans-serif !important;
            font-size: 16px !important;
            margin-bottom: 0 !important;
            font-weight: 600 !important;
            color: #374151 !important;
            transition: all 0.2s ease !important;
        }

        /* 날짜 입력 필드 전용 스타일 - 브라우저 기본 아이콘 숨김 */
        .form-input[type="date"] {
            width: 149px !important;
            height: 40px !important;
            padding: 0 16px !important;
            padding-right: 40px !important;
            background-image: none !important;
            -webkit-appearance: none !important;
            -moz-appearance: none !important;
            appearance: none !important;
            font-weight: 600 !important;
            margin-bottom: 0 !important;
        }

        /* WebKit 브라우저 (Chrome, Safari)에서 날짜 아이콘 숨김 */
        .form-input[type="date"]::-webkit-calendar-picker-indicator {
            display: none;
            -webkit-appearance: none;
        }

        /* Firefox에서 날짜 아이콘 숨김 */
        .form-input[type="date"]::-moz-calendar-picker-indicator {
            display: none;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--brand, #2F6BFF);
            box-shadow: 0 0 0 3px rgba(47, 107, 255, 0.1);
        }

        [data-theme="dark"] .form-input {
            background: #374151 !important;
            border-color: #4B5563 !important;
            color: #E5E7EB !important;
        }

        /* 모든 form-input이 600 Semi-Bold로 통일됨 */

        /* 작성자 관련 요소 컬러 */
        .form-label:has(+ input#author),
        #author {
            color: #374151 !important;
        }

        /* 다크모드에서 작성자 폰트 컬러를 공수와 동일하게 */
        [data-theme="dark"] .form-label:has(+ input#author),
        [data-theme="dark"] #author,
        [data-theme="dark"] .author-select {
            color: #E5E7EB !important;
        }

        /* 블럭, 동, 호수 입력 필드 가운데 정렬 */
        #block, #building, #unit {
            text-align: center !important;
        }

        /* 선택된 현장 표시 스타일 */
        #selectedSiteDisplay {
            position: relative;
            cursor: default;
            background: #F9FAFB !important;
            color: #6B7280 !important;
            border: 1px solid #E5E7EB !important;
            width: 100% !important;
            max-width: 100% !important;
        }

        [data-theme="dark"] #selectedSiteDisplay {
            background: #374151 !important;
            color: #9CA3AF !important;
            border-color: #4B5563 !important;
        }

        #selectedSiteDisplay:hover::after {
            content: attr(title);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 16px !important;
            white-space: nowrap;
            z-index: 1000;
            pointer-events: none;
            margin-bottom: 5px;
        }

        #selectedSiteDisplay:hover::before {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent;
            border-top-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            pointer-events: none;
            margin-bottom: -5px;
        }

        .date-input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .date-input-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
            max-width: 100%;
        }
        
        /* 반응형 가로너비 맞춤 */
        @media (max-width: 768px) {
            .date-input-wrapper {
                width: 100%;
                max-width: 100%;
            }
            
            /* 모바일에서 요약 데이터 한글 폰트 강제 적용 */
            .summary-label,
            .summary-value,
            .summary-item {
                font-family: "Noto Sans KR", sans-serif !important;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }
        }

        .date-input-wrapper .form-input {
            padding: 0 16px !important;
            padding-right: 40px; /* 캘린더 아이콘을 위한 공간 확보 */
            font-size: 16px; /* 날짜만 폰트 크기 16px로 조정 */
            width: 100% !important;
            cursor: pointer; /* 클릭 가능함을 표시 */
            margin-bottom: 0 !important;
        }

        .date-input-wrapper .form-input:hover {
            border-color: #31a3fa; /* 호버 시 테두리 색상 변경 */
        }

        /* 브라우저 기본 날짜 선택기 아이콘 숨기기 */
        .date-input-wrapper .form-input::-webkit-calendar-picker-indicator {
            display: none;
            -webkit-appearance: none;
        }

        .date-input-wrapper .form-input::-moz-calendar-picker-indicator {
            display: none;
        }

        .calendar-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            width: 18px;
            height: 18px;
            pointer-events: auto;
            cursor: pointer;
            z-index: 10;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%236B7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3crect x='3' y='4' width='18' height='18' rx='2' ry='2'%3e%3c/rect%3e%3cline x1='16' y1='2' x2='16' y2='6'%3e%3c/line%3e%3cline x1='8' y1='2' x2='8' y2='6'%3e%3c/line%3e%3cline x1='3' y1='10' x2='21' y2='10'%3e%3c/line%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: center;
            background-size: contain;
            transition: all 0.2s ease;
        }

        .calendar-icon:hover {
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%233B82F6' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3crect x='3' y='4' width='18' height='18' rx='2' ry='2'%3e%3c/rect%3e%3cline x1='16' y1='2' x2='16' y2='6'%3e%3c/line%3e%3cline x1='8' y1='2' x2='8' y2='6'%3e%3c/line%3e%3cline x1='3' y1='10' x2='21' y2='10'%3e%3c/line%3e%3c/svg%3e");
            background-position: center;
            background-size: 16px;
        }

        .selected-site {
            height: 40px !important;
            padding: 10px 12px !important;
            border: 1px solid #D1D5DB !important;
            border-radius: 10px !important;
            background: #F9FAFB !important;
            font-size: 16px !important;
            font-weight: 600 !important;
            color: #6B7280 !important;
            display: flex !important;
            align-items: center !important;
        }

        [data-theme="dark"] .selected-site {
            background: #374151 !important;
            border-color: #4B5563 !important;
            color: #9CA3AF !important;
        }

        .button-group {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            width: 100%;
        }

        .option-btn {
            display: inline-flex;
            align-items: center;
            height: 40px;
            padding: 8px 16px;
            gap: 8px;
            border: 1px solid var(--line, #E6ECF4);
            border-radius: 8px; /* ino.css style */
            background: var(--card, #FFFFFF);
            color: var(--text, #1A1A1A);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.12s ease;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            flex: 1;
            min-width: 0;
            justify-content: center;
            position: relative;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        .option-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .option-btn.active {
            background: var(--tag-blue-20, rgba(49, 163, 250, 0.2));
            color: var(--tag-blue, #31a3fa);
            border-color: var(--tag-blue, #31a3fa);
        }

        [data-theme="dark"] .option-btn {
            background: var(--card, #111827);
            border-color: var(--line, #3A4048);
            color: var(--text, #E5E7EB);
        }

        [data-theme="dark"] .option-btn:hover {
            background: var(--card, #111827);
            border-color: var(--line, #3A4048);
        }

        [data-theme="dark"] .option-btn.active {
            background: rgba(0, 188, 212, 0.2) !important;
            color: #31a3fa !important;
            border-color: #31a3fa !important;
        }

        .number-input {
            display: flex;
            align-items: center;
            border: 1px solid #D1D5DB;
            border-radius: 10px;
            background: #FFFFFF;
            overflow: hidden;
            width: 100% !important;
            height: 40px !important;
            justify-content: space-between;
        }
        
        /* 공수입력컨트롤박스와 작성자 입력박스 높이 통일 */
        .author-manpower-row .number-input {
            height: 40px !important;
        }
        
        .author-manpower-row .form-input {
            height: 40px !important;
        }

        /* 추가태그 행 스타일 */
        .additional-work-row {
            margin-top: 16px;
            margin-bottom: 16px;
            padding: 12px;
            border: 1px solid #E5E7EB;
            border-radius: 10px;
            background: #F9FAFB;
            position: relative;
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box !important;
            overflow: hidden !important;
            word-wrap: break-word !important;
            overflow-wrap: break-word !important;
        }

        [data-theme="dark"] .additional-work-row {
            background: #1F2937;
            border-color: #374151;
        }

        .additional-work-row .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 0 0 8px 0;
            padding: 0 0 0 0;
        }

        .additional-work-row .section-title {
            font-size: 16px;
            font-weight: 600;
            color: #374151;
            margin: 0;
        }

        [data-theme="dark"] .additional-work-row .section-title {
            color: #E5E7EB;
        }

        .delete-tag-btn {
            height: 32px !important;
            background: rgba(255, 51, 153, 0.15) !important;
            border: 1.5px solid rgba(255, 51, 153, 0.8) !important;
            border-radius: 16px !important;
            padding: 8px 16px !important;
            font-size: 16px !important;
            font-weight: 500 !important;
            color: rgba(255, 51, 153, 0.8) !important;
            cursor: pointer !important;
            transition: all 0.2s ease !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            min-width: 60px !important;
            font-family: "Noto Sans KR", sans-serif !important;
        }

        .delete-tag-btn:hover {
            background: rgba(255, 51, 153, 0.25) !important;
            border-color: #FF3399 !important;
            color: rgba(255, 51, 153, 0.9) !important;
            transform: translateY(-1px) !important;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
        }

        .delete-tag-btn:active {
            background: rgba(255, 51, 153, 0.25) !important;
            border-color: #FF3399 !important;
            color: rgba(255, 51, 153, 0.9) !important;
            transform: translateY(0.5px) !important;
            filter: saturate(0.98) !important;
        }

        /* 다크모드 삭제태그버튼 */
        [data-theme="dark"] .delete-tag-btn {
            background: rgba(255, 51, 153, 0.15) !important;
            border-color: rgba(255, 51, 153, 0.8) !important;
            color: #FF3399 !important;
        }

        [data-theme="dark"] .delete-tag-btn:hover {
            background: rgba(255, 51, 153, 0.25) !important;
            border-color: #FF3399 !important;
            color: #FF3399 !important;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        /* 추가 공수 행 스타일 */
        .additional-manpower-row {
            margin-top: 16px;
            padding: 12px;
            border: 1px solid #E5E7EB;
            border-radius: 10px;
            background: #F9FAFB;
            position: relative;
        }

        [data-theme="dark"] .additional-manpower-row {
            background: #1F2937;
            border-color: #374151;
        }

        .additional-manpower-row .form-group {
            margin-bottom: 0;
            flex: 1;
            padding: 0 8px;
            min-width: 0; /* flex 아이템이 축소될 수 있도록 */
        }

        .additional-manpower-row .form-group:first-child {
            padding-left: 0;
            flex: 1.1; /* 작성자 선택박스가 조금 더 넓게 */
        }

        .additional-manpower-row .form-group:nth-child(2) {
            flex: 1.2; /* 공수 입력 컨트롤을 더 넓게 */
        }

        .additional-manpower-row .form-group:last-child {
            padding-right: 0;
            flex: 0.7; /* 삭제 버튼은 조금 더 좁게 */
            display: flex;
            align-items: center;
            justify-content: flex-end;
        }

        /* 공수입력컨트롤 가로폭 줄였을 때 짤리지 않게 */
        .additional-manpower-row .number-input {
            min-width: 140px;
            max-width: 180px;
            width: 100%;
            box-sizing: border-box;
            overflow: visible;
        }

        .additional-manpower-row .number-field {
            min-width: 60px;
            max-width: 80px;
            width: 60px;
            height: 38px;
            box-sizing: border-box;
        }

        .additional-manpower-row .number-btn {
            min-width: 32px;
            max-width: 36px;
            width: 32px;
            height: 38px;
            box-sizing: border-box;
        }

        /* 작성자 선택박스 크기 조정 */
        .additional-manpower-row .form-select {
            min-width: 80px;
            max-width: 120px;
            text-align: center !important;
            padding: 0 16px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        /* 삭제 버튼 크기 조정 */
        .additional-manpower-row .delete-tag-btn {
            min-width: 50px;
            max-width: 60px;
            white-space: nowrap;
        }

        #author {
            width: 100% !important;
            text-align: left !important;
        }

        .number-btn {
            width: 32px;
            height: 40px;
            border: none;
            background: #F3F4F6;
            font-size: 18px;
            font-weight: 600 !important; /* Semi-Bold 강제 적용 */
            color: #374151;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .number-btn:hover {
            background: #E5E7EB;
        }

        .number-field {
            width: 60px;
            height: 40px;
            border: none;
            background: transparent;
            text-align: center;
            font-size: 16px !important;
            font-weight: 400;
            color: #374151;
        }

        .number-field:focus {
            outline: none;
        }

        [data-theme="dark"] .number-input {
            background: #374151 !important;
            border-color: #4B5563 !important;
        }

        [data-theme="dark"] .number-btn {
            background: #4B5563 !important;
            color: #E5E7EB !important;
            font-weight: 600 !important; /* Semi-Bold 강제 적용 */
        }

        [data-theme="dark"] .number-btn:hover {
            background: #6B7280 !important;
        }

        /* number-btn plus/minus 특별 스타일 */
        .number-btn.plus,
        .number-btn.minus {
            font-family: 'Noto Sans KR', system-ui, sans-serif !important;
            font-weight: 600 !important; /* Semi-Bold */
            padding: 0 !important; /* 좌우 패딩 0 */
            text-align: center !important; /* 가운데 정렬 */
        }

        /* form-select author-select 특별 스타일 */
        .form-select.author-select {
            padding: 0 16px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        /* author-manpower-row 간격 조정 */
        .form-row.author-manpower-row {
            gap: 12px !important;
            width: 100% !important;
            max-width: 100% !important;
            box-sizing: border-box !important;
        }

        /* form-label 좌측 정렬 */
        .form-label {
            text-align: left !important;
        }

        /* 입력 컨트롤 박스 테두리 오류 해결 */
        .form-row.author-manpower-row .form-control,
        .form-row.author-manpower-row .form-select {
            border: 1px solid #D1D5DB !important;
            border-radius: 12px !important;
            box-sizing: border-box !important;
            overflow: visible !important;
        }

        /* 공수 입력 컨트롤 - 외곽 테두리만 적용 */
        .form-row.author-manpower-row .number-input {
            border: 1px solid #D1D5DB !important;
            border-radius: 12px !important;
            box-sizing: border-box !important;
            overflow: visible !important;
        }

        /* qty-split3 부모 컨테이너 테두리 관리 */
        .number-input.qty-split3 {
            border: 1px solid #E6ECF4 !important;
            border-radius: 8px !important;
            box-sizing: border-box !important;
            overflow: visible !important;
            position: relative !important;
            z-index: 10 !important;
            background: transparent !important;
        }

        /* qty-split3 내부 요소들 테두리 제거 */
        .number-input.qty-split3 .number-field {
            border: 1px !important;
            border-radius: 0 !important;
            outline: none !important;
            box-shadow: none !important;
            background: transparent !important;
            z-index: 1 !important;
        }

        .number-input.qty-split3 .number-btn {
            border: 1px !important;
            border-radius: 0 !important;
            outline: none !important;
            box-shadow: none !important;
            background: transparent !important;
            z-index: 1 !important;
        }

        /* qty-split3 포커스 스타일 초기화 */
        .number-input.qty-split3 input:focus {
            outline: none !important;
            box-shadow: none !important;
        }

        /* qty-split3 호버 시 테두리 유지 */
        .number-input.qty-split3:hover {
            border-color: #E6ECF4 !important;
        }

        /* 팝업 바텀시트 스타일 */
        .bottom-sheet-popup {
            position: fixed !important;
            bottom: 0px !important;
            left: 0px !important;
            right: 0px !important;
            background: rgba(0, 0, 0, 0.8) !important;
            backdrop-filter: blur(8px) !important;
            padding: 24px !important;
            border-radius: 20px 20px 0px 0px !important;
            z-index: 10000 !important;
            animation: slideUp 0.3s ease-out !important;
        }

        @keyframes slideUp {
            from {
                transform: translateY(100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* task-selection-dialog 빠른메뉴 팝업 CSS 적용 */
        .task-selection-dialog {
            position: fixed !important;
            bottom: 0px !important;
            left: 0px !important;
            right: 0px !important;
            background: rgba(255, 255, 255, 0.95) !important;
            backdrop-filter: blur(12px) !important;
            padding: 24px !important;
            border-radius: 20px 20px 0px 0px !important;
            z-index: 10000 !important;
            animation: slideUp 0.3s ease-out !important;
            display: flex !important;
            flex-direction: column !important;
            gap: 16px !important;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15) !important;
        }

        .task-selection-dialog .camera-option {
            display: flex !important;
            align-items: center !important;
            gap: 16px !important;
            padding: 20px !important;
            border: 1px solid #E5E7EB !important;
            border-radius: 12px !important;
            background: #FFFFFF !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08) !important;
        }

        .task-selection-dialog .camera-option:hover {
            border-color: #31a3fa !important;
            background: #F0F8FF !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 16px rgba(49, 163, 250, 0.2) !important;
        }

        .task-selection-dialog .gallery-option {
            display: flex !important;
            align-items: center !important;
            gap: 16px !important;
            padding: 20px !important;
            border: 1px solid #E5E7EB !important;
            border-radius: 12px !important;
            background: #FFFFFF !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08) !important;
        }

        .task-selection-dialog .gallery-option:hover {
            border-color: #31a3fa !important;
            background: #F0F8FF !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 16px rgba(49, 163, 250, 0.2) !important;
        }

        .task-selection-dialog .option-icon {
            width: 32px !important;
            height: 32px !important;
            flex-shrink: 0 !important;
            border-radius: 8px !important;
            object-fit: contain !important;
            background: transparent !important;
        }

        .task-selection-dialog .option-text {
            font-family: 'Noto Sans KR', sans-serif !important;
            font-weight: 600 !important;
            font-size: 18px !important;
            color: #1A1A1A !important;
            line-height: 1.4 !important;
        }

        /* 라이트모드 카메라, 사진 폰트 컬러 1A254F - 강화 */
        .task-selection-dialog .camera-option .option-text,
        .task-selection-dialog .gallery-option .option-text,
        .task-option[data-type="camera"] .option-text,
        .task-option[data-type="gallery"] .option-text {
            color: #1A254F !important;
            font-family: 'Noto Sans KR', sans-serif !important;
            font-weight: 600 !important;
            font-size: 18px !important;
            line-height: 1.4 !important;
        }

        /* 라이트모드 전체 옵션 텍스트 강제 적용 */
        .task-selection-dialog .camera-option,
        .task-selection-dialog .gallery-option,
        .task-option[data-type="camera"],
        .task-option[data-type="gallery"] {
            color: #1A254F !important;
        }

        .task-selection-dialog .camera-option *,
        .task-selection-dialog .gallery-option *,
        .task-option[data-type="camera"] *,
        .task-option[data-type="gallery"] * {
            color: inherit !important;
        }

        /* 라이트모드 강제 적용 */
        body:not([data-theme="dark"]) .task-selection-dialog .camera-option,
        body:not([data-theme="dark"]) .task-selection-dialog .gallery-option,
        body:not([data-theme="dark"]) .task-option[data-type="camera"],
        body:not([data-theme="dark"]) .task-option[data-type="gallery"] {
            color: #1A254F !important;
        }

        body:not([data-theme="dark"]) .task-selection-dialog .camera-option *,
        body:not([data-theme="dark"]) .task-selection-dialog .gallery-option *,
        body:not([data-theme="dark"]) .task-option[data-type="camera"] *,
        body:not([data-theme="dark"]) .task-option[data-type="gallery"] * {
            color: #1A254F !important;
        }

        /* 다크모드 카메라, 사진 폰트 컬러 화이트 - 강화 */
        [data-theme="dark"] .task-selection-dialog .camera-option,
        [data-theme="dark"] .task-selection-dialog .gallery-option,
        [data-theme="dark"] .task-option[data-type="camera"],
        [data-theme="dark"] .task-option[data-type="gallery"],
        body[data-theme="dark"] .task-selection-dialog .camera-option,
        body[data-theme="dark"] .task-selection-dialog .gallery-option,
        body[data-theme="dark"] .task-option[data-type="camera"],
        body[data-theme="dark"] .task-option[data-type="gallery"] {
            color: #FFFFFF !important;
        }

        [data-theme="dark"] .task-selection-dialog .camera-option *,
        [data-theme="dark"] .task-selection-dialog .gallery-option *,
        [data-theme="dark"] .task-option[data-type="camera"] *,
        [data-theme="dark"] .task-option[data-type="gallery"] *,
        body[data-theme="dark"] .task-selection-dialog .camera-option *,
        body[data-theme="dark"] .task-selection-dialog .gallery-option *,
        body[data-theme="dark"] .task-option[data-type="camera"] *,
        body[data-theme="dark"] .task-option[data-type="gallery"] * {
            color: #FFFFFF !important;
        }

        /* 다크모드 텍스트 강제 적용 - 최강 우선순위 */
        [data-theme="dark"] .task-selection-dialog .camera-option .option-text,
        [data-theme="dark"] .task-selection-dialog .gallery-option .option-text,
        [data-theme="dark"] .task-option[data-type="camera"] .option-text,
        [data-theme="dark"] .task-option[data-type="gallery"] .option-text,
        body[data-theme="dark"] .task-selection-dialog .camera-option .option-text,
        body[data-theme="dark"] .task-selection-dialog .gallery-option .option-text,
        body[data-theme="dark"] .task-option[data-type="camera"] .option-text,
        body[data-theme="dark"] .task-option[data-type="gallery"] .option-text {
            color: #FFFFFF !important;
            font-family: 'Noto Sans KR', sans-serif !important;
            font-weight: 600 !important;
            font-size: 18px !important;
            line-height: 1.4 !important;
        }

        /* 다크모드 모든 텍스트 요소 강제 화이트 */
        [data-theme="dark"] .task-selection-dialog span,
        [data-theme="dark"] .task-selection-dialog div,
        [data-theme="dark"] .task-selection-dialog p,
        [data-theme="dark"] .task-selection-dialog label,
        [data-theme="dark"] .task-option span,
        [data-theme="dark"] .task-option div,
        [data-theme="dark"] .task-option p,
        [data-theme="dark"] .task-option label,
        body[data-theme="dark"] .task-selection-dialog span,
        body[data-theme="dark"] .task-selection-dialog div,
        body[data-theme="dark"] .task-selection-dialog p,
        body[data-theme="dark"] .task-selection-dialog label,
        body[data-theme="dark"] .task-option span,
        body[data-theme="dark"] .task-option div,
        body[data-theme="dark"] .task-option p,
        body[data-theme="dark"] .task-option label {
            color: #FFFFFF !important;
        }

        /* 다크모드 카메라/사진 텍스트 직접 타겟팅 */
        [data-theme="dark"] .task-selection-dialog .camera-option,
        [data-theme="dark"] .task-selection-dialog .gallery-option,
        [data-theme="dark"] .task-option[data-type="camera"],
        [data-theme="dark"] .task-option[data-type="gallery"] {
            color: #FFFFFF !important;
        }

        [data-theme="dark"] .task-selection-dialog .camera-option *,
        [data-theme="dark"] .task-selection-dialog .gallery-option *,
        [data-theme="dark"] .task-option[data-type="camera"] *,
        [data-theme="dark"] .task-option[data-type="gallery"] * {
            color: #FFFFFF !important;
        }

        /* task-selection-dialog inocss 폰트 CSS 적용 */
        .task-selection-dialog {
            font-family: 'Noto Sans KR', sans-serif !important;
        }

        /* task-selection-dialog 다크모드 카메라, 사진 폰트 컬러 강제 적용 */
        [data-theme="dark"] .task-selection-dialog {
            color: #FFFFFF !important;
        }

        [data-theme="dark"] .task-selection-dialog * {
            color: #FFFFFF !important;
        }

        [data-theme="dark"] .task-selection-dialog .camera-option,
        [data-theme="dark"] .task-selection-dialog .gallery-option {
            color: #FFFFFF !important;
        }

        [data-theme="dark"] .task-selection-dialog .camera-option *,
        [data-theme="dark"] .task-selection-dialog .gallery-option * {
            color: #FFFFFF !important;
        }

        /* 다크모드 task-selection-dialog 내 모든 텍스트 화이트 */
        body[data-theme="dark"] .task-selection-dialog {
            color: #FFFFFF !important;
        }

        body[data-theme="dark"] .task-selection-dialog * {
            color: #FFFFFF !important;
        }

        body[data-theme="dark"] .task-selection-dialog .camera-option,
        body[data-theme="dark"] .task-selection-dialog .gallery-option {
            color: #FFFFFF !important;
        }

        body[data-theme="dark"] .task-selection-dialog .camera-option *,
        body[data-theme="dark"] .task-selection-dialog .gallery-option * {
            color: #FFFFFF !important;
        }

        /* 다크모드 폰트 컬러 최강 강제 적용 */
        [data-theme="dark"] .task-selection-dialog .camera-option,
        [data-theme="dark"] .task-selection-dialog .gallery-option,
        [data-theme="dark"] .task-selection-dialog .camera-option span,
        [data-theme="dark"] .task-selection-dialog .gallery-option span,
        [data-theme="dark"] .task-selection-dialog .camera-option div,
        [data-theme="dark"] .task-selection-dialog .gallery-option div,
        [data-theme="dark"] .task-selection-dialog .camera-option p,
        [data-theme="dark"] .task-selection-dialog .gallery-option p,
        [data-theme="dark"] .task-selection-dialog .camera-option label,
        [data-theme="dark"] .task-selection-dialog .gallery-option label,
        body[data-theme="dark"] .task-selection-dialog .camera-option,
        body[data-theme="dark"] .task-selection-dialog .gallery-option,
        body[data-theme="dark"] .task-selection-dialog .camera-option span,
        body[data-theme="dark"] .task-selection-dialog .gallery-option span,
        body[data-theme="dark"] .task-selection-dialog .camera-option div,
        body[data-theme="dark"] .task-selection-dialog .gallery-option div,
        body[data-theme="dark"] .task-selection-dialog .camera-option p,
        body[data-theme="dark"] .task-selection-dialog .gallery-option p,
        body[data-theme="dark"] .task-selection-dialog .camera-option label,
        body[data-theme="dark"] .task-selection-dialog .gallery-option label {
            color: #FFFFFF !important;
            font-family: 'Noto Sans KR', sans-serif !important;
            font-weight: 600 !important;
            font-size: 18px !important;
            line-height: 1.4 !important;
        }

        /* 다크모드 모든 텍스트 요소 강제 화이트 - 최강 */
        [data-theme="dark"] .task-selection-dialog *,
        body[data-theme="dark"] .task-selection-dialog * {
            color: #FFFFFF !important;
        }

        /* 다크모드 폰트 컬러 최종 강제 적용 - 절대적 */
        [data-theme="dark"] .task-selection-dialog,
        [data-theme="dark"] .task-selection-dialog *,
        [data-theme="dark"] .task-selection-dialog span,
        [data-theme="dark"] .task-selection-dialog div,
        [data-theme="dark"] .task-selection-dialog p,
        [data-theme="dark"] .task-selection-dialog label,
        [data-theme="dark"] .task-selection-dialog button,
        [data-theme="dark"] .task-selection-dialog a,
        [data-theme="dark"] .task-selection-dialog h1,
        [data-theme="dark"] .task-selection-dialog h2,
        [data-theme="dark"] .task-selection-dialog h3,
        [data-theme="dark"] .task-selection-dialog h4,
        [data-theme="dark"] .task-selection-dialog h5,
        [data-theme="dark"] .task-selection-dialog h6,
        body[data-theme="dark"] .task-selection-dialog,
        body[data-theme="dark"] .task-selection-dialog *,
        body[data-theme="dark"] .task-selection-dialog span,
        body[data-theme="dark"] .task-selection-dialog div,
        body[data-theme="dark"] .task-selection-dialog p,
        body[data-theme="dark"] .task-selection-dialog label,
        body[data-theme="dark"] .task-selection-dialog button,
        body[data-theme="dark"] .task-selection-dialog a,
        body[data-theme="dark"] .task-selection-dialog h1,
        body[data-theme="dark"] .task-selection-dialog h2,
        body[data-theme="dark"] .task-selection-dialog h3,
        body[data-theme="dark"] .task-selection-dialog h4,
        body[data-theme="dark"] .task-selection-dialog h5,
        body[data-theme="dark"] .task-selection-dialog h6 {
            color: #FFFFFF !important;
        }

        /* 다크모드 작업선택 팝업 텍스트 컬러 최종 패치 - #E5E7EB */
        [data-theme="dark"] .task-selection-dialog,
        [data-theme="dark"] .task-selection-dialog .option-text,
        [data-theme="dark"] .task-option .option-text,
        html[data-theme="dark"] .task-selection-dialog,
        html[data-theme="dark"] .task-selection-dialog .option-text,
        html[data-theme="dark"] .task-option .option-text,
        body[data-theme="dark"] .task-selection-dialog,
        body[data-theme="dark"] .task-selection-dialog .option-text,
        body[data-theme="dark"] .task-option .option-text {
            color: #E5E7EB !important;
            -webkit-text-fill-color: #E5E7EB !important;
        }

        /* 팝업 루트 data-theme 동기화 */
        .task-selection-dialog[data-theme="dark"],
        .task-selection-dialog[data-theme="dark"] .option-text,
        .task-selection-dialog[data-theme="dark"] .task-option .option-text {
            color: #E5E7EB !important;
            -webkit-text-fill-color: #E5E7EB !important;
        }

        /* task-option 색상 상속 설정 */
        .task-option {
            color: inherit !important;
        }

        /* 버튼/링크/아이콘 색상 상속 */
        .task-option button,
        .task-option a,
        .task-option .option-icon {
            color: inherit !important;
        }

        /* SVG 아이콘 currentColor 설정 */
        .task-option svg,
        .task-option .option-icon svg {
            fill: currentColor !important;
            stroke: currentColor !important;
        }

        /* 다크모드 hover/active 상태에서도 동일한 컬러 유지 */
        [data-theme="dark"] .task-option:hover,
        [data-theme="dark"] .task-option:active,
        [data-theme="dark"] .task-option:hover .option-text,
        [data-theme="dark"] .task-option:active .option-text,
        html[data-theme="dark"] .task-option:hover,
        html[data-theme="dark"] .task-option:active,
        html[data-theme="dark"] .task-option:hover .option-text,
        html[data-theme="dark"] .task-option:active .option-text,
        body[data-theme="dark"] .task-option:hover,
        body[data-theme="dark"] .task-option:active,
        body[data-theme="dark"] .task-option:hover .option-text,
        body[data-theme="dark"] .task-option:active .option-text,
        .task-selection-dialog[data-theme="dark"] .task-option:hover,
        .task-selection-dialog[data-theme="dark"] .task-option:active,
        .task-selection-dialog[data-theme="dark"] .task-option:hover .option-text,
        .task-selection-dialog[data-theme="dark"] .task-option:active .option-text {
            color: #E5E7EB !important;
            -webkit-text-fill-color: #E5E7EB !important;
        }

        /* 다크모드 팝업 컨테이너 내 모든 텍스트 요소 */
        [data-theme="dark"] .task-selection-dialog *,
        html[data-theme="dark"] .task-selection-dialog *,
        body[data-theme="dark"] .task-selection-dialog *,
        .task-selection-dialog[data-theme="dark"] * {
            color: #E5E7EB !important;
            -webkit-text-fill-color: #E5E7EB !important;
        }

        /* 팝업 아이콘 인라인 스타일 강제 적용 */
        .task-selection-dialog .task-option[data-type="camera"] .option-icon[style*="background-image"] {
            background-image: url('./images/photo.png?v=20250119') !important;
        }

        .task-selection-dialog .task-option[data-type="gallery"] .option-icon[style*="background-image"] {
            background-image: url('./images/gallery.png?v=20250119') !important;
        }

        .task-selection-dialog h1,
        .task-selection-dialog h2,
        .task-selection-dialog h3,
        .task-selection-dialog h4,
        .task-selection-dialog h5,
        .task-selection-dialog h6 {
            font-family: 'Noto Sans KR', sans-serif !important;
            font-weight: 700 !important;
            font-size: 24px !important;
            color: #1A254F !important;
            line-height: 1.4 !important;
        }

        .task-selection-dialog .section-title,
        .task-selection-dialog .card-title {
            font-family: 'Noto Sans KR', sans-serif !important;
            font-weight: 600 !important;
            font-size: 18px !important;
            color: #1A1A1A !important;
            line-height: 1.4 !important;
        }

        .task-selection-dialog .body-text {
            font-family: 'Noto Sans KR', sans-serif !important;
            font-weight: 400 !important;
            font-size: 15px !important;
            color: #1A1A1A !important;
            line-height: 1.4 !important;
        }

        .task-selection-dialog .secondary-text {
            font-family: 'Noto Sans KR', sans-serif !important;
            font-weight: 400 !important;
            font-size: 12px !important;
            color: #6B7280 !important;
            line-height: 1.4 !important;
        }

        .task-selection-dialog .button-text {
            font-family: 'Noto Sans KR', sans-serif !important;
            font-weight: 500 !important;
            font-size: 14px !important;
            line-height: 1.4 !important;
        }

        /* 다크모드 전환 시 어울리는 컬러 적용 */
        [data-theme="dark"] .task-selection-dialog {
            background: rgba(31, 41, 55, 0.95) !important;
            color: #E5E7EB !important;
        }

        [data-theme="dark"] .task-selection-dialog .camera-option,
        [data-theme="dark"] .task-selection-dialog .gallery-option {
            background: #374151 !important;
            border-color: #4B5563 !important;
            color: #E5E7EB !important;
        }

        /* 다크모드 다이스 스타일 아이콘 */
        [data-theme="dark"] .task-selection-dialog .camera-option .option-icon,
        [data-theme="dark"] .task-selection-dialog .gallery-option .option-icon {
            background-color: #4B5563 !important;
            border-color: #6B7280 !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3) !important;
        }

        [data-theme="dark"] .task-selection-dialog .camera-option:hover,
        [data-theme="dark"] .task-selection-dialog .gallery-option:hover {
            background: #4B5563 !important;
            border-color: #31a3fa !important;
            color: #FFFFFF !important;
        }

        [data-theme="dark"] .task-selection-dialog .option-text {
            color: #E5E7EB !important;
        }

        [data-theme="dark"] .task-selection-dialog h1,
        [data-theme="dark"] .task-selection-dialog h2,
        [data-theme="dark"] .task-selection-dialog h3,
        [data-theme="dark"] .task-selection-dialog h4,
        [data-theme="dark"] .task-selection-dialog h5,
        [data-theme="dark"] .task-selection-dialog h6 {
            color: #F3F4F6 !important;
        }

        [data-theme="dark"] .task-selection-dialog .section-title,
        [data-theme="dark"] .task-selection-dialog .card-title {
            color: #E5E7EB !important;
        }

        [data-theme="dark"] .task-selection-dialog .body-text {
            color: #D1D5DB !important;
        }

        [data-theme="dark"] .task-selection-dialog .secondary-text {
            color: #9CA3AF !important;
        }

        /* 이미지 링크 보호 및 최적화 */
        .task-selection-dialog img {
            max-width: 100% !important;
            height: auto !important;
            object-fit: contain !important;
            image-rendering: -webkit-optimize-contrast !important;
            image-rendering: crisp-edges !important;
            -webkit-backface-visibility: hidden !important;
            backface-visibility: hidden !important;
            -webkit-transform: translateZ(0) !important;
            transform: translateZ(0) !important;
        }

        /* 작업선택 팝업 아이콘 - 로컬 이미지로 교체 (최강 우선순위) */
        .task-selection-dialog .task-option[data-type="camera"] .option-icon {
            background-image: url('./images/photo.png?v=20250119') !important;
            background-size: contain !important;
            background-position: center !important;
            background-repeat: no-repeat !important;
            background-attachment: scroll !important;
            background-origin: padding-box !important;
            background-clip: padding-box !important;
            width: 60px !important;
            height: 60px !important;
            min-width: 60px !important;
            min-height: 60px !important;
            display: inline-block !important;
            content: '' !important;
            position: relative !important;
            z-index: 9999 !important;
            image-rendering: -webkit-optimize-contrast !important;
            image-rendering: crisp-edges !important;
            backface-visibility: hidden !important;
            -webkit-transform: translateZ(0) !important;
            transform: translateZ(0) !important;
        }

        .task-selection-dialog .task-option[data-type="gallery"] .option-icon {
            background-image: url('./images/gallery.png?v=20250119') !important;
            background-size: contain !important;
            background-position: center !important;
            background-repeat: no-repeat !important;
            background-attachment: scroll !important;
            background-origin: padding-box !important;
            background-clip: padding-box !important;
            width: 60px !important;
            height: 60px !important;
            min-width: 60px !important;
            min-height: 60px !important;
            display: inline-block !important;
            content: '' !important;
            position: relative !important;
            z-index: 9999 !important;
            image-rendering: -webkit-optimize-contrast !important;
            image-rendering: crisp-edges !important;
            backface-visibility: hidden !important;
            -webkit-transform: translateZ(0) !important;
            transform: translateZ(0) !important;
        }

        /* 이미지 링크 보호 강화 */
        .task-selection-dialog .option-icon,
        .task-option .option-icon {
            background-attachment: scroll !important;
            background-origin: padding-box !important;
            background-clip: padding-box !important;
            -webkit-background-size: contain !important;
            -moz-background-size: contain !important;
            -o-background-size: contain !important;
        }


        /* task-option 기본 스타일 - 고정 마크업 */
        .task-option {
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            gap: 16px !important;
            padding: 20px !important;
            border: none !important;
            border-radius: 0 !important;
            background: transparent !important;
            cursor: pointer !important;
            transition: none !important;
            box-shadow: none !important;
            width: auto !important;
            height: auto !important;
        }

        .task-option:hover {
            border: none !important;
            background: transparent !important;
            transform: none !important;
            box-shadow: none !important;
        }

        /* option-text 표시 */
        .task-option .option-text {
            display: inline-block !important;
            font-family: 'Noto Sans KR', sans-serif !important;
            font-weight: 600 !important;
            font-size: 18px !important;
            line-height: 1.4 !important;
        }

        /* form-input 모서리 라운드 8px */
        .form-input {
            border-radius: 8px !important;
        }

        /* savePasswordChange와 cancelPasswordChange 버튼 높이 40px */
        #savePasswordChange,
        #cancelPasswordChange {
            height: 40px !important;
            min-height: 40px !important;
            line-height: 40px !important;
            padding: 0 16px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        #savePasswordChange .btn,
        #savePasswordChange button,
        #cancelPasswordChange .btn,
        #cancelPasswordChange button {
            height: 40px !important;
            min-height: 40px !important;
            line-height: 40px !important;
            padding: 0 16px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        /* logout-btn 드로우메뉴 박스 버튼들 높이 40px */
        .logout-btn,
        .drawer-menu .logout-btn,
        .drawer-menu button.logout-btn {
            height: 40px !important;
            min-height: 40px !important;
            line-height: 40px !important;
            padding: 0 16px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        /* account-manage-btn 높이 40px */
        .account-manage-btn {
            height: 40px !important;
            min-height: 40px !important;
            line-height: 40px !important;
            padding: 0 16px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        /* 폼 버튼들 모서리 라운드 8px 공통 적용 */
        .btn,
        .form-btn,
        .form-button,
        .submit-btn,
        .cancel-btn,
        .number-btn,
        .btn-primary,
        .btn-secondary,
        .btn-success,
        .btn-danger,
        .btn-warning,
        .btn-info,
        .btn-light,
        .btn-dark,
        button[type="submit"],
        button[type="button"],
        button[type="reset"],
        input[type="submit"],
        input[type="button"] {
            border-radius: 8px !important;
        }

        /* 추가, 삭제 버튼 pill 스타일 */
        .add-btn,
        .delete-btn,
        .remove-btn,
        .btn-add,
        .btn-delete,
        .btn-remove {
            border-radius: 50px !important;
            padding: 8px 16px !important;
            font-weight: 500 !important;
            transition: all 0.3s ease !important;
        }

        .add-btn:hover,
        .delete-btn:hover,
        .remove-btn:hover,
        .btn-add:hover,
        .btn-delete:hover,
        .btn-remove:hover {
            transform: translateY(-1px) !important;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
        }

        /* additional-manpower-section 외곽 테두리 */
        .additional-manpower-section {
            border: 1px solid #D1D5DB !important;
            border-radius: 6px !important;
            box-sizing: border-box !important;
            overflow: visible !important;
            position: relative !important;
            z-index: 2 !important;
            padding: 12px !important;
            margin: 4px 0 !important;
        }

        /* additional-manpower-section 내부 요소들 테두리 제거 */
        .additional-manpower-section .number-input {
            border: none !important;
            border-radius: 0 !important;
        }

        .additional-manpower-section .number-field {
            border: none !important;
            border-radius: 0 !important;
        }

        .additional-manpower-section .number-btn {
            border: none !important;
            border-radius: 0 !important;
        }

        /* 내부 요소들 테두리 제거 */
        .form-row.author-manpower-row .number-field {
            border: none !important;
            border-radius: 0 !important;
            box-sizing: border-box !important;
        }

        .form-row.author-manpower-row .number-btn {
            border: none !important;
            border-radius: 0 !important;
            box-sizing: border-box !important;
        }

        [data-theme="dark"] .number-field {
            color: #E5E7EB !important;
        }

        .form-actions {
            display: flex;
            gap: 12px;
            justify-content: space-between;
            margin-top: 0 !important;
            padding-top: 0 !important;
            border: none !important;
            width: 100%;
        }

        .form-actions .btn {
            flex: 1 1 0 !important;
            min-width: 0 !important;
            max-width: none !important;
            width: 100% !important;
        }

        [data-theme="dark"] .form-actions {
            border: none !important;
            margin-top: 0 !important;
            padding-top: 0 !important;
        }

        .btn {
            height: 40px;
            padding: 8px;
            border-radius: 8px;
            font-family: "Noto Sans KR", system-ui, sans-serif;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-secondary {
            background: #F3F4F6;
            color: #374151;
            border: 1px solid #D1D5DB;
            width: 152px !important;
        }

        .btn-secondary:hover {
            background: #E5E7EB;
            border-color: #9CA3AF;
        }

        .btn-primary {
            background: #1A254F;
            color: #FFFFFF;
            width: 152px !important;
        }

        .btn-primary:hover {
            background: color-mix(in srgb, #1A254F 85%, white);
        }

        [data-theme="dark"] .btn-secondary {
            background: #374151 !important;
            color: #E5E7EB !important;
            border-color: #4B5563 !important;
        }

        [data-theme="dark"] .btn-secondary:hover {
            background: #4B5563 !important;
            border-color: #6B7280 !important;
        }

        [data-theme="dark"] .btn-primary {
            background: #1A254F !important;
            color: #FFFFFF !important;
        }

        [data-theme="dark"] .btn-primary:hover {
            background: color-mix(in srgb, #1A254F 85%, white) !important;
        }

        /* 첨부파일 섹션 스타일 */
        .upload-hint {
            font-size: 16px;
            color: #31a3fa;
            font-weight: 500;
        }

        .photo-upload-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 16px;
        }

        .photo-upload-item {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .upload-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .upload-title {
            font-size: 16px;
            font-weight: 400;
            color: #374151;
        }

        .upload-counter {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .counter-number {
            width: 24px;
            height: 24px;
            border: 1px solid #D1D5DB;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            color: #6B7280;
            background: #FFFFFF;
        }

        .counter-total {
            font-size: 12px;
            font-weight: 500;
            color: #9CA3AF;
        }

        .upload-area {
            border: 1px dashed #D1D5DB;
            border-radius: 10px;
            min-height: 40px;
            padding: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            background: #F9FAFB;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 4px;
        }

        .before-area {
            border-color: #8B5CF6;
            background: #F8F7FF;
        }

        .after-area {
            border-color: #31a3fa;
            background: #F0FDFF;
        }

        .upload-area:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .before-area:hover {
            border-color: #7C3AED;
            background: #F3F0FF;
        }

        .after-area:hover {
            border-color: #00A8B5;
            background: #E6F9FF;
        }



        .upload-actions {
            display: flex;
            gap: 12px;
            justify-content: space-between;
            width: 100%;
        }

        .upload-actions .btn {
            flex: 1 1 0 !important;
            min-width: 0 !important;
            max-width: none !important;
            width: 100% !important;
        }

        .drawing-actions {
            display: flex;
            gap: 12px;
            justify-content: space-between;
            margin-bottom: 0;
            padding-bottom: 0;
            width: 100%;
        }

        .drawing-actions .btn {
            flex: 1 1 0 !important;
            min-width: 0 !important;
            max-width: none !important;
            white-space: nowrap !important;
            overflow: hidden !important;
            text-overflow: ellipsis !important;
            width: 100% !important;
        }

        .btn-outline {
            background: #FFFFFF;
            border: 1px solid #D1D5DB;
            color: #374151;
            padding: 8px 16px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-outline:hover {
            background: #F3F4F6;
            border-color: #9CA3AF;
        }

        .summary-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .summary-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        .summary-full-width {
            width: 100%;
            margin-bottom: 0 !important;
            padding-bottom: 0 !important;
        }


        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #F3F4F6;
            font-family: "Noto Sans KR", sans-serif;
        }

        .summary-item:last-child {
            border-bottom: none;
        }
        
        /* 사진, 도면, 블럭/동/호수 항목에 하단 회색 라인 적용 */
        .summary-item.highlight-line {
            border-bottom: 1px solid #E5E7EB !important;
        }
        
        /* 다크모드에서의 하이라이트 라인 */
        [data-theme="dark"] .summary-item.highlight-line {
            border-bottom: 1px solid #374151 !important;
        }

        /* 도면 섹션에 동일한 회색 라인 적용 */
        .drawing-section {
            border-bottom: 1px solid #E5E7EB !important;
            margin-bottom: 12px !important;
            padding-bottom: 16px !important;
        }

        /* 다크모드에서 도면 섹션 회색 라인 */
        [data-theme="dark"] .drawing-section {
            border-bottom: 1px solid #374151 !important;
        }

        [data-theme="dark"] .summary-item {
            border-bottom-color: #374151;
        }


         /* ===== 본문 컨테이너에 fs-150 클래스 적용 (상단/하단 고정, 본문만 확대) ===== */
         
         /* ===== 큰글씨 모드 - 폰트 크기만 130% 확대 ===== */
         .main-page-content.fs-150 {
           font-size: 1.3em !important; /* 130% 확대 */
           line-height: 1.4 !important;
         }
         
         /* ===== 큰글씨 모드에서 모든 텍스트 요소 확대 ===== */
         .main-page-content.fs-150 * {
           font-size: inherit !important;
         }
         
        /* ===== 큰글씨 모드에서 입력 필드 확대 ===== */
        .main-page-content.fs-150 input,
        .main-page-content.fs-150 textarea,
        .main-page-content.fs-150 select,
        .main-page-content.fs-150 button {
          font-size: inherit !important;
        }

        /* ===== 큰글씨 모드에서 공수입력 컨트롤은 130%에 맞게 조정 ===== */
        .main-page-content.fs-150 .number-input {
          height: 42px !important;
          min-height: 42px !important;
          font-size: 15px !important;
        }

        .main-page-content.fs-150 .number-field {
          height: 42px !important;
          min-height: 42px !important;
          font-size: 15px !important;
          padding: 0 9px !important;
        }

        .main-page-content.fs-150 .number-btn {
          height: 42px !important;
          min-height: 42px !important;
          width: 34px !important;
          min-width: 34px !important;
          font-size: 15px !important;
          font-weight: bold !important;
        }

        /* author-manpower-row는 큰글씨 효과 적용하지 않음 */

        /* ===== 큰글씨 모드에서 추가 공수 행 컨트롤도 130%에 맞게 조정 ===== */
        .main-page-content.fs-150 .additional-manpower-row .number-input {
          height: 42px !important;
          min-height: 42px !important;
          font-size: 15px !important;
        }

        .main-page-content.fs-150 .additional-manpower-row .number-field {
          height: 42px !important;
          min-height: 42px !important;
          font-size: 15px !important;
          padding: 0 9px !important;
        }

        .main-page-content.fs-150 .additional-manpower-row .number-btn {
          height: 42px !important;
          min-height: 42px !important;
          width: 34px !important;
          min-width: 34px !important;
          font-size: 15px !important;
          font-weight: bold !important;
        }

        .main-page-content.fs-150 .additional-manpower-row .form-input,
        .main-page-content.fs-150 .additional-manpower-row .form-select {
          height: 42px !important;
          min-height: 42px !important;
          font-size: 15px !important;
        }
         
        /* ===== 큰글씨 모드에서 선택박스/버튼 높이 조정 (글씨 잘림 방지) ===== */
        .main-page-content.fs-150 select,
        .main-page-content.fs-150 .form-select,
        .main-page-content.fs-150 .ctl {
          height: auto !important;
          min-height: 2.3em !important;
          padding: 0 16px !important;
          line-height: 1.4 !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
        }
        
        /* ===== 큰글씨 모드에서 빠른메뉴 텍스트 넘침 방지 ===== */
        .main-page-content.fs-150 #quick-menu .quick-item span {
          font-size: 14px !important;
          line-height: 1.2 !important;
          word-break: keep-all !important;
          overflow: hidden !important;
          text-overflow: ellipsis !important;
          white-space: nowrap !important;
          max-width: 100% !important;
        }
        
        /* ===== 큰글씨 모드에서 빠른메뉴 아이콘 크기 조정 ===== */
        .main-page-content.fs-150 #quick-menu .quick-item img {
          width: 52px !important;
          height: 52px !important;
        }
        
        /* ===== 큰글씨 모드에서 빠른메뉴 아이템 패딩 조정 ===== */
        .main-page-content.fs-150 #quick-menu .quick-item {
          padding: 4px !important;
          gap: 2px !important;
        }
        
        /* ===== 큰글씨 모드에서 빠른메뉴 그리드 간격 조정 ===== */
        .main-page-content.fs-150 #quick-menu.quick-grid {
          gap: 0.5px !important;
        }
        
        /* ===== 큰글씨 모드에서 섹션 제목 크기 조정 ===== */
        .main-page-content.fs-150 .section-title {
          font-size: 17px !important;
          line-height: 1.3 !important;
        }
        
        /* ===== 큰글씨 모드에서 빠른메뉴 아이콘 크기 조정 ===== */
        .main-page-content.fs-150 .quick-menu-icon {
          width: 19px !important;
          height: 19px !important;
        }
        
        /* ===== 큰글씨 모드에서 섹션 헤더 간격 조정 ===== */
        .main-page-content.fs-150 .section-header {
          margin-bottom: 8px !important;
        }
        
        /* 큰글씨 모드에서 빠른메뉴 섹션 헤더만 하단 마진 0 유지 */
        .main-page-content.fs-150 #home-quick .section-header {
          margin-bottom: 0 !important;
        }
        
        /* ===== 큰글씨 모드에서 섹션 간격 조정 ===== */
        .main-page-content.fs-150 .section {
          margin-bottom: 12px !important;
        }
        
        /* ===== 큰글씨 모드에서 카드 패딩 조정 ===== */
        .main-page-content.fs-150 .card {
          padding: 18px !important;
        }
        
        /* ===== 큰글씨 모드에서 공지사항 아이템 패딩 조정 ===== */
        .main-page-content.fs-150 .notice-item {
          padding: 6px 0 !important;
        }
        
        /* ===== 큰글씨 모드에서 공지사항 콘텐츠 패딩 조정 ===== */
        .main-page-content.fs-150 .notice-content {
          padding: 0 !important;
        }
        
        /* ===== 큰글씨 모드에서 공지사항 아이템 간격 조정 ===== */
        .main-page-content.fs-150 .notice-item + .notice-item {
          margin-top: 4px !important;
        }
        
        /* ===== 큰글씨 모드에서 공지사항 아이템 간격 조정 ===== */
        .main-page-content.fs-150 .notice-item + .notice-item {
          margin-top: 4px !important;
        }
        
        /* ===== 큰글씨 모드에서 공지사항 텍스트 크기 조정 ===== */
        .main-page-content.fs-150 .notice-text {
          font-size: 13px !important;
          line-height: 1.3 !important;
        }
        
        /* ===== 큰글씨 모드에서 태그 라벨 크기 조정 ===== */
        .main-page-content.fs-150 .tag-label {
          font-size: 12px !important;
          line-height: 1.2 !important;
        }
        
        /* ===== 큰글씨 모드에서 추가 버튼 크기 조정 ===== */
        .main-page-content.fs-150 .add-btn {
          font-size: 13px !important;
          height: 32px !important;
          padding: 4px 14px !important;
        }

        /* ===== 큰글씨 모드에서 딜레트태그버튼 크기 고정 ===== */
        .main-page-content.fs-150 .delete-tag-btn {
          font-size: 13px !important;
          height: 34px !important;
          padding: 5px 18px !important;
          min-width: 55px !important;
          max-width: 65px !important;
        }

          /* ===== 큰글씨 모드에서 폼-맨파워 섹션 130%에 맞게 조정 ===== */
          .main-page-content.fs-150 .manpower-section,
          .main-page-content.fs-150 .additional-manpower-section,
          .main-page-content.fs-150 .additional-manpower-row {
            font-size: 17px !important;
          }

          .main-page-content.fs-150 .manpower-section .form-label,
          .main-page-content.fs-150 .additional-manpower-section .form-label,
          .main-page-content.fs-150 .additional-manpower-row .form-label {
            font-size: 17px !important;
          }

          .main-page-content.fs-150 .manpower-section .form-input,
          .main-page-content.fs-150 .additional-manpower-section .form-input,
          .main-page-content.fs-150 .additional-manpower-row .form-input {
            font-size: 17px !important;
            height: 42px !important;
          }

          .main-page-content.fs-150 .manpower-section .form-select,
          .main-page-content.fs-150 .additional-manpower-section .form-select,
          .main-page-content.fs-150 .additional-manpower-row .form-select {
            font-size: 17px !important;
            height: 42px !important;
          }

          /* 큰글씨 모드에서 공수입력컨트롤은 위의 전용 스타일 적용 */
          
          /* ===== 큰글씨 모드에서 폼 라벨 크기 조정 ===== */
        .main-page-content.fs-150 .form-label {
          font-size: 14px !important;
          line-height: 1.3 !important;
        }
        
        /* ===== 큰글씨 모드에서 폼 입력 필드 크기 조정 ===== */
        .main-page-content.fs-150 .form-select,
        .main-page-content.fs-150 .form-input {
          font-size: 14px !important;
          padding: 0 16px !important;
          margin-bottom: 0 !important;
        }
        
        /* ===== 큰글씨 모드에서 버튼 텍스트 크기 조정 ===== */
        .main-page-content.fs-150 .btn {
          font-size: 14px !important;
          padding: 10px 18px !important;
          margin: 4px 0 !important;
        }
         
         .main-page-content.fs-150 button,
         .main-page-content.fs-150 .btn,
         .main-page-content.fs-150 .chip {
           height: auto !important;
           min-height: 2.3em !important;
           padding: 0.4em 0.7em !important;
           line-height: 1.4 !important;
         }
         
         .main-page-content.fs-150 input[type="text"],
         .main-page-content.fs-150 input[type="number"],
         .main-page-content.fs-150 .sp-input {
           height: auto !important;
           min-height: 2.3em !important;
           padding: 0.4em 0.7em !important;
           line-height: 1.4 !important;
         }



        .summary-label {
            font-size: 16px !important;
            font-weight: 500;
            color: #6B7280;
            font-family: "Noto Sans KR", sans-serif;
        }

        .summary-value {
            font-size: 16px !important;
            font-weight: 600;
            color: #374151;
            font-family: "Noto Sans KR", sans-serif;
        }

        [data-theme="dark"] .upload-title {
            color: #E5E7EB;
        }

        [data-theme="dark"] .counter-number {
            background: #374151;
            border-color: #4B5563;
            color: #D1D5DB;
        }

        [data-theme="dark"] .counter-total {
            color: #9CA3AF;
        }

        [data-theme="dark"] .upload-area {
            background: #374151;
            border-color: #4B5563;
        }

        [data-theme="dark"] .before-area {
            border-color: #8B5CF6;
            background: #2D1B69;
        }

        [data-theme="dark"] .after-area {
            border-color: #31a3fa;
            background: #0F4C5C;
        }

        /* 사진 썸네일 스타일 */
        .photo-thumbnail {
            position: relative;
            display: inline-block;
            margin: 4px;
            width: 60px;
            height: 60px;
            border-radius: 8px;
            overflow: visible;
            border: 2px solid #E5E7EB;
            cursor: move;
            z-index: 1;
        }

        .photo-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: relative;
            z-index: 1;
        }

        .delete-photo-btn {
            position: absolute !important;
            top: -8px !important;
            right: -8px !important;
            width: 28px !important;
            height: 28px !important;
            border-radius: 50% !important;
            background: #1A254F !important;
            color: #FFFFFF !important;
            border: 2px solid white !important;
            font-size: 12px !important;
            font-weight: bold !important;
            cursor: pointer !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            line-height: 1 !important;
            z-index: 9999 !important;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important;
            pointer-events: auto !important;
            isolation: isolate !important;
            transition: background .18s ease, color .18s ease, border-color .18s ease, box-shadow .18s ease, transform .02s ease !important;
        }

        .move-photo-btn {
            position: absolute;
            top: -8px;
            left: -8px;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: #6B7280;
            color: #FFFFFF;
            border: 2px solid white;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            z-index: 9999;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            pointer-events: auto;
            isolation: isolate;
            transition: background .18s ease, color .18s ease, border-color .18s ease, box-shadow .18s ease, transform .02s ease;
        }

        .delete-photo-btn:hover {
            background: #2B3A6B !important;
            color: #FFFFFF !important;
            transform: translateY(-0.5px) !important;
        }

        .move-photo-btn:hover {
            background: #4B5563;
            color: #FFFFFF;
            transform: translateY(-0.5px);
        }

        [data-theme="dark"] .photo-thumbnail {
            border-color: #4B5563;
        }

        [data-theme="dark"] .delete-photo-btn {
            background: #1A254F !important;
            border-color: white !important;
            color: #FFFFFF !important;
        }

        [data-theme="dark"] .delete-photo-btn:hover {
            background: #2B3A6B !important;
            border-color: white !important;
            color: #FFFFFF !important;
        }

        [data-theme="dark"] .move-photo-btn {
            background: #6B7280;
            border-color: white;
            color: #FFFFFF;
        }

        [data-theme="dark"] .move-photo-btn:hover {
            background: #4B5563;
            color: #FFFFFF;
            border-color: white;
        }


        /* 도면 미리보기 스타일 */
        .drawing-preview {
            margin-top: 16px;
            padding: 8px;
            border: 1px solid #E5E7EB;
            border-radius: 10px;
            background: #F9FAFB;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }

        .drawing-preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .drawing-preview-header h4 {
            margin: 0;
            color: #374151;
        }

        .close-drawing-btn {
            background-color: var(--card);
            color: var(--text);
            border: 1px solid var(--line);
            border-radius: 10px;
            padding: 8px 16px;
            font-family: 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .close-drawing-btn:hover {
            background-color: #f5f5f5;
            border-color: #d0d0d0;
        }

        .drawing-canvas-container {
            width: 100%;
            margin-bottom: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #drawingCanvas {
            border: 1px solid #D1D5DB;
            border-radius: 8px;
            cursor: crosshair;
            width: 100%;
            height: auto;
            max-width: 100%;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        #drawingCanvas:hover {
            border-color: var(--accent, #31a3fa);
            box-shadow: 0 0 0 2px rgba(49, 163, 250, 0.1);
        }

        #drawingCanvas.upload-mode {
            cursor: pointer;
            border-color: var(--accent, #31a3fa);
            box-shadow: 0 0 0 2px rgba(49, 163, 250, 0.2);
        }

        /* 모바일 반응형 */
        @media (max-width: 768px) {
            #drawingCanvas {
                width: 100%;
                max-width: 100%;
            }
        }

        .drawing-tools {
            display: flex;
            gap: 8px;
            justify-content: center;
        }

        .drawing-tool-btn {
            padding: 8px 16px;
            border: 1px solid #D1D5DB;
            border-radius: 6px;
            background: white;
            color: #374151;
            cursor: pointer;
            transition: all 0.2s;
        }

        .drawing-tool-btn:hover {
            background: #F3F4F6;
        }

        .drawing-tool-btn.active {
            background: #3B82F6;
            color: white;
            border-color: #3B82F6;
        }

        [data-theme="dark"] .drawing-preview {
            background: #1F2937;
            border-color: #374151;
        }

        [data-theme="dark"] .drawing-preview-header h4 {
            color: #E5E7EB;
        }

        [data-theme="dark"] .close-drawing-btn:hover {
            background-color: rgba(0, 188, 212, 0.1);
            border-color: #31a3fa;
            color: #31a3fa;
        }

        [data-theme="dark"] #drawingCanvas {
            border-color: #4B5563;
        }

        [data-theme="dark"] #drawingCanvas:hover {
            border-color: var(--accent, #31a3fa);
            box-shadow: 0 0 0 2px rgba(0, 188, 212, 0.1);
        }

        [data-theme="dark"] #drawingCanvas.upload-mode {
            border-color: var(--accent, #31a3fa);
            box-shadow: 0 0 0 2px rgba(0, 188, 212, 0.2);
        }

        [data-theme="dark"] .drawing-tool-btn {
            background: #374151;
            border-color: #4B5563;
            color: #E5E7EB;
        }

        [data-theme="dark"] .drawing-tool-btn:hover {
            background: #4B5563;
        }

        [data-theme="dark"] .upload-area:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        /* upload-area before-area와 after-area 색상 설정 */
        .upload-area.before-area {
            border-color: #99a4be !important;
            background: rgba(153, 164, 190, 0.05) !important;
        }

        .upload-area.after-area {
            border-color: #31a3fa !important;
            background: rgba(49, 163, 250, 0.05) !important;
        }

        .upload-area.before-area:hover {
            border-color: #99a4be !important;
            background: rgba(153, 164, 190, 0.1) !important;
        }

        .upload-area.after-area:hover {
            border-color: #31a3fa !important;
            background: rgba(49, 163, 250, 0.1) !important;
        }

        [data-theme="dark"] .upload-area.before-area {
            border-color: #99a4be !important;
            background: rgba(153, 164, 190, 0.1) !important;
        }

        [data-theme="dark"] .upload-area.after-area {
            border-color: #31a3fa !important;
            background: rgba(49, 163, 250, 0.1) !important;
        }

        [data-theme="dark"] .upload-area.before-area:hover {
            border-color: #99a4be !important;
            background: rgba(153, 164, 190, 0.15) !important;
        }

        [data-theme="dark"] .upload-area.after-area:hover {
            border-color: #31a3fa !important;
            background: rgba(49, 163, 250, 0.15) !important;
        }

        [data-theme="dark"] .before-area:hover {
            border-color: #7C3AED;
            background: #3D1A78;
        }

        [data-theme="dark"] .after-area:hover {
            border-color: #00A8B5;
            background: #0D3A47;
        }


        [data-theme="dark"] .upload-counter {
            color: #9CA3AF;
        }

        [data-theme="dark"] .btn-outline {
            background: #374151;
            border-color: #4B5563;
            color: #E5E7EB;
        }

        [data-theme="dark"] .btn-outline:hover {
            background: #4B5563;
            border-color: #6B7280;
        }

        [data-theme="dark"] .summary-item {
            border-bottom-color: #4B5563;
        }

        [data-theme="dark"] .summary-label {
            color: #9CA3AF;
            font-family: "Noto Sans KR", sans-serif;
        }

        [data-theme="dark"] .summary-value {
            color: #E5E7EB;
            font-family: "Noto Sans KR", sans-serif;
        }



        /* 다크모드에서 이미지 로딩 실패 시 대체 아이콘 */
        [data-theme="dark"] #quick-menu .quick-item img:not([src]),
        [data-theme="dark"] #quick-menu .quick-item img[src=""],
        [data-theme="dark"] #quick-menu .quick-item img[src*="error"] {
            background: #374151 url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgMCA0OCA0OCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjQ4IiBoZWlnaHQ9IjQ4IiByeD0iOCIgZmlsbD0iIzM3NDE1MSIvPgo8cGF0aCBkPSJNMjQgMTJMMzYgMjRMMjQgMzZMMTIgMjRMMjQgMTJaIiBmaWxsPSIjOUNBQUFGIi8+CjxwYXRoIGQ9Ik0yNCAyMEwyOCAyNEwyNCAyOEwyMCAyNEwyNCAyMFoiIGZpbGw9IiNGRkZGRkYiLz4KPC9zdmc+') no-repeat center;
            background-size: 24px 24px;
        }

        /* 빠른메뉴 텍스트 */
        #quick-menu .quick-item span {
            font-family: "Noto Sans KR", system-ui, sans-serif;
            font-size: 14px;
            font-weight: 500;
            color: #1A254F;
            text-align: center;
            line-height: 1.4;
            margin: 0 !important;
            padding: 10px 4px !important; /* 상하 10px, 좌우 4px */
            word-break: keep-all;
            overflow-wrap: break-word;
        }

        /* 공지사항 박스 */
        .notice-card {
            position: relative;
            background: var(--card);
            border: 1px solid #E6ECF4;
            border-radius: 10px;
            padding: 0 18px; /* 상단/하단 0px, 좌우 18px */
            height: 46px;
            display: flex;
            align-items: center;
            box-shadow: 0 2px 10px rgba(2,6,23,.04);
            margin: 12px 0 12px 0 !important;
            box-sizing: border-box;
        }

        .notice-content {
            position: relative;
            min-height: 32px;
            overflow: hidden;
            padding: 0;
            width: 100%;
            box-sizing: border-box;
        }

        .notice-item {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            opacity: 0;
            transform: translateY(100%);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .notice-item.active {
            opacity: 1;
            transform: translateY(0);
        }

        .notice-item.prev {
            opacity: 0;
            transform: translateY(-100%);
        }

        .notice-text {
            font-size: 16px;
            font-weight: 600;
            color: #6B7280;
            line-height: 24px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
            display: block;
            width: 100%;
            box-sizing: border-box;
        }

        /* 공지사항 내부 태그 폰트 크기 14px 강제 적용 */
        .notice-text .tag-label,
        .notice-text strong.tag-label {
            font-size: 16px !important;
        }

        /* Tag Label 스타일 */
        .tag-label {
            font-family: 'Noto Sans KR', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
            font-size: 16px !important;
            font-weight: 700;
            line-height: 1.2;
            color: #1A254F;
        }

        /* Strong 태그 내부 폰트 크기 강제 적용 */
        strong.tag-label {
            font-size: 16px !important;
        }

        /* 다크모드 스타일 - 홈과 동일 */
        [data-theme="dark"] #quick-menu .quick-item span {
            color: #31a3fa !important;
        }

        [data-theme="dark"] #quick-menu .quick-item:hover {
            background: transparent !important;
        }

        [data-theme="dark"] #quick-menu .quick-item:hover span {
            color: #2F6BFF !important;
        }

        [data-theme="dark"] #quick-menu .quick-item:active {
            background: transparent !important;
        }

        [data-theme="dark"] .notice-text {
            color: #ffffff !important;
        }

        [data-theme="dark"] .tag-label {
            color: #31a3fa !important;
        }

        /* 빠른메뉴와 공지사항 섹션 간격 */
        #home-quick {
            margin-bottom: 12px !important;
            padding-bottom: 0 !important;
        }

        #home-quick::after {
            content: "";
            display: block;
            height: 12px;
            width: 100%;
        }

        #home-notice {
            margin-top: 0 !important;
            margin-bottom: 12px !important;
            padding-top: 0 !important;
        }

        /* Flex 유틸리티 클래스 */
        .flex {
            display: flex;
        }

        .items-center {
            align-items: center;
        }

        .gap-2 {
            gap: 8px;
        }

        .mb-3 {
            margin-bottom: 12px;
        }

        .mb-3\.5 {
            margin-bottom: 12px;
        }

        .w-4 {
            width: 16px;
        }

        .h-4 {
            height: 16px;
        }
    </style>
<script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
<style>
        /* =============== TOKENS =============== */
        :root {
            /* Fonts */
            --font-sans: "Noto Sans KR", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Apple SD Gothic Neo", "Malgun Gothic", sans-serif;
            --font-brand: "Poppins", var(--font-sans);

            /* Type scale / line-height */
            --lh: 1.4;
            --fs-title: 24px;  /* 헤드라인/메인 타이틀 (700) */
            --fs-h2: 20px;     /* 섹션/카드 타이틀 (600) */
            --fs-body: 15px;   /* 본문 (400) */
            --fs-cap: 12px;    /* 캡션 (400) */
            --fs-ctl: 14px;    /* 버튼/탭 (500) */

        }


        body {
            margin: 0;
            padding: 0;
            font-family: var(--font-sans);
            background-color: var(--bg);
            color: var(--text);
            line-height: var(--lh);
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* 타이포그래피 시스템 - Noto Sans KR */
        .headline, .main-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 700; /* Bold */
            font-size: 24px;
            line-height: 1.4;
            color: #1A1A1A;
        }


        .body-text {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 400; /* Regular */
            font-size: 16px;
            line-height: 1.4;
            color: #1A1A1A;
        }

        .caption, .helper-text {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 300; /* Light */
            font-size: 16px !important;
            line-height: 1.4;
            color: #6B7280;
        }

        .button-text, .tab-text {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 500; /* Medium */
            font-size: 16px;
            line-height: 1.4;
            color: #1A1A1A;
        }

        .app-container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* 상단 헤더 스타일 */
        .app-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background-color: var(--card);
            padding: 0;
            transition: background-color 0.3s ease;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 80px;
            padding: 0 18px;
            width: 100%;
            box-sizing: border-box;
            border-bottom: 1px solid #e5e7eb;
        }

        .header-left {
            display: flex;
            align-items: center;
            flex: 0 0 auto;
            min-width: 120px;
        }

        .header-center {
            display: none; /* 제목을 왼쪽으로 이동 */
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1px;
            flex: 0 0 auto;
            width: auto;
            padding: 0 0;
            min-width: 0;
        }

        /* 공통 INOPNC 브랜드 타이틀 */
        .brand-title, .header-title {
            font-family: var(--font-brand);
            font-size: var(--fs-title);
            font-weight: 700;
            color: #1A254F;
            margin: 0;
            line-height: var(--lh);
            white-space: nowrap;
        }

        [data-theme="dark"] .brand-title {
            color: #FFFFFF;
        }

        .header-icon-btn {
            background: none;
            border: none;
            padding: 0 18px 18px 18px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            transition: all 0.2s ease;
            position: relative;
            min-width: 32px;
            min-height: 32px;
            color: #1A254F;
        }

        [data-theme="dark"] .header-icon-btn {
            color: #31a3fa;
        }

        .header-icon-btn:hover {
            background-color: transparent;
            transform: none;
            box-shadow: none;
        }

        .header-icon-btn:active {
            background-color: transparent !important;
            transform: none !important;
            box-shadow: none !important;
        }

        .header-icon-btn:focus {
            outline: none;
            box-shadow: none;
        }

        /* 메뉴 버튼 우측 패딩만 0으로 설정 */
        .header-icon-btn#menuBtn {
            padding-right: 0;
        }

        /* 모든 클릭 가능한 요소의 클릭 효과 제거 */
        button:active,
        .btn:active,
        [role="button"]:active,
        .clickable:active {
            background-color: transparent !important;
            transform: none !important;
            box-shadow: none !important;
            outline: none !important;
        }

        button:focus,
        .btn:focus,
        [role="button"]:focus,
        .clickable:focus {
            outline: none !important;
            box-shadow: none !important;
        }

        .header-icon-btn .icon-text {
            font-family: var(--font-sans);
            font-size: 10px; /* 12px → 10px */
            font-weight: 500; /* Medium */
            color: #1A254F;
            margin-top: 1px;
            line-height: 1.2;
        }

        [data-theme="dark"] .header-icon-btn .icon-text {
            color: #31a3fa;
        }
        
        /* 큰글씨 모드에서 헤더 아이콘 텍스트 크기 조정 */
        .main-page-content.fs-150 ~ .app-header .icon-text {
            font-size: 9px !important;
            line-height: 1.1 !important;
        }
        
        /* 큰글씨 모드에서 브랜드 제목 크기 조정 */
        .main-page-content.fs-150 ~ .app-header .brand-title {
            font-size: 20px !important;
            line-height: 1.2 !important;
        }

        .notification-badge {
            position: absolute;
            top: 1px;
            right: 1px;
            background-color: #ff4444;
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            font-size: 9px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #f8f9fa;
            min-width: 16px;
            min-height: 16px;
            transition: all 0.3s ease;
            transform-origin: center;
        }

        /* 알림 배지 숨김 상태 */
        .notification-badge.hidden {
            opacity: 0;
            transform: scale(0);
        }

        /* 알림 배지 카운트 증가 애니메이션 */
        .notification-badge.count-up {
            animation: countUp 0.5s ease-out;
        }

        @keyframes countUp {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.3);
            }
            100% {
                transform: scale(1);
            }
        }

        /* 따릉따릉 애니메이션 */
        .bell-shake {
            animation: bellShake 0.6s ease-in-out;
        }

        @keyframes bellShake {
            0%, 100% {
                transform: rotate(0deg);
            }
            10%, 30%, 50%, 70%, 90% {
                transform: rotate(-10deg);
            }
            20%, 40%, 60%, 80% {
                transform: rotate(10deg);
            }
        }

        /* 알림 배지 깜빡임 효과 */
        .notification-badge.pulse {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(255, 68, 68, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(255, 68, 68, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(255, 68, 68, 0);
            }
        }

        /* 메인 컨텐츠 영역 */
        .main-content {
            flex: 1;
            height: 1500px;
            width: 100%;
            max-width: 1200px;
            padding: 135px 18px 91px 18px !important; /* 상단 135px, 좌우 18px, 하단 91px */
            margin: 0 auto !important;
            background-color: var(--bg);
            overflow-y: auto;
            overflow-x: hidden;
            box-sizing: border-box;
            transition: background-color 0.3s ease;
        }

        /* 작은글씨 모드 (100%) */
        body.fs-100 {
            font-size: 16px !important;
            font-weight: 200;
            font-family: 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
        }



        /* 하단 네비게이터 */
        .bottom-nav-wrap {
            position: fixed;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 50;
        }

        .bottom-nav {
            background: var(--card);
            border-top: 1px solid var(--line);
            box-shadow: 0 -6px 16px rgba(17, 24, 39, 0.06);
            height: 72px;
            padding-bottom: env(safe-area-inset-bottom);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-list {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            padding: 0 20px;
            list-style: none;
        }

        .nav-item {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            list-style: none;
        }

        .nav-link {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            color: #6B7280;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform-origin: center;
            padding: 8px 4px;
            min-width: 60px;
            text-align: center;
        }


        .nav-link.active {
            color: #1A254F;
        }

        .nav-link.active .nav-svg,
        .nav-link.active .nav-label {
            color: #1A254F !important;
        }

        /* 통합 전환 */
        .nav-link, .nav-svg, .nav-label {
            transition: all .2s ease-out;
            transform-origin: center;
        }

        /* 호버/클릭/포커스 모두 동일 효과 */
        .nav-link:is(:hover, :active, :focus-visible),
        .nav-link.pressed {
            transform: translateY(-2px) scale(1.05);
        }

        .nav-link:is(:hover, :active, :focus-visible) .nav-svg,
        .nav-link:is(:hover, :active, :focus-visible) .nav-label,
        .nav-link.pressed .nav-svg,
        .nav-link.pressed .nav-label {
            transform: scale(1.05);
            color: #1A254F !important;
        }

        [data-theme="dark"] .nav-link:is(:hover, :active, :focus-visible) .nav-svg,
        [data-theme="dark"] .nav-link:is(:hover, :active, :focus-visible) .nav-label,
        [data-theme="dark"] .nav-link.pressed .nav-svg,
        [data-theme="dark"] .nav-link.pressed .nav-label {
            color: #31a3fa !important;
        }

        /* 터치 기기에서도 동일하게 보이도록 */
        @media (hover: none) {
            .nav-link:active {
                transform: translateY(-2px) scale(1.05);
            }
            .nav-link:active .nav-svg,
            .nav-link:active .nav-label {
                transform: scale(1.05);
            }
        }

        /* active/current 페이지는 색만 유지 */
        .nav-link.active,
        .nav-link[aria-current="page"] {
            color: #1A254F !important;
        }

        .nav-link.active .nav-svg,
        .nav-link.active .nav-label,
        .nav-link[aria-current="page"] .nav-svg,
        .nav-link[aria-current="page"] .nav-label {
            color: #1A254F !important;
        }

        [data-theme="dark"] .nav-link.active .nav-svg,
        [data-theme="dark"] .nav-link.active .nav-label,
        [data-theme="dark"] .nav-link[aria-current="page"] .nav-svg,
        [data-theme="dark"] .nav-link[aria-current="page"] .nav-label {
            color: #6B7280 !important;
        }

        /* 다크모드에서 진행중인 페이지 호버 시 컬러 */
        [data-theme="dark"] .nav-link.active:is(:hover, :active, :focus-visible) .nav-svg,
        [data-theme="dark"] .nav-link.active:is(:hover, :active, :focus-visible) .nav-label,
        [data-theme="dark"] .nav-link[aria-current="page"]:is(:hover, :active, :focus-visible) .nav-svg,
        [data-theme="dark"] .nav-link[aria-current="page"]:is(:hover, :active, :focus-visible) .nav-label {
            color: #31a3fa !important;
        }

        /* 현재 페이지 활성화 표시 제거됨 */

        /* 프로그래싱 관련 스타일 제거됨 */

        /* 애니메이션 키프레임 제거됨 */

        /* 프로그래싱 관련 애니메이션 키프레임 제거됨 */

        /* 작성중 상태 관련 스타일 제거됨 */

        .nav-ico {
            width: 26px;
            height: 26px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .nav-svg {
            width: 24px;
            height: 24px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            flex-shrink: 0;
            color: #6B7280;
        }

        .nav-label {
            font-size: 12px;
            font-weight: 500;
            line-height: 1.2;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            white-space: nowrap;
            text-align: center;
            color: #6B7280;
        }

        /* 확대 모드에서 하단 네비게이터 동적 조정 */
        body.large-text .nav-label {
            font-size: 12px;
        }

        body.large-text .nav-svg {
            width: 22px;
            height: 22px;
        }
        
        /* 큰글씨 모드에서 하단 네비게이터 추가 조정 */
        .main-page-content.fs-150 ~ .bottom-nav .nav-label {
            font-size: 11px !important;
            line-height: 1.2 !important;
        }
        
        .main-page-content.fs-150 ~ .bottom-nav .nav-svg {
            width: 20px !important;
            height: 20px !important;
        }



        /* 메인 컨텐츠 하단 여백 조정 */
        .main-content {
            padding: 135px 18px 91px 18px !important; /* 상단 135px, 좌우 18px, 하단 91px */
            margin: 0 auto !important;
            height: 1500px;
            width: 100%;
            max-width: 1200px;
            overflow-x: hidden;
            box-sizing: border-box;
        }

        /* 메인 페이지 컨텐츠 스타일 */
        .main-page-content {
            max-width: 1200px !important;
            margin: 0 auto !important;
            padding: 0 0 0 0 !important; /* 상단 0px, 좌우 0px, 하단 0px */
        }

        /* 급여현황 탭에서 main-page-content 상단 정렬 */
        #payView .main-page-content {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            justify-content: flex-start;
            padding-top: 0 !important;
            margin-top: 0 !important;
        }

        /* 급여현황탭 상단 여백 완전 제거 */
        #payView {
            margin-top: 0 !important;
            padding-top: 0 !important;
        }

        #payView .payroll-container {
            margin-top: 0 !important;
            padding-top: 0 !important;
        }

        #payView .top-badges {
            margin: 0 auto !important;
            padding: 0 !important;
            max-width: 100% !important;
            width: 100% !important;
            justify-content: center !important;
            display: flex !important;
            gap: 16px !important;
        }

        /* 메인컨텐츠 스크롤 제거 - 전체 스크롤 사용 */
        .main-content {
            height: auto !important;
            max-height: none !important;
            min-height: auto !important;
            overflow: visible !important;
        }

        /* 출력현황탭 전용 설정 */
        #workView .main-content,
        .tab-content:not(#payView) .main-content {
            height: auto !important;
            max-height: none !important;
            min-height: auto !important;
            overflow: visible !important;
        }

        /* 급여현황탭 전용 설정 - 내부 스크롤 완전 제거 */
        #payView .main-content,
        section#payView .main-content,
        .tab-content#payView .main-content {
            height: auto !important;
            max-height: none !important;
            min-height: auto !important;
            overflow: visible !important;
            overflow-y: visible !important;
            overflow-x: hidden !important;
            padding-bottom: 50px !important; /* 하단 여백 추가 */
        }

        /* 빠른메뉴 아이콘 스타일 */
        .quick-menu-icon {
            width: 20px;
            height: 20px;
            object-fit: contain;
            margin-right: 8px;
        }

        /* 빠른메뉴와 공지사항 섹션 간격 적용 - 0px 패딩 */
        #home-quick {
            margin-bottom: 0px !important;
            padding-bottom: 0px !important;
            padding-top: 0px !important;
        }
        #home-quick::after {
            content: "";
            display: block;
            height: 0px;
            width: 100%;
        }
        #home-notice {
            margin-top: 0px !important;
            margin-bottom: 0px !important;
            padding-top: 0px !important;
            padding-bottom: 0px !important;
        }

        /* 빠른메뉴 그리드: 6개 1줄로 복원 */
        #quick-menu.quick-grid{
            display: grid !important;
            grid-template-columns: repeat(6, minmax(0, 1fr)) !important;
            gap: 1px !important;  /* 6개 1줄에 맞는 간격 */
            margin: 0 !important; 
            margin-bottom: 0 !important; /* 하단 마진 제거 */
            padding: 0 !important;
            list-style: none !important;
            justify-items: center !important; 
            align-items: start !important;
        }

        /* 빠른메뉴 아이템 스타일 (quick-item 클래스에 맞게 수정) */
        #quick-menu .quick-item{
            display: flex; flex-direction: column; align-items: center; gap: 1px; width: 100%;
            text-decoration: none; color: inherit;
            border-radius: 10px;
            transition: all 0.2s ease;
            padding: 4px;  /* 패딩을 4px로 설정 */
        }


        /* 빠른메뉴 아이콘 스타일 */
        .qm-icon {
            width: 46px;
            height: 46px;
            object-fit: contain;
            transition: transform 0.3s ease;
        }

        /* 빠른메뉴 제목 스타일 */
        .section-title {
            font-family: 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
            font-size: 20px;
            font-weight: 600;
            color: #1A254F;
            margin: 0;
            line-height: 1.2;
        }

        /* 빠른메뉴 텍스트 스타일 */
        #quick-menu .quick-item span {
            font-family: 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: #1A254F;
            text-align: center;
            line-height: 1.2;
            margin: 0 !important;
            padding: 10px 4px !important; /* 상하 10px, 좌우 4px */
            transition: color 0.3s ease;
        }

        /* 공지사항 박스 오른쪽 텍스트 붙는 현상 방지: 내부 여백 보강 */
        .notice-card{ 
            padding: 0 18px !important; /* 상단/하단 0px, 좌우 18px */
            height: 46px !important;
            display: flex !important;
            align-items: center !important;
            box-sizing: border-box; 
            margin-top: 0 !important; /* 상단 마진 제거 */
            margin-bottom: 0 !important; /* 하단 마진은 상위 섹션에서 처리 */
        }
        .notice-content{ padding-right: 16px !important; }

        .notice-icon {
            font-size: 20px;
            margin-right: 8px;
        }

        .notice-title {
            font-size: 20px;
            font-weight: 600;
            color: #1A254F;
        }

        .notice-content {
            position: relative;
            min-height: 24px;
            overflow: visible;
            padding: 0;
        }

        .notice-item {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            opacity: 0;
            transform: translateY(100%);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .notice-item.active {
            opacity: 1;
            transform: translateY(0);
        }

        .notice-item.prev {
            opacity: 0;
            transform: translateY(-100%);
        }


        /* Tag Label 스타일 - 슬라브 버튼과 동일한 폰트 */
        .tag-label {
            font-family: 'Noto Sans KR', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
            font-size: 16px !important;
            font-weight: 700;
            line-height: 1.2;
            color: #1A254F;
        }

        /* Strong 태그 내부 폰트 크기 강제 적용 (중복 방지를 위한 추가 선언) */
        strong.tag-label {
            font-size: 16px !important;
        }

        /* 공지사항 박스 새 글 추가 효과 */
        @keyframes noticeBoxHighlight {
            0% { 
                background-color: var(--card);
                transform: scale(1);
            }
            50% { 
                background-color: rgba(0, 104, 254, 0.05);
                transform: scale(1.02);
            }
            100% { 
                background-color: var(--card);
                transform: scale(1);
            }
        }
        
        .notice-card.highlight {
            animation: noticeBoxHighlight 1.5s ease-out;
        }

        /* 다크모드에서 빠른메뉴 항목 폰트 색상 적용 */
        [data-theme="dark"] #quick-menu .quick-item span{
            color: #31a3fa !important;        /* 다크모드에서 터콰이즈 색상으로 변경 */
        }

        /* 다크모드에서 빠른메뉴 개별 색상 적용 - 최고 우선순위 */
        body[data-theme="dark"] #quick-menu .quick-item:nth-child(2) span,  /* 작업일지 */
        body[data-theme="dark"] #quick-menu .quick-item:nth-child(6) span { /* 재고관리 */
            color: #31a3fa !important;        /* 다크모드에서 터콰이즈 색상으로 변경 */
        }


        [data-theme="dark"] #quick-menu .quick-item:nth-child(3) span,  /* 현장정보 */
        [data-theme="dark"] #quick-menu .quick-item:nth-child(5) span { /* 본사요청 */
            color: #31a3fa !important;        /* 다크모드에서 터콰이즈 색상으로 변경 */
        }

        
        /* 공지사항 태그는 기존 색상 유지 */
        [data-theme="dark"] .tag-label {
            color: #31a3fa !important;  /* 청록색 (#31a3fa) */
        }

        /* 드로우메뉴 메뉴 아이템 호버 효과 제거 (홈, 출력현황, 작업일지, 현장정보, 문서함) */
        .drawer .menu-item[href="main.html"]:hover,
        .drawer .menu-item[href="worklog.html"]:hover,
        .drawer .menu-item[href="task.html"]:hover,
        .drawer .menu-item[href="site.html"]:hover,
        .drawer .menu-item[href="doc.html"]:hover {
            transform: none !important;
            box-shadow: none !important;
            background-color: transparent !important;
            color: var(--text) !important;
        }

        .drawer .menu-item[href="main.html"]:active,
        .drawer .menu-item[href="worklog.html"]:active,
        .drawer .menu-item[href="task.html"]:active,
        .drawer .menu-item[href="site.html"]:active,
        .drawer .menu-item[href="doc.html"]:active {
            transform: none !important;
            background-color: transparent !important;
        }

        /* 다크모드에서 메뉴 드로우메뉴 카드박스 테두리 제거 */
        [data-theme="dark"] .drawer .menu-item[href="main.html"],
        [data-theme="dark"] .drawer .menu-item[href="worklog.html"],
        [data-theme="dark"] .drawer .menu-item[href="task.html"],
        [data-theme="dark"] .drawer .menu-item[href="site.html"],
        [data-theme="dark"] .drawer .menu-item[href="doc.html"] {
            border: none !important;
            box-shadow: none !important;
        }

        [data-theme="dark"] .drawer .menu-item[href="main.html"]:hover,
        [data-theme="dark"] .drawer .menu-item[href="worklog.html"]:hover,
        [data-theme="dark"] .drawer .menu-item[href="task.html"]:hover,
        [data-theme="dark"] .drawer .menu-item[href="site.html"]:hover,
        [data-theme="dark"] .drawer .menu-item[href="doc.html"]:hover {
            border: none !important;
            box-shadow: none !important;
            transform: none !important;
            background-color: transparent !important;
            color: var(--text) !important;
        }

        /* 검색 버튼 호버 효과 제거 */
        #searchBtn:hover {
            background-color: transparent !important;
            color: inherit !important;
        }

        #searchBtn:active {
            background-color: transparent !important;
            transform: none !important;
        }

        #searchBtn:focus {
            box-shadow: none !important;
        }
        
        /* 다크모드 검색 버튼 호버 효과 제거 */
        [data-theme="dark"] #searchBtn:hover {
            background-color: transparent !important;
            color: inherit !important;
        }
        
        [data-theme="dark"] #searchBtn:active {
            background-color: transparent !important;
            transform: none !important;
        }
        
        [data-theme="dark"] #searchBtn:focus {
            box-shadow: none !important;
        }

        /* 검색 버튼 리플 효과 제거 */
        #searchBtn::before {
            display: none !important;
        }

        #searchBtn.ripple::before {
            display: none !important;
        }

        /* 검색어 입력 박스 높이 40px 설정 - 제거됨 (base.html과 동일하게 통합) */

        /* 검색 전체화면 페이지 */
        .search-page {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100vw;
            height: 100vh;
            z-index: 9999;
            background: var(--card);
            display: none;
            overflow: hidden;
            transition: background-color 0.3s ease;
            -webkit-overflow-scrolling: touch;
            box-sizing: border-box;
        }

        .search-page.active {
            display: block;
        }

        .sp-head {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: var(--card);
            padding: 16px 20px;
            border-bottom: 1px solid var(--line);
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s ease, border-color 0.3s ease;
            z-index: 10;
            height: 80px;
            box-sizing: border-box;
        }

        .sp-back {
            background: transparent;
            border: 1px;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            color: var(--muted);
            font-size: var(--fs-ctl);
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.3s ease;
        }

        .sp-back-text {
            font-family: var(--font-sans);
            font-size: 16px;
            font-weight: 500;
            color: #6B7280;
            line-height: var(--lh);
        }

        .sp-back:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .sp-back:active {
            transform: translateY(1px) scale(0.98);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .sp-input-wrap {
            flex: 1;
            position: relative;
        }

        .sp-input {
            width: 100%;
            height: 40px;
            padding: 0 18px 0 50px;
            border: 1px solid var(--line);
            border-radius: 20px;
            font-family: var(--font-sans);
            font-size: var(--fs-ctl);
            font-weight: 500;
            background: var(--card);
            color: var(--text);
            outline: none;
            transition: all 0.2s ease;
            line-height: 1.4;
            -webkit-autofill: none;
            -webkit-box-shadow: 0 0 0 1000px var(--card) inset;
            box-shadow: 0 0 0 1000px var(--card) inset;
            -webkit-text-fill-color: var(--text);
            box-sizing: border-box;
        }

        .sp-input::-webkit-search-cancel-button,
        .sp-input::-webkit-search-decoration,
        .sp-input::-webkit-search-results-button,
        .sp-input::-webkit-search-results-decoration {
            display: none;
            -webkit-appearance: none;
        }

        .sp-input:focus {
            border-color: #31a3fa;
            box-shadow: 0 0 0 2px rgba(49, 163, 250, 0.2);
            -webkit-box-shadow: 0 0 0 2px rgba(49, 163, 250, 0.2), 0 0 0 1000px var(--card) inset;
        }

        /* 다크모드에서 검색 입력 필드 포커스 색상 변경 */
        [data-theme="dark"] .sp-input:focus {
            border-color: #31a3fa !important;
            box-shadow: 0 0 0 2px rgba(0, 188, 212, 0.2) !important;
            -webkit-box-shadow: 0 0 0 2px rgba(0, 188, 212, 0.2), 0 0 0 1000px var(--card) inset !important;
        }

        .sp-input:-webkit-autofill,
        .sp-input:-webkit-autofill:hover,
        .sp-input:-webkit-autofill:focus,
        .sp-input:-webkit-autofill:active {
            -webkit-box-shadow: 0 0 0 1000px var(--card) inset;
            -webkit-text-fill-color: var(--text);
            transition: background-color 5000s ease-in-out 0s;
        }

        .sp-input::placeholder {
            color: #31a3fa;
            font-size: 16px;
            font-weight: 400;
            line-height: 1.4;
        }

        .sp-icon {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: #6b7280;
            width: 20px;
            height: 20px;
            pointer-events: none;
        }

        /* 다크모드에서 검색 아이콘 색상 변경 */
        [data-theme="dark"] .sp-icon {
            color: #31a3fa !important;
        }

        .sp-body {
            padding: 24px 20px;
            padding-top: 104px; /* 헤더 높이(80px) + 여백(24px) */
            height: calc(100vh - 80px);
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .sp-section-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 20px;
            font-weight: 600; /* Semi-Bold */
            color: #1A1A1A;
            margin-bottom: 16px;
            line-height: 1.4;
        }

        .sp-list {
            display: flex;
            flex-direction: column;
        }

        .sp-list.recent-keywords {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            gap: 8px;
        }

        .sp-row.recent-keyword {
            display: inline-flex;
            align-items: center;
            height: 32px;
            padding: 0 16px;
            background-color: rgba(0, 104, 254, 0.1);
            border: 1px solid rgba(0, 104, 254, 0.1);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin: 0;
            gap: 0;
        }

        /* 다크모드에서 최근 검색어 태그 색상 변경 */
        [data-theme="dark"] .sp-row.recent-keyword {
            background-color: rgba(0, 188, 212, 0.1) !important;
            border: 1px solid rgba(0, 188, 212, 0.1) !important;
        }

        .sp-row.recent-keyword:hover {
            background-color: rgba(0, 104, 254, 0.15);
            border-color: var(--accent);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 104, 254, 0.15);
        }

        /* 다크모드에서 최근 검색어 태그 호버 효과 변경 */
        [data-theme="dark"] .sp-row.recent-keyword:hover {
            background-color: rgba(0, 188, 212, 0.15) !important;
            border-color: #31a3fa !important;
            box-shadow: 0 2px 8px rgba(0, 188, 212, 0.15) !important;
        }

        .sp-row.recent-keyword:active {
            transform: translateY(0);
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2);
            transition: all 0.1s ease;
        }

        .sp-row.recent-keyword .sp-num {
            display: none;
        }

        .sp-row.recent-keyword .sp-item {
            font-family: var(--font-sans);
            font-size: var(--fs-ctl);
            font-weight: 500;
            color: #31a3fa;
            line-height: var(--lh);
        }

        /* 다크모드에서 최근 검색어 태그 텍스트 색상 변경 */
        [data-theme="dark"] .sp-row.recent-keyword .sp-item {
            color: #31a3fa !important;
        }

        .sp-row {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 10px 0;
            border-bottom: 1px solid #e5e7eb;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 0;
            margin: 0;
        }

        .sp-row:hover {
            background-color: rgba(26, 37, 79, 0.05);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        /* 다크모드에서 검색 결과 행 호버 효과 변경 */
        [data-theme="dark"] .sp-row:hover {
            background-color: rgba(0, 188, 212, 0.05) !important;
            box-shadow: 0 2px 8px rgba(0, 188, 212, 0.1) !important;
        }

        /* 다크모드에서 검색 결과 텍스트 색상 */
        [data-theme="dark"] .sp-row {
            color: #E5E7EB !important;
        }

        [data-theme="dark"] .sp-item {
            color: #E5E7EB !important;
        }

        [data-theme="dark"] .sp-num {
            color: #9CA3AF !important;
        }

        .sp-row:active {
            transform: translateY(0);
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2);
            transition: all 0.1s ease;
        }

        .sp-row.active {
            background-color: rgba(26, 37, 79, 0.08);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        /* 다크모드에서 검색 결과 행 활성 상태 색상 변경 */
        [data-theme="dark"] .sp-row.active {
            background-color: rgba(0, 188, 212, 0.08) !important;
            box-shadow: 0 2px 8px rgba(0, 188, 212, 0.1) !important;
        }

        .sp-row.clicked {
            animation: searchButtonRipple 0.6s ease-out;
        }

        @keyframes searchButtonRipple {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(26, 37, 79, 0.4); }
            50% { transform: scale(1.02); box-shadow: 0 0 0 8px rgba(26, 37, 79, 0.1); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(26, 37, 79, 0); }
        }

        /* 다크모드에서 검색 버튼 리플 애니메이션 변경 */
        [data-theme="dark"] .sp-row.clicked {
            animation: searchButtonRippleDark 0.6s ease-out;
        }

        @keyframes searchButtonRippleDark {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(0, 188, 212, 0.4); }
            50% { transform: scale(1.02); box-shadow: 0 0 0 8px rgba(0, 188, 212, 0.1); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(0, 188, 212, 0); }
        }

        .search-ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.35);
            transform: scale(0);
            animation: searchRipple 0.45s ease-out;
            pointer-events: none;
        }

        /* 다크모드에서 검색 리플 효과 변경 */
        [data-theme="dark"] .search-ripple {
            background: rgba(0, 188, 212, 0.35) !important;
        }

        @keyframes searchRipple {
            to { transform: scale(1); opacity: 0; }
        }

        .sp-num {
            width: 24px;
            text-align: left;
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 16px;
            font-weight: 500;
            color: #31a3fa;
            line-height: 1.4;
            flex-shrink: 0;
        }

        .sp-item {
            font-family: 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
            font-size: 16px;
            font-weight: 400; /* Regular */
            color: #1a1a1a;
            line-height: 1.4;
            flex: 1;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .sp-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: #6b7280;
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 16px;
            font-weight: 400;
        }

        .sp-loading::before {
            content: '';
            width: 16px;
            height: 16px;
            border: 2px solid #e5e7eb;
            border-top-color: #31a3fa;
            border-radius: 50%;
            margin-right: 8px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .sp-item:hover {
            background-color: #f8f9fa;
        }

        .sp-item:active {
            transform: translateY(1px) scale(0.98);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        /* 알림 팝업 스타일 */
        .notification-popup {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.45);
            backdrop-filter: blur(4px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1001;
            transition: background-color 0.3s ease;
        }
        
        [data-theme="dark"] .notification-popup {
            background: rgba(0, 0, 0, 0.7);
        }

        .notification-popup.show {
            display: flex;
        }

        .notification-popup.hidden {
            display: none;
        }

        .notification-popup-content {
            width: min(480px, 92vw);
            background: var(--card);
            border-radius: 24px;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.25);
            padding: 20px;
            margin: 0 20px;
            animation: fadeIn 0.28s ease-out;
            max-height: 80vh;
            overflow-y: auto;
            transition: background-color 0.3s ease;
        }

        .notification-popup-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--line);
            transition: border-color 0.3s ease;
        }

        .notification-popup-header h3 {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 600; /* Semi-Bold */
            font-size: 20px;
            color: var(--text);
            margin: 0;
            line-height: 1.4;
            transition: color 0.3s ease;
        }

        .notification-popup-close {
            padding: 8px 16px;
            border: 1px solid var(--line);
            background: var(--card);
            color: var(--text);
            border-radius: 8px;
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 16px;
            font-weight: 500; /* Medium */
            cursor: pointer;
            transition: all 0.2s ease;
            height: auto;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            line-height: 1.4;
        }

        .notification-popup-close:hover {
            background: rgba(26, 37, 79, 0.1);
            border-color: #1A254F;
            color: #1A254F;
        }

        [data-theme="dark"] .notification-popup-close:hover {
            background: rgba(0, 188, 212, 0.1);
            border-color: #31a3fa;
            color: #31a3fa;
        }

        .notification-popup-close:active {
            transform: translateY(1px) scale(0.98);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .notification-popup-body {
            padding: 8px 2px 16px;
        }

        .notification-content p {
            margin: 0 0 16px;
            color: var(--muted);
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 16px;
            font-weight: 400; /* Regular */
            transition: color 0.3s ease;
            text-align: center;
            line-height: 1.4;
        }

        .notification-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 20px;
        }

        .notification-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px;
            background: #f8fafc;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        [data-theme="dark"] .notification-item {
            background: var(--card);
            border: 1px solid var(--line);
        }

        .notification-icon {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
            margin-top: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .notification-icon svg {
            color: #3b82f6;
        }

        .notification-text {
            flex: 1;
        }

        .notification-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 600; /* Semi-Bold */
            font-size: 20px;
            color: #1A254F;
            margin-bottom: 4px;
            line-height: 1.4;
            transition: color 0.3s ease;
        }

        [data-theme="dark"] .notification-title {
            color: var(--text);
        }

        .notification-desc {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 16px !important;
            font-weight: 400; /* Regular */
            color: #6B7280;
            line-height: 1.4;
            transition: color 0.3s ease;
        }

        [data-theme="dark"] .notification-desc {
            color: var(--muted);
        }

        .notification-popup-footer {
            display: flex;
            gap: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--line);
            transition: border-color 0.3s ease;
        }

        .notification-btn {
            flex: 1;
            height: 44px;
            border-radius: 8px;
            border: none;
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 16px;
            font-weight: 500; /* Medium */
            cursor: pointer;
            transition: all 0.2s ease;
            line-height: 1.4;
        }

        .notification-btn-secondary {
            background: #f8f9fa;
            color: #1A1A1A;
            border: 1px solid #e6eaf2;
        }

        .notification-btn-secondary:hover {
            background: #e9ecef;
        }

        .notification-btn-secondary:active {
            transform: translateY(1px) scale(0.98);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .notification-btn-primary {
            background: #1A254F;
            color: #ffffff;
            transition: background-color 0.3s ease;
        }

        .notification-btn-primary:hover {
            background: #1A254F;
            opacity: 0.8;
        }

        [data-theme="dark"] .notification-btn-primary {
            background: #31a3fa;
            color: #0F172A;
        }

        [data-theme="dark"] .notification-btn-primary:hover {
            background: #31a3fa;
            color: #0F172A;
        }

        .notification-btn-primary:active {
            transform: translateY(1px) scale(0.98);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* 햄버거 드로어 스타일 */
        .drawer-scrim {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.35);
            display: none;
            z-index: 1400;
        }

        .drawer-scrim.show {
            display: block;
        }

        .drawer {
            position: fixed;
            top: 0;
            left: -320px;
            width: 320px;
            max-width: calc(100vw - 40px);
            min-width: 280px;
            height: 100vh;
            background: var(--card);
            box-shadow: 4px 0 24px rgba(0, 0, 0, 0.18);
            z-index: 1500;
            display: none;
            flex-direction: column;
            transition: left 0.28s ease-out, background-color 0.3s ease;
            font-family: 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
            overflow: hidden;
            contain: layout paint;
            isolation: isolate;
            padding: calc(12px + env(safe-area-inset-top, 0px)) 12px calc(16px + env(safe-area-inset-bottom, 0px));
        }

        .drawer.show {
            display: flex;
            left: 0;
            padding: 16px 16px 0 16px;
        }

        .drawer-body {
            padding: 0;
            flex: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            color: var(--text);
        }

        .drawer-scale {
            transform-origin: top center;
            will-change: transform;
            padding: 0 16px;
            min-height: 100%;
            width: 100%;
            box-sizing: border-box;
            overflow-x: hidden;
        }

        .profile-sec {
            display: flex;
            flex-direction: column;
            margin: 10px 0 16px;
            gap: 8px;
            width: 100%;
            box-sizing: border-box;
        }

        .profile-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
        }

        .profile-name {
            font: 600 20px/1.2 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
            color: var(--text);
            transition: color 0.3s ease;
        }

        .important-tag {
            display: inline-block;
            background: rgba(49, 163, 250, 0.1);
            color: #31a3fa;
            padding: 8px 16px;
            border-radius: 16px;
            font-size: 14px !important;
            font-weight: 600;
            font-family: 'Noto Sans KR', sans-serif;
            line-height: 1.2;
            margin: 0;
            white-space: nowrap;
        }

        [data-theme="dark"] .important-tag {
            background: rgba(49, 163, 250, 0.2);
            color: #31a3fa;
        }

        .profile-email {
            font: 400 13px 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
            color: var(--muted);
            text-align: left;
            transition: color 0.3s ease;
        }

        .close-btn {
            background-color: var(--card);
            color: var(--text);
            border: 1px solid var(--line);
            border-radius: 10px;
            padding: 8px 16px;
            font-family: 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            background-color: #f5f5f5;
            border-color: #d0d0d0;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        [data-theme="dark"] .close-btn:hover {
            background-color: rgba(0, 188, 212, 0.1);
            border-color: #31a3fa;
            color: #31a3fa;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 188, 212, 0.2);
        }

        /* 드로우메뉴 닫기버튼 강제 적용 */
        #drawerCloseBtn,
        .drawer .close-btn,
        .profile-header .close-btn {
            background-color: var(--card) !important;
            color: var(--text) !important;
            border: 1px solid var(--line) !important;
            border-radius: 10px !important;
            padding: 8px 16px !important;
            font-family: 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif !important;
            font-size: 16px !important;
            font-weight: 500 !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
            height: 40px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        #drawerCloseBtn:hover,
        .drawer .close-btn:hover,
        .profile-header .close-btn:hover {
            background-color: #f5f5f5 !important;
            border-color: #d0d0d0 !important;
            transform: translateY(-1px) !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15) !important;
        }

        [data-theme="dark"] #drawerCloseBtn:hover,
        [data-theme="dark"] .drawer .close-btn:hover,
        [data-theme="dark"] .profile-header .close-btn:hover {
            background-color: rgba(0, 188, 212, 0.1) !important;
            border-color: #31a3fa !important;
            color: #31a3fa !important;
            transform: translateY(-1px) !important;
            box-shadow: 0 2px 8px rgba(0, 188, 212, 0.2) !important;
        }

        .menu-list {
            margin: 8px 0 0;
            padding: 0;
            list-style: none;
            border-top: 1px solid var(--line);
            width: 100%;
            box-sizing: border-box;
            transition: border-color 0.3s ease;
        }

        .menu-item {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            padding: 0;
            height: 40px;
            min-height: 40px;
            margin-bottom: 0;
            color: var(--text);
            text-decoration: none;
            width: 100%;
            box-sizing: border-box;
            word-wrap: break-word;
            overflow-wrap: break-word;
            transition: color 0.3s ease;
            background: transparent !important;
            border: none !important;
            border-radius: 0 !important;
            box-shadow: none !important;
        }

        .menu-item:hover {
            background: transparent;
        }

        .menu-label {
            font-family: 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
            font-size: 16px;
            font-weight: 600;
            line-height: 1.2;
            color: var(--text);
            transform: translateX(0);
            transition: color 0.3s ease;
        }

        .menu-item-with-btn {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0;
            width: 100%;
            box-sizing: border-box;
        }

        .menu-item-with-btn .menu-item {
            padding: 0;
            border-bottom: none;
        }

        .account-manage-btn {
            background: rgba(49, 163, 250, 0.1);
            border: 1px solid rgba(0, 104, 254, 0.3);
            border-radius: 10px;
            padding: 8px 16px;
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 16px;
            font-weight: 500;
            color: #31a3fa;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .account-manage-btn:hover {
            background: rgba(49, 163, 250, 0.15);
            border-color: #31a3fa;
        }

        .account-manage-btn:active {
            background: rgba(49, 163, 250, 0.2);
            transform: scale(0.95);
        }

        [data-theme="dark"] .account-manage-btn {
            background: rgba(49, 163, 250, 0.2);
            border-color: rgba(49, 163, 250, 0.3);
            color: #31a3fa;
        }

        [data-theme="dark"] .account-manage-btn:hover {
            background: rgba(49, 163, 250, 0.3);
            border-color: #31a3fa;
        }

        [data-theme="dark"] .account-manage-btn:active {
            background: rgba(0, 104, 254, 0.4);
        }

        .account-info {
            margin-top: 12px;
            padding: 16px;
            background: rgba(0, 0, 0, 0.03);
            border-radius: 10px;
            border: 1px solid #E5E7EB;
            width: 100%;
            box-sizing: border-box;
        }

        [data-theme="dark"] .account-info {
            background: rgba(255, 255, 255, 0.03);
            border-color: #374151;
        }

        [data-theme="dark"] .account-info-item {
            border-bottom: 1px solid #374151;
        }

        [data-theme="dark"] .account-info-item:last-child {
            border-bottom: none;
        }

        .account-info-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            font-family: 'Noto Sans KR', system-ui, sans-serif;
            font-size: 16px;
            font-weight: 600;
            border-bottom: 1px solid #E5E7EB;
        }

        .account-info-item:last-child {
            border-bottom: none;
        }

        .account-label {
            color: var(--muted);
            transition: color 0.3s ease;
        }

        .account-value {
            color: var(--text);
            font-weight: 600;
            transition: color 0.3s ease;
        }

        .change-password-btn {
            color: #31a3fa !important;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .change-password-btn:hover {
            color: #00ACC1 !important;
        }

        .password-change-form {
            padding: 16px;
            border-bottom: none;
            opacity: 1;
            transform: translateY(0);
            transition: opacity 0.3s ease, transform 0.3s ease;
            min-height: 100vh;
            min-height: 100dvh;
            min-height: 100svh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            width: 100%;
            box-sizing: border-box;
        }

        .password-form-container {
            padding: 16px;
            background: rgba(0, 0, 0, 0.03);
            border-radius: 10px;
            border: 1px solid #E5E7EB;
            position: relative;
            z-index: 1;
            width: 100%;
            box-sizing: border-box;
        }

        [data-theme="dark"] .password-form-container {
            background: rgba(255, 255, 255, 0.03);
            border-color: #374151;
        }

        [data-theme="dark"] .form-input {
            background: #374151;
            border-color: #4B5563;
            color: #F9FAFB;
        }

        [data-theme="dark"] .form-input::placeholder {
            color: #9CA3AF;
        }

        [data-theme="dark"] .cancel-btn {
            background: #374151;
            border-color: #4B5563;
            color: #F9FAFB;
        }

        .form-group {
            margin-bottom: 12px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-family: 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
            font-size: 16px;
            font-weight: 400; /* 본문 일반 텍스트 - Regular */
            color: #6B7280; /* 보조텍스트 */
            line-height: 1.4;
        }

        .form-input {
            width: 100%;
            height: 48px;
            padding: 8px;
            border: 1px solid #E5E7EB;
            border-radius: 8px;
            font-family: 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
            font-size: 14px;
            font-weight: 500; /* 버튼·탭 등 클릭 요소 - Medium */
            background: #FFFFFF;
            color: #1A254F;
            line-height: 1.4;
            transition: border-color 0.3s ease, background-color 0.3s ease, color 0.3s ease;
            box-sizing: border-box;
        }

        .form-input::placeholder {
            color: #9CA3AF;
            font-size: 14px !important; /* 보조 설명 / 캡션 */
            font-weight: 400; /* Regular */
            transition: color 0.3s ease;
            line-height: 1.4;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 2px rgba(0, 104, 254, 0.1);
        }

        [data-theme="dark"] .form-input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 2px rgba(0, 188, 212, 0.2);
        }

        .form-actions {
            display: flex;
            gap: 12px;
            margin-top: 16px;
            width: 100%;
        }

        .cancel-btn {
            flex: 1;
            height: 48px;
            border: 1px solid #E5E7EB;
            border-radius: 10px;
            background: #FFFFFF;
            color: #6B7280;
            font-family: 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
            font-size: 16px !important;
            font-weight: 500; /* 버튼·탭 등 클릭 요소 - Medium */
            line-height: 1.4;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 0;
        }

        .cancel-btn:hover {
            background: var(--muted);
            border-color: var(--muted);
            opacity: 0.1;
        }

        [data-theme="dark"] .cancel-btn:hover {
            background: rgba(0, 188, 212, 0.1);
            border-color: #31a3fa;
        }

        .save-btn {
            flex: 1;
            height: 48px;
            border: none;
            border-radius: 10px;
            background: #31a3fa;
            color: #FFFFFF;
            font-family: 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
            font-size: 16px !important;
            font-weight: 500; /* 버튼·탭 등 클릭 요소 - Medium */
            line-height: 1.4;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 0;
        }

        [data-theme="dark"] .save-btn {
            background: #00ACC1;
            color: #0F172A;
        }

        [data-theme="dark"] .save-btn:hover {
            background: #00ACC1;
            color: #0F172A;
        }

        .save-btn:hover {
            background: #00ACC1;
        }

        .drawer-foot {
            margin-top: auto;
            padding: 16px;
            border-top: 1px solid #E5E7EB;
            padding-bottom: max(50px, env(safe-area-inset-bottom, 0px));
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--card);
            z-index: 1600;
        }

        .logout-btn {
            width: 100%;
            height: 48px;
            border-radius: 10px;
            opacity: 1 !important;
            visibility: visible !important;
            display: block !important;
            border: 1px solid var(--brand);
            background: var(--brand);
            font-family: 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
            font-size: 16px;
            font-weight: 600;
            color: #FFFFFF;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        [data-theme="dark"] .logout-btn {
            color: #0F172A;
        }

        .logout-btn:hover {
            background: #162043;
            border-color: #162043;
            color: #FFFFFF;
        }

        [data-theme="dark"] .logout-btn:hover {
            color: #0F172A;
        }


        /* 반응형 디자인 */
        @media (max-width: 768px) {
            .header-content {
                padding: 0 18px;
                width: 100%;
                box-sizing: border-box;
            }

            .header-content {
                padding: 0 18px;
                width: 100%;
                box-sizing: border-box;
            }
            
            .header-left {
                min-width: 100px;
            }
            
            .header-icon-btn {
                min-width: 32px;
                padding: 0 8px 8px 8px;
                min-height: 32px;
            }
            
            .header-icon-btn .icon-text {
                font-size: 9px;
            }
            
            /* 메인 콘텐츠 반응형 */
            .main-content {
                max-width: 100% !important;
                margin: 0 auto !important;
                padding: 135px 18px 91px 18px !important;
                height: 1500px;
            }
            
            .main-page-content {
                max-width: 100% !important;
                padding: 0 0 0 0 !important;
            }
            
            .sp-input::placeholder {
                font-size: 16px;
            }
            
            /* 모바일 검색창 최적화 */
            .search-page {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                width: 100vw;
                height: 100vh;
                z-index: 9999;
                background: var(--card);
                display: none;
                overflow: hidden;
                -webkit-overflow-scrolling: touch;
                box-sizing: border-box;
            }
            
            .sp-head {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                padding: 12px 16px;
                gap: 8px;
                height: 68px;
                z-index: 10;
                box-sizing: border-box;
            }

            .main-page-content {
                padding: 0 0 0 0 !important; /* 모바일에서도 상단 0px, 좌우 0px, 하단 0px */
            }

            .quick-actions {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }
            
        }

        /* 작은 화면 반응형 (480px 이하) */
        @media (max-width: 480px) {
            .main-content {
                margin: 0 auto !important;
                padding: 135px 18px 91px 18px !important;
                height: 1500px;
            }
            
            .main-page-content {
                padding: 0 0 0 0 !important;
            }
            
            .header-content {
                padding: 0 18px;
            }
            
            .header-icon-btn .icon-text {
                font-size: 8px;
            }
        }

        /* 큰 화면 반응형 (1200px 이상) */
        @media (min-width: 1200px) {
            .main-content {
                margin: 0 auto !important;
                padding: 135px 18px 91px 18px !important;
                height: 1500px;
            }
            
            .main-page-content {
                padding: 0 0 0 0 !important;
            }
        }

        /* ===== 급여명세서 버튼 스타일 (form-actions와 동일) ===== */
        .payslip-buttons {
            display: flex;
            gap: 12px;
            justify-content: space-between;
            margin: 18px auto 12px auto !important; /* 상단 마진 18px로 변경 */
            padding: 0 4px !important;
            max-width: 480px;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }

        .payslip-buttons .btn {
            flex: 1 1 0 !important;
            min-width: 0 !important;
            max-width: none !important;
            width: 100% !important;
            height: 40px;
            padding: 8px 16px;
            border-radius: 8px;
            font-family: 'Noto Sans KR', system-ui, -apple-system, sans-serif;
            font-size: 16px;
            font-weight: 500;
            border: 1px solid #6B7280;
            background: #6B7280;
            color: #FFFFFF;
        }

        .payslip-buttons .btn:hover {
            background: #4B5563;
        }

        .payslip-buttons .btn.dark {
            background: #1A254F;
            color: #FFFFFF;
            border-color: #1A254F;
        }

        .payslip-buttons .btn.dark:hover {
            background: #0F1A3A;
        }

        /* 급여명세서 버튼 아웃라인 스타일 */
        .payslip-buttons .btn.btn-outline {
            background: #FFFFFF !important;
            border: 1px solid #D1D5DB !important;
            color: #374151 !important;
        }

        .payslip-buttons .btn.btn-outline:hover {
            background: #F3F4F6 !important;
            border-color: #9CA3AF !important;
        }

        /* 다크모드 급여명세서 버튼 */
        [data-theme="dark"] .payslip-buttons {
            border: none !important;
            margin-top: 0 !important;
            padding-top: 0 !important;
        }

        /* 급여현황 탭에서 payslip-buttons 하단 마진 */
        #payView .payslip-buttons {
            margin-bottom: 12px !important;
        }

        /* 급여현황 탭에서 main-content-wrapper 하단 마진 */
        #payView .main-content-wrapper {
            margin-bottom: 12px !important;
        }

        /* 급여현황 탭에서 main-content 하단 패딩 조정 */
        #payView .main-content {
            padding-bottom: 0px !important; /* 하단 패딩 0으로 설정 */
            margin-bottom: 12px !important; /* 하단 마진 12px 설정 */
        }

        /* 급여현황 탭에서 payslip-preview-container 잘림 방지 */
        #payView .payslip-preview-container {
            margin-bottom: 0 !important; /* 하단 마진 0 강제 적용 */
            overflow: visible !important; /* 오버플로우 허용 */
            position: relative !important; /* 위치 지정 */
            z-index: 10 !important; /* 다른 요소들 위에 표시 */
        }

        /* 다크모드 급여명세서 버튼 아웃라인 스타일 */
        [data-theme="dark"] .payslip-buttons .btn.btn-outline {
            background: #374151 !important;
            border-color: #4B5563 !important;
            color: #E5E7EB !important;
        }

        [data-theme="dark"] .payslip-buttons .btn.btn-outline:hover {
            background: #4B5563 !important;
            border-color: #6B7280 !important;
        }

        /* ===== 급여명세서 버튼 스타일 (form-actions와 동일) ===== */
        .payslip-buttons {
            display: flex;
            gap: 12px;
            justify-content: space-between;
            margin: 12px auto 12px auto !important;
            padding: 0 4px !important;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }

        .payslip-buttons .btn {
            flex: 1 1 0 !important;
            min-width: 0 !important;
            max-width: none !important;
            width: 100% !important;
            height: 40px;
            border-radius: 8px;
            font-family: var(--font-sans);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid #D1D5DB;
            background: #FFFFFF;
            color: #374151;
        }

        .payslip-buttons .btn:hover {
            background: #4B5563;
        }

        .payslip-buttons .btn.dark {
            background: #1A254F;
            color: #FFFFFF;
            border-color: #1A254F;
        }

        .payslip-buttons .btn.dark:hover {
            background: #0F1A3A;
        }

        /* 급여명세서 버튼 아웃라인 스타일 */
        .payslip-buttons .btn.btn-outline {
            background: #FFFFFF !important;
            border: 1px solid #D1D5DB !important;
            color: #374151 !important;
        }

        .payslip-buttons .btn.btn-outline:hover {
            background: #F3F4F6 !important;
            border-color: #9CA3AF !important;
        }

        /* 다크모드 급여명세서 버튼 */
        [data-theme="dark"] .payslip-buttons {
            border: none !important;
            margin-top: 0 !important;
            padding-top: 0 !important;
        }

        /* 급여현황 탭에서 payslip-buttons 하단 마진 */
        #payView .payslip-buttons {
            margin-bottom: 12px !important;
        }

        /* 급여현황 탭에서 main-content-wrapper 하단 마진 */
        #payView .main-content-wrapper {
            margin-bottom: 12px !important;
        }

        /* 급여현황 탭에서 payslip-preview-container 잘림 방지 */
        #payView .payslip-preview-container {
            margin-bottom: 0 !important; /* 하단 마진 0 강제 적용 */
            overflow: visible !important; /* 오버플로우 허용 */
            position: relative !important; /* 위치 지정 */
            z-index: 10 !important; /* 다른 요소들 위에 표시 */
        }

        /* 다크모드 급여명세서 버튼 아웃라인 스타일 */
        [data-theme="dark"] .payslip-buttons .btn.btn-outline {
            background: #374151 !important;
            border-color: #4B5563 !important;
            color: #E5E7EB !important;
        }

        [data-theme="dark"] .payslip-buttons .btn.btn-outline:hover {
            background: #4B5563 !important;
            border-color: #6B7280 !important;
        }

        /* ===== 급여명세서 미리보기 컨테이너 ===== */
        .payslip-preview-container {
            background: var(--surface);
            border: 1px solid var(--line);
            border-radius: 10px;
            margin: 0 auto 0 auto;
            padding: 18px;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
            box-shadow: var(--shadow-card);
            overflow: visible;
        }

        /* 급여현황 탭에서 payslip-preview-container 잘림 방지 */
        #payView .payslip-preview-container {
            margin-bottom: 0 !important; /* 하단 마진 0 강제 적용 */
            overflow: visible !important; /* 오버플로우 허용 */
            position: relative !important; /* 위치 지정 */
            z-index: 10 !important; /* 다른 요소들 위에 표시 */
        }

        /* ===== 급여명세서 미리보기 ===== */
        #payslipPreview {
            padding: 0 !important;
            font-size: 13px !important;
            max-width: 100%;
            overflow-x: auto;
            box-sizing: border-box;
        }

        .payslip-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-md);
            background: none;
            height: 40px;
            margin-top: 12px;
            margin-bottom: 12px;
        }

        .payslip-header h3 {
            font-family: var(--font-sans);
            font-weight: var(--fw-b);
            font-size: var(--fs-h3);
            color: var(--text);
            margin: 0;
        }

        .payslip-controls {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
        }

        .zoom-controls {
            display: flex;
            align-items: center;
            border: 1px solid #D1D5DB;
            border-radius: 10px;
            background: #FFFFFF;
            overflow: hidden;
            height: 40px;
            padding: 0 8px;
            box-sizing: border-box;
        }

        .zoom-btn {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 10px;
            background: transparent;
            color: var(--text);
            font-family: var(--font-sans);
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .zoom-level {
            font-family: var(--font-sans);
            font-weight: var(--fw-sb);
            font-size: var(--fs-body);
            color: var(--text);
            min-width: 50px;
            text-align: center;
        }

        .close-btn {
            background-color: var(--card);
            color: var(--text);
            border: 1px solid var(--line);
            border-radius: 10px;
            padding: 8px 16px;
            font-family: 'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            width: auto;
            margin-left: 0;
            margin-bottom: 0;
        }

        .zoom-btn:hover {
            background: var(--hover);
        }

        .close-btn:hover {
            background-color: #f5f5f5;
            border-color: #d0d0d0;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        /* ===== 급여명세서 문서 스타일 ===== */
        .payslip-content {
            padding: var(--space-lg);
            background: #fff;
            cursor: grab;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            overflow: auto;
            transform: scale(1);
            transform-origin: left top;
            max-width: 100%;
            box-sizing: border-box;
        }

        .payslip-content:active {
            cursor: grabbing;
        }

        .payslip-content.dragging {
            cursor: grabbing;
        }

        .payslip-document {
            max-width: 430px;
            margin: 0 auto;
            margin-top: -10px;
            font-family: var(--font-sans);
            font-size: 13px;
            color: #333;
            text-align: left;
            background: #ffffff;
            min-height: auto; /* 높이 자동 조정 */
            padding: 0px !important;
            width: 100%;
            max-width: 100%;
            cursor: grab;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            transition: transform 0.1s ease;
            box-sizing: border-box;
        }

        .payslip-document:active {
            cursor: grabbing;
        }

        .payslip-document.dragging {
            cursor: grabbing;
        }

        .payslip-title {
            font-family: var(--font-sans);
            font-weight: 600;
            font-size: 20px;
            color: #0d2a4a;
            margin: 18px 0 4px 0;
            text-align: left;
        }

        .payslip-date {
            font-family: var(--font-sans);
            font-weight: 600;
            font-size: 14px;
            color: #1f5dbd;
            text-decoration: underline;
            text-align: left;
            margin-bottom: 16px;
        }

        .payslip-info-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 16px;
        }

        .payslip-info-table th,
        .payslip-info-table td {
            border: 1px solid #E6ECF4;
            padding: 6px 8px;
            font-family: var(--font-sans);
            font-size: 13px;
            height: 32px;
        }

        .payslip-info-table th {
            background: #f2f6ff;
            font-weight: var(--fw-sb);
            text-align: center;
            font-size: 13px;
        }

        .payslip-info-table td {
            text-align: center;
        }

        .payslip-info-table td:last-child {
            text-align: right;
        }

        .payslip-tables {
            display: flex;
            gap: 0;
            margin-bottom: 16px;
        }

        .payslip-payment-table,
        .payslip-deduction-table {
            flex: 1;
            border-collapse: collapse;
        }

        .payslip-payment-table {
            border-right: none;
        }

        .payslip-deduction-table {
            border-left: none;
        }

        .payslip-payment-table td:last-child,
        .payslip-payment-table th:last-child {
            border-right: 1px solid #E6ECF4;
        }

        .payslip-deduction-table td:first-child,
        .payslip-deduction-table th:first-child {
            border-left: none;
            border-right: 1px solid #E6ECF4;
        }

        .payslip-payment-table th,
        .payslip-payment-table td,
        .payslip-deduction-table th,
        .payslip-deduction-table td {
            border: 1px solid #E6ECF4;
            padding: 6px 8px;
            font-family: var(--font-sans);
            font-size: 14px;
            height: 32px;
        }

        .payslip-payment-table th,
        .payslip-deduction-table th {
            background: #0f3761;
            color: #fff;
            text-align: center;
            font-weight: var(--fw-sb);
            font-size: 13px;
        }

        .payslip-payment-table td,
        .payslip-deduction-table td {
            text-align: center;
        }

        .payslip-payment-table td:last-child,
        .payslip-deduction-table td:last-child {
            text-align: right;
        }

        .payslip-calculation-table {
            width: 100%;
            border-collapse: collapse;
        }

        .payslip-calculation-table th,
        .payslip-calculation-table td {
            border: 1px solid #E6ECF4;
            padding: 6px 8px;
            font-family: var(--font-sans);
            font-size: 14px;
            height: 32px;
        }

        .payslip-calculation-table th {
            background: #0f3761;
            color: #fff;
            text-align: center;
            font-weight: var(--fw-sb);
            font-size: 13px;
        }

        .payslip-calculation-table td {
            text-align: center;
        }

        .payslip-calculation-table td:last-child {
            text-align: right;
        }

        /* 다크모드 */
        [data-theme="dark"] .payslip-preview-container {
            background: var(--surface);
            border-color: var(--line);
        }

        [data-theme="dark"] .payslip-header {
            background: var(--surface);
        }

        [data-theme="dark"] .payslip-header h3 {
            color: var(--text);
        }

        [data-theme="dark"] .zoom-controls {
            background: #374151 !important;
            border-color: #4B5563 !important;
        }

        [data-theme="dark"] .zoom-btn {
            background: transparent;
            color: var(--text);
        }

        [data-theme="dark"] .close-btn {
            background-color: var(--card);
            border-color: var(--line);
            color: var(--text);
        }

        [data-theme="dark"] .close-btn:hover {
            background-color: rgba(0, 188, 212, 0.1);
            border-color: #31a3fa;
            color: #31a3fa;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 188, 212, 0.2);
        }

        [data-theme="dark"] .zoom-level {
            color: var(--text);
        }

        [data-theme="dark"] .payslip-content {
            background: #fff;
        }

        /* 급여명세서 확대 시 가로폭 제한 */
        .payslip-preview-container .payslip-content {
            max-width: 100%;
            overflow-x: auto;
        }

        .payslip-preview-container .payslip-document {
            max-width: 100%;
            overflow-x: auto;
        }

        /* 급여명세서 테이블 가로폭 제한 */
        .payslip-preview-container .payslip-info-table,
        .payslip-preview-container .payslip-payment-table,
        .payslip-preview-container .payslip-deduction-table,
        .payslip-preview-container .payslip-calculation-table {
            max-width: 100%;
            table-layout: fixed;
            word-wrap: break-word;
        }

        /* 모바일 급여명세서 프리뷰 최적화 */
        @media (max-width: 768px) {
            .payslip-preview-container {
                width: 100% !important;
                max-width: 100% !important;
                margin: 0 auto !important;
                padding: 0 8px !important;
                box-sizing: border-box !important;
            }

            .payslip-content {
                width: 100% !important;
                max-width: 100% !important;
                overflow-x: auto !important;
                box-sizing: border-box !important;
            }

            .payslip-document {
                width: 100% !important;
                max-width: 100% !important;
                margin: 0 auto !important;
                box-sizing: border-box !important;
            }

            .payslip-info-table,
            .payslip-payment-table,
            .payslip-deduction-table,
            .payslip-calculation-table {
                width: 100% !important;
                max-width: 100% !important;
                table-layout: fixed !important;
                word-wrap: break-word !important;
                box-sizing: border-box !important;
            }
        }

        @media (max-width: 480px) {
            .payslip-preview-container {
                padding: 0 4px !important;
            }

            .payslip-document {
                font-size: 12px !important;
            }

            .payslip-info-table th,
            .payslip-info-table td,
            .payslip-payment-table th,
            .payslip-payment-table td,
            .payslip-deduction-table th,
            .payslip-deduction-table td,
            .payslip-calculation-table th,
            .payslip-calculation-table td {
                padding: 4px 6px !important;
                font-size: 12px !important;
            }
        }

        .payslip-title {
            font-family: var(--font-sans);
            font-weight: 600;
            font-size: 20px;
            color: #0d2a4a;
            margin: 18px 0 4px 0;
            text-align: left;
        }

        .payslip-date {
            font-family: var(--font-sans);
            font-weight: 600;
            font-size: 14px;
            color: #1f5dbd;
            text-decoration: underline;
            text-align: left;
            margin-bottom: 16px;
        }

        .payslip-info-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 16px;
        }

        .payslip-info-table th,
        .payslip-info-table td {
            border: 1px solid #E6ECF4;
            padding: 6px 8px;
            font-family: var(--font-sans);
            font-size: 13px;
            height: 32px;
            vertical-align: middle;
        }

        .payslip-info-table th {
            background: #f2f6ff;
            font-weight: var(--fw-sb);
            text-align: center;
            font-size: 13px;
        }

        .payslip-info-table td {
            text-align: center;
        }

        .payslip-info-table td:last-child {
            text-align: right;
        }

        .payslip-tables {
            display: flex;
            gap: 0;
            margin-bottom: 16px;
        }

        .payslip-payment-table,
        .payslip-deduction-table {
            flex: 1;
            border-collapse: collapse;
        }

        .payslip-payment-table {
            border-right: none;
        }

        .payslip-deduction-table {
            border-left: none;
        }

        .payslip-payment-table td:last-child,
        .payslip-payment-table th:last-child {
            border-right: 1px solid #E6ECF4;
        }

        .payslip-deduction-table td:first-child,
        .payslip-deduction-table th:first-child {
            border-left: none;
            border-right: 1px solid #E6ECF4;
        }

        .payslip-payment-table th,
        .payslip-payment-table td,
        .payslip-deduction-table th,
        .payslip-deduction-table td {
            border: 1px solid #E6ECF4;
            padding: 6px 8px;
            font-family: var(--font-sans);
            font-size: 14px;
            height: 32px;
            vertical-align: middle;
        }

        .payslip-payment-table th,
        .payslip-deduction-table th {
            background: #0f3761;
            color: #fff;
            text-align: center;
            font-weight: var(--fw-sb);
            font-size: 13px;
        }

        .payslip-payment-table td,
        .payslip-deduction-table td {
            text-align: center;
        }

        .payslip-payment-table td:last-child,
        .payslip-deduction-table td:last-child {
            text-align: right;
        }

        .payslip-calculation-table {
            width: 100%;
            border-collapse: collapse;
        }

        .payslip-calculation-table th,
        .payslip-calculation-table td {
            border: 1px solid #E6ECF4;
            padding: 6px 8px;
            font-family: var(--font-sans);
            font-size: 14px;
            height: 32px;
            vertical-align: middle;
        }

        .payslip-calculation-table th {
            background: #0f3761;
            color: #fff;
            text-align: center;
            font-weight: var(--fw-sb);
            font-size: 13px;
        }

        .payslip-calculation-table td {
            text-align: center;
        }

        .payslip-calculation-table td:last-child {
            text-align: right;
        }

    </style>
<style id="logout-fix-css">
/* ===== Logout visibility fix (scoped, non-destructive) ===== */
.drawer-foot{
  position: sticky;
  bottom: 0;
  background: var(--card, #FFFFFF);
  z-index: 1600; /* above drawer-body content */
}
.logout-btn{
  opacity: 1 !important;
  visibility: visible !important;
  color: #FFFFFF !important;
  background: var(--brand, #1A254F) !important;
  border: 1px solid var(--brand, #1A254F) !important;
}
</style>
</head>
<body>
<div class="app-container">
<!-- 상단 헤더 -->
<header class="app-header">
<div class="header-content">
<div class="header-left">
<h1 class="brand-title" id="brandTitle" style="cursor: pointer;">INOPNC</h1>
</div>
<div class="header-center">
<!-- 중앙 영역은 비워둠 -->
</div>
<div class="header-right">
<button aria-label="검색" class="header-icon-btn" id="searchBtn">
<i class="w-5 h-5" data-lucide="search"></i>
<span class="icon-text">검색</span>
</button>
<button aria-label="다크모드" class="header-icon-btn" id="darkModeBtn">
<i class="w-5 h-5" data-lucide="moon" id="darkModeIcon"></i>
<span class="icon-text">다크모드</span>
</button>
<button aria-label="글씨 크기" class="header-icon-btn" id="fontSizeBtn">
<i class="w-5 h-5" data-lucide="type"></i>
<span class="icon-text" id="fontSizeText">작은글씨</span>
</button>
<button aria-label="알림" class="header-icon-btn" id="notificationBtn">
<i class="w-5 h-5" data-lucide="bell" id="bellIcon"></i>
<span class="icon-text">알림</span>
<span class="notification-badge hidden" id="notificationBadge">0</span>
</button>
<button aria-label="메뉴" class="header-icon-btn" id="menuBtn">
<i class="w-5 h-5" data-lucide="menu"></i>
<span class="icon-text">메뉴</span>
</button>
</div>
</div>
</header>


<nav class="tab-navigation">
    <div class="tab-container">
        <button class="tab-button active" data-tab="work">출력현황</button>
        <button class="tab-button" data-tab="pay">급여현황</button>
    </div>
</nav>

<!-- 메인 컨텐츠 -->
<main class="main-content">
    <div class="main-page-content">
        <!-- 현장/년월일 선택 (탭 메뉴 아래) - 출력현황탭에서만 표시 -->
        <div class="site-filter-section" id="siteFilterSection">
            <label class="select-shell">
                <div class="box" id="selectDisplay">전체 현장</div>
                <div class="filter-arrow">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="chevron-down" class="lucide lucide-chevron-down">
                        <path d="m6 9 6 6 6-6"></path>
                    </svg>
                </div>
                <select id="siteSelect">
                    <option selected="">전체 현장</option>
                    <option>Site A</option><option>Site B</option><option>Site C</option>
                </select>
            </label>
            <label class="select-shell">
                <div class="box" id="yearMonthDisplay">2025-09</div>
                <div class="filter-arrow">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="chevron-down" class="lucide lucide-chevron-down">
                        <path d="m6 9 6 6 6-6"></path>
                    </svg>
                </div>
                <select id="yearMonthSelect"><option value="2024-09">2024-09</option><option value="2024-10">2024-10</option><option value="2024-11">2024-11</option><option value="2024-12">2024-12</option><option value="2025-01">2025-01</option><option value="2025-02">2025-02</option><option value="2025-03">2025-03</option><option value="2025-04">2025-04</option><option value="2025-05">2025-05</option><option value="2025-06">2025-06</option><option value="2025-07">2025-07</option><option value="2025-08">2025-08</option><option value="2025-09">2025-09</option><option value="2025-10">2025-10</option><option value="2025-11">2025-11</option><option value="2025-12">2025-12</option><option value="2026-01">2026-01</option><option value="2026-02">2026-02</option><option value="2026-03">2026-03</option><option value="2026-04">2026-04</option><option value="2026-05">2026-05</option><option value="2026-06">2026-06</option><option value="2026-07">2026-07</option><option value="2026-08">2026-08</option><option value="2026-09">2026-09</option></select>
            </label>
        </div>

        <!-- 현장/년월일 선택 (급여현황 탭용) - 출력현황탭과 동일한 위치 -->
        <div class="site-filter-section" id="paySiteFilterSection" style="display: none;">
            <label class="select-shell">
                <div class="box" id="paySelectDisplay">전체 현장</div>
                <div class="filter-arrow">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="chevron-down" class="lucide lucide-chevron-down"><path d="m6 9 6 6 6-6"></path></svg>
                </div>
                <select id="paySiteSelect">
                    <option selected="">전체 현장</option>
                    <option>Site A</option><option>Site B</option><option>Site C</option>
                </select>
            </label>
            <label class="select-shell">
                <div class="box" id="payYearMonthDisplay">2025-09</div>
                <div class="filter-arrow">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="chevron-down" class="lucide lucide-chevron-down"><path d="m6 9 6 6 6-6"></path></svg>
                </div>
                <select id="payYearMonthSelect"><option value="2024-09">2024-09</option><option value="2024-10">2024-10</option><option value="2024-11">2024-11</option><option value="2024-12">2024-12</option><option value="2025-01">2025-01</option><option value="2025-02">2025-02</option><option value="2025-03">2025-03</option><option value="2025-04">2025-04</option><option value="2025-05">2025-05</option><option value="2025-06">2025-06</option><option value="2025-07">2025-07</option><option value="2025-08">2025-08</option><option value="2025-09">2025-09</option><option value="2025-10">2025-10</option><option value="2025-11">2025-11</option><option value="2025-12">2025-12</option><option value="2026-01">2026-01</option><option value="2026-02">2026-02</option><option value="2026-03">2026-03</option><option value="2026-04">2026-04</option><option value="2026-05">2026-05</option><option value="2026-06">2026-06</option><option value="2026-07">2026-07</option><option value="2026-08">2026-08</option><option value="2026-09">2026-09</option><option value="2024-09">2024-09</option><option value="2024-10">2024-10</option><option value="2024-11">2024-11</option><option value="2024-12">2024-12</option><option value="2025-01">2025-01</option><option value="2025-02">2025-02</option><option value="2025-03">2025-03</option><option value="2025-04">2025-04</option><option value="2025-05">2025-05</option><option value="2025-06">2025-06</option><option value="2025-07">2025-07</option><option value="2025-08">2025-08</option><option value="2025-09">2025-09</option><option value="2025-10">2025-10</option><option value="2025-11">2025-11</option><option value="2025-12">2025-12</option><option value="2026-01">2026-01</option><option value="2026-02">2026-02</option><option value="2026-03">2026-03</option><option value="2026-04">2026-04</option><option value="2026-05">2026-05</option><option value="2026-06">2026-06</option><option value="2026-07">2026-07</option><option value="2026-08">2026-08</option><option value="2026-09">2026-09</option></select>
            </label>
        </div>

        <!-- 캘린더 섹션 - 출력현황탭에서만 표시 -->
        <section class="cal-wrap" id="calWrap">
            <div class="cal-head">
                <button id="btnPrev" style="background:none;border:none"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="chevron-left" class="lucide lucide-chevron-left"><path d="m15 18-6-6 6-6"></path></svg></button>
                <button id="ymBtn" class="cal-title" style="background:none;border:none">2025년 9월</button>
                <button id="btnNext" style="background:none;border:none"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="chevron-right" class="lucide lucide-chevron-right"><path d="m9 18 6-6-6-6"></path></svg></button>
            </div>
            <div class="cal-grid">
                <div class="dow sun">일</div><div class="dow">월</div><div class="dow">화</div>
                <div class="dow">수</div><div class="dow">목</div><div class="dow">금</div><div class="dow">토</div>
            </div>
            <div class="cal-grid" id="calGrid"><div class="cell out" data-date="2025-09-31"><div class="date">31</div></div><div class="cell" data-date="2025-09-01"><div class="date">1</div><div class="site-name">전체</div><div class="work-hours">6일</div></div><div class="cell" data-date="2025-09-02"><div class="date">2</div><div class="site-name">전체</div><div class="work-hours">4일</div></div><div class="cell" data-date="2025-09-03"><div class="date">3</div><div class="site-name">전체</div><div class="work-hours">1일</div></div><div class="cell" data-date="2025-09-04"><div class="date">4</div><div class="site-name">전체</div><div class="work-hours">1일</div></div><div class="cell" data-date="2025-09-05"><div class="date">5</div><div class="site-name">전체</div><div class="work-hours">7일</div></div><div class="cell" data-date="2025-09-06"><div class="date">6</div><div class="site-name">전체</div><div class="work-hours">2일</div></div><div class="cell" data-date="2025-09-07"><div class="date sun">7</div><div class="site-name">전체</div><div class="work-hours">3일</div></div><div class="cell" data-date="2025-09-08"><div class="date">8</div><div class="site-name">전체</div><div class="work-hours">2일</div></div><div class="cell" data-date="2025-09-09"><div class="date">9</div><div class="site-name">전체</div><div class="work-hours">1일</div></div><div class="cell" data-date="2025-09-10"><div class="date">10</div><div class="site-name">전체</div><div class="work-hours">5일</div></div><div class="cell" data-date="2025-09-11"><div class="date">11</div><div class="site-name">전체</div><div class="work-hours">3일</div></div><div class="cell" data-date="2025-09-12"><div class="date">12</div><div class="site-name">전체</div><div class="work-hours">7일</div></div><div class="cell" data-date="2025-09-13"><div class="date">13</div><div class="site-name">전체</div><div class="work-hours">6일</div></div><div class="cell" data-date="2025-09-14"><div class="date sun">14</div><div class="site-name">전체</div><div class="work-hours">6일</div></div><div class="cell" data-date="2025-09-15"><div class="date">15</div><div class="site-name">전체</div><div class="work-hours">1일</div></div><div class="cell" data-date="2025-09-16"><div class="date">16</div><div class="site-name">전체</div><div class="work-hours">7일</div></div><div class="cell" data-date="2025-09-17"><div class="date">17</div><div class="site-name">전체</div><div class="work-hours">2일</div></div><div class="cell" data-date="2025-09-18"><div class="date">18</div><div class="site-name">전체</div><div class="work-hours">5일</div></div><div class="cell" data-date="2025-09-19"><div class="date">19</div><div class="site-name">전체</div><div class="work-hours">4일</div></div><div class="cell" data-date="2025-09-20"><div class="date">20</div><div class="site-name">전체</div><div class="work-hours">3일</div></div><div class="cell" data-date="2025-09-21"><div class="date sun">21</div><div class="site-name">전체</div><div class="work-hours">4일</div></div><div class="cell" data-date="2025-09-22"><div class="date">22</div><div class="site-name">전체</div><div class="work-hours">3일</div></div><div class="cell" data-date="2025-09-23"><div class="date">23</div><div class="site-name">전체</div><div class="work-hours">4일</div></div><div class="cell" data-date="2025-09-24"><div class="date">24</div><div class="site-name">전체</div><div class="work-hours">5일</div></div><div class="cell" data-date="2025-09-25"><div class="date">25</div><div class="site-name">전체</div><div class="work-hours">4일</div></div><div class="cell" data-date="2025-09-26"><div class="date">26</div><div class="site-name">전체</div><div class="work-hours">4일</div></div><div class="cell" data-date="2025-09-27"><div class="date">27</div><div class="site-name">전체</div><div class="work-hours">3일</div></div><div class="cell" data-date="2025-09-28"><div class="date sun">28</div><div class="site-name">전체</div><div class="work-hours">1일</div></div><div class="cell" data-date="2025-09-29"><div class="date">29</div><div class="site-name">전체</div><div class="work-hours">1일</div></div><div class="cell" data-date="2025-09-30"><div class="date">30</div><div class="site-name">전체</div><div class="work-hours">1일</div></div><div class="cell out" data-date="2025-09-01"><div class="date">1</div></div><div class="cell out" data-date="2025-09-02"><div class="date">2</div></div><div class="cell out" data-date="2025-09-03"><div class="date">3</div></div><div class="cell out" data-date="2025-09-04"><div class="date">4</div></div><div class="cell out" data-date="2025-09-05"><div class="date">5</div></div><div class="cell out" data-date="2025-09-06"><div class="date">6</div></div><div class="cell out" data-date="2025-09-07"><div class="date">7</div></div><div class="cell out" data-date="2025-09-08"><div class="date">8</div></div><div class="cell out" data-date="2025-09-09"><div class="date">9</div></div><div class="cell out" data-date="2025-09-10"><div class="date">10</div></div><div class="cell out" data-date="2025-09-11"><div class="date">11</div></div></div>
        </section>

        <!-- 통계 (캘린더 아래) - 출력현황탭에서만 표시 -->
        <div class="stats" id="workStats" style="display: none;">
            <div class="stat stat-workdays"><div class="num" id="workDays">18</div><div class="label">총 현장(월)</div></div>
            <div class="stat stat-sites"><div class="num" id="siteCount">3</div><div class="label">총 공수(월)</div></div>
            <div class="stat stat-hours"><div class="num" id="totalManDays">22</div><div class="label">총 출근(월)</div></div>
        </div>

        <!-- 급여현황 탭 콘텐츠 -->
        <section id="payView" class="tab-content" style="display: none;">
            <div class="payroll-container">
                <!-- 상단 3개 배지 -->
                <div class="top-badges" id="topBadges">
                    <div class="badge"><div class="num" id="badgePresent">1</div><div class="label">출근(월)</div></div>
                    <div class="badge"><div class="num" id="badgeOff">30</div><div class="label">휴무일</div></div>
                    <div class="badge"><div class="num" id="badgeUnits">22</div><div class="label">총공수</div></div>
                    </div>

                <!-- 급여 정보 입력 패널 -->
                <div class="panel" id="formPanel">
                    <div class="panel-h">
                        <div class="title">급여 정보 입력</div>
                        <button class="small" id="toggleForm" type="button">열기</button>
                    </div>
                    <div id="formBody" style="display: none;">
                        <div class="grid-2">
                            <div class="field">
                                <label for="daysUnits">실제 공수</label>
                                <input id="daysUnits" class="input" inputmode="numeric" value="22">
                            </div>
                            <div class="field">
                                <label for="daysOff">휴무일(자동)</label>
                                <input id="daysOff" class="input" inputmode="numeric" value="0" readonly>
                            </div>
                        </div>
                        <div class="grid-2">
                            <div class="field">
                                <label for="baseAdmin">기본급(자동)</label>
                                <input id="baseAdmin" class="input" inputmode="numeric" value="220,000">
                            </div>
                            <div class="field">
                                <label for="baseManual">기본급(직접입력)</label>
                                <input id="baseManual" class="input" inputmode="numeric" placeholder="직접입력">
                            </div>
                        </div>
                        <div class="field">
                            <label>고용형태</label>
                            <div class="chips" role="tablist" aria-label="고용형태">
                                <div class="chip" data-role="emp" data-value="freelance" data-rate="3.3" tabindex="0" aria-selected="true" data-active="true">프리</div>
                                <div class="chip" data-role="emp" data-value="daily" data-rate="6.0" tabindex="0" aria-selected="false">일용</div>
                                <div class="chip" data-role="emp" data-value="regular" data-rate="15.4" tabindex="0" aria-selected="false">상용</div>
                            </div>
                            <div class="field" id="customRateField" style="display:none;">
                                <label for="customRate">세율 직접입력 (%)</label>
                                <input id="customRate" class="input" inputmode="numeric" placeholder="세율을 입력하세요">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 요약 카드 -->
                <div class="card">
                    <div class="row"><div class="left">기본급</div><div class="right" id="rowBase">220,000원</div></div>
                    <div class="row"><div class="left">출근(일)</div><div class="right" id="rowPresent">0일</div></div>
                    <div class="row"><div class="left">휴무</div><div class="right negative" id="rowOff">0일</div></div>
                    <div class="row"><div class="left">실제 공수</div><div class="right primary" id="rowUnits">0일</div></div>
                    <div class="row"><div class="left">소득세(<span id="rowTaxRate">3.0</span>%)</div><div class="right negative" id="rowIncomeTax">-0원</div></div>
                    <div class="row"><div class="left">지방소득세(<span id="rowLocalTaxRate">0.3</span>%)</div><div class="right negative" id="rowLocalTax">-0원</div></div>
                    <div class="row"><div class="left"><strong>실 수령액</strong></div><div class="right primary" id="rowNet"><strong>0원</strong></div></div>
                </div>

                <!-- 급여명세서 버튼 -->
                <div class="payslip-buttons payslip-preview-container">
                    <button class="btn btn-outline" id="payslipPreviewBtn">급여명세서 보기</button>
                    <button class="btn dark" id="payslipPdfBtn">PDF 저장</button>
                </div>

            </div>

            <!-- 급여명세서 미리보기 -->
            <div id="payslipPreview" style="display: none;">
                <div class="payslip-header">
                    <h3></h3>
                    <div class="payslip-controls">
                        <div class="zoom-controls">
                            <button class="zoom-btn" id="zoomOut">-</button>
                            <span class="zoom-level" id="zoomLevel">100%</span>
                            <button class="zoom-btn" id="zoomIn">+</button>
            </div>
                        <button class="close-btn" id="closePreview">닫기</button>
                    </div>
                </div>
                <div class="payslip-preview-container">
                    <div class="payslip-content" id="payslipContent">
                    <div class="payslip-document">
                        <h2 class="payslip-title">급여 명세서</h2>
                        <div class="payslip-date" id="payslipDate">2025. 월</div>
                        
                        <table class="payslip-info-table">
                            <tr>
                                <th>성명</th>
                                <td id="payslipName">-</td>
                                <th>지급일</th>
                                <td id="payslipPayDate">2025. .10</td>
                            </tr>
                        </table>
                        
                        <div class="payslip-tables">
                            <table class="payslip-payment-table">
                                <thead>
                                    <tr>
                                        <th>임금지급내역</th>
                                        <th>지급금액(원)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>기본급</td>
                                        <td id="payslipBasicPay">-</td>
                                    </tr>
                                    <tr>
                                        <td><strong>지급액 계</strong></td>
                                        <td id="payslipTotalEarn"><strong>-</strong></td>
                                    </tr>
                                    <tr>
                                        <td>실지급액</td>
                                        <td id="payslipNetPay">-</td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <table class="payslip-deduction-table">
                                <thead>
                                    <tr>
                                        <th>공제내역</th>
                                        <th>지급금액(원)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>소득세</td>
                                        <td id="payslipIncomeTax">-</td>
                                    </tr>
                                    <tr>
                                        <td>지방소득세</td>
                                        <td id="payslipLocalTax">-</td>
                                    </tr>
                                    <tr>
                                        <td><strong>공제액 계</strong></td>
                                        <td id="payslipTotalDeduct"><strong>-</strong></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <table class="payslip-calculation-table">
                            <thead>
                                <tr>
                                    <th>구분</th>
                                    <th>산출식 또는 산출방법</th>
                                    <th>지급액(원)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>기본급</td>
                                    <td id="payslipCalculation">실시간 공수 × 기본급</td>
                                    <td id="payslipCalcAmount">-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    </div>
                </div>
            </div>
            </div>

        </section>

    </div>
</main>

<!-- 검색 전체화면 페이지 -->
<div aria-modal="true" class="search-page" id="searchPage" role="dialog">
<div class="sp-head">
<button aria-label="취소" class="sp-back" id="spBack">
<span class="sp-back-text">취소</span>
</button>
<div class="sp-input-wrap">
<input class="sp-input" id="spInput" placeholder="검색어를 입력하세요." type="text">
<i class="sp-icon" data-lucide="search"></i>
</input></div>
</div>
<div class="sp-body">
<div class="sp-section-title">최근 검색어</div>
<div class="sp-list" id="spList">
<!-- 검색 결과가 여기에 표시됩니다 -->
</div>
</div>
</div>
<!-- 알림 팝업 -->
<div aria-modal="true" class="notification-popup" id="notificationPopup" role="dialog">
<div class="notification-popup-content">
<div class="notification-popup-header">
<h3>알림</h3>
<button class="notification-popup-close" id="notificationClose">닫기</button>
</div>
<div class="notification-popup-body">
<div class="notification-content">
<p>새로운 알림이 있습니다.</p>
</div>
<div class="notification-list" id="notificationList">
<div class="notification-item">
<div class="notification-icon">
<i class="w-5 h-5" data-lucide="bell"></i>
</div>
<div class="notification-text">
<div class="notification-title">시스템 알림</div>
<div class="notification-desc">새로운 업데이트가 있습니다.</div>
</div>
</div>
<div class="notification-item">
<div class="notification-icon">
<i class="w-5 h-5" data-lucide="info"></i>
</div>
<div class="notification-text">
<div class="notification-title">정보 알림</div>
<div class="notification-desc">작업이 완료되었습니다.</div>
</div>
</div>
<div class="notification-item">
<div class="notification-icon">
<i class="w-5 h-5" data-lucide="alert-circle"></i>
</div>
<div class="notification-text">
<div class="notification-title">주의 알림</div>
<div class="notification-desc">확인이 필요한 항목이 있습니다.</div>
</div>
</div>
</div>
</div>
<div class="notification-popup-footer">
<button class="notification-btn notification-btn-primary" id="notificationMore">알림 더보기</button>
</div>
</div>
</div>
<!-- 햄버거 드로어 -->
<div aria-hidden="true" class="drawer-scrim" id="drawerScrim"></div>
<aside aria-hidden="true" aria-modal="true" class="drawer" id="drawer" role="dialog">
<div class="drawer-body">
<div class="drawer-scale">
<div class="profile-sec">
<div class="profile-header">
<div class="profile-name" id="profileUserName">이현수 <span class="important-tag" style="position: relative; top: 0; right: 0; margin-left: 8px;">현장관리자</span></div>
<button class="close-btn" id="drawerCloseBtn" tabindex="0" aria-label="드로우메뉴 닫기">닫기</button>
</div>
<div class="profile-email" id="profileUserEmail">manager@inopnc.com</div>
</div>
<ul class="menu-list">
<li><a class="menu-item" href="main.html"><span class="menu-label">홈</span></a></li>
<li><a class="menu-item" href="worklog.html"><span class="menu-label">출력현황</span></a></li>
<li><a class="menu-item" href="task.html"><span class="menu-label">작업일지</span></a></li>
<li><a class="menu-item" href="site.html"><span class="menu-label">현장정보</span></a></li>
<li><a class="menu-item" href="doc.html"><span class="menu-label">문서함</span></a></li>
<li class="menu-item-with-btn">
<a class="menu-item" href="main.html"><span class="menu-label">내정보</span></a>
<button class="account-manage-btn" id="accountManageBtn">계정관리</button>
</li>
<li class="account-info" id="accountInfo" style="display: none;">
<div class="account-info-item">
<span class="account-label">연락처</span>
<span class="account-value">010-1234-5678</span>
</div>
<div class="account-info-item">
<span class="account-label">가입일</span>
<span class="account-value">2024.01.15</span>
</div>
<div class="account-info-item">
<span class="account-label">비밀번호 변경</span>
<span class="account-value change-password-btn" id="changePasswordBtn">변경하기</span>
</div>
</li>
<li class="password-change-form" id="passwordChangeForm" style="display: none;">
<div class="password-form-container">
<div class="form-group">
<input class="form-input" id="currentPassword" inputmode="text" placeholder="현재 비밀번호를 입력" type="password"/>
</div>
<div class="form-group">
<input class="form-input" id="newPassword" inputmode="text" placeholder="새 비밀번호 (최소 6자)" type="password"/>
</div>
<div class="form-group">
<input class="form-input" id="confirmPassword" inputmode="text" placeholder="새 비밀번호를 다시 입력" type="password"/>
</div>
<div class="form-actions">
<button class="cancel-btn" id="cancelPasswordChange">취소</button>
<button class="save-btn" id="savePasswordChange">저장</button>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="drawer-foot">
<button class="logout-btn" id="drawerLogout" type="button">로그아웃</button>
</div>
</aside>
<!-- 하단 네비게이터 -->
<nav class="bottom-nav-wrap">
<div class="bottom-nav">
<ul class="nav-list">
<li class="nav-item">
<a class="nav-link" data-route="home" href="main.html">
<span class="nav-ico">
<i class="nav-svg" data-lucide="home"></i>
</span>
<span class="nav-label">홈</span>
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-route="output" href="worklog.html">
<span class="nav-ico">
<i class="nav-svg" data-lucide="calculator"></i>
</span>
<span class="nav-label">출력현황</span>
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-route="worklog" href="task.html">
<span class="nav-ico">
<i class="nav-svg" data-lucide="clipboard-list"></i>
</span>
<span class="nav-label">작업일지</span>
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-route="sites" href="site.html">
<span class="nav-ico">
<i class="nav-svg" data-lucide="map"></i>
</span>
<span class="nav-label">현장정보</span>
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-route="docs" href="doc.html">
<span class="nav-ico">
<i class="nav-svg" data-lucide="folder"></i>
</span>
<span class="nav-label">문서함</span>
</a>
</li>
</ul>
</div>
</nav>
</div>
<script>
        // Lucide 아이콘 초기화
        lucide.createIcons();


        // 폰트 로딩 상태 확인 및 fallback 처리
        function checkFontLoading() {
            // Poppins 폰트 로딩 확인
            if ('fonts' in document) {
                document.fonts.load('700 24px Poppins').then(() => {
                    console.log('Poppins 폰트 로딩 완료');
                }).catch(() => {
                    console.log('Poppins 폰트 로딩 실패 - fallback 폰트 사용');
                    // 폰트 로딩 실패 시 fallback 클래스 추가
                    document.body.classList.add('font-loading-fallback');
                });
            }
            
            // Noto Sans KR 폰트 로딩 확인
            if ('fonts' in document) {
                document.fonts.load('400 15px Noto Sans KR').then(() => {
                    console.log('Noto Sans KR 폰트 로딩 완료');
                }).catch(() => {
                    console.log('Noto Sans KR 폰트 로딩 실패 - fallback 폰트 사용');
                });
            }
        }

        // 통합 ESC 키 이벤트 리스너
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                // 검색 페이지 닫기
                const searchPage = document.getElementById('searchPage');
                if (searchPage && searchPage.classList.contains('active')) {
                    searchPage.classList.remove('active');
                    const spInput = document.getElementById('spInput');
                    if (spInput) spInput.value = '';
                    return;
                }
                
                // 알림 팝업 닫기
                const notificationPopup = document.getElementById('notificationPopup');
                if (notificationPopup && notificationPopup.classList.contains('show')) {
                    notificationPopup.classList.remove('show');
                    notificationPopup.classList.add('hidden');
                    return;
                }
                
                // 햄버거 드로어 닫기
                const drawer = document.getElementById('drawer');
                if (drawer && drawer.classList.contains('show')) {
                    const scrim = document.getElementById('drawerScrim');
                    if (scrim) scrim.classList.remove('show');
                    drawer.classList.remove('show');
                    drawer.setAttribute('aria-hidden','true');
                    document.body.classList.remove('modal-open');
                    return;
                }
            }
        });

        // 헤더 기능들
        // 터치/마우스 눌림 효과
        document.addEventListener('pointerdown', e => {
            const a = e.target.closest('.nav-link');
            if (!a) return;
            a.classList.add('pressed');
        });
        document.addEventListener('pointerup', e => {
            document.querySelectorAll('.nav-link.pressed').forEach(el => el.classList.remove('pressed'));
        });
        document.addEventListener('pointercancel', e => {
            document.querySelectorAll('.nav-link.pressed').forEach(el => el.classList.remove('pressed'));
        });

        document.addEventListener('DOMContentLoaded', function() {
            // 페이지 로드 시 폰트 상태 확인
            checkFontLoading();
            
            // 네비게이터 상태 관리 초기화
            initNavigationStatus();
            
            // 자동 저장된 데이터 복원 (폼 초기화 후 실행)
            setTimeout(() => {
                if (typeof restoreAutoSavedData === 'function') {
                restoreAutoSavedData();
                } else {
                    console.warn('restoreAutoSavedData 함수가 정의되지 않았습니다.');
                }
            }, 100);
            
            
            // 검색 페이지 기능
            const searchBtn = document.getElementById('searchBtn');
            const searchPage = document.getElementById('searchPage');
            const spBack = document.getElementById('spBack');
            const spInput = document.getElementById('spInput');
            const spList = document.getElementById('spList');

            // 최근 검색어 데이터 관리
            const RECENT_KEYWORDS_KEY = 'recentSearchKeywords';
            const MAX_RECENT_KEYWORDS = 8;
            
            // 기본 검색어 (처음 사용 시)
            const defaultKeywords = [
                "INOPNC 프로젝트", "현장 관리", "작업 일지", "출력 현황", 
                "문서 관리", "사용자 설정", "알림 설정", "데이터 분석"
            ];

            // 로컬 스토리지에서 최근 검색어 불러오기
            function getRecentKeywords() {
                try {
                    const stored = localStorage.getItem(RECENT_KEYWORDS_KEY);
                    if (stored) {
                        const keywords = JSON.parse(stored);
                        return Array.isArray(keywords) ? keywords : defaultKeywords;
                    }
                } catch (error) {
                    console.error('최근 검색어 불러오기 실패:', error);
                }
                return defaultKeywords;
            }

            // 로컬 스토리지에 최근 검색어 저장하기
            function saveRecentKeywords(keywords) {
                try {
                    localStorage.setItem(RECENT_KEYWORDS_KEY, JSON.stringify(keywords));
                } catch (error) {
                    console.error('최근 검색어 저장 실패:', error);
                }
            }

            // 검색어를 최근 검색어에 추가
            function addToRecentKeywords(keyword) {
                if (!keyword || keyword.trim() === '') return;
                
                const trimmedKeyword = keyword.trim();
                let recentKeywords = getRecentKeywords();
                
                // 이미 존재하는 검색어 제거
                recentKeywords = recentKeywords.filter(k => k !== trimmedKeyword);
                
                // 맨 앞에 추가
                recentKeywords.unshift(trimmedKeyword);
                
                // 최대 개수 제한
                if (recentKeywords.length > MAX_RECENT_KEYWORDS) {
                    recentKeywords = recentKeywords.slice(0, MAX_RECENT_KEYWORDS);
                }
                
                saveRecentKeywords(recentKeywords);
                return recentKeywords;
            }

            if (searchBtn && searchPage && spBack && spInput && spList) {
                // 검색 버튼 클릭 시 검색 페이지 활성화
                searchBtn.addEventListener('click', function(e) {
                    // 리플 효과 추가
                    searchBtn.classList.add('ripple');
                    setTimeout(() => {
                        searchBtn.classList.remove('ripple');
                    }, 300);
                    
                    // 햅틱 피드백 (지원하는 경우)
                    if (navigator.vibrate) {
                        navigator.vibrate(10);
                    }
                    
                    searchPage.classList.add('active');
                    spInput.focus();
                    renderRecentKeywords();
                    console.log('검색 페이지 활성화됨');
                });

                // 뒤로가기 버튼 클릭 시 검색 페이지 닫기
                spBack.addEventListener('click', function() {
                    searchPage.classList.remove('active');
                    spInput.value = '';
                    console.log('검색 페이지 비활성화됨');
                });

                // 검색 입력 처리 (디바운스 적용)
                let searchTimeout;
                let currentIndex = -1;
                let searchResults = [];
                
                spInput.addEventListener('input', function() {
                    const searchTerm = this.value.trim();
                    
                    // 이전 타이머 클리어
                    clearTimeout(searchTimeout);
                    currentIndex = -1;
                    
                    if (searchTerm.length > 0) {
                        // 입력 중일 때 로딩 효과
                        spList.innerHTML = '<div class="sp-loading">검색 중...</div>';
                        
                        // 300ms 후 검색 실행 (디바운스)
                        searchTimeout = setTimeout(() => {
                            console.log('검색어:', searchTerm);
                            performSearch(searchTerm);
                        }, 300);
                    } else {
                        // 빈 값일 때 최근 검색어 표시
                        renderRecentKeywords();
                    }
                });

                // 키보드 네비게이션
                spInput.addEventListener('keydown', function(e) {
                    const rows = spList.querySelectorAll('.sp-row');
                    
                    if (e.key === 'ArrowDown') {
                        e.preventDefault();
                        currentIndex = Math.min(currentIndex + 1, rows.length - 1);
                        updateActiveRow(rows);
                    } else if (e.key === 'ArrowUp') {
                        e.preventDefault();
                        currentIndex = Math.max(currentIndex - 1, -1);
                        updateActiveRow(rows);
                    } else if (e.key === 'Enter') {
                        e.preventDefault();
                        if (currentIndex >= 0 && rows[currentIndex]) {
                            rows[currentIndex].click();
                        } else {
                            const searchTerm = this.value.trim();
                            if (searchTerm.length > 0) {
                                console.log('Enter로 검색:', searchTerm);
                                performSearch(searchTerm);
                            }
                        }
                    } else if (e.key === 'Escape') {
                        e.preventDefault();
                        searchPage.classList.remove('active');
                        spInput.value = '';
                    }
                });
                
                function updateActiveRow(rows) {
                    rows.forEach((row, index) => {
                        row.classList.toggle('active', index === currentIndex);
                    });
                }

                // 최근 검색어 렌더링
                function renderRecentKeywords() {
                    spList.innerHTML = '';
                    spList.className = 'sp-list recent-keywords';
                    const keywords = getRecentKeywords();
                    searchResults = keywords;
                    keywords.forEach((keyword, index) => {
                        const row = document.createElement('div');
                        row.className = 'sp-row recent-keyword';
                        row.innerHTML = `
                            <div class="sp-num">${index + 1}</div>
                            <div class="sp-item">${keyword}</div>
                        `;
                        row.addEventListener('click', function(e) {
                            // 리플 효과 추가
                            const rect = row.getBoundingClientRect();
                            const size = Math.max(rect.width, rect.height);
                            const ripple = document.createElement('span');
                            ripple.className = 'search-ripple';
                            ripple.style.width = ripple.style.height = size + 'px';
                            ripple.style.left = (e.clientX - rect.left - size / 2) + 'px';
                            ripple.style.top = (e.clientY - rect.top - size / 2) + 'px';
                            row.appendChild(ripple);
                            setTimeout(() => ripple.remove(), 460);
                            
                            // 클릭 애니메이션
                            row.classList.add('clicked');
                            setTimeout(() => row.classList.remove('clicked'), 600);
                            
                            // 햅틱 피드백
                            if (navigator.vibrate) {
                                navigator.vibrate(10);
                            }
                            
                            spInput.value = keyword;
                            addToRecentKeywords(keyword);
                            performSearch(keyword);
                        });
                        spList.appendChild(row);
                    });
                }

                // 검색 실행 함수
                function performSearch(searchTerm) {
                    console.log('검색 실행:', searchTerm);
                    
                    // 검색어를 최근 검색어에 추가
                    if (searchTerm && searchTerm.trim() !== '') {
                        addToRecentKeywords(searchTerm.trim());
                    }
                    
                    // 검색 결과 렌더링 (예시)
                    const results = [
                        `"${searchTerm}"에 대한 검색 결과 1`,
                        `"${searchTerm}"에 대한 검색 결과 2`,
                        `"${searchTerm}"에 대한 검색 결과 3`,
                        `"${searchTerm}"에 대한 검색 결과 4`,
                        `"${searchTerm}"에 대한 검색 결과 5`
                    ];
                    
                    spList.innerHTML = '';
                    spList.className = 'sp-list';
                    searchResults = results;
                    results.forEach((result, index) => {
                        const row = document.createElement('div');
                        row.className = 'sp-row';
                        row.innerHTML = `
                            <div class="sp-num">${index + 1}</div>
                            <div class="sp-item">${result}</div>
                        `;
                        row.addEventListener('click', function(e) {
                            // 리플 효과 추가
                            const rect = row.getBoundingClientRect();
                            const size = Math.max(rect.width, rect.height);
                            const ripple = document.createElement('span');
                            ripple.className = 'search-ripple';
                            ripple.style.width = ripple.style.height = size + 'px';
                            ripple.style.left = (e.clientX - rect.left - size / 2) + 'px';
                            ripple.style.top = (e.clientY - rect.top - size / 2) + 'px';
                            row.appendChild(ripple);
                            setTimeout(() => ripple.remove(), 460);
                            
                            // 클릭 애니메이션
                            row.classList.add('clicked');
                            setTimeout(() => row.classList.remove('clicked'), 600);
                            
                            // 햅틱 피드백
                            if (navigator.vibrate) {
                                navigator.vibrate(10);
                            }
                            
                            console.log('검색 결과 클릭:', result);
                        });
                        spList.appendChild(row);
                    });
                }
            }

            // 알림 팝업 기능
            const notificationBtn = document.getElementById('notificationBtn');
            const notificationPopup = document.getElementById('notificationPopup');
            const notificationClose = document.getElementById('notificationClose');
            const notificationMore = document.getElementById('notificationMore');
            const notificationBadge = document.getElementById('notificationBadge');
            const bellIcon = document.getElementById('bellIcon');

            // 알림 카운트 관리
            let notificationCount = 0;
            let unreadCount = 0;

            // 알림 카운트 업데이트 함수
            function updateNotificationCount(count) {
                notificationCount = count;
                if (notificationBadge) {
                    if (count > 0) {
                        notificationBadge.textContent = count > 99 ? '99+' : count;
                        notificationBadge.classList.remove('hidden');
                        notificationBadge.classList.add('count-up');
                        
                        // 카운트 업 애니메이션 완료 후 클래스 제거
                        setTimeout(() => {
                            notificationBadge.classList.remove('count-up');
                        }, 500);
                    } else {
                        notificationBadge.classList.add('hidden');
                    }
                }
            }

            // 따릉따릉 애니메이션 함수
            function triggerBellShake() {
                if (bellIcon) {
                    bellIcon.classList.add('bell-shake');
                    
                    // 애니메이션 완료 후 클래스 제거
                    setTimeout(() => {
                        bellIcon.classList.remove('bell-shake');
                    }, 600);
                }
            }

            // 새 알림 추가 함수 (시뮬레이션용)
            function addNewNotification() {
                unreadCount++;
                updateNotificationCount(unreadCount);
                triggerBellShake();
                
                // 배지에 펄스 효과 추가
                if (notificationBadge) {
                    notificationBadge.classList.add('pulse');
                    setTimeout(() => {
                        notificationBadge.classList.remove('pulse');
                    }, 3000);
                }
                
                console.log(`새 알림 추가됨. 총 ${unreadCount}개`);
            }

            // 알림 읽음 처리 함수
            function markNotificationsAsRead() {
                unreadCount = 0;
                updateNotificationCount(0);
                console.log('모든 알림을 읽음으로 처리');
            }

            if (notificationBtn && notificationPopup) {
                // 알림 버튼 클릭 시 팝업 표시 및 읽음 처리
                notificationBtn.addEventListener('click', function() {
                    notificationPopup.classList.add('show');
                    notificationPopup.classList.remove('hidden');
                    
                    // 알림 팝업을 열면 읽음 처리
                    markNotificationsAsRead();
                    
                    console.log('알림 팝업 표시됨');
                });

                // 닫기 버튼 클릭 시 팝업 숨김
                if (notificationClose) {
                    notificationClose.addEventListener('click', function() {
                        notificationPopup.classList.remove('show');
                        notificationPopup.classList.add('hidden');
                        console.log('알림 팝업 숨김됨');
                    });
                }

                // 알림 더보기 버튼
                if (notificationMore) {
                    notificationMore.addEventListener('click', function() {
                        console.log('알림 더보기 클릭됨');
                        // 알림 더보기 페이지로 이동하거나 추가 알림 로드
                        notificationPopup.classList.remove('show');
                        notificationPopup.classList.add('hidden');
                    });
                }

                // 팝업 외부 클릭 시 닫기
                notificationPopup.addEventListener('click', function(e) {
                    if (e.target === notificationPopup) {
                        notificationPopup.classList.remove('show');
                        notificationPopup.classList.add('hidden');
                    }
                });

                // 시뮬레이션: 새 알림 추가 (테스트용)
                // 실제 환경에서는 서버에서 푸시 알림을 받아서 호출
                window.addTestNotification = addNewNotification;
                
                // 자동 시뮬레이션 (5초마다 새 알림 추가)
                // 실제 환경에서는 제거하고 서버 푸시로 대체
                setInterval(() => {
                    if (Math.random() < 0.3) { // 30% 확률로 새 알림
                        addNewNotification();
                    }
                }, 5000);
            }

            // 햄버거 드로어 기능
            (function(){
                const btn = document.getElementById('menuBtn');
                const scrim = document.getElementById('drawerScrim');
                const drawer = document.getElementById('drawer');
                const drawerScale = document.querySelector('.drawer-scale');
                const closeBtn = document.getElementById('drawerCloseBtn');
                const accountManageBtn = document.getElementById('accountManageBtn');
                const accountInfo = document.getElementById('accountInfo');
                const changePasswordBtn = document.getElementById('changePasswordBtn');
                const passwordChangeForm = document.getElementById('passwordChangeForm');
                const cancelPasswordChange = document.getElementById('cancelPasswordChange');
                const savePasswordChange = document.getElementById('savePasswordChange');
                const drawerLogout = document.getElementById('drawerLogout');
                
                function lockScroll(lock){ 
                    document.body.classList.toggle('modal-open', !!lock); 
                }
                
                function fitDrawer(){
                    if(!drawer || !drawerScale) return;
                    
                    // 모바일에서는 스케일링 비활성화
                    if (window.innerWidth <= 768) {
                        drawerScale.style.transform = 'none';
                        return;
                    }
                    
                    // 가용 높이(패널 패딩/안전영역 감안)
                    const style = getComputedStyle(drawer);
                    const padTop = parseFloat(style.paddingTop);
                    const padBottom = parseFloat(style.paddingBottom);
                    const avail = window.innerHeight - padTop - padBottom;

                    // 실제 콘텐츠 전체 높이
                    const contentH = drawerScale.scrollHeight;

                    // 축소 비율 계산 (최소 0.85 유지)
                    const s = Math.max(0.85, Math.min(1, avail / contentH));
                    drawerScale.style.transform = `scale(${s})`;
                }
                
                function open(){ 
                    scrim.classList.add('show'); 
                    drawer.classList.add('show'); 
                    drawer.setAttribute('aria-hidden','false'); 
                    lockScroll(true);
                    // 열릴 때 자동 축소 적용
                    setTimeout(fitDrawer, 50);
                }
                
                function close(){ 
                    scrim.classList.remove('show'); 
                    drawer.classList.remove('show'); 
                    drawer.setAttribute('aria-hidden','true'); 
                    lockScroll(false); 
                }
                
                // 햄버거 버튼 클릭 시 드로어 열기
                btn?.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    open();
                });
                
                closeBtn?.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    close();
                });
                
                // 드로우메뉴 닫기버튼 키보드 접근성 추가
                closeBtn?.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        e.stopPropagation();
                        close();
                    }
                });
                
                // 드로우메뉴 닫기버튼 포커스 스타일 추가
                closeBtn?.addEventListener('focus', function() {
                    this.style.outline = '2px solid #31a3fa';
                    this.style.outlineOffset = '2px';
                });
                
                closeBtn?.addEventListener('blur', function() {
                    this.style.outline = 'none';
                });
                
                // 드로우메뉴 닫기버튼 스타일 강제 적용
                if (closeBtn) {
                    closeBtn.style.backgroundColor = 'var(--card)';
                    closeBtn.style.color = 'var(--text)';
                    closeBtn.style.border = '1px solid var(--line)';
                    closeBtn.style.borderRadius = '10px';
                    closeBtn.style.padding = '8px 16px';
                    closeBtn.style.fontFamily = "'Noto Sans KR', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif";
                    closeBtn.style.fontSize = '16px';
                    closeBtn.style.fontWeight = '500';
                    closeBtn.style.cursor = 'pointer';
                    closeBtn.style.transition = 'all 0.3s ease';
                    closeBtn.style.boxShadow = '0 1px 3px rgba(0, 0, 0, 0.1)';
                    closeBtn.style.height = '40px';
                    closeBtn.style.display = 'flex';
                    closeBtn.style.alignItems = 'center';
                    closeBtn.style.justifyContent = 'center';
                }
                
                scrim?.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    close();
                });
                
                // 햄버거 메뉴 링크 클릭 이벤트
                const menuItems = document.querySelectorAll('.menu-item');
                menuItems.forEach(item => {
                    item.addEventListener('click', function(e) {
                        const href = this.getAttribute('href');
                        if (href && href !== '#' && !href.startsWith('#')) {
                            e.preventDefault();
                            // 드로어 닫기
                            close();
                            // 페이지 이동
                            setTimeout(() => {
                                window.location.href = href;
                            }, 200);
                        }
                    });
                });
                
                // 뷰포트 변동에 대응
                window.addEventListener('resize', fitDrawer);
                window.visualViewport?.addEventListener('resize', fitDrawer);
                window.visualViewport?.addEventListener('scroll', fitDrawer);
                
                // 모바일 키보드 대응
                if (window.visualViewport) {
                    window.visualViewport.addEventListener('resize', function() {
                        // 키보드가 올라올 때 드로어 높이 조정
                        if (window.visualViewport.height < window.innerHeight) {
                            drawer.style.height = window.visualViewport.height + 'px';
                        } else {
                            drawer.style.height = '100vh';
                        }
                    });
                }
                
                // 계정관리 버튼 클릭
                accountManageBtn?.addEventListener('click', function() {
                    if (accountInfo.style.display === 'none') {
                        accountInfo.style.display = 'block';
                        this.textContent = '접기';
                    } else {
                        accountInfo.style.display = 'none';
                        this.textContent = '계정관리';
                    }
                });
                
                // 비밀번호 변경 버튼 클릭
                changePasswordBtn?.addEventListener('click', function() {
                    passwordChangeForm.style.display = 'block';
                    accountInfo.style.display = 'none';
                    accountManageBtn.textContent = '계정관리';
                });
                
                // 비밀번호 변경 취소
                cancelPasswordChange?.addEventListener('click', function() {
                    // 폼 초기화
                    document.getElementById('currentPassword').value = '';
                    document.getElementById('newPassword').value = '';
                    document.getElementById('confirmPassword').value = '';
                    // 폼 숨기기
                    passwordChangeForm.style.display = 'none';
                    // 계정 정보 다시 보이기
                    accountInfo.style.display = 'block';
                });
                
                // 비밀번호 변경 저장
                savePasswordChange?.addEventListener('click', function() {
                    const currentPassword = document.getElementById('currentPassword').value;
                    const newPassword = document.getElementById('newPassword').value;
                    const confirmPassword = document.getElementById('confirmPassword').value;
                    
                    // 입력값 검증 (공백 제거)
                    const trimmedCurrentPassword = currentPassword.trim();
                    const trimmedNewPassword = newPassword.trim();
                    const trimmedConfirmPassword = confirmPassword.trim();
                    
                    if (!trimmedCurrentPassword) {
                        alert('현재 비밀번호를 입력해주세요.');
                        document.getElementById('currentPassword').focus();
                        return;
                    }
                    
                    if (!trimmedNewPassword) {
                        alert('새 비밀번호를 입력해주세요.');
                        document.getElementById('newPassword').focus();
                        return;
                    }
                    
                    if (!trimmedConfirmPassword) {
                        alert('새 비밀번호 확인을 입력해주세요.');
                        document.getElementById('confirmPassword').focus();
                        return;
                    }
                    
                    // 디버깅을 위한 로그 추가
                    console.log('비밀번호 비교:', {
                        newPassword: `"${trimmedNewPassword}"`,
                        confirmPassword: `"${trimmedConfirmPassword}"`,
                        newPasswordLength: trimmedNewPassword.length,
                        confirmPasswordLength: trimmedConfirmPassword.length,
                        areEqual: trimmedNewPassword === trimmedConfirmPassword
                    });
                    
                    if (trimmedNewPassword !== trimmedConfirmPassword) {
                        alert('새 비밀번호가 일치하지 않습니다.');
                        document.getElementById('confirmPassword').focus();
                        return;
                    }
                    
                    if (trimmedNewPassword.length < 6) {
                        alert('새 비밀번호는 최소 6자 이상이어야 합니다.');
                        document.getElementById('newPassword').focus();
                        return;
                    }
                    
                    if (trimmedCurrentPassword === trimmedNewPassword) {
                        alert('현재 비밀번호와 새 비밀번호가 같습니다.');
                        document.getElementById('newPassword').focus();
                        return;
                    }
                    
                    // 비밀번호 변경 로직 (실제 API 호출)
                    console.log('비밀번호 변경 요청:', {
                        currentPassword: trimmedCurrentPassword,
                        newPassword: trimmedNewPassword
                    });
                    
                    // 성공 시 처리
                    alert('비밀번호가 성공적으로 변경되었습니다.');
                    
                    // 폼 초기화 및 숨기기
                    document.getElementById('currentPassword').value = '';
                    document.getElementById('newPassword').value = '';
                    document.getElementById('confirmPassword').value = '';
                    passwordChangeForm.style.display = 'none';
                    accountInfo.style.display = 'block';
                });
                
                // 로그아웃 버튼 클릭
                drawerLogout?.addEventListener('click', function() {
                    if (confirm('정말 로그아웃하시겠습니까?')) {
                        console.log('로그아웃');
                        // 실제 구현 시 로그아웃 로직
                        alert('로그아웃되었습니다.');
                        close();
                    }
                });
            })();

            // 글씨 크기 토글 버튼 (메인 페이지와 동일한 기능)
                const fontSizeBtn = document.getElementById('fontSizeBtn');
                const fontSizeText = document.getElementById('fontSizeText');
                let isLargeFont = false;
                
                if (fontSizeBtn && fontSizeText) {
                fontSizeBtn.addEventListener('click', function() {
                    isLargeFont = !isLargeFont;
                    
                    // 컨테이너 찾기 (여러 선택자 시도)
                    let container = document.querySelector('.main-page-content');
                    if (!container) {
                        container = document.querySelector('.main-content');
                    }
                    if (!container) {
                        container = document.querySelector('.container');
                    }
                    if (!container) {
                        container = document.querySelector('main');
                    }
                    
                    console.log('찾은 컨테이너:', container);
                        
                        if (isLargeFont) {
                        if (container) {
                            container.classList.add('fs-150');
                            console.log('큰글씨 클래스 추가됨:', container.className);
                        }
                            fontSizeText.textContent = '큰글씨';
                        console.log('큰글씨로 변경됨 (본문 컨테이너에 적용):', container);
                        } else {
                        if (container) {
                            container.classList.remove('fs-150');
                            console.log('큰글씨 클래스 제거됨:', container.className);
                        }
                            fontSizeText.textContent = '작은글씨';
                        console.log('작은글씨로 변경됨 (본문 컨테이너에서 제거):', container);
                    }
                });
            }

            // 다크모드 버튼 기능
            const darkModeBtn = document.getElementById('darkModeBtn');
            const darkModeIcon = document.getElementById('darkModeIcon');
            let isDarkMode = false;

            if (darkModeBtn && darkModeIcon) {
                darkModeBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    isDarkMode = !isDarkMode;
                    
                    if (isDarkMode) {
                        document.documentElement.setAttribute('data-theme', 'dark');
                        darkModeIcon.setAttribute('data-lucide', 'sun');
                        console.log('다크모드로 변경됨');
                    } else {
                        document.documentElement.setAttribute('data-theme', 'light');
                        darkModeIcon.setAttribute('data-lucide', 'moon');
                        console.log('라이트모드로 변경됨');
                    }
                    
                    // Lucide 아이콘 다시 렌더링
                    if (typeof lucide !== 'undefined') {
                        lucide.createIcons();
                    }
                });
            }

            // 하단 네비게이션 기능 (베이스 파일과 100% 동일)
            const navLinks = document.querySelectorAll('.nav-link');
            
            // 현재 페이지에 따른 활성 네비게이션 아이템 설정
            const currentPage = window.location.pathname.split('/').pop() || 'home.html';
            
            navLinks.forEach(link => {
                const href = link.getAttribute('href');
                if (href === currentPage || 
                    (currentPage === 'index.html' && href === 'home.html') ||
                    (currentPage === '' && href === 'home.html')) {
                    link.classList.add('active');
                }
            });

            // 네비게이션 클릭 이벤트
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    const route = this.getAttribute('data-route');
                    const href = this.getAttribute('href');
                    
                    // 해시 링크인 경우 페이지 이동 없이 처리
                    if (href.startsWith('#')) {
                        e.preventDefault();
                        console.log(`${route} 섹션으로 스크롤`);
                        // 해당 섹션으로 스크롤하는 로직 추가
                        return;
                    }
                    
                    // 모든 활성 클래스 제거
                    navLinks.forEach(l => l.classList.remove('active'));
                    // 현재 클릭된 링크에 활성 클래스 추가
                    this.classList.add('active');
                    
                    console.log(`${route} 페이지로 이동: ${href}`);
                });
            });

            // INOPNC 브랜드 타이틀 클릭 시 메인으로 이동
            const brandTitle = document.getElementById('brandTitle');
            if (brandTitle) {
                brandTitle.addEventListener('click', function() {
                    window.location.href = 'main.html';
                });
            }

            // ========== 공지사항 슬라이드 기능 ==========
            function initNoticeSlider() {
                const noticeItems = document.querySelectorAll('.notice-item');
                let currentIndex = 0;
                
                if (noticeItems.length <= 1) return; // 공지사항이 1개 이하면 슬라이드 불필요
                
                function showNextNotice() {
                    // 현재 활성화된 항목을 이전으로 표시
                    noticeItems[currentIndex].classList.remove('active');
                    noticeItems[currentIndex].classList.add('prev');
                    
                    // 다음 인덱스 계산
                    currentIndex = (currentIndex + 1) % noticeItems.length;
                    
                    // 다음 항목을 활성화
                    noticeItems[currentIndex].classList.remove('prev');
                    noticeItems[currentIndex].classList.add('active');
                    
                    // 이전 항목의 prev 클래스 제거 (애니메이션 완료 후)
                    setTimeout(() => {
                        noticeItems.forEach((item, index) => {
                            if (index !== currentIndex) {
                                item.classList.remove('prev');
                            }
                        });
                    }, 400);
                }
                
                // 3초마다 다음 공지사항으로 슬라이드
                setInterval(showNextNotice, 3000);
            }

            // 공지사항 슬라이드 초기화
            initNoticeSlider();

            // ========== 이미지 로딩 오류 처리 ==========
            function handleImageErrors() {
                const quickMenuImages = document.querySelectorAll('#quick-menu .quick-item img');
                
                quickMenuImages.forEach(img => {
                    // 이미지 로딩 실패 시 처리
                    img.addEventListener('error', function() {
                        console.log('이미지 로딩 실패:', this.src);
                        
                        // 로컬 이미지로 대체 시도
                        const altText = this.alt;
                        let fallbackSrc = '';
                        
                        switch(altText) {
                            case '출력현황':
                                fallbackSrc = './public/images/pay.png';
                                break;
                            case '작업일지':
                                fallbackSrc = './public/images/report.png';
                                break;
                            case '현장정보':
                                fallbackSrc = './public/images/map.png';
                                break;
                            case '문서함':
                                fallbackSrc = './public/images/doc.png';
                                break;
                            case '본사요청':
                                fallbackSrc = './public/images/request.png';
                                break;
                            case '재고관리':
                                fallbackSrc = './public/images/stock.png';
                                break;
                            default:
                                fallbackSrc = './public/images/logo_a.png';
                        }
                        
                        // 로컬 이미지로 대체
                        if (fallbackSrc) {
                            this.src = fallbackSrc;
                            this.onerror = null; // 무한 루프 방지
                        }
                    });
                    
                    // 이미지 로딩 성공 시 처리
                    img.addEventListener('load', function() {
                        console.log('이미지 로딩 성공:', this.src);
                    });
                });
            }

        // 이미지 오류 처리 초기화
        handleImageErrors();

        // ========== 빠른메뉴 모바일 인터랙션 처리 ==========
        function initQuickMenuInteractions() {
            console.log('빠른메뉴 인터랙션 초기화 시작');
            const quickItems = document.querySelectorAll('#quick-menu .quick-item');
            console.log(`빠른메뉴 아이템 개수: ${quickItems.length}`);
            
            quickItems.forEach(item => {
                // 모바일에서 pointer 이벤트로 pressed 클래스 토글
                item.addEventListener('pointerdown', function(e) {
                    e.preventDefault();
                    this.classList.add('pressed');
                });
                
                item.addEventListener('pointerup', function(e) {
                    e.preventDefault();
                    this.classList.remove('pressed');
                });
                
                item.addEventListener('pointercancel', function(e) {
                    e.preventDefault();
                    this.classList.remove('pressed');
                });
                
                // 터치 이벤트도 처리 (iOS Safari 호환성)
                item.addEventListener('touchstart', function(e) {
                    e.preventDefault();
                    this.classList.add('pressed');
                });
                
                item.addEventListener('touchend', function(e) {
                    e.preventDefault();
                    this.classList.remove('pressed');
                });
                
                item.addEventListener('touchcancel', function(e) {
                    e.preventDefault();
                    this.classList.remove('pressed');
                });
                
                // 키보드 접근성 개선
                item.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        this.classList.add('pressed');
                    }
                });
                
                item.addEventListener('keyup', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        this.classList.remove('pressed');
                        // 링크 클릭 실행
                        if (e.key === 'Enter') {
                            this.click();
                        }
                    }
                });
                
                // 클릭 이벤트 처리
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const href = this.getAttribute('href');
                    const text = this.querySelector('span')?.textContent || '알 수 없음';
                    
                    console.log(`빠른메뉴 클릭: ${text} -> ${href}`);
                    
                    if (href && href !== '#') {
                        // 페이지 이동 전에 pressed 클래스 제거
                        this.classList.remove('pressed');
                        
                        // 약간의 지연 후 페이지 이동 (시각적 피드백을 위해)
                        setTimeout(() => {
                            console.log(`페이지 이동: ${href}`);
                            window.location.href = href;
                        }, 150);
                    } else {
                        console.log('유효하지 않은 링크:', href);
                    }
                });
            });
            
            console.log('빠른메뉴 인터랙션 초기화 완료');
        }
        
        // 빠른메뉴 인터랙션 초기화
        initQuickMenuInteractions();
        

        // ========== 네비게이터 상태 관리 ==========
        function initNavigationStatus() {
            // 네비게이터 상태 관리 제거됨
        }



        // 현재 페이지 감지 함수 제거됨

        // 현재 페이지 표시 제거됨

        // 폼 작성 상태 모니터링 제거됨

        // 네비게이터 상태 설정 함수들 제거됨

        // ========== 전역 상태 객체 ==========
        const state = {
            site: '',
            date: new Date().toISOString().split('T')[0],
            writer: '',
            part: [], // 부재명 배열
            proc: [], // 작업공정 배열
            area: [], // 작업유형 배열
            block: { type: '', val: '' },
            dong: '',
            section: '',
            ho: '',
            men: 1,
            additionalTags: [], // 추가태그 배열
            additionalManpower: [], // 추가 공수 배열
            photos: {
                pre: [],
                post: [],
                receipt: [],
                drawing: []
            }
        };

        // ========== 로그인된 사용자 정보 가져오기 ==========
        function getLoggedInUser() {
            // 실제로는 서버에서 로그인된 사용자 정보를 가져와야 함
            // 현재는 프로필에서 사용자명을 가져옴
            const profileUserName = document.getElementById('profileUserName');
            if (profileUserName) {
                const userName = profileUserName.textContent.split(' ')[0]; // "이현수 현장관리자"에서 "이현수"만 추출
                return userName;
            }
            return '이현수'; // 기본값
        }

        // ========== localStorage 유틸리티 ==========
        const storage = {
            save: function(key, data) {
                try {
                    localStorage.setItem(key, JSON.stringify(data));
                    return true;
                } catch (e) {
                    console.error('저장 실패:', e);
                    return false;
                }
            },
            load: function(key) {
                try {
                    const data = localStorage.getItem(key);
                    return data ? JSON.parse(data) : null;
                } catch (e) {
                    console.error('로드 실패:', e);
                    return null;
                }
            },
            remove: function(key) {
                try {
                    localStorage.removeItem(key);
                    return true;
                } catch (e) {
                    console.error('삭제 실패:', e);
                    return false;
                }
            }
        };

        // ========== 오늘 날짜 가져오기 ==========
        function getTodayDate() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        // ========== 작업일지 폼 기능 ==========
        function initWorkLogForm() {
            // 작성자 자동 설정
            const authorInput = document.getElementById('author');
            if (authorInput) {
                authorInput.value = getLoggedInUser();
                state.writer = getLoggedInUser();
            }

            // 작업일자 자동 설정 (오늘 날짜)
            const workDateInput = document.getElementById('workDate');
            if (workDateInput) {
                workDateInput.value = getTodayDate();
                
                // 날짜 입력 필드 클릭 시 날짜 선택기 열기
                workDateInput.addEventListener('click', function() {
                    try {
                        if (typeof this.showPicker === 'function') {
                            this.showPicker();
                        }
                    } catch (error) {
                        console.log('showPicker not supported');
                    }
                });
            }

            // 옵션 버튼 토글 기능 (다중 선택 허용)
            const optionButtons = document.querySelectorAll('.option-btn');
            optionButtons.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // 토글 기능 (다중 선택 허용)
                    this.classList.toggle('active');
                    
                    // 상태 업데이트
                    updateButtonGroupState(this);
                    
                    // 직접입력 처리
                    handleCustomInput(this);
                    
                    // 요약 업데이트
                    updateSummary();
                });
                
                // 키보드 접근성 추가
                btn.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        this.click();
                    }
                });
            });

            // 버튼 그룹 상태 업데이트 함수
            function updateButtonGroupState(clickedButton) {
                const group = clickedButton.closest('.button-group');
                const formGroup = group.closest('.form-group');
                const groupId = formGroup.querySelector('.form-label').textContent;
                
                const activeButtons = group.querySelectorAll('.option-btn.active');
                const values = Array.from(activeButtons).map(btn => {
                    const customInput = formGroup.querySelector('.custom-input');
                    if (btn.dataset.value === 'other' && customInput && customInput.value.trim()) {
                        return customInput.value.trim();
                    }
                    return btn.dataset.value;
                }).filter(value => value && value.trim() !== '');

                // 상태에 반영
                if (groupId.includes('부재명')) {
                    state.part = values;
                } else if (groupId.includes('작업공정')) {
                    state.proc = values;
                } else if (groupId.includes('작업유형')) {
                    state.area = values;
                }
                
                // 디버깅을 위한 콘솔 로그
                console.log(`Updated ${groupId}:`, values);
            }

            // 직접입력 처리 함수
            function handleCustomInput(button) {
                const formGroup = button.closest('.form-group');
                const customInput = formGroup.querySelector('.custom-input');
                
                if (button.dataset.value === 'other' && customInput) {
                    if (button.classList.contains('active')) {
                        customInput.style.display = 'block';
                        customInput.focus();
                        
                        // 기존 이벤트 리스너 제거 후 새로 추가 (중복 방지)
                        customInput.removeEventListener('input', handleCustomInputChange);
                        customInput.removeEventListener('blur', handleCustomInputBlur);
                        customInput.addEventListener('input', handleCustomInputChange);
                        customInput.addEventListener('blur', handleCustomInputBlur);
                        
                        // 다른 화면 클릭 시 텍스트박스 숨김
                        const hideInputOnClickOutside = (event) => {
                            if (!formGroup.contains(event.target)) {
                                customInput.style.display = 'none';
                                document.removeEventListener('click', hideInputOnClickOutside);
                            }
                        };
                        
                        setTimeout(() => {
                            document.addEventListener('click', hideInputOnClickOutside);
                        }, 100);
                    } else {
                        customInput.style.display = 'none';
                        customInput.value = '';
                        // 상태 업데이트
                        updateButtonGroupState(button);
                        updateSummary();
                    }
                }
            }

            // 직접입력 변경 처리 함수
            function handleCustomInputChange(event) {
                const customInput = event.target;
                const formGroup = customInput.closest('.form-group');
                const button = formGroup.querySelector('.option-btn[data-value="other"]');
                
                // 입력한 텍스트가 있으면 "기타" 버튼의 텍스트를 입력한 텍스트로 변경
                if (customInput.value.trim()) {
                    button.textContent = customInput.value.trim();
                } else {
                    button.textContent = '기타';
                }
                
                updateButtonGroupState(button);
                updateSummary();
                
                // 자동 저장 기능
                autoSaveCustomInput(customInput);
            }
            
            // 자동 저장 함수
            function autoSaveCustomInput(customInput) {
                const formGroup = customInput.closest('.form-group');
                const labelElement = formGroup.querySelector('.form-label');
                const fieldName = labelElement ? labelElement.textContent.trim() : 'unknown';
                const value = customInput.value.trim();
                
                // 저장할 데이터 준비
                const saveData = {
                    fieldName: fieldName,
                    value: value,
                    timestamp: new Date().toISOString(),
                    id: customInput.id || `custom-${Date.now()}`
                };
                
                // 로컬 스토리지에 자동 저장
                try {
                    const existingData = JSON.parse(localStorage.getItem('autoSavedCustomInputs') || '{}');
                    existingData[saveData.id] = saveData;
                    localStorage.setItem('autoSavedCustomInputs', JSON.stringify(existingData));
                    
                    // 저장 상태 피드백 표시 제거 (요청에 따라)
                    // showAutoSaveFeedback(customInput, true);
                    
                    console.log(`자동 저장됨: ${fieldName} = ${value}`);
                } catch (error) {
                    console.error('자동 저장 실패:', error);
                    showAutoSaveFeedback(customInput, false);
                }
            }
            
            // 자동 저장 피드백 표시 함수
            function showAutoSaveFeedback(inputElement, success) {
                // 기존 피드백 제거
                const existingFeedback = inputElement.parentNode.querySelector('.auto-save-feedback');
                if (existingFeedback) {
                    existingFeedback.remove();
                }
                
                // 피드백 요소 생성
                const feedback = document.createElement('div');
                feedback.className = 'auto-save-feedback';
                feedback.style.cssText = `
                    position: absolute;
                    right: 8px;
                    top: 50%;
                    transform: translateY(-50%);
                    font-size: 12px;
                    color: ${success ? '#10B981' : '#EF4444'};
                    opacity: 0;
                    transition: opacity 0.3s ease;
                    pointer-events: none;
                    z-index: 10;
                `;
                feedback.textContent = success ? '✓ 저장됨' : '✗ 저장 실패';
                
                // 입력 필드의 부모 요소에 상대 위치 설정
                const parent = inputElement.parentNode;
                if (getComputedStyle(parent).position === 'static') {
                    parent.style.position = 'relative';
                }
                
                parent.appendChild(feedback);
                
                // 애니메이션 효과
                setTimeout(() => {
                    feedback.style.opacity = '1';
                }, 10);
                
                // 2초 후 자동 제거
                setTimeout(() => {
                    feedback.style.opacity = '0';
                    setTimeout(() => {
                        if (feedback.parentNode) {
                            feedback.parentNode.removeChild(feedback);
                        }
                    }, 300);
                }, 2000);
            }
            
            // 페이지 로드 시 자동 저장된 데이터 복원
            function restoreAutoSavedData() {
                try {
                    const savedData = JSON.parse(localStorage.getItem('autoSavedCustomInputs') || '{}');
                    
                    Object.values(savedData).forEach(data => {
                        const input = document.getElementById(data.id);
                        if (input && data.value) {
                            input.value = data.value;
                            
                            // 해당 버튼 활성화
                            const formGroup = input.closest('.form-group');
                            const otherButton = formGroup.querySelector('.option-btn[data-value="other"]');
                            if (otherButton) {
                                otherButton.classList.add('active');
                                input.style.display = 'block';
                                updateButtonGroupState(otherButton);
                            }
                        }
                    });
                    
                    // 요약 업데이트
                    updateSummary();
                    
                    console.log('자동 저장된 데이터 복원 완료');
                } catch (error) {
                    console.error('자동 저장된 데이터 복원 실패:', error);
                }
            }
            
            // 추가 태그 자동 저장 함수
            function autoSaveAdditionalTagCustomInput(customInput, tagId) {
                const buttonGroup = customInput.previousElementSibling;
                const labelElement = buttonGroup ? buttonGroup.previousElementSibling : null;
                const fieldName = labelElement ? labelElement.textContent.trim() : 'unknown';
                const value = customInput.value.trim();
                
                // 저장할 데이터 준비
                const saveData = {
                    fieldName: fieldName,
                    value: value,
                    timestamp: new Date().toISOString(),
                    tagId: tagId,
                    id: `additional-${tagId}-${fieldName.replace(/\s+/g, '-')}`
                };
                
                // 로컬 스토리지에 자동 저장
                try {
                    const existingData = JSON.parse(localStorage.getItem('autoSavedAdditionalTags') || '{}');
                    existingData[saveData.id] = saveData;
                    localStorage.setItem('autoSavedAdditionalTags', JSON.stringify(existingData));
                    
                    // 저장 상태 피드백 표시 제거 (요청에 따라)
                    // showAutoSaveFeedback(customInput, true);
                    
                    console.log(`추가 태그 자동 저장됨: ${fieldName} = ${value} (Tag ID: ${tagId})`);
                } catch (error) {
                    console.error('추가 태그 자동 저장 실패:', error);
                    showAutoSaveFeedback(customInput, false);
                }
            }
            
            // 직접입력 blur 처리 함수
            function handleCustomInputBlur(event) {
                const customInput = event.target;
                const formGroup = customInput.closest('.form-group');
                const button = formGroup.querySelector('.option-btn[data-value="other"]');
                
                if (!customInput.value.trim()) {
                    // 입력값이 없으면 "기타"로 되돌리고 입력박스 숨김
                    button.textContent = '기타';
                    button.classList.remove('active');
                    customInput.style.display = 'none';
                    updateButtonGroupState(button);
                    updateSummary();
                } else {
                    // 입력값이 있으면 입력박스는 숨기되 버튼 텍스트는 유지
                    customInput.style.display = 'none';
                    updateButtonGroupState(button);
                    updateSummary();
                }
            }

            // 숫자 입력 컨트롤
            // 블럭/동/호수 입력 이벤트
            const blockInput = document.getElementById('block');
            const buildingInput = document.getElementById('building');
            const unitInput = document.getElementById('unit');

            if (blockInput) {
                blockInput.addEventListener('input', function() {
                    state.block.val = this.value.toUpperCase();
                    this.value = state.block.val; // 대문자로 변환된 값을 다시 입력
                    updateSummary();
                });
            }

            if (buildingInput) {
                // 숫자만 입력 허용
                buildingInput.addEventListener('input', function() {
                    // 숫자가 아닌 문자 제거
                    this.value = this.value.replace(/[^0-9]/g, '');
                    state.dong = this.value;
                    updateSummary();
                });
                
                // 키 입력 시 숫자가 아닌 키 차단
                buildingInput.addEventListener('keypress', function(e) {
                    // 숫자(0-9), 백스페이스, 삭제, 탭, 엔터, 화살표 키만 허용
                    if (!/[0-9]/.test(e.key) && !['Backspace', 'Delete', 'Tab', 'Enter', 'ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown'].includes(e.key)) {
                        e.preventDefault();
                    }
                });
            }

            if (unitInput) {
                // 숫자만 입력 허용
                unitInput.addEventListener('input', function() {
                    // 숫자가 아닌 문자 제거
                    this.value = this.value.replace(/[^0-9]/g, '');
                    state.ho = this.value;
                    updateSummary();
                });
                
                // 키 입력 시 숫자가 아닌 키 차단
                unitInput.addEventListener('keypress', function(e) {
                    // 숫자(0-9), 백스페이스, 삭제, 탭, 엔터, 화살표 키만 허용
                    if (!/[0-9]/.test(e.key) && !['Backspace', 'Delete', 'Tab', 'Enter', 'ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown'].includes(e.key)) {
                        e.preventDefault();
                    }
                });
            }

            // 공수(일) 컨트롤 이벤트 (data-values 기반)
            const minusBtn = document.querySelector('.number-btn.minus');
            const plusBtn = document.querySelector('.number-btn.plus');
            const numberField = document.getElementById('manDays');
            const qtySplit3 = document.querySelector('.qty-split3');

            // data-values 파싱 (기본값: 0,0.5,1,1.5,2,2.5,3)
            const dataValues = qtySplit3 ? qtySplit3.getAttribute('data-values') : '0,0.5,1,1.5,2,2.5,3';
            const values = dataValues.split(',').map(v => parseFloat(v.trim()));

            if (minusBtn && plusBtn && numberField) {
                minusBtn.addEventListener('click', function() {
                    const currentValue = parseFloat(numberField.value) || 1;
                    const currentIndex = values.indexOf(currentValue);
                    if (currentIndex > 0) {
                        const newValue = values[currentIndex - 1];
                        numberField.value = newValue;
                        state.men = newValue;
                        updateSummary();
                        updateSummaryPersonnel(newValue);
                    }
                });

                plusBtn.addEventListener('click', function() {
                    const currentValue = parseFloat(numberField.value) || 1;
                    const currentIndex = values.indexOf(currentValue);
                    if (currentIndex < values.length - 1) {
                        const newValue = values[currentIndex + 1];
                        numberField.value = newValue;
                        state.men = newValue;
                        updateSummary();
                        updateSummaryPersonnel(newValue);
                    }
                });

                // 키보드 이벤트 (←/→, +/-)
                numberField.addEventListener('keydown', function(e) {
                    const currentValue = parseFloat(this.value) || 1;
                    const currentIndex = values.indexOf(currentValue);
                    
                    if (e.key === 'ArrowLeft' || e.key === '-') {
                        e.preventDefault();
                        if (currentIndex > 0) {
                            const newValue = values[currentIndex - 1];
                            this.value = newValue;
                            state.men = newValue;
                            updateSummary();
                            updateSummaryPersonnel(newValue);
                        }
                    } else if (e.key === 'ArrowRight' || e.key === '+') {
                        e.preventDefault();
                        if (currentIndex < values.length - 1) {
                            const newValue = values[currentIndex + 1];
                            this.value = newValue;
                            state.men = newValue;
                            updateSummary();
                            updateSummaryPersonnel(newValue);
                        }
                    }
                });

                // 직접 입력 시에도 출력인원 업데이트
                numberField.addEventListener('input', function() {
                    let value = parseFloat(this.value) || 1;
                    // data-values에 있는 값으로 제한
                    if (!values.includes(value)) {
                        // 가장 가까운 값으로 조정
                        const closest = values.reduce((prev, curr) => 
                            Math.abs(curr - value) < Math.abs(prev - value) ? curr : prev
                        );
                        value = closest;
                        this.value = value;
                    }
                    state.men = value;
                    updateSummary();
                    updateSummaryPersonnel(value);
                });
            }

            // 출력인원 업데이트 함수
            function updateSummaryPersonnel(manDays) {
                const personnelElement = document.getElementById('summary-personnel');
                if (personnelElement) {
                    personnelElement.textContent = manDays + '명';
                }
            }

            // 현장 선택 시 선택된 현장 표시 업데이트
            const siteSelect = document.getElementById('siteSelect');
            const selectedSiteDisplay = document.getElementById('selectedSiteDisplay');

            if (siteSelect && selectedSiteDisplay) {
                siteSelect.addEventListener('change', function() {
                    const selectedValue = this.value;
                    const selectedText = this.options[this.selectedIndex].text;
                    
                    // 선택된 현장 표시 업데이트 (input 필드에 텍스트 표시)
                    if (selectedValue) {
                        selectedSiteDisplay.value = selectedText;
                        selectedSiteDisplay.title = selectedText; // 툴팁 업데이트
                    } else {
                        selectedSiteDisplay.value = "현장 미선택";
                        selectedSiteDisplay.title = "현장 미선택";
                    }
                    
                    // 요약 업데이트
                    updateSummary();
                });
            }

            // 폼 리셋 기능 (최적화)
            const resetBtn = document.getElementById('resetBtn');
            if (resetBtn) {
                resetBtn.addEventListener('click', function() {
                    // 모든 입력 필드 초기화
                    const form = document.querySelector('.work-form-container');
                    const inputs = form.querySelectorAll('input, select');
                    inputs.forEach(input => {
                         if (input.id === 'workDate') {
                             input.value = getTodayDate(); // 오늘 날짜로 초기화
                         } else if (input.id === 'author') {
                             input.value = getLoggedInUser(); // 로그인된 사용자로 초기화
                        } else if (input.type === 'number') {
                            input.value = '1';
                        } else {
                            input.value = '';
                        }
                    });

                    // 모든 옵션 버튼 비활성화
                    optionButtons.forEach(btn => btn.classList.remove('active'));

                     // 직접입력 필드 숨김 및 초기화
                     const customInputs = document.querySelectorAll('.custom-input');
                     customInputs.forEach(input => {
                         input.style.display = 'none';
                         input.value = '';
                     });

                // 상태 초기화
                state.part = [];
                state.proc = [];
                state.area = [];
                state.block = { type: '', val: '' };
                state.dong = '';
                state.section = '';
                state.ho = '';
                state.men = 1;
                state.additionalTags = [];
                state.additionalManpower = [];
                
                // 추가태그 컨테이너 초기화
                if (additionalWorkTagsContainer) {
                    additionalWorkTagsContainer.innerHTML = '';
                }
                
                // 추가 공수 행들 초기화
                const additionalManpowerRows = document.querySelectorAll('.additional-manpower-row');
                additionalManpowerRows.forEach(row => row.remove());

                    // 선택된 현장 표시 초기화
                    if (selectedSiteDisplay) {
                        selectedSiteDisplay.value = '';
                    }

                     // 요약 재렌더
                     updateSummary();

                     // 네비게이터 상태 초기화 제거됨

                     // 알림 표시
                     alert('폼이 초기화되었습니다.');

                    console.log('폼이 초기화되었습니다.');
                });
            }

            // 저장 기능
            const saveBtn = document.getElementById('saveBtn');
            if (saveBtn) {
                saveBtn.addEventListener('click', function() {
                    // 필수값 검증: site, date, writer, part, men
                    let isValid = true;
                    const missingFields = [];

                    // site 검증
                    const siteValue = document.getElementById('siteSelect').value;
                    if (!siteValue || !siteValue.trim()) {
                            isValid = false;
                        missingFields.push('현장');
                    }

                    // date 검증
                    const dateValue = document.getElementById('workDate').value;
                    if (!dateValue || !dateValue.trim()) {
                        isValid = false;
                        missingFields.push('작업일자');
                    }

                    // writer 검증
                    const writerValue = document.getElementById('author').value;
                    if (!writerValue || !writerValue.trim()) {
                        isValid = false;
                        missingFields.push('작성자');
                    }

                    // part 검증 (홈 변형에서는 part 필요)
                    if (state.part.length === 0) {
                        isValid = false;
                        missingFields.push('부재명');
                    }

                    // men 검증 (men<1이면 1로 보정)
                    let menValue = parseFloat(document.getElementById('manDays').value) || 0;
                    if (menValue < 1) {
                        menValue = 1; // 1로 보정
                        document.getElementById('manDays').value = 1;
                        state.men = 1;
                    }

                    if (isValid) {
                        // newWorkLog 객체 생성
                        const newWorkLog = {
                            date: dateValue,
                            site: siteValue,
                            men: menValue,
                            writer: writerValue,
                            part: state.part.join(', '),
                            process: state.proc.join(', '),
                            area: state.area.join(', '),
                            photos: {
                                before: state.photos.pre.length,
                                after: state.photos.post.length,
                                receipt: state.photos.receipt.length,
                                drawing: state.photos.drawing.length
                            },
                            timestamp: new Date().toISOString()
                        };

                        // localStorage에 저장
                        const existingData = storage.load('workLogData') || [];
                        
                        // 동일 날짜가 존재하면 교체, 없으면 push
                        const existingIndex = existingData.findIndex(item => item.date === dateValue);
                        if (existingIndex !== -1) {
                            existingData[existingIndex] = newWorkLog;
                        } else {
                            existingData.push(newWorkLog);
                        }
                        
                        storage.save('workLogData', existingData);

                        // 요약 재렌더
                        updateSummary();

                        // 네비게이터 상태 업데이트 제거됨

                        // 알림 표시
                        alert('작업일지가 성공적으로 저장되었습니다!');
                        
                        console.log('저장된 데이터:', newWorkLog);
                        console.log('전체 저장 데이터:', existingData);
                    } else {
                        alert(`다음 필수 항목을 입력해주세요:\n${missingFields.join(', ')}`);
                    }
                });
            }

            // ========== 추가태그 기능 ==========
            const addWorkContentBtn = document.getElementById('addWorkContentBtn');
            const addManDaysBtn = document.getElementById('addManDaysBtn');
            const additionalWorkTagsContainer = document.getElementById('additionalWorkTagsContainer');

            // 추가태그 행 생성 함수
            function createAdditionalWorkRow(tagId) {
                const row = document.createElement('div');
                row.className = 'additional-work-row';
                row.setAttribute('data-tag-id', tagId);
                
                row.innerHTML = `
                    <div class="section-header">
                        <h3 class="section-title">작업 내용 기록</h3>
                        <div class="header-actions">
                            <button class="delete-tag-btn" onclick="deleteAdditionalTag('${tagId}')">삭제</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">부재명</label>
                        <div class="button-group">
                            <button class="option-btn" data-value="slab">슬라브</button>
                            <button class="option-btn" data-value="girder">거더</button>
                            <button class="option-btn" data-value="column">기둥</button>
                            <button class="option-btn" data-value="other">기타</button>
                        </div>
                        <input type="text" class="form-input custom-input" placeholder="부재명을 직접 입력하세요" style="display: none; margin-top: 8px; border-radius: 14px;">
                    </div>
                    <div class="form-group">
                        <label class="form-label">작업공정</label>
                        <div class="button-group">
                            <button class="option-btn" data-value="crack">균열</button>
                            <button class="option-btn" data-value="surface">면</button>
                            <button class="option-btn" data-value="finish">마감</button>
                            <button class="option-btn" data-value="other">기타</button>
                        </div>
                        <input type="text" class="form-input custom-input" placeholder="작업공정을 직접 입력하세요" style="display: none; margin-top: 8px; border-radius: 14px;">
                    </div>
                    <div class="form-group">
                        <label class="form-label">작업유형</label>
                        <div class="button-group">
                            <button class="option-btn" data-value="underground">지하</button>
                            <button class="option-btn" data-value="ground">지상</button>
                            <button class="option-btn" data-value="roof">지붕</button>
                            <button class="option-btn" data-value="other">기타</button>
                        </div>
                        <input type="text" class="form-input custom-input" placeholder="작업유형을 직접 입력하세요" style="display: none; margin-top: 8px; border-radius: 14px;">
                    </div>
                    <div class="form-group block-dong-ho-group">
                        <label class="form-label">블럭 / 동 / 층</label>
                        <div class="form-row">
                            <div class="form-group">
                                <input type="text" class="form-input" placeholder="블럭" maxlength="2">
                            </div>
                            <div class="form-group">
                                <input type="text" class="form-input" placeholder="동" maxlength="2" inputmode="numeric">
                            </div>
                            <div class="form-group">
                                <input type="text" class="form-input" placeholder="층" maxlength="2" inputmode="numeric">
                            </div>
                        </div>
                    </div>
                `;
                
                return row;
            }

            // 추가태그 삭제 함수
            window.deleteAdditionalTag = function(tagId) {
                const row = document.querySelector(`[data-tag-id="${tagId}"]`);
                if (row) {
                    row.remove();
                    // 상태에서도 제거
                    state.additionalTags = state.additionalTags.filter(tag => tag.id !== tagId);
                    updateSummary();
                    console.log(`추가태그 ${tagId} 삭제됨`);
                }
            };

            // 작업 내용 추가 버튼
            if (addWorkContentBtn) {
                addWorkContentBtn.addEventListener('click', function() {
                    const tagId = 'tag_' + Date.now();
                    const newRow = createAdditionalWorkRow(tagId);
                    
                    if (additionalWorkTagsContainer) {
                        additionalWorkTagsContainer.appendChild(newRow);
                        
                        // 추가된 행의 동/층 입력박스에 숫자 입력 제한 적용
                        const buildingInputs = newRow.querySelectorAll('input[placeholder="동"]');
                        const unitInputs = newRow.querySelectorAll('input[placeholder="층"]');
                        
                        buildingInputs.forEach(input => {
                            input.addEventListener('input', function() {
                                this.value = this.value.replace(/[^0-9]/g, '');
                            });
                            input.addEventListener('keypress', function(e) {
                                if (!/[0-9]/.test(e.key) && !['Backspace', 'Delete', 'Tab', 'Enter', 'ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown'].includes(e.key)) {
                                    e.preventDefault();
                                }
                            });
                        });
                        
                        unitInputs.forEach(input => {
                            input.addEventListener('input', function() {
                                this.value = this.value.replace(/[^0-9]/g, '');
                            });
                            input.addEventListener('keypress', function(e) {
                                if (!/[0-9]/.test(e.key) && !['Backspace', 'Delete', 'Tab', 'Enter', 'ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown'].includes(e.key)) {
                                    e.preventDefault();
                                }
                            });
                        });
                        
                        // 상태에 추가
                        state.additionalTags.push({
                            id: tagId,
                            part: [],
                            proc: [],
                            area: [],
                            block: { type: '', val: '' },
                            dong: '',
                            section: '',
                            ho: ''
                        });
                        
                        // 새로 추가된 행의 이벤트 리스너 설정
                        initAdditionalTagRowEvents(newRow, tagId);
                        
                        console.log(`추가태그 ${tagId} 추가됨`);
                    }
                });
            }

            // 추가태그 행의 이벤트 리스너 설정
            function initAdditionalTagRowEvents(row, tagId) {
                const optionButtons = row.querySelectorAll('.option-btn');
                const customInputs = row.querySelectorAll('.custom-input');
                const blockInputs = row.querySelectorAll('.block-dong-ho-group input');

                // 옵션 버튼 이벤트
                optionButtons.forEach(btn => {
                    btn.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        this.classList.toggle('active');
                        updateAdditionalTagButtonGroupState(this, tagId);
                        handleAdditionalTagCustomInput(this, tagId);
                        updateSummary();
                    });
                });

                // 블럭/동/호수 입력 이벤트
                blockInputs.forEach((input, index) => {
                    input.addEventListener('input', function() {
                        const tag = state.additionalTags.find(t => t.id === tagId);
                        if (tag) {
                            if (index === 0) { // 블럭
                                tag.block.val = this.value.toUpperCase();
                            } else if (index === 1) { // 동
                                tag.dong = this.value;
                            } else if (index === 2) { // 호수
                                tag.ho = this.value;
                            }
                        }
                        updateSummary();
                    });
                });
            }

            // 추가태그 버튼 그룹 상태 업데이트
            function updateAdditionalTagButtonGroupState(clickedButton, tagId) {
                const buttonGroup = clickedButton.closest('.button-group');
                const groupId = buttonGroup.previousElementSibling.textContent;
                const activeButtons = buttonGroup.querySelectorAll('.option-btn.active');
                
                const values = Array.from(activeButtons).map(btn => {
                    if (btn.dataset.value === 'other') {
                        const customInput = buttonGroup.nextElementSibling;
                        if (customInput && customInput.style.display !== 'none') {
                            return customInput.value.trim();
                        }
                    }
                    return btn.dataset.value;
                }).filter(value => value && value.trim() !== '');

                // 해당 태그의 상태에 반영
                const tag = state.additionalTags.find(t => t.id === tagId);
                if (tag) {
                    if (groupId.includes('부재명')) {
                        tag.part = values;
                    } else if (groupId.includes('작업공정')) {
                        tag.proc = values;
                    } else if (groupId.includes('작업유형')) {
                        tag.area = values;
                    }
                }
                
                console.log(`Updated additional tag ${tagId} ${groupId}:`, values);
            }

            // 추가태그 직접입력 처리
            function handleAdditionalTagCustomInput(button, tagId) {
                if (button.dataset.value === 'other') {
                    const customInput = button.closest('.button-group').nextElementSibling;
                    if (customInput) {
                        if (button.classList.contains('active')) {
                            customInput.style.display = 'block';
                            customInput.focus();
                            
                            // 직접입력 이벤트 리스너 추가
                            customInput.addEventListener('input', function(e) {
                                updateAdditionalTagButtonGroupState(button, tagId);
                                // 추가 태그 자동 저장
                                autoSaveAdditionalTagCustomInput(this, tagId);
                            });
                            
                            customInput.addEventListener('blur', function(e) {
                                if (!this.value.trim()) {
                                    button.classList.remove('active');
                                    this.style.display = 'none';
                                }
                            });
                        } else {
                            customInput.style.display = 'none';
                            customInput.value = '';
                        }
                    }
                }
            }

            // 공수 추가 버튼 - 동일한 구조의 행 추가
            // 작성자 직업 입력 내용을 모든 공수 행에 동기화하는 함수
            function syncAuthorToAllRows() {
                const existingCustomInput = document.querySelector('.custom-author-input');
                if (existingCustomInput && existingCustomInput.value.trim()) {
                    const existingValue = existingCustomInput.value.trim();
                    
                    // 모든 author-select 요소에 동일한 옵션 추가 및 선택
                    const allAuthorSelects = document.querySelectorAll('.author-select');
                    allAuthorSelects.forEach(select => {
                        // 이미 같은 옵션이 있는지 확인
                        const existingOption = Array.from(select.options).find(option => option.value === existingValue);
                        if (!existingOption) {
                            // 새로운 옵션 추가
                            const newOption = document.createElement('option');
                            newOption.value = existingValue;
                            newOption.textContent = existingValue;
                            select.appendChild(newOption);
                        }
                        
                        // 해당 값으로 선택
                        select.value = existingValue;
                    });
                }
            }

            // 기존 작성자/공수 행 이벤트 리스너 설정
            function initMainAuthorManpowerEvents() {
                const mainAuthorSelect = document.getElementById('mainAuthorSelect');
                const mainCustomAuthorInput = document.getElementById('mainCustomAuthorInput');
                
                if (mainAuthorSelect && mainCustomAuthorInput) {
                    // 작성자 선택 이벤트
                    mainAuthorSelect.addEventListener('change', function() {
                        if (this.value === '직접입력') {
                            mainCustomAuthorInput.style.display = 'block';
                            mainCustomAuthorInput.focus();
                        } else {
                            mainCustomAuthorInput.style.display = 'none';
                            mainCustomAuthorInput.value = '';
                        }
                    });
                    
                    // 직접입력 처리
                    mainCustomAuthorInput.addEventListener('blur', function() {
                        const inputValue = this.value.trim();
                        if (inputValue) {
                            // 셀렉트박스에 새로운 옵션 추가
                            const existingOption = Array.from(mainAuthorSelect.options).find(option => option.value === inputValue);
                            if (!existingOption) {
                                const newOption = document.createElement('option');
                                newOption.value = inputValue;
                                newOption.textContent = inputValue;
                                mainAuthorSelect.appendChild(newOption);
                            }
                            
                            // 해당 값으로 선택
                            mainAuthorSelect.value = inputValue;
                            
                            // 모든 다른 author-select에도 동일한 옵션 추가
                            const allAuthorSelects = document.querySelectorAll('.author-select');
                            allAuthorSelects.forEach(select => {
                                if (select !== mainAuthorSelect) {
                                    const existingOption = Array.from(select.options).find(option => option.value === inputValue);
                                    if (!existingOption) {
                                        const newOption = document.createElement('option');
                                        newOption.value = inputValue;
                                        newOption.textContent = inputValue;
                                        select.appendChild(newOption);
                                    }
                                }
                            });
                            
                            console.log(`메인 작성자 직접입력 반영: ${inputValue}`);
                        } else {
                            // 입력값이 없으면 직접입력으로 되돌리기
                            mainAuthorSelect.value = '직접입력';
                        }
                    });
                    
                    mainCustomAuthorInput.addEventListener('keypress', function(e) {
                        if (e.key === 'Enter') {
                            this.blur(); // blur 이벤트 트리거
                        }
                    });
                }
            }

            if (addManDaysBtn) {
                addManDaysBtn.addEventListener('click', function() {
                    const rowId = 'manpower_row_' + Date.now();
                    const newRow = createAdditionalManpowerRow(rowId);
                    
                    // 기존 작성자/공수 행 다음에 추가
                    const existingRow = document.querySelector('.author-manpower-row');
                    if (existingRow && existingRow.parentNode) {
                        existingRow.parentNode.insertBefore(newRow, existingRow.nextSibling);
                        
                        // 상태에 추가
                        state.additionalManpower = state.additionalManpower || [];
                        state.additionalManpower.push({
                            id: rowId,
                            author: '',
                            manDays: 1
                        });
                        
                        // 새로 추가된 행의 이벤트 리스너 설정
                        initAdditionalManpowerRowEvents(newRow, rowId);
                        
                        // 기존 작성자 직업 입력 내용을 새 행에 자동 반영
                        syncAuthorToAllRows();
                        
                        console.log(`추가 공수 행 ${rowId} 추가됨`);
                    }
                });
            }

            // 추가 공수 행 생성 함수
            function createAdditionalManpowerRow(rowId) {
                const row = document.createElement('div');
                row.className = 'additional-manpower-section';
                row.setAttribute('data-row-id', rowId);
                
                row.innerHTML = `
                    <div class="section-header">
                        <h3 class="section-title">공수(일)</h3>
                        <div class="header-actions">
                            <button class="delete-tag-btn" onclick="deleteAdditionalManpowerRow('${rowId}')">삭제</button>
                        </div>
                    </div>
                    <div class="form-row author-manpower-row">
                        <div class="form-group">
                            <label class="form-label">작성자</label>
                            <select class="form-select author-select" data-row-id="${rowId}">
                                <option value="">선택</option>
                                <option value="김재형">김재형</option>
                                <option value="송용호">송용호</option>
                                <option value="권용호">권용호</option>
                                <option value="강영권">강영권</option>
                                <option value="김문수">김문수</option>
                                <option value="이장환">이장환</option>
                                <option value="직접입력">직접입력</option>
                            </select>
                            <input type="text" class="form-input custom-author-input" placeholder="작성자명을 직접 입력하세요" style="display: none; margin-top: 8px;" data-row-id="${rowId}">
                        </div>
                        <div class="form-group">
                            <label class="form-label">공수</label>
                            <div class="number-input qty-split3" data-values="0,0.5,1,1.5,2,2.5,3">
                                <button class="number-btn minus">-</button>
                                <input type="number" class="number-field" value="1" min="0" step="0.5" data-row-id="${rowId}">
                                <button class="number-btn plus">+</button>
                            </div>
                        </div>
                    </div>
                `;
                
                return row;
            }

            // 추가 공수 행 삭제 함수
            window.deleteAdditionalManpowerRow = function(rowId) {
                const row = document.querySelector(`[data-row-id="${rowId}"]`);
                if (row) {
                    row.remove();
                    // 상태에서도 제거
                    if (state.additionalManpower) {
                        state.additionalManpower = state.additionalManpower.filter(item => item.id !== rowId);
                    }
                    updateSummary();
                    console.log(`추가 공수 행 ${rowId} 삭제됨`);
                }
            };

            // 추가 공수 행의 이벤트 리스너 설정
            function initAdditionalManpowerRowEvents(row, rowId) {
                const authorSelect = row.querySelector('.author-select');
                const customAuthorInput = row.querySelector('.custom-author-input');
                const numberField = row.querySelector('.number-field');
                const minusBtn = row.querySelector('.number-btn.minus');
                const plusBtn = row.querySelector('.number-btn.plus');

                // 작성자 선택 이벤트 - 기존 작성자 직업 입력 내용 자동 반영
                if (authorSelect) {
                    // 기존 작성자 직업 입력 내용이 있다면 자동으로 선택
                    const existingCustomInput = document.querySelector('.custom-author-input');
                    if (existingCustomInput && existingCustomInput.value.trim()) {
                        // 기존 입력 내용을 새 행의 author-select에 추가하고 선택
                        const existingValue = existingCustomInput.value.trim();
                        
                        // 이미 같은 옵션이 있는지 확인
                        const existingOption = Array.from(authorSelect.options).find(option => option.value === existingValue);
                        if (!existingOption) {
                            // 새로운 옵션 추가
                            const newOption = document.createElement('option');
                            newOption.value = existingValue;
                            newOption.textContent = existingValue;
                            authorSelect.appendChild(newOption);
                        }
                        
                        // 해당 값으로 선택
                        authorSelect.value = existingValue;
                    }
                    
                    authorSelect.addEventListener('change', function() {
                        if (this.value === '직접입력') {
                            customAuthorInput.style.display = 'block';
                            customAuthorInput.focus();
                        } else {
                            customAuthorInput.style.display = 'none';
                            customAuthorInput.value = '';
                        }
                    });
                }

                // 작성자 직접입력 처리
                if (customAuthorInput) {
                    customAuthorInput.addEventListener('blur', function() {
                        const inputValue = this.value.trim();
                        if (inputValue) {
                            // 셀렉트박스에 새로운 옵션 추가
                            const existingOption = Array.from(authorSelect.options).find(option => option.value === inputValue);
                            if (!existingOption) {
                                const newOption = document.createElement('option');
                                newOption.value = inputValue;
                                newOption.textContent = inputValue;
                                authorSelect.appendChild(newOption);
                            }
                            
                            // 해당 값으로 선택
                            authorSelect.value = inputValue;
                            
                            // 상태 업데이트
                            const manpowerItem = state.additionalManpower.find(item => item.id === rowId);
                            if (manpowerItem) {
                                manpowerItem.author = inputValue;
                            }
                            
                            // 모든 다른 author-select에도 동일한 옵션 추가
                            const allAuthorSelects = document.querySelectorAll('.author-select');
                            allAuthorSelects.forEach(select => {
                                if (select !== authorSelect) {
                                    const existingOption = Array.from(select.options).find(option => option.value === inputValue);
                                    if (!existingOption) {
                                        const newOption = document.createElement('option');
                                        newOption.value = inputValue;
                                        newOption.textContent = inputValue;
                                        select.appendChild(newOption);
                                    }
                                }
                            });
                            
                            console.log(`작성자 직접입력 반영: ${inputValue}`);
                        } else {
                            // 입력값이 없으면 직접입력으로 되돌리기
                            authorSelect.value = '직접입력';
                        }
                    });
                    
                    customAuthorInput.addEventListener('keypress', function(e) {
                        if (e.key === 'Enter') {
                            this.blur(); // blur 이벤트 트리거
                        }
                    });
                }

                // 작성자 선택 이벤트 (중복 제거)
                if (authorSelect) {
                    // 기존 이벤트 리스너가 있다면 제거
                    authorSelect.removeEventListener('change', function() {});
                    
                    authorSelect.addEventListener('change', function() {
                        const selectedAuthor = this.value;
                        const manpowerItem = state.additionalManpower.find(item => item.id === rowId);
                        
                        if (selectedAuthor === '직접입력') {
                            customAuthorInput.style.display = 'block';
                            customAuthorInput.focus();
                        } else if (selectedAuthor) {
                            customAuthorInput.style.display = 'none';
                            customAuthorInput.value = '';
                            if (manpowerItem) {
                                manpowerItem.author = selectedAuthor;
                            }
                            updateSummary();
                        }
                    });
                }

                // 직접입력 작성자 이벤트
                if (customAuthorInput) {
                    customAuthorInput.addEventListener('input', function() {
                        const manpowerItem = state.additionalManpower.find(item => item.id === rowId);
                        if (manpowerItem) {
                            manpowerItem.author = this.value.trim();
                        }
                        updateSummary();
                    });

                    customAuthorInput.addEventListener('blur', function() {
                        if (!this.value.trim()) {
                            const authorSelect = row.querySelector('.author-select');
                            if (authorSelect) {
                                authorSelect.value = '';
                            }
                            this.style.display = 'none';
                        }
                    });
                }

                // 공수 입력 이벤트 (data-values 기반)
                const qtySplit3 = row.querySelector('.qty-split3');
                const dataValues = qtySplit3 ? qtySplit3.getAttribute('data-values') : '0,0.5,1,1.5,2,2.5,3';
                const values = dataValues.split(',').map(v => parseFloat(v.trim()));

                if (minusBtn && plusBtn && numberField) {
                    minusBtn.addEventListener('click', function() {
                        const currentValue = parseFloat(numberField.value) || 1;
                        const currentIndex = values.indexOf(currentValue);
                        if (currentIndex > 0) {
                            const newValue = values[currentIndex - 1];
                            numberField.value = newValue;
                            const manpowerItem = state.additionalManpower.find(item => item.id === rowId);
                            if (manpowerItem) {
                                manpowerItem.manDays = newValue;
                            }
                            updateSummary();
                        }
                    });

                    plusBtn.addEventListener('click', function() {
                        const currentValue = parseFloat(numberField.value) || 1;
                        const currentIndex = values.indexOf(currentValue);
                        if (currentIndex < values.length - 1) {
                            const newValue = values[currentIndex + 1];
                            numberField.value = newValue;
                            const manpowerItem = state.additionalManpower.find(item => item.id === rowId);
                            if (manpowerItem) {
                                manpowerItem.manDays = newValue;
                            }
                            updateSummary();
                        }
                    });

                    // 키보드 이벤트
                    numberField.addEventListener('keydown', function(e) {
                        const currentValue = parseFloat(this.value) || 1;
                        const currentIndex = values.indexOf(currentValue);
                        
                        if (e.key === 'ArrowLeft' || e.key === '-') {
                            e.preventDefault();
                            if (currentIndex > 0) {
                                const newValue = values[currentIndex - 1];
                                this.value = newValue;
                                const manpowerItem = state.additionalManpower.find(item => item.id === rowId);
                                if (manpowerItem) {
                                    manpowerItem.manDays = newValue;
                                }
                                updateSummary();
                            }
                        } else if (e.key === 'ArrowRight' || e.key === '+') {
                            e.preventDefault();
                            if (currentIndex < values.length - 1) {
                                const newValue = values[currentIndex + 1];
                                this.value = newValue;
                                const manpowerItem = state.additionalManpower.find(item => item.id === rowId);
                                if (manpowerItem) {
                                    manpowerItem.manDays = newValue;
                                }
                                updateSummary();
                            }
                        }
                    });

                    numberField.addEventListener('input', function() {
                        let value = parseFloat(this.value) || 1;
                        if (!values.includes(value)) {
                            const closest = values.reduce((prev, curr) => 
                                Math.abs(curr - value) < Math.abs(prev - value) ? curr : prev
                            );
                            value = closest;
                            this.value = value;
                        }
                        const manpowerItem = state.additionalManpower.find(item => item.id === rowId);
                        if (manpowerItem) {
                            manpowerItem.manDays = value;
                        }
                        updateSummary();
                    });
                }
            }

            // 캘린더 아이콘 클릭 이벤트
            const calendarIcon = document.getElementById('calendarIcon');
            
            if (calendarIcon && workDateInput) {
                calendarIcon.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // 포커스 후 클릭 이벤트 발생
                    workDateInput.focus();
                    workDateInput.click();
                    
                    // showPicker() 메서드가 지원되는 브라우저에서 날짜 선택기 열기
                    try {
                        if (typeof workDateInput.showPicker === 'function') {
                            workDateInput.showPicker();
                        }
                    } catch (error) {
                        console.log('showPicker not supported, using click method');
                    }
                });

                // 작업일자 변경 시 요약 업데이트
                workDateInput.addEventListener('change', function() {
                    updateSummary();
                });

                // 작업일자 입력 시 실시간 요약 업데이트
                workDateInput.addEventListener('input', function() {
                    updateSummary();
                });
            }

            // 작성자 변경 시 요약 업데이트
            if (authorInput) {
                authorInput.addEventListener('input', function() {
                    updateSummary();
                });
            }

            // 요약 업데이트 함수 (최적화)
            function updateSummary() {
                // DOM 요소들을 한 번에 가져와서 성능 최적화
                const elements = {
                    site: document.getElementById('summary-site'),
                    date: document.getElementById('summary-date'),
                    author: document.getElementById('summary-author'),
                    component: document.getElementById('summary-component'),
                    process: document.getElementById('summary-process'),
                    worktype: document.getElementById('summary-worktype'),
                    mandays: document.getElementById('summary-mandays'),
                    personnel: document.getElementById('summary-personnel'),
                    photos: document.getElementById('summary-photos'),
                    documents: document.getElementById('summary-documents'),
                    location: document.getElementById('summary-location')
                };

                // 현장 요약 업데이트
                if (elements.site) {
                    const siteSelect = document.getElementById('siteSelect');
                    elements.site.textContent = siteSelect && siteSelect.value ? siteSelect.value : '선택 안됨';
                }

                // 작업일자 요약 업데이트
                if (elements.date && workDateInput) {
                    elements.date.textContent = workDateInput.value || getTodayDate();
                }

                // 작성자 요약 업데이트
                if (elements.author && authorInput) {
                    elements.author.textContent = authorInput.value || getLoggedInUser();
                }

                // 부재명 요약 업데이트
                if (elements.component) {
                    elements.component.textContent = state.part.length > 0 ? state.part.join(', ') : '없음';
                }

                // 작업공정 요약 업데이트
                if (elements.process) {
                    elements.process.textContent = state.proc.length > 0 ? state.proc.join(', ') : '없음';
                }

                // 작업유형 요약 업데이트
                if (elements.worktype) {
                    elements.worktype.textContent = state.area.length > 0 ? state.area.join(', ') : '없음';
                }

                // 공수 요약 업데이트 (n일)
                if (elements.mandays) {
                    elements.mandays.textContent = `${state.men}일`;
                }

                // 출력인원 요약 업데이트 (n명)
                if (elements.personnel) {
                    elements.personnel.textContent = `${state.men}명`;
                }

                // 사진 합계 요약 업데이트
                if (elements.photos) {
                    const preCount = state.photos.pre.length;
                    const postCount = state.photos.post.length;
                    elements.photos.textContent = `보수 전 ${preCount}장 / 보수 후 ${postCount}장`;
                }

                // 도면 요약 업데이트
                if (elements.documents) {
                    const drawingCount = state.photos.drawing.length;
                    elements.documents.textContent = `${drawingCount}장`;
                }

                // 위치 요약 업데이트 (block/dong/ho 형식)
                if (elements.location) {
                    const block = state.block.val || '';
                    const dong = state.dong || '';
                    const ho = state.ho || '';
                    
                    if (block || dong || ho) {
                        elements.location.textContent = `${block}/${dong}/${ho}`.replace(/\/$/, '');
                    } else {
                        elements.location.textContent = '없음';
                    }
                }
                
                // 디버깅을 위한 콘솔 로그
                console.log('Summary updated:', {
                    site: elements.site?.textContent,
                    date: elements.date?.textContent,
                    author: elements.author?.textContent,
                    part: state.part,
                    proc: state.proc,
                    area: state.area,
                    men: state.men,
                    photos: { pre: state.photos.pre.length, post: state.photos.post.length },
                    drawing: state.photos.drawing.length,
                    location: `${state.block.val}/${state.dong}/${state.ho}`
                });
            }

            // 초기 요약 업데이트
            updateSummary();
        }

        // 작업일지 폼 초기화
        initWorkLogForm();

        // ========== 첨부파일 섹션 기능 ==========
        function initAttachmentSection() {
            const beforeArea = document.querySelector('.before-area');
            const afterArea = document.querySelector('.after-area');
            const beforeCounter = document.querySelector('.photo-upload-item:first-child .counter-number');
            const afterCounter = document.querySelector('.photo-upload-item:last-child .counter-number');

            // 파일 업로드 기능
            function setupUploadArea(area, type) {
                // area가 null인지 확인
                if (!area) {
                    console.warn(`setupUploadArea: ${type} area를 찾을 수 없습니다.`);
                    return;
                }
                
                // 기존 이벤트 리스너 제거 (중복 방지)
                if (area._clickHandler) area.removeEventListener('click', area._clickHandler);
                if (area._dragoverHandler) area.removeEventListener('dragover', area._dragoverHandler);
                if (area._dragleaveHandler) area.removeEventListener('dragleave', area._dragleaveHandler);
                if (area._dropHandler) area.removeEventListener('drop', area._dropHandler);
                
                // 클릭으로 파일 선택
                area._clickHandler = function(e) {
                    const input = document.createElement('input');
                    input.type = 'file';
                    input.accept = 'image/*';
                    input.multiple = true;
                    input.style.display = 'none';
                    
                    input.addEventListener('change', function(e) {
                        const files = Array.from(e.target.files);
                        handleFileUpload(files, type);
                    });
                    
                    document.body.appendChild(input);
                    input.click();
                    document.body.removeChild(input);
                };
                area.addEventListener('click', area._clickHandler);

                // 드래그 앤 드롭
                area._dragoverHandler = function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    this.style.borderColor = '#31a3fa';
                    this.style.backgroundColor = '#F0FDFF';
                };
                area.addEventListener('dragover', area._dragoverHandler);

                area._dragleaveHandler = function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    this.style.borderColor = type === 'before' ? '#7C3AED' : '#31a3fa';
                    this.style.backgroundColor = type === 'before' ? '#F3F0FF' : '#F0FDFF';
                };
                area.addEventListener('dragleave', area._dragleaveHandler);

                area._dropHandler = function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    this.style.borderColor = type === 'before' ? '#7C3AED' : '#31a3fa';
                    this.style.backgroundColor = type === 'before' ? '#F3F0FF' : '#F0FDFF';
                    
                    const files = Array.from(e.dataTransfer.files).filter(file => file.type.startsWith('image/'));
                    handleFileUpload(files, type);
                };
                area.addEventListener('drop', area._dropHandler);
            }

            // 파일 업로드 처리
            function handleFileUpload(files, type) {
                const maxFiles = 30;
                const currentCount = state.photos[type === 'before' ? 'pre' : 'post'].length;
                
                if (currentCount + files.length > maxFiles) {
                    alert(`최대 ${maxFiles}장까지 업로드 가능합니다. (현재: ${currentCount}장)`);
                    return;
                }

                files.forEach(file => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const photoData = {
                            id: 'photo_' + Date.now() + '_' + Math.random(),
                            name: file.name,
                            url: e.target.result,
                            type: file.type,
                            size: file.size
                        };

                        if (type === 'before') {
                            state.photos.pre.push(photoData);
                        } else {
                            state.photos.post.push(photoData);
                        }

                        createThumbnail(photoData, type);
                        refreshCounts();
                        updateSummary();
                    };
                    reader.readAsDataURL(file);
                });
            }

            // 썸네일 생성
            function createThumbnail(photoData, type) {
                const area = type === 'before' ? beforeArea : afterArea;
                
                
                const thumbnail = document.createElement('div');
                thumbnail.className = 'photo-thumbnail';
                thumbnail.draggable = true;
                thumbnail.setAttribute('data-photo-id', photoData.id);
                thumbnail.setAttribute('data-type', type);
                
                thumbnail.innerHTML = `
                    <img src="${photoData.url}" alt="${photoData.name}">
                    <button class="delete-photo-btn" onclick="event.stopPropagation(); deletePhoto('${photoData.id}', '${type}')">×</button>
                    <button class="move-photo-btn" onclick="event.stopPropagation(); togglePhotoCategory('${photoData.id}', '${type}')">↔</button>
                `;

                // 드래그 이벤트
                thumbnail.addEventListener('dragstart', function(e) {
                    e.dataTransfer.setData('text/plain', JSON.stringify({
                        id: photoData.id,
                        type: type
                    }));
                });

                // 썸네일 클릭 시 업로드 영역으로 이벤트 전파 방지
                thumbnail.addEventListener('click', function(e) {
                    e.stopPropagation();
                });

                area.appendChild(thumbnail);
            }

            // 사진 삭제 함수
            window.deletePhoto = function(photoId, type) {
                if (type === 'before') {
                    state.photos.pre = state.photos.pre.filter(photo => photo.id !== photoId);
                } else {
                    state.photos.post = state.photos.post.filter(photo => photo.id !== photoId);
                }
                
                const thumbnail = document.querySelector(`[data-photo-id="${photoId}"]`);
                if (thumbnail) {
                    thumbnail.remove();
                }
                
                
                refreshCounts();
                updateSummary();
            };



            // 카운트 업데이트
            function refreshCounts() {
                const preCount = state.photos.pre.length;
                const postCount = state.photos.post.length;
                const totalCount = preCount + postCount;
                
                // 모든 카운터 요소 찾기
                const allCounters = document.querySelectorAll('.counter-number');
                console.log(`발견된 카운터 개수: ${allCounters.length}`);
                
                // 보수전 카운터 업데이트 (첫 번째)
                if (allCounters.length > 0) {
                    allCounters[0].textContent = preCount;
                    console.log(`보수전 카운터 업데이트: ${preCount}`);
                }
                
                // 보수후 카운터 업데이트 (두 번째)
                if (allCounters.length > 1) {
                    allCounters[1].textContent = postCount;
                    console.log(`보수후 카운터 업데이트: ${postCount}`);
                }
                
                // 전체 카운터 업데이트 (세 번째 또는 별도)
                const totalCounter = document.querySelector('.upload-counter .counter-number');
                if (totalCounter) {
                    totalCounter.textContent = totalCount;
                    console.log(`전체 카운터 업데이트: ${totalCount}`);
                }
                
                // 추가 안전장치: ID로 직접 찾기
                const beforeCounterById = document.querySelector('#before-counter');
                const afterCounterById = document.querySelector('#after-counter');
                
                if (beforeCounterById) {
                    beforeCounterById.textContent = preCount;
                    console.log(`ID로 보수전 카운터 업데이트: ${preCount}`);
                }
                
                if (afterCounterById) {
                    afterCounterById.textContent = postCount;
                    console.log(`ID로 보수후 카운터 업데이트: ${postCount}`);
                }
                
                // 디버깅을 위한 콘솔 로그
                console.log(`전체 카운터 업데이트 완료: 보수전=${preCount}, 보수후=${postCount}, 전체=${totalCount}`);
            }

            // 카테고리 간 드래그&드롭 이동
            function setupCategoryDrop(area, targetType) {
                area.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                });

                area.addEventListener('drop', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    try {
                        const dragData = JSON.parse(e.dataTransfer.getData('text/plain'));
                        if (dragData.id && dragData.type) {
                            movePhotoBetweenCategories(dragData.id, dragData.type, targetType);
                        }
                    } catch (error) {
                        console.error('드래그 데이터 파싱 오류:', error);
                    }
                });
            }

            // 사진을 카테고리 간 이동
            function movePhotoBetweenCategories(photoId, fromType, toType) {
                if (fromType === toType) return;

                const fromArray = fromType === 'before' ? state.photos.pre : state.photos.post;
                const toArray = toType === 'before' ? state.photos.pre : state.photos.post;
                
                // 최대 30장 제한 확인
                if (toArray.length >= 30) {
                    alert('최대 30장까지 업로드 가능합니다.');
                    return;
                }

                // 사진 찾기 및 이동
                const photoIndex = fromArray.findIndex(photo => photo.id === photoId);
                if (photoIndex !== -1) {
                    const photo = fromArray[photoIndex];
                    fromArray.splice(photoIndex, 1);
                    toArray.push(photo);

                    // DOM에서 썸네일 이동
                    const thumbnail = document.querySelector(`[data-photo-id="${photoId}"]`);
                    if (thumbnail) {
                        thumbnail.remove();
                        createThumbnail(photo, toType);
                    }

                    // 카운터 즉시 업데이트 (여러 번 호출하여 확실하게)
                    console.log(`이미지 이동: ${fromType} -> ${toType}, 보수전: ${state.photos.pre.length}, 보수후: ${state.photos.post.length}`);
                    
                    // 즉시 업데이트
                    refreshCounts();
                    
                    // DOM 업데이트 후 재업데이트
                    setTimeout(() => {
                        refreshCounts();
                        updateSummary();
                    }, 10);
                    
                    // 추가 안전장치
                    setTimeout(() => {
                        refreshCounts();
                    }, 50);
                    
                    // 최종 확인
                    setTimeout(() => {
                        refreshCounts();
                        console.log(`최종 카운터 확인: 보수전=${state.photos.pre.length}, 보수후=${state.photos.post.length}`);
                    }, 100);
                }
            }

            // 사진 카테고리 토글 (보수전 ↔ 보수후)
            window.togglePhotoCategory = function(photoId, currentType) {
                const toType = currentType === 'before' ? 'after' : 'before';
                movePhotoBetweenCategories(photoId, currentType, toType);
            };

            // 드롭 영역 설정
            setupUploadArea(beforeArea, 'before');
            setupUploadArea(afterArea, 'after');
            setupCategoryDrop(beforeArea, 'before');
            setupCategoryDrop(afterArea, 'after');


            // 초기 카운트 설정
            refreshCounts();

            // 사진 업로드 버튼 기능
            const photoResetBtn = document.getElementById('photoResetBtn');
            const photoSaveBtn = document.getElementById('photoSaveBtn');

            // 처음부터 버튼 - 업로드한 행위 초기화
            if (photoResetBtn) {
                photoResetBtn.addEventListener('click', function() {
                    resetPhotoUploads();
                });
            }

            // 저장하기 버튼 - 관리자 콘솔에 사진 데이터 저장
            if (photoSaveBtn) {
                photoSaveBtn.addEventListener('click', function() {
                    savePhotosToAdmin();
                });
            }

            // 사진 업로드 초기화 함수
            function resetPhotoUploads() {
                // 상태 초기화
                state.photos.pre = [];
                state.photos.post = [];
                
                // DOM에서 모든 썸네일 제거
                const beforeArea = document.querySelector('.before-area');
                const afterArea = document.querySelector('.after-area');
                
                if (beforeArea) {
                    beforeArea.innerHTML = '';
                }
                
                if (afterArea) {
                    afterArea.innerHTML = '';
                }
                
                // 카운트 업데이트
                refreshCounts();
                updateSummary();
                
                alert('사진 업로드가 초기화되었습니다.');
            }

            // 사진을 관리자 콘솔에 저장하는 함수
            function savePhotosToAdmin() {
                const prePhotos = state.photos.pre;
                const postPhotos = state.photos.post;
                
                if (prePhotos.length === 0 && postPhotos.length === 0) {
                    alert('저장할 사진이 없습니다.');
                    return;
                }

                // 관리자 콘솔 데이터 구조
                const adminPhotoData = {
                    id: 'photo_upload_' + Date.now(),
                    site: state.site || '미선택',
                    date: state.date || getTodayDate(),
                    writer: state.writer || getLoggedInUser(),
                    part: state.part.join(', ') || '없음',
                    proc: state.proc.join(', ') || '없음',
                    area: state.area.join(', ') || '없음',
                    men: state.men,
                    block: state.block.val || '',
                    dong: state.dong || '',
                    ho: state.ho || '',
                    photos: {
                        pre: prePhotos.map(photo => ({
                            id: photo.id,
                            name: photo.name,
                            type: photo.type,
                            size: photo.size,
                            timestamp: new Date().toISOString()
                        })),
                        post: postPhotos.map(photo => ({
                            id: photo.id,
                            name: photo.name,
                            type: photo.type,
                            size: photo.size,
                            timestamp: new Date().toISOString()
                        }))
                    },
                    timestamp: new Date().toISOString(),
                    status: 'pending' // 관리자 승인 대기 상태
                };

                // 관리자 콘솔에 저장 (localStorage 시뮬레이션)
                const adminData = JSON.parse(localStorage.getItem('adminPhotoData') || '[]');
                adminData.push(adminPhotoData);
                localStorage.setItem('adminPhotoData', JSON.stringify(adminData));

                // 사진 데이터를 관리자 콘솔에 매핑
                const photoMapping = {
                    uploadId: adminPhotoData.id,
                    siteMapping: adminPhotoData.site,
                    dateMapping: adminPhotoData.date,
                    photoCount: {
                        pre: prePhotos.length,
                        post: postPhotos.length,
                        total: prePhotos.length + postPhotos.length
                    },
                    mappingTimestamp: new Date().toISOString()
                };

                // 사진 매핑 데이터 저장
                const mappingData = JSON.parse(localStorage.getItem('photoMappingData') || '[]');
                mappingData.push(photoMapping);
                localStorage.setItem('photoMappingData', JSON.stringify(mappingData));

                alert(`사진이 관리자 콘솔에 저장되었습니다.\n보수 전: ${prePhotos.length}장, 보수 후: ${postPhotos.length}장`);
                
                // 요약 업데이트
                updateSummary();
            }

            console.log('첨부파일 섹션 초기화됨');
        }

        // 첨부파일 섹션 초기화
        initAttachmentSection();

        // ========== 도면 관리 섹션 기능 ==========
        function initDrawingSection() {
            const uploadBtn = document.querySelector('.drawing-actions .btn-outline');
            const loadBtn = document.querySelector('.drawing-actions .btn-secondary');
            const saveBtn = document.querySelector('.drawing-actions .btn-primary');
            const drawingPreview = document.getElementById('drawingPreview');

            // 도면 업로드 기능 (작업 선택 팝업)
            if (uploadBtn && !uploadBtn.hasAttribute('data-listener-added')) {
                uploadBtn.setAttribute('data-listener-added', 'true');
                uploadBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    
                    
                    showTaskSelectionDialog();
                }, true); // capture phase에서 실행
            }

            // 작업 선택 다이얼로그
            function showTaskSelectionDialog() {
                
                // 기존 작업선택 다이얼로그가 있다면 제거
                const existingDialog = document.querySelector('.task-selection-dialog');
                if (existingDialog) {
                    existingDialog.remove();
                }
                
                const dialog = document.createElement('div');
                dialog.className = 'task-selection-dialog';
                
                // 다크모드 감지
                const isDarkMode = document.documentElement.getAttribute('data-theme') === 'dark';
                const backgroundColor = isDarkMode ? '#374151' : 'rgba(0, 0, 0, 0.8)';
                
                dialog.style.cssText = `
                    position: fixed;
                    bottom: 0;
                    left: 0;
                    right: 0;
                    background: ${backgroundColor};
                    backdrop-filter: blur(8px);
                    padding: 24px;
                    border-radius: 20px 20px 0 0;
                    z-index: 10000;
                    animation: slideUp 0.3s ease-out;
                `;
                
                const content = document.createElement('div');
                content.style.cssText = `
                    text-align: center;
                    color: white;
                `;
                
                content.innerHTML = `
                    <h3 style="margin: 0 0 24px 0; font-size: 20px; font-weight: 600; color: white;">작업 선택</h3>
                    <div style="display: flex; gap: 20px; justify-content: center;">
                        <div class="task-option" style="
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            padding: 20px;
                            cursor: pointer;
                            transition: all 0.2s ease;
                            min-width: 120px;
                        " data-type="camera">
                            <div style="
                                width: 60px;
                                height: 60px;
                                background: ${isDarkMode ? '#4B5563' : '#9CA3AF'};
                                border-radius: 12px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                margin-bottom: 12px;
                                position: relative;
                            ">
                                <div style="
                                    width: 28px;
                                    height: 28px;
                                    background: ${isDarkMode ? '#6B7280' : '#374151'};
                                    border-radius: 50%;
                                    position: relative;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                ">
                                    <div style="
                                        width: 16px;
                                        height: 16px;
                                        background: ${isDarkMode ? '#374151' : '#1F2937'};
                                        border-radius: 50%;
                                        position: relative;
                                    ">
                                        <div style="
                                            position: absolute;
                                            top: 2px;
                                            left: 2px;
                                            width: 4px;
                                            height: 4px;
                                            background: #14B8A6;
                                            border-radius: 50%;
                                        "></div>
                                        <div style="
                                            position: absolute;
                                            top: 1px;
                                            left: 1px;
                                            width: 2px;
                                            height: 2px;
                                            background: #EF4444;
                                            border-radius: 50%;
                                        "></div>
                                    </div>
                                </div>
                            </div>
                             <span style="font-size: 16px; font-weight: 600; color: white;">카메라</span>
                        </div>
                        
                        <div class="task-option" style="
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            padding: 20px;
                            cursor: pointer;
                            transition: all 0.2s ease;
                            min-width: 120px;
                        " data-type="gallery">
                            <div style="
                                width: 60px;
                                height: 60px;
                                background: linear-gradient(90deg, #8B5CF6 0%, #F97316 100%);
                                border-radius: 12px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                margin-bottom: 12px;
                                position: relative;
                            ">
                                <div style="
                                    width: 36px;
                                    height: 36px;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    position: relative;
                                ">
                                    <!-- 갤러리 아이콘 -->
                                    <div style="
                                        width: 60px;
                                        height: 60px;
                                        position: relative;
                                        display: flex;
                                        align-items: center;
                                        justify-content: center;
                                    ">
                                        <img src="https://postfiles.pstatic.net/MjAyNTA5MTVfMTQ5/MDAxNzU3OTQxOTA1MTM2.gUq5Z7pO1dRvJzdPMjid2c6zhPTMc-2sCjzvbbFuk9Qg.O2_dMV4OMwf-VVJfwQsahtWHDI8yTS-b4ikmL3ltbNog.PNG/gallery.png?type=w3840" 
                                             alt="갤러리 아이콘" 
                                             style="
                                                width: 60px;
                                                height: 60px;
                                                object-fit: contain;
                                                border-radius: 12px;
                                             ">
                                    </div>
                                </div>
                            </div>
                             <span style="font-size: 16px; font-weight: 600; color: white;">사진</span>
                        </div>
                    </div>
                `;
                
                dialog.appendChild(content);
                document.body.appendChild(dialog);
                
                // 팝업 닫기 함수
                function closeDialog() {
                    dialog.style.animation = 'slideDown 0.3s ease-out';
                    setTimeout(() => {
                        document.body.removeChild(dialog);
                        document.removeEventListener('keydown', handleKeyDown);
                        
                    }, 300);
                }
                
                // 바깥 영역 클릭으로 팝업 닫기
                dialog.addEventListener('click', function(e) {
                    if (e.target === dialog) {
                        e.preventDefault();
                        e.stopPropagation();
                        closeDialog();
                    }
                });
                
                // ESC 키로 팝업 닫기
                const handleKeyDown = function(e) {
                    if (e.key === 'Escape') {
                        closeDialog();
                    }
                };
                document.addEventListener('keydown', handleKeyDown);
                
                // 드래그로 팝업 닫기 기능
                let startY = 0;
                let currentY = 0;
                let isDragging = false;
                
                content.addEventListener('touchstart', function(e) {
                    startY = e.touches[0].clientY;
                    isDragging = true;
                });
                
                content.addEventListener('touchmove', function(e) {
                    if (!isDragging) return;
                    
                    currentY = e.touches[0].clientY;
                    const deltaY = currentY - startY;
                    
                    // 아래로 드래그할 때만 팝업을 따라 움직임
                    if (deltaY > 0) {
                        content.style.transform = `translateY(${deltaY}px)`;
                        content.style.opacity = Math.max(0.3, 1 - (deltaY / 200));
                    }
                });
                
                content.addEventListener('touchend', function(e) {
                    if (!isDragging) return;
                    
                    const deltaY = currentY - startY;
                    isDragging = false;
                    
                    // 100px 이상 아래로 드래그했으면 팝업 닫기
                    if (deltaY > 100) {
                        closeDialog();
                    } else {
                        // 원래 위치로 복원
                        content.style.transform = '';
                        content.style.opacity = '';
                    }
                });
                
                // 마우스 드래그 지원 (데스크톱)
                content.addEventListener('mousedown', function(e) {
                    startY = e.clientY;
                    isDragging = true;
                    e.preventDefault();
                });
                
                document.addEventListener('mousemove', function(e) {
                    if (!isDragging) return;
                    
                    currentY = e.clientY;
                    const deltaY = currentY - startY;
                    
                    if (deltaY > 0) {
                        content.style.transform = `translateY(${deltaY}px)`;
                        content.style.opacity = Math.max(0.3, 1 - (deltaY / 200));
                    }
                });
                
                document.addEventListener('mouseup', function(e) {
                    if (!isDragging) return;
                    
                    const deltaY = currentY - startY;
                    isDragging = false;
                    
                    if (deltaY > 100) {
                        closeDialog();
                    } else {
                        content.style.transform = '';
                        content.style.opacity = '';
                    }
                });
                
                // 호버 효과
                content.querySelectorAll('.task-option').forEach(option => {
                    option.addEventListener('mouseenter', function() {
                        this.style.transform = 'scale(1.05)';
                    });
                    option.addEventListener('mouseleave', function() {
                        this.style.transform = 'scale(1)';
                    });
                    
                    option.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        e.stopImmediatePropagation();
                        const type = this.dataset.type;
                        
                        
                        closeDialog();
                        openDirectUpload(type);
                    });
                });
                
                // CSS 애니메이션 추가
                if (!document.getElementById('task-selection-styles')) {
                    const style = document.createElement('style');
                    style.id = 'task-selection-styles';
                    style.textContent = `
                        @keyframes slideUp {
                            from {
                                transform: translateY(100%);
                                opacity: 0;
                            }
                            to {
                                transform: translateY(0);
                                opacity: 1;
                            }
                        }
                        
                        @keyframes slideDown {
                            from {
                                transform: translateY(0);
                                opacity: 1;
                            }
                            to {
                                transform: translateY(100%);
                                opacity: 0;
                            }
                        }
                    `;
                    document.head.appendChild(style);
                }
            }

            // 직접 업로드 함수
            function openDirectUpload(type) {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = (type === 'receipt' || type === 'drawing')
                    ? 'image/*,application/pdf,.dwg,.dxf'
                    : 'image/*';
                
                if (type === 'camera') {
                    input.setAttribute('capture', 'environment');
                }
                
                input.multiple = (type === 'gallery');
                input.style.display = 'none';
                
                input.onchange = e => handleFiles(e.target.files, type);
                input.click();
            }

            // 파일 처리 함수
            function handleFiles(files, type) {
                if (!files || files.length === 0) return;
                
                const fileArray = Array.from(files);
                const maxFiles = 30; // 최대 30개 제한
                const maxSize = 10 * 1024 * 1024; // 10MB 제한
                
                // 개수 제한 확인
                if (fileArray.length > maxFiles) {
                    alert(`최대 ${maxFiles}개까지만 업로드 가능합니다. 처음 ${maxFiles}개만 처리됩니다.`);
                    fileArray.splice(maxFiles);
                }
                
                // 각 파일 처리
                fileArray.forEach(file => {
                    // 파일 크기 검증
                    if (file.size > maxSize) {
                        alert(`파일 "${file.name}"이 너무 큽니다. (최대 10MB)`);
                        return;
                    }
                    
                    // 파일 타입 검증
                    const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp', 'application/pdf'];
                    if (!allowedTypes.includes(file.type)) {
                        alert(`파일 "${file.name}"은 지원하지 않는 형식입니다.`);
                        return;
                    }
                    
                    // 도면 업로드 처리
                    handleDrawingUpload(file, type);
                });
                
                // 카운터 업데이트
                updateDrawingCounter();
            }

            // 도면 카운터 업데이트
            function updateDrawingCounter() {
                const drawings = JSON.parse(localStorage.getItem('siteDrawings') || '[]');
                const counter = document.getElementById('cntDrawing');
                if (counter) {
                    counter.textContent = drawings.length;
                }
            }

            // 도면 불러오기 기능
            if (loadBtn) {
                loadBtn.addEventListener('click', function() {
                    loadDrawingFromStorage();
                });
            }

            // 도면 저장하기 기능
            if (saveBtn) {
                saveBtn.addEventListener('click', function() {
                    saveMarkedDrawing();
                });
            }





            // 도면 업로드 처리
            function handleDrawingUpload(file, source) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const drawingData = {
                        id: 'drawing_' + Date.now(),
                        name: file.name,
                        url: e.target.result,
                        type: file.type,
                        size: file.size,
                        source: source, // 업로드 소스 추가
                        timestamp: new Date().toISOString()
                    };

                    // 도면 미리보기창에 표시
                    showDrawingPreview(drawingData);
                    
                    alert('도면이 업로드되었습니다. 마킹 기능을 사용할 수 있습니다.');
                };
                reader.readAsDataURL(file);
            }

            // 공도면에서 도면 불러오기
            function loadDrawingFromStorage() {
                const publicDrawings = JSON.parse(localStorage.getItem('publicDrawings') || '[]');
                
                if (publicDrawings.length === 0) {
                    alert('공도면에 저장된 파일이 없습니다.');
                    return;
                }

                // 공도면 선택 다이얼로그 표시
                showPublicDrawingSelectionDialog(publicDrawings);
            }

            // 공도면 선택 다이얼로그
            function showPublicDrawingSelectionDialog(drawings) {
                const dialog = document.createElement('div');
                dialog.className = 'public-drawing-selection-dialog';
                dialog.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.5);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 10000;
                `;
                
                const content = document.createElement('div');
                content.style.cssText = `
                    background: white;
                    border-radius: 16px;
                    padding: 24px;
                    max-width: 400px;
                    width: 90%;
                    max-height: 80vh;
                    overflow-y: auto;
                `;
                
                let drawingsList = '';
                drawings.forEach((drawing, index) => {
                    const date = new Date(drawing.timestamp).toLocaleString();
                    drawingsList += `
                        <div class="drawing-item" style="
                            display: flex;
                            align-items: center;
                            padding: 12px;
                            border: 1px solid #e0e0e0;
                            border-radius: 8px;
                            margin-bottom: 8px;
                            cursor: pointer;
                            transition: background-color 0.2s;
                        " data-index="${index}">
                            <img src="${drawing.url}" style="
                                width: 60px;
                                height: 60px;
                                object-fit: cover;
                                border-radius: 4px;
                                margin-right: 12px;
                            ">
                            <div style="flex: 1;">
                                <div style="font-weight: 600; margin-bottom: 4px;">${drawing.name}</div>
                                <div style="font-size: 12px; color: #666;">${date}</div>
                                <div style="font-size: 12px; color: #666;">${(drawing.size / 1024).toFixed(1)} KB</div>
                                <div style="font-size: 12px; color: #31a3fa;">공도면</div>
                            </div>
                        </div>
                    `;
                });
                
                content.innerHTML = `
                    <h3 style="margin: 0 0 20px 0; color: #1A254F;">공도면에서 도면 선택</h3>
                    <div style="margin-bottom: 20px;">
                        ${drawingsList}
                    </div>
                    <button class="cancel-btn" style="
                        width: 100%;
                        padding: 12px;
                        border: none;
                        background: #f5f5f5;
                        color: #666;
                        border-radius: 12px;
                        font-size: 16px !important;
                        cursor: pointer;
                    ">취소</button>
                `;
                
                dialog.appendChild(content);
                document.body.appendChild(dialog);
                
                // 도면 선택 이벤트
                content.querySelectorAll('.drawing-item').forEach(item => {
                    item.addEventListener('click', function() {
                        const index = parseInt(this.dataset.index);
                        const selectedDrawing = drawings[index];
                        document.body.removeChild(dialog);
                        showDrawingPreview(selectedDrawing);
                        alert('공도면을 불러왔습니다. 마킹 기능을 사용할 수 있습니다.');
                    });
                    
                    item.addEventListener('mouseenter', function() {
                        this.style.backgroundColor = '#f8f9fa';
                    });
                    
                    item.addEventListener('mouseleave', function() {
                        this.style.backgroundColor = 'white';
                    });
                });
                
                // 취소 버튼
                content.querySelector('.cancel-btn').addEventListener('click', () => {
                    document.body.removeChild(dialog);
                });
                
                // 배경 클릭으로 닫기
                dialog.addEventListener('click', (e) => {
                    if (e.target === dialog) {
                        document.body.removeChild(dialog);
                    }
                });
            }

            // 도면 선택 다이얼로그 (기존 관리자용)
            function showDrawingSelectionDialog(drawings) {
                const dialog = document.createElement('div');
                dialog.className = 'drawing-selection-dialog';
                dialog.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.5);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 10000;
                `;
                
                const content = document.createElement('div');
                content.style.cssText = `
                    background: white;
                    border-radius: 16px;
                    padding: 24px;
                    max-width: 400px;
                    width: 90%;
                    max-height: 80vh;
                    overflow-y: auto;
                `;
                
                let drawingsList = '';
                drawings.forEach((drawing, index) => {
                    const date = new Date(drawing.timestamp).toLocaleString();
                    drawingsList += `
                        <div class="drawing-item" style="
                            display: flex;
                            align-items: center;
                            padding: 12px;
                            border: 1px solid #e0e0e0;
                            border-radius: 8px;
                            margin-bottom: 8px;
                            cursor: pointer;
                            transition: background-color 0.2s;
                        " data-index="${index}">
                            <img src="${drawing.url}" style="
                                width: 60px;
                                height: 60px;
                                object-fit: cover;
                                border-radius: 4px;
                                margin-right: 12px;
                            ">
                            <div style="flex: 1;">
                                <div style="font-weight: 600; margin-bottom: 4px;">${drawing.name}</div>
                                <div style="font-size: 12px; color: #666;">${date}</div>
                                <div style="font-size: 12px; color: #666;">${(drawing.size / 1024).toFixed(1)} KB</div>
                            </div>
                        </div>
                    `;
                });
                
                content.innerHTML = `
                    <h3 style="margin: 0 0 20px 0; color: #1A254F;">공도면에서 도면 선택</h3>
                    <div style="margin-bottom: 20px;">
                        ${drawingsList}
                    </div>
                    <button class="cancel-btn" style="
                        width: 100%;
                        padding: 12px;
                        border: none;
                        background: #f5f5f5;
                        color: #666;
                        border-radius: 12px;
                        font-size: 16px !important;
                        cursor: pointer;
                    ">취소</button>
                `;
                
                dialog.appendChild(content);
                document.body.appendChild(dialog);
                
                // 도면 선택 이벤트
                content.querySelectorAll('.drawing-item').forEach(item => {
                    item.addEventListener('click', function() {
                        const index = parseInt(this.dataset.index);
                        const selectedDrawing = drawings[index];
                        document.body.removeChild(dialog);
                        showDrawingPreview(selectedDrawing);
                        alert('도면을 불러왔습니다. 마킹 기능을 사용할 수 있습니다.');
                    });
                    
                    item.addEventListener('mouseenter', function() {
                        this.style.backgroundColor = '#f8f9fa';
                    });
                    
                    item.addEventListener('mouseleave', function() {
                        this.style.backgroundColor = 'white';
                    });
                });
                
                // 취소 버튼
                content.querySelector('.cancel-btn').addEventListener('click', () => {
                    document.body.removeChild(dialog);
                });
                
                // 배경 클릭으로 닫기
                dialog.addEventListener('click', (e) => {
                    if (e.target === dialog) {
                        document.body.removeChild(dialog);
                    }
                });
            }

            // 도면 미리보기 표시
            function showDrawingPreview(drawingData) {
                // 기존 미리보기 제거
                const existingPreview = document.getElementById('drawingPreview');
                if (existingPreview) {
                    existingPreview.remove();
                }

                // 새 미리보기 생성
                const preview = document.createElement('div');
                preview.id = 'drawingPreview';
                preview.className = 'drawing-preview';
                preview.innerHTML = `
                    <div class="drawing-preview-header">
                        <h4>도면 미리보기</h4>
                        <button class="close-drawing-btn" onclick="closeDrawingPreview()">닫기</button>
                    </div>
                    <div class="drawing-canvas-container">
                        <canvas id="drawingCanvas" width="800" height="600"></canvas>
                    </div>
                    <div class="drawing-tools">
                        <button class="drawing-tool-btn" data-tool="pen">펜</button>
                        <button class="drawing-tool-btn" data-tool="eraser">지우개</button>
                        <button class="drawing-tool-btn" data-tool="clear">전체 지우기</button>
                    </div>
                `;

                // 도면 섹션에 추가
                const drawingSection = document.querySelector('.drawing-section');
                if (drawingSection) {
                    drawingSection.appendChild(preview);
                }

                // 캔버스에 도면 그리기
                const canvas = document.getElementById('drawingCanvas');
                const ctx = canvas.getContext('2d');
                const img = new Image();
                img.onload = function() {
                    // 컨테이너 너비에 맞춘 캔버스 크기 계산
                    const container = canvas.parentElement;
                    const containerWidth = container.clientWidth - 32; // 패딩 고려
                    const imgRatio = img.width / img.height;
                    const canvasWidth = containerWidth;
                    const canvasHeight = canvasWidth / imgRatio;
                    
                    // 캔버스 크기 설정
                    canvas.width = canvasWidth;
                    canvas.height = canvasHeight;
                    canvas.style.width = canvasWidth + 'px';
                    canvas.style.height = canvasHeight + 'px';
                    
                    // 이미지 그리기
                    ctx.drawImage(img, 0, 0, canvasWidth, canvasHeight);
                    initDrawingTools(canvas, ctx);
                };
                img.src = drawingData.url;
            }

            // 도면 마킹 도구 초기화
            function initDrawingTools(canvas, ctx) {
                let isDrawing = false;
                let currentTool = 'pen';

                // 도구 버튼 이벤트
                document.querySelectorAll('.drawing-tool-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        document.querySelectorAll('.drawing-tool-btn').forEach(b => b.classList.remove('active'));
                        this.classList.add('active');
                        currentTool = this.dataset.tool;
                        
                        // 캔버스 커서 및 모드 변경
                        if (currentTool === 'pen' || currentTool === 'eraser') {
                            canvas.style.cursor = 'crosshair';
                            canvas.classList.remove('upload-mode');
                        } else if (currentTool === 'clear') {
                            ctx.clearRect(0, 0, canvas.width, canvas.height);
                            canvas.style.cursor = 'pointer';
                            canvas.classList.add('upload-mode');
                        } else {
                            // 기본 상태 (업로드 모드)
                            canvas.style.cursor = 'pointer';
                            canvas.classList.add('upload-mode');
                        }
                    });
                });

                // 초기 상태 설정 (업로드 모드)
                canvas.style.cursor = 'pointer';
                canvas.classList.add('upload-mode');

                // 캔버스 클릭으로 파일 업로드
                canvas.addEventListener('click', function(e) {
                    // 마킹 도구가 활성화된 상태가 아닐 때만 파일 업로드
                    if (currentTool === 'pen' || currentTool === 'eraser') {
                        return; // 마킹 도구 사용 중이면 파일 업로드 하지 않음
                    }
                    
                    const input = document.createElement('input');
                    input.type = 'file';
                    input.accept = 'image/*';
                    input.style.display = 'none';
                    
                    input.addEventListener('change', function(e) {
                        const file = e.target.files[0];
                        if (file) {
                            handleDrawingUpload(file);
                        }
                    });
                    
                    document.body.appendChild(input);
                    input.click();
                    document.body.removeChild(input);
                });

                // 캔버스 우클릭으로 파일 업로드 (마킹 도구 사용 중에도 가능)
                canvas.addEventListener('contextmenu', function(e) {
                    e.preventDefault(); // 기본 우클릭 메뉴 방지
                    
                    const input = document.createElement('input');
                    input.type = 'file';
                    input.accept = 'image/*';
                    input.style.display = 'none';
                    
                    input.addEventListener('change', function(e) {
                        const file = e.target.files[0];
                        if (file) {
                            handleDrawingUpload(file);
                        }
                    });
                    
                    document.body.appendChild(input);
                    input.click();
                    document.body.removeChild(input);
                });

                // 마우스 이벤트
                canvas.addEventListener('mousedown', function(e) {
                    isDrawing = true;
                    const rect = canvas.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    
                    if (currentTool === 'pen') {
                        ctx.beginPath();
                        ctx.moveTo(x, y);
                        ctx.strokeStyle = '#FF0000';
                        ctx.lineWidth = 3;
                    }
                });

                canvas.addEventListener('mousemove', function(e) {
                    if (!isDrawing) return;
                    
                    const rect = canvas.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    
                    if (currentTool === 'pen') {
                        ctx.lineTo(x, y);
                        ctx.stroke();
                    } else if (currentTool === 'eraser') {
                        ctx.globalCompositeOperation = 'destination-out';
                        ctx.beginPath();
                        ctx.arc(x, y, 10, 0, Math.PI * 2);
                        ctx.fill();
                        ctx.globalCompositeOperation = 'source-over';
                    }
                });

                canvas.addEventListener('mouseup', function() {
                    isDrawing = false;
                });
            }

            // 도면 미리보기 닫기
            window.closeDrawingPreview = function() {
                const preview = document.getElementById('drawingPreview');
                if (preview) {
                    preview.remove();
                }
            };

            // 마킹된 도면을 현장 진행 도면에 저장
            function saveMarkedDrawing() {
                const canvas = document.getElementById('drawingCanvas');
                if (!canvas) {
                    alert('저장할 도면이 없습니다.');
                    return;
                }

                // 캔버스를 이미지로 변환
                const dataURL = canvas.toDataURL('image/png');
                
                // 마킹된 도면을 현장 진행 도면에 저장
                const markedDrawing = {
                    id: 'site_drawing_' + Date.now(),
                    name: '현장 진행 도면',
                    url: dataURL,
                    type: 'image/png',
                    size: dataURL.length,
                    timestamp: new Date().toISOString(),
                    markings: getCurrentMarkings(), // 현재 마킹 정보 저장
                    source: 'site_progress' // 현장 진행 도면임을 표시
                };

                // 현장 진행 도면에 저장
                const siteDrawings = JSON.parse(localStorage.getItem('siteDrawings') || '[]');
                siteDrawings.push(markedDrawing);
                localStorage.setItem('siteDrawings', JSON.stringify(siteDrawings));
                
                alert('마킹된 도면이 현장 진행 도면에 저장되었습니다.');
                updateSummary();
                
                // 미리보기 닫기
                closeDrawingPreview();
            }

            // 현재 마킹 정보 가져오기
            function getCurrentMarkings() {
                const canvas = document.getElementById('drawingCanvas');
                if (!canvas) return [];
                
                // 마킹된 도형들의 정보를 수집
                const markings = [];
                // 실제 구현에서는 캔버스에 그려진 도형들의 정보를 수집
                // 예: 선, 원, 텍스트 등의 좌표와 속성 정보
                
                return markings;
            }

            console.log('도면 관리 섹션 초기화됨');
        }

        // 도면 관리 섹션 초기화
        initDrawingSection();


        // 전역 함수: 아이콘 클릭 시 페이지 이동
        window.navigateToPage = function(url, event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            console.log('페이지 이동:', url);
            
            
            // 즉시 페이지 이동
            window.location.href = url;
        };


        });

        // ===== 캘린더 기능 =====
        (function() {
            let currentDate = new Date();
            
            // 워크로그와 동일한 테스트 데이터 (시간을 일로 변환)
            const workData = {
                '전체 현장': { '2025-09': { workdays: 18, sites: 3, hours: 22 } },  // 176시간 ÷ 8시간 = 22일
                'Site A':   { '2025-09': { workdays: 12, sites: 1, hours: 15 } }    // 120시간 ÷ 8시간 = 15일
            };

            function generateYearMonthOptions(){
                const sel = document.getElementById('yearMonthSelect');
                const disp = document.getElementById('yearMonthDisplay');
                const now = new Date(); 
                const y = now.getFullYear();
                
                for(let i = -12; i <= 12; i++){
                    const d = new Date(y, now.getMonth() + i, 1);
                    const ym = `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}`;
                    const opt = document.createElement('option');
                    opt.value = ym;
                    opt.textContent = ym;
                    sel.appendChild(opt);
                }
                
                const cur = `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, '0')}`;
                sel.value = cur; 
                disp.textContent = cur;
            }

            function renderCalendar(){
                const ymBtn = document.getElementById('ymBtn');
                const calGrid = document.getElementById('calGrid');
                const year = currentDate.getFullYear();
                const month = currentDate.getMonth();
                ymBtn.textContent = `${year}년 ${month + 1}월`;

                const first = new Date(year, month, 1);
                const last = new Date(year, month + 1, 0);
                const prevLast = new Date(year, month, 0).getDate();

                calGrid.innerHTML = '';
                for(let i = first.getDay() - 1; i >= 0; i--) addCell(prevLast - i, true);
                for(let d = 1; d <= last.getDate(); d++) addCell(d, false);
                const remain = 42 - calGrid.children.length;
                for(let d = 1; d <= remain; d++) addCell(d, true);

                updateStats();
            }

            function addCell(day, isOut){
                const cell = document.createElement('div'); 
                cell.className = 'cell';
                if(isOut) cell.classList.add('out');
                cell.dataset.date = `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                
                const date = document.createElement('div'); 
                date.className = 'date'; 
                date.textContent = day;
                if(!isOut && new Date(currentDate.getFullYear(), currentDate.getMonth(), day).getDay() === 0) 
                    date.classList.add('sun');
                cell.appendChild(date);
                
                if(!isOut){
                    // 저장된 데이터 불러오기
                    const cellData = JSON.parse(localStorage.getItem('calendarData') || '{}');
                    const savedData = cellData[cell.dataset.date] || {};
                    
                    // 선택된 현장명 가져오기
                    const selectedSite = document.getElementById('selectDisplay').textContent;
                    
                    // 현장명을 4글자로 제한하는 함수
                    function truncateToFourChars(text) {
                        if (text.length <= 4) return text;
                        return text.substring(0, 4);
                    }
                    
                    // 날짜별 테스트 데이터 (실제로는 선택된 현장에 따라 달라짐)
                    const testSiteData = {
                        '2025-09-01': '현장A',
                        '2025-09-02': '현장B', 
                        '2025-09-03': '현장C',
                        '2025-09-04': '현장D',
                        '2025-09-05': '현장E',
                        '2025-09-06': '현장F',
                        '2025-09-07': '현장G',
                        '2025-09-08': '현장H',
                        '2025-09-09': '현장I',
                        '2025-09-10': '현장J',
                        '2025-09-11': '현장K',
                        '2025-09-12': '현장L',
                        '2025-09-13': '현장M',
                        '2025-09-14': '현장N',
                        '2025-09-15': '현장O',
                        '2025-09-16': '현장P',
                        '2025-09-17': '현장Q',
                        '2025-09-18': '현장R',
                        '2025-09-19': '현장S',
                        '2025-09-20': '현장T',
                        '2025-09-21': '현장U',
                        '2025-09-22': '현장V',
                        '2025-09-23': '현장W',
                        '2025-09-24': '현장X',
                        '2025-09-25': '현장Y',
                        '2025-09-26': '현장Z',
                        '2025-09-27': '현장AA',
                        '2025-09-28': '현장BB',
                        '2025-09-29': '현장CC',
                        '2025-09-30': '현장DD'
                    };
                    
                    // 현장명 편집 가능한 div
                    const site = document.createElement('div'); 
                    site.className = 'site-name';
                    const siteName = savedData.site || testSiteData[cell.dataset.date] || selectedSite || '전체';
                    site.textContent = truncateToFourChars(siteName);
                    cell.appendChild(site);
                    
                    // 작업시간 편집 가능한 div
                    const hours = document.createElement('div'); 
                    hours.className = 'work-hours';
                    hours.textContent = savedData.hours ? `${savedData.hours}일` : '6일';
                    cell.appendChild(hours);
                }
                document.getElementById('calGrid').appendChild(cell);
            }

            function updateStats(){
                const site = document.getElementById('selectDisplay').textContent;
                const ym = document.getElementById('yearMonthSelect').value;
                const d = workData[site]?.[ym] || {workdays: 0, sites: 0, hours: 0};
                document.getElementById('workDays').textContent = d.workdays;
                document.getElementById('siteCount').textContent = d.sites;
                document.getElementById('totalManDays').textContent = d.hours;
            }

            // 이벤트 리스너
            document.getElementById('btnPrev').onclick = () => {
                currentDate.setMonth(currentDate.getMonth() - 1);
                renderCalendar();
            };
            
            document.getElementById('btnNext').onclick = () => {
                currentDate.setMonth(currentDate.getMonth() + 1);
                renderCalendar();
            };
            
            document.getElementById('siteSelect').onchange = e => {
                const selectedValue = e.target.value || '전체 현장';
                document.getElementById('selectDisplay').textContent = selectedValue;
                renderCalendar();
                updateStats();
            };
            
            document.getElementById('yearMonthSelect').onchange = e => {
                document.getElementById('yearMonthDisplay').textContent = e.target.value;
                renderCalendar();
                updateStats();
            };

            // 초기화
            generateYearMonthOptions();
            renderCalendar();
        })();

        // ===== 급여현황 탭 기능 =====
        (function() {
            // DOM 요소 선택 함수
            window.$ = function(id) {
                return document.getElementById(id);
            }
            
            // 급여 기능 초기화
            console.log('급여 기능 초기화 시작');

            // 숫자 파싱 함수 - 글로벌 정의
            window.number = (v)=>{
                if(typeof v==='number') return v;
                v = (v||'').toString().replace(/[^0-9\\-]/g,'');
                return parseInt(v||'0',10);
            };

            // 고용형태별 세율 계산 함수 - 워크로그와 동일
            window.getTaxRate = function(empType, customRate = null) {
                let incomeRate = 0;
                let localRate = 0;
                
                if (empType === 'freelance') {
                    incomeRate = 3.3; // 3.3%
                    localRate = incomeRate * 0.1; // 소득세의 10%
                } else if (empType === 'daily') {
                    incomeRate = 6.0; // 6.0%
                    localRate = 0.6; // 0.6%
                } else if (empType === 'regular') {
                    incomeRate = customRate || 15.4; // 15.4% 기본값 또는 직접입력값
                    localRate = 0; // 0%
                }
                
                // 소득세와 지방소득세 계산
                const incomeTaxRate = incomeRate / 100;
                const localTaxRate = localRate / 100;
                
                return {
                    income: incomeTaxRate,
                    local: localTaxRate,
                    total: incomeRate
                };
            }

            // 급여 계산 함수 - 워크로그와 동일
            window.recalc = function() {
                console.log('급여 계산 시작');
                const units = window.number(window.$('daysUnits').value); // 공수
                const off = window.number(window.$('daysOff').value); // 휴무(음수 허용)
                const present = units + off; // 출근(일) = 공수 + 휴무(음수)
                const baseAuto = window.number(window.$('baseAdmin').value);
                const baseManual = window.number(window.$('baseManual').value);
                
                console.log(`계산 데이터: units=${units}, off=${off}, present=${present}, baseAuto=${baseAuto}, baseManual=${baseManual}`);
                const base = baseManual > 0 ? baseManual : baseAuto; // 직접입력 우선
                
                // 고용형태에 따른 세율 계산
                const empType = window.getSelectedEmpType();
                const customRate = document.getElementById('customRate')?.value ? parseFloat(document.getElementById('customRate').value) : null;
                const rate = window.getTaxRate(empType, customRate);
                
                // 계산된 기본급 (공수 × 기본급)
                const calculatedBasic = units * base;
                
                // 소득세와 지방소득세 계산
                const incomeTax = Math.round(calculatedBasic * rate.income);
                const localTax = Math.round(calculatedBasic * rate.local);
                
                // 지급액 계
                const totalEarn = calculatedBasic;
                
                // 공제액 계
                const totalDeduct = incomeTax + localTax;
                
                // 실지급액
                const netPay = totalEarn - totalDeduct;
                
                console.log(`계산 결과: gross=${calculatedBasic}, incomeTax=${incomeTax}, localTax=${localTax}, netPay=${netPay}`);

                // 휴무일 필드 자동 업데이트
                window.$('daysOff').value = off;

                // 상단 배지
                window.$('badgePresent').textContent = isNaN(present) ? '0' : present;
                window.$('badgeOff').textContent = Math.abs(off);
                window.$('badgeUnits').textContent = units;

                // 요약 행
                window.$('rowBase').textContent = new Intl.NumberFormat('ko-KR').format(base) + '원';
                window.$('rowUnits').textContent = units + '일';
                
                // 세율 표시 (커스텀 세율이 있으면 표시)
                let rateDisplay = rate.total.toFixed(1);
                if (empType === 'regular' && customRate && customRate > 0) {
                    rateDisplay = customRate.toFixed(1);
                }
                window.$('rowTaxRate').textContent = rateDisplay;
                
                // 지방소득세 비율 표시
                let localTaxRateDisplay = '0.0';
                if (empType === 'freelance') {
                    localTaxRateDisplay = (rate.total * 0.1).toFixed(1); // 소득세의 10%
                } else if (empType === 'daily') {
                    localTaxRateDisplay = '0.6'; // 고정 0.6%
                } else if (empType === 'regular') {
                    localTaxRateDisplay = '0.0'; // 고정 0%
                }
                window.$('rowLocalTaxRate').textContent = localTaxRateDisplay;
                
                window.$('rowPresent').textContent = present + '일';
                window.$('rowOff').textContent = off + '일';
                window.$('rowIncomeTax').textContent = '-' + new Intl.NumberFormat('ko-KR').format(Math.round(incomeTax)) + '원';
                window.$('rowLocalTax').textContent = '-' + new Intl.NumberFormat('ko-KR').format(Math.round(localTax)) + '원';
                window.$('rowNet').textContent = new Intl.NumberFormat('ko-KR').format(Math.round(netPay)) + '원';
                
                console.log('급여 계산 완료');
            }

            // 고용형태 칩 선택 이벤트 - 워크로그와 동일
            const chips = document.querySelectorAll('.chip[data-role="emp"]');
            console.log(`고용형태 칩 ${chips.length}개 발견`);
            let empType = 'freelance'; // 기본값

            window.activeChip = function(value) {
                chips.forEach(ch => {
                    const on = ch.dataset.value === value;
                    ch.setAttribute('data-active', on ? 'true' : 'false');
                    ch.setAttribute('aria-selected', on ? 'true' : 'false');
                });
            }

            // 고용형태 가져오기
            window.getSelectedEmpType = function() {
                const chips = document.querySelectorAll('.chip[data-role="emp"]');
                for (const chip of chips) {
                    if (chip.getAttribute('data-active') === 'true') {
                        return chip.getAttribute('data-value');
                    }
                }
                return 'freelance';
            }

            chips.forEach(ch => {
                ch.addEventListener('click', () => {
                    empType = ch.dataset.value;
                    console.log(`고용형태 선택: ${empType}`);
                    window.activeChip(empType);
                    
                    // 상용 선택 시 세율 직접입력 필드 표시/숨김
                    const customRateField = document.getElementById('customRateField');
                    const customRateInput = window.$('customRate');
                    
                    if (empType === 'regular') {
                        // 상용 선택 시: 세율 입력창 표시
                        customRateField.style.display = 'block';
                        // 입력창에 포커스
                        setTimeout(() => {
                            if (customRateInput) {
                                customRateInput.focus();
                            }
                        }, 100);
                    } else {
                        // 다른 고용형태 선택 시 필드 숨기기 및 입력값 초기화
                        customRateField.style.display = 'none';
                        if (customRateInput) {
                            customRateInput.value = '';
                        }
                        
                        // 상용 칩 텍스트 원래대로 복원
                        const regularChip = document.querySelector('.chip[data-value="regular"]');
                        if (regularChip) {
                            regularChip.textContent = '상용';
                        }
                    }
                    
                    window.recalc();
                });
            });

            // 커스텀 세율 입력 이벤트 - 워크로그와 동일
            const customRateInput = window.$('customRate');
            if (customRateInput) {
                customRateInput.addEventListener('input', function(e) {
                    // 숫자만 입력 허용
                    let value = e.target.value.replace(/[^0-9.]/g, '');
                    e.target.value = value;
                    
                    // 상용 칩 텍스트 업데이트
                    const regularChip = document.querySelector('.chip[data-value="regular"]');
                    if (regularChip) {
                        if (value && value.trim() !== '') {
                            regularChip.textContent = `${value}%`;
                        } else {
                            regularChip.textContent = '상용';
                        }
                    }
                    
                    // 입력값이 있으면 계산 실행
                    if (value && value.trim() !== '') {
                        window.recalc();
                    }
                });
                
                // 포커스 아웃 시 입력창 닫기
                customRateInput.addEventListener('blur', function() {
                    setTimeout(() => {
                        const customRateField = window.$('customRateField');
                        if (customRateField && empType === 'regular') {
                            customRateField.style.display = 'none';
                        }
                    }, 200);
                });
            }
            
            // 외부 클릭 시 세율 입력창 닫기
            document.addEventListener('click', function(e) {
                const customRateField = window.$('customRateField');
                const customRateInput = window.$('customRate');
                
                if (customRateField && customRateField.style.display === 'block' && 
                    empType === 'regular' && 
                    !customRateField.contains(e.target) && 
                    !e.target.closest('.chip[data-value="regular"]')) {
                    customRateField.style.display = 'none';
                }
            });

            // 입력 필드 이벤트 리스너 (휴무일 제외 - 자동 계산)
            const inputFields = ['daysUnits', 'baseAdmin', 'baseManual'];
            inputFields.forEach(fieldId => {
                const field = window.$(fieldId);
                if (field) {
                    console.log(`${fieldId} 필드 이벤트 리스너 추가`);
                    field.addEventListener('input', () => {
                        console.log(`${fieldId} 필드 값 변경됨`);
                        if (window.recalc) {
                            window.recalc();
                        }
                    });
                } else {
                    console.error(`${fieldId} 필드를 찾을 수 없음`);
                }
            });

            // 접기/펼치기
            const toggleForm = window.$('toggleForm');
            if (toggleForm) {
                toggleForm.addEventListener('click', () => {
                    const body = document.getElementById('formBody');
                    const isOpen = body.style.display !== 'none';
                    body.style.display = isOpen ? 'none' : 'block';
                    toggleForm.textContent = isOpen ? '열기' : '닫기';
                });
            }

            // 급여명세서 관련 변수
            let zoomLevel = 1.0;

            // 숫자 포맷팅 함수
            function formatNumber(num) {
                return new Intl.NumberFormat('ko-KR').format(num || 0);
            }

            // 급여명세서 데이터 계산
            function calculatePayslipData() {
                // 기본급 가져오기
                const baseAdmin = parseFloat(document.getElementById('baseAdmin')?.value || 0);
                const baseManual = parseFloat(document.getElementById('baseManual')?.value || 0);
                const basicPay = baseAdmin || baseManual;

                // 공수 가져오기
                const units = parseFloat(document.getElementById('daysUnits')?.value || 0);

                // 고용형태에 따른 세율 계산
                const empType = window.getSelectedEmpType();
                const customRate = document.getElementById('customRate')?.value ? parseFloat(document.getElementById('customRate').value) : null;
                const rate = window.getTaxRate(empType, customRate);

                // 계산된 기본급 (공수 × 기본급)
                const calculatedBasic = units * basicPay;

                // 소득세와 지방소득세 계산
                const incomeTax = Math.round(calculatedBasic * rate.income);
                const localTax = Math.round(calculatedBasic * rate.local);

                // 지급액 계
                const totalEarn = calculatedBasic;

                // 공제액 계
                const totalDeduct = incomeTax + localTax;

                // 실지급액
                const netPay = totalEarn - totalDeduct;

                return {
                    basicPay: basicPay,
                    units: units,
                    calculatedBasic: calculatedBasic,
                    totalEarn: totalEarn,
                    incomeTax: incomeTax,
                    localTax: localTax,
                    totalDeduct: totalDeduct,
                    netPay: netPay,
                    calculation: `${units}일 × ${formatNumber(basicPay)}원`
                };
            }

            // 작성자 이름 가져오기
            function getAuthorName() {
                // 실제 구현에서는 사용자 정보를 가져와야 합니다
                // 여기서는 예시로 고정값을 사용합니다
                const name = localStorage.getItem('userName');
                if (name) {
                    return name;
                }
                return '이현수';
            }

            // 급여명세서 데이터 업데이트
            function updatePayslipData() {
                const data = calculatePayslipData();
                const authorName = getAuthorName();
                
                // 현재 날짜 정보
                const now = new Date();
                const currentYear = now.getFullYear();
                const currentMonth = now.getMonth() + 1;
                const prevMonth = currentMonth === 1 ? 12 : currentMonth - 1;
                const prevYear = currentMonth === 1 ? currentYear - 1 : currentYear;

                // 데이터 반영
                document.getElementById('payslipName').textContent = authorName;
                document.getElementById('payslipPayDate').textContent = `${currentYear}.${String(currentMonth).padStart(2, '0')}.10`;
                document.getElementById('payslipDate').textContent = `${prevYear}.${String(prevMonth).padStart(2, '0')}월`;
                
                document.getElementById('payslipBasicPay').textContent = formatNumber(data.basicPay);
                document.getElementById('payslipTotalEarn').textContent = formatNumber(data.totalEarn);
                document.getElementById('payslipNetPay').textContent = formatNumber(data.netPay);
                
                document.getElementById('payslipIncomeTax').textContent = formatNumber(data.incomeTax);
                document.getElementById('payslipLocalTax').textContent = formatNumber(data.localTax);
                document.getElementById('payslipTotalDeduct').textContent = formatNumber(data.totalDeduct);
                
                document.getElementById('payslipCalculation').textContent = data.calculation;
                document.getElementById('payslipCalcAmount').textContent = formatNumber(data.totalEarn);
            }

            // 줌 기능
            function updateZoom() {
                const content = document.getElementById('payslipContent');
                const zoomLevelElement = document.getElementById('zoomLevel');
                const payslipDocument = document.querySelector('.payslip-document');
                
                if (content) {
                    content.style.transform = `scale(${zoomLevel})`;
                    content.style.transformOrigin = 'top left';
                    // 줌 시 스크롤 위치 조정
                    content.scrollLeft = 0;
                    content.scrollTop = 0;
                }
                
                // 100% 줌일 때 payslip-document를 가로에 딱 맞춤
                if (payslipDocument) {
                    if (zoomLevel === 1.0) {
                        // 100%일 때: 가로에 딱 맞춤, transform 초기화, 패딩 0
                        payslipDocument.style.transform = 'translate(0px, 0px)';
                        payslipDocument.style.width = '100%';
                        payslipDocument.style.maxWidth = '100%';
                        payslipDocument.style.padding = '0px';
                    } else {
                        // 다른 줌 레벨일 때: 원래 크기 유지, 패딩 0
                        payslipDocument.style.width = '100%';
                        payslipDocument.style.maxWidth = '100%';
                        payslipDocument.style.padding = '0px';
                    }
                }
                
                if (zoomLevelElement) {
                    zoomLevelElement.textContent = Math.round(zoomLevel * 100) + '%';
                }
            }

            // 관리자 승인 상태 확인 함수
            function checkAdminApproval() {
                // 실제 구현에서는 서버에서 승인 상태를 확인해야 합니다
                // 여기서는 예시로 localStorage를 사용합니다
                const approvalStatus = localStorage.getItem('adminApproval') || 'pending';
                return approvalStatus === 'approved';
            }

            // 개발자 테스트용 함수 (콘솔에서 사용)
            window.setAdminApproval = function(status) {
                localStorage.setItem('adminApproval', status);
                console.log(`관리자 승인 상태가 ${status}로 설정되었습니다.`);
            };

            // 관리자 승인 상태 확인 함수 (전역 접근 가능)
            window.checkAdminApproval = checkAdminApproval;

            // 승인 필요 메시지 표시
            function showApprovalRequiredMessage() {
                alert('관리자승인후 저장가능합니다.');
            }

            // PDF 다운로드 함수
            function downloadPayslipPDF() {
                // html2canvas와 jsPDF를 사용한 PDF 생성
                const payslipDocument = document.querySelector('.payslip-document');
                
                if (!payslipDocument) {
                    alert('급여명세서 문서를 찾을 수 없습니다.');
                    return;
                }

                // html2canvas로 캔버스 생성
                html2canvas(payslipDocument, {
                    scale: 2,
                    useCORS: true,
                    allowTaint: true,
                    backgroundColor: '#ffffff'
                }).then(canvas => {
                    const imgData = canvas.toDataURL('image/png');
                    const pdf = new jsPDF('p', 'mm', 'a4');
                    
                    const imgWidth = 210;
                    const pageHeight = 295;
                    const imgHeight = (canvas.height * imgWidth) / canvas.width;
                    let heightLeft = imgHeight;
                    
                    let position = 0;
                    
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                    
                    while (heightLeft >= 0) {
                        position = heightLeft - imgHeight;
                        pdf.addPage();
                        pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                        heightLeft -= pageHeight;
                    }
                    
                    // 파일명 생성
                    const now = new Date();
                    const fileName = `급여명세서_${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}.pdf`;
                    
                    console.log('PDF 저장 시작:', fileName);
                    pdf.save(fileName);
                    console.log('PDF 저장 완료');
                }).catch(error => {
                    console.error('PDF 생성 중 오류 발생:', error);
                    alert('PDF 생성 중 오류가 발생했습니다.');
                });
            }

            // 급여명세서 버튼 이벤트
            const payslipPreviewBtn = window.$('payslipPreviewBtn');
            const payslipPdfBtn = window.$('payslipPdfBtn');
            const closeBtn = window.$('closePreview');
            const zoomOutBtn = window.$('zoomOut');
            const zoomInBtn = window.$('zoomIn');
            const previewContainer = window.$('payslipPreview');
            
            if (payslipPreviewBtn) {
                payslipPreviewBtn.addEventListener('click', function() {
                    updatePayslipData();
                    previewContainer.style.display = 'block';
                    zoomLevel = 1.0;
                    updateZoom();
                    // payslip-document 패딩 0으로 설정
                    const payslipDocument = document.querySelector('.payslip-document');
                    if (payslipDocument) {
                        payslipDocument.style.padding = '0px';
                    }
                });
            }
            
            if (payslipPdfBtn) {
                payslipPdfBtn.addEventListener('click', function() {
                    console.log('PDF 저장 버튼 클릭됨');
                    
                    // 관리자 승인 상태 확인
                    const isApproved = checkAdminApproval();
                    console.log('관리자 승인 상태:', isApproved);
                    
                    if (!isApproved) {
                        showApprovalRequiredMessage();
                        return;
                    }
                    
                    // PDF 다운로드 실행
                    console.log('PDF 다운로드 시작');
                    downloadPayslipPDF();
                });
            }

            // 닫기 버튼
            if (closeBtn) {
                closeBtn.addEventListener('click', function() {
                    previewContainer.style.display = 'none';
                });
            }

            // 줌 아웃 버튼
            if (zoomOutBtn) {
                zoomOutBtn.addEventListener('click', function() {
                    if (zoomLevel > 0.5) {
                        zoomLevel -= 0.1;
                        updateZoom();
                    }
                });
            }

            // 줌 인 버튼
            if (zoomInBtn) {
                zoomInBtn.addEventListener('click', function() {
                    if (zoomLevel < 2.0) {
                        zoomLevel += 0.1;
                        updateZoom();
                    }
                });
            }


            // 드래그 스크롤 기능 - 강화된 버전
            const payslipContent = document.getElementById('payslipContent');
            if (payslipContent) {
                console.log('급여명세서 팬 기능 초기화됨');
                
                // 스크롤 가능하도록 강제 설정
                payslipContent.style.overflow = 'auto';
                // payslip-document 드래그 기능
                const payslipDocument = document.querySelector('.payslip-document');
                if (payslipDocument) {
                    let isDragging = false;
                    let startX = 0;
                    let startY = 0;
                    let initialTransformX = 0;
                    let initialTransformY = 0;
                    let currentTransformX = 0;
                    let currentTransformY = 0;

                    // 마우스 이벤트
                    payslipDocument.addEventListener('mousedown', function(e) {
                        isDragging = true;
                        payslipDocument.style.cursor = 'grabbing';
                        payslipDocument.classList.add('dragging');
                        startX = e.clientX;
                        startY = e.clientY;
                        initialTransformX = currentTransformX;
                        initialTransformY = currentTransformY;
                        console.log('팬 시작:', { startX, startY, initialTransformX, initialTransformY });
                        e.preventDefault();
                        e.stopPropagation();
                    });

                    document.addEventListener('mouseleave', function() {
                        isDragging = false;
                        payslipDocument.style.cursor = 'grab';
                        payslipDocument.classList.remove('dragging');
                    });

                    document.addEventListener('mouseup', function() {
                        if (isDragging) {
                            isDragging = false;
                            payslipDocument.style.cursor = 'grab';
                            payslipDocument.classList.remove('dragging');
                            console.log('팬 종료:', { currentTransformX, currentTransformY });
                        }
                    });

                    document.addEventListener('mousemove', function(e) {
                        if (isDragging) {
                            const deltaX = e.clientX - startX;
                            const deltaY = e.clientY - startY;
                            currentTransformX = initialTransformX + deltaX;
                            currentTransformY = initialTransformY + deltaY;
                            
                            payslipDocument.style.transform = `translate(${currentTransformX}px, ${currentTransformY}px)`;
                            e.preventDefault();
                        }
                    });

                    // 터치 이벤트 (모바일 지원)
                    payslipDocument.addEventListener('touchstart', function(e) {
                        if (e.touches.length === 1) {
                            isDragging = true;
                            payslipDocument.style.cursor = 'grabbing';
                            payslipDocument.classList.add('dragging');
                            startX = e.touches[0].clientX;
                            startY = e.touches[0].clientY;
                            initialTransformX = currentTransformX;
                            initialTransformY = currentTransformY;
                            e.preventDefault();
                        }
                    });

                    document.addEventListener('touchend', function() {
                        if (isDragging) {
                            isDragging = false;
                            payslipDocument.style.cursor = 'grab';
                            payslipDocument.classList.remove('dragging');
                        }
                    });

                    document.addEventListener('touchmove', function(e) {
                        if (isDragging && e.touches.length === 1) {
                            const deltaX = e.touches[0].clientX - startX;
                            const deltaY = e.touches[0].clientY - startY;
                            currentTransformX = initialTransformX + deltaX;
                            currentTransformY = initialTransformY + deltaY;
                            
                            payslipDocument.style.transform = `translate(${currentTransformX}px, ${currentTransformY}px)`;
                            e.preventDefault();
                        }
                    });
                }
            }

            // 초기 계산 실행
            window.recalc();
        })();
        
        // 급여 기능 초기화 호출
        console.log('급여 기능 초기화 완료');
        
        // 페이지 로드 시 급여현황탭 초기화
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM 로드 완료, 급여현황탭 초기화 시도');
            setTimeout(() => {
                if (typeof initPayrollTab === 'function') {
                    initPayrollTab();
                } else {
                    console.error('initPayrollTab 함수가 정의되지 않음');
                }
            }, 500);
        });

        // ===== 탭 네비게이션 기능 =====
        (function() {
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');

            // 페이지 로드 시 초기 상태 설정
            function initializeTabs() {
                const activeTab = document.querySelector('.tab-button.active');
                if (activeTab) {
                    const targetTab = activeTab.dataset.tab;
                    
                    if (targetTab === 'work') {
                        // 출력현황 탭 - 현장선택, 캘린더, 통계 표시
                        const siteFilterSection = document.getElementById('siteFilterSection');
                        const calWrap = document.getElementById('calWrap');
                        const workStats = document.getElementById('workStats');
                        if (siteFilterSection) siteFilterSection.style.display = 'flex';
                        if (calWrap) calWrap.style.display = 'block';
                        if (workStats) {
                            workStats.style.display = 'flex';
                            workStats.style.visibility = 'visible';
                            workStats.style.opacity = '1';
                            workStats.style.height = 'auto';
                            workStats.style.overflow = 'visible';
                            workStats.style.padding = '18px 4px 0 4px';
                            workStats.style.margin = '0 auto';
                        }
                        
                        // 출력현황탭 main-content 자연스러운 높이 설정
                        const mainContent = document.querySelector('.main-content');
                        if (mainContent) {
                            mainContent.style.height = 'auto';
                            mainContent.style.maxHeight = 'none';
                            mainContent.style.minHeight = 'auto';
                            mainContent.style.overflow = 'visible';
                        }
                    } else if (targetTab === 'pay') {
                        // 급여현황 탭 - 급여현황 콘텐츠 표시
                        const payView = document.getElementById('payView');
                        if (payView) payView.style.display = 'block';
                        
                        // 급여현황 탭 필터 표시
                        const paySiteFilterSection = document.getElementById('paySiteFilterSection');
                        if (paySiteFilterSection) paySiteFilterSection.style.display = 'flex';
                        
                        // 급여현황탭 main-content 자연스러운 높이 설정 - 내부 스크롤 완전 제거
                        const mainContent = document.querySelector('.main-content');
                        if (mainContent) {
                            mainContent.style.height = 'auto';
                            mainContent.style.maxHeight = 'none';
                            mainContent.style.minHeight = 'auto';
                            mainContent.style.overflow = 'visible';
                            mainContent.style.overflowY = 'visible';
                            mainContent.style.overflowX = 'hidden';
                        }
                        
                        // 현장선택, 캘린더, 통계 완전히 숨기기
                        const siteFilterSection = document.getElementById('siteFilterSection');
                        const calWrap = document.getElementById('calWrap');
                        const workStats = document.getElementById('workStats');
                        if (siteFilterSection) siteFilterSection.style.display = 'none';
                        if (calWrap) calWrap.style.display = 'none';
                        if (workStats) {
                            workStats.style.display = 'none';
                            workStats.style.visibility = 'hidden';
                            workStats.style.opacity = '0';
                            workStats.style.height = '0';
                            workStats.style.overflow = 'hidden';
                            workStats.style.padding = '0';
                            workStats.style.margin = '0';
                        }
                    }
                }
            }

            // 페이지 로드 시 초기화
            initializeTabs();

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetTab = button.dataset.tab;

                    // 모든 탭 버튼 비활성화
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    
                    // 모든 탭 콘텐츠 숨기기
                    tabContents.forEach(content => {
                        content.style.display = 'none';
                    });

                    // 선택된 탭 버튼 활성화
                    button.classList.add('active');

                    // 선택된 탭 콘텐츠 표시
                    if (targetTab === 'work') {
                        // 출력현황 탭 - 현장선택, 캘린더, 통계 표시
                        const siteFilterSection = document.getElementById('siteFilterSection');
                        const calWrap = document.getElementById('calWrap');
                        const workStats = document.getElementById('workStats');
                        if (siteFilterSection) siteFilterSection.style.display = 'flex';
                        if (calWrap) calWrap.style.display = 'block';
                        if (workStats) {
                            workStats.style.display = 'flex';
                            workStats.style.visibility = 'visible';
                            workStats.style.opacity = '1';
                        }
                        
                        // 급여현황 탭 필터 숨기기
                        const paySiteFilterSection = document.getElementById('paySiteFilterSection');
                        if (paySiteFilterSection) paySiteFilterSection.style.display = 'none';
                    } else if (targetTab === 'pay') {
                        // 급여현황 탭 - 급여현황 콘텐츠 표시
                        const payView = document.getElementById('payView');
                        if (payView) payView.style.display = 'block';
                        
                        // 급여현황 탭 필터 표시
                        const paySiteFilterSection = document.getElementById('paySiteFilterSection');
                        if (paySiteFilterSection) paySiteFilterSection.style.display = 'flex';
                        
                        // 현장선택, 캘린더, 통계 완전히 숨기기
                        const siteFilterSection = document.getElementById('siteFilterSection');
                        const calWrap = document.getElementById('calWrap');
                        const workStats = document.getElementById('workStats');
                        if (siteFilterSection) siteFilterSection.style.display = 'none';
                        if (calWrap) calWrap.style.display = 'none';
                        if (workStats) {
                            workStats.style.display = 'none';
                            workStats.style.visibility = 'hidden';
                            workStats.style.opacity = '0';
                            workStats.style.height = '0';
                            workStats.style.overflow = 'hidden';
                            workStats.style.padding = '0';
                            workStats.style.margin = '0';
                        }
                    }
                });
            });
        })();

        // ===== 급여현황 탭 기능 =====
        (function() {
            // 급여 계산 로직
            function initPayrollCalculation(){
                const $ = (id)=>document.getElementById(id);
                const chips = document.querySelectorAll('.chip[data-role="emp"]');

                const fmt = (n)=> new Intl.NumberFormat('ko-KR').format(Math.round(n)) + '원';

                function getTaxRate(empType, customRate=null){
                    let incomeRate = 0;
                    let localRate = 0;
                    if(empType==='freelance'){ 
                        incomeRate = 3.3; 
                        localRate = incomeRate * 0.1; // 소득세의 10%
                    }
                    else if(empType==='daily'){ 
                        incomeRate = 6.0; 
                        localRate = 0.6; // 0.6%
                    }
                    else if(empType==='regular'){ 
                        incomeRate = customRate || 15.4; 
                        localRate = 0; // 0%
                    }
                    const incomeTaxRate = incomeRate/100;
                    const localTaxRate = localRate/100;
                    return {income: incomeTaxRate, local: localTaxRate, total: incomeRate};
                }



                // 입력 이벤트 (휴무일 제외 - 자동 계산)
                ['daysUnits','baseAdmin','baseManual','customRate'].forEach(id=>{
                    const el = window.$(id); if(el) el.addEventListener('input', window.recalc);
                });

                // 기본급(직접입력) 천단위 포맷
                const baseManualInput = window.$('baseManual');
                if(baseManualInput){
                    baseManualInput.addEventListener('input', (e)=>{
                        let value = e.target.value.replace(/[^0-9]/g,'');
                        if(value){ e.target.value = new Intl.NumberFormat('ko-KR').format(parseInt(value)); }
                        window.recalc();
                    });
                }
            }

            // 미리보기 & PDF
            let zoomLevelVal = 1.0;
            function updateZoom(){
                const content = document.getElementById('payslipContent');
                const z = Math.max(.5, Math.min(2.0, zoomLevelVal));
                content.style.transform = 'scale(' + z + ')';
                document.getElementById('zoomLevel').textContent = Math.round(z*100) + '%';
            }


            function updatePayslipData(){
                // 간단한 미리보기 데이터 동기화
                const name = '작성자';
                const today = new Date();
                const yyyy = today.getFullYear();
                const mm = String(today.getMonth()+1).padStart(2,'0');
                const dd = '10'; // 요구사항: 현재 월의 10일 자동 반영
                document.getElementById('payslipDate').textContent = `${yyyy}. ${mm}`;
                document.getElementById('payslipPayDate').textContent = `${yyyy}. ${dd}`;
                document.getElementById('payslipName').textContent = name;
                // 금액 계는 요약 카드 값 재사용
                document.getElementById('payslipPayTotal').textContent = document.getElementById('rowBase').textContent;
                document.getElementById('payslipIncomeTax').textContent = document.getElementById('rowIncomeTax').textContent.replace('-', '');
                document.getElementById('payslipLocalTax').textContent = document.getElementById('rowLocalTax').textContent.replace('-', '');
                document.getElementById('payslipDeductTotal').textContent = (function(){
                    const it = document.getElementById('rowIncomeTax').textContent.replace(/[^0-9]/g,'')||'0';
                    const lt = document.getElementById('rowLocalTax').textContent.replace(/[^0-9]/g,'')||'0';
                    const sum = parseInt(it,10)+parseInt(lt,10);
                    return new Intl.NumberFormat('ko-KR').format(sum) + '원';
                })();
                document.getElementById('payslipNet').textContent = document.getElementById('rowNet').innerText;
            }

            async function downloadPayslipPDF(){
                try{
                    const payslipContainer = document.getElementById('payslipContainer');
                    const canvas = await html2canvas(payslipContainer, { scale:2, useCORS:true, allowTaint:true, backgroundColor:'#ffffff' });
                    const pdf = new jsPDF.jsPDF({ orientation:'portrait', unit:'mm', format:'a4' });
                    const imgData = canvas.toDataURL('image/png');
                    const imgWidth = 210, pageHeight = 295;
                    const imgHeight = (canvas.height * imgWidth) / canvas.width;
                    let heightLeft = imgHeight, position = 0;
                    pdf.addImage(imgData,'PNG',0,position,imgWidth,imgHeight); heightLeft -= pageHeight;
                    while(heightLeft >= 0){ position = heightLeft - imgHeight; pdf.addPage(); pdf.addImage(imgData,'PNG',0,position,imgWidth,imgHeight); heightLeft -= pageHeight; }
                    const fileName = `급여명세서_${new Date().getFullYear()}_${String(new Date().getMonth()+1).padStart(2,'0')}.pdf`;
                    pdf.save(fileName);
                }catch(e){
                    console.error('PDF 생성 오류:', e);
                    alert('PDF 생성 중 오류가 발생했습니다. 다시 시도해주세요.');
                }
            }

            // 급여현황 탭이 활성화될 때만 초기화
            function initPayrollTab() {
                console.log('급여현황탭 초기화 시작');
                const payView = document.getElementById('payView');
                if (payView && payView.style.display !== 'none') {
                    console.log('급여현황탭 활성화됨');
                    
                    // 급여 계산 로직 초기화
                    initPayrollCalculation();
                    
                    // 초기 계산 실행
                    setTimeout(() => {
                        console.log('초기 계산 실행');
                        if (window.recalc) {
                            window.recalc();
                            console.log('급여 계산 완료');
                        } else {
                            console.error('window.recalc 함수가 정의되지 않음');
                        }
                    }, 200);

                }
            }

            // 급여현황 탭 전환 시 초기화
            // 탭 버튼 클릭 이벤트에 급여현황 탭 초기화 추가
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetTab = button.dataset.tab;
                    if (targetTab === 'pay') {
                        setTimeout(initPayrollTab, 100); // 탭 전환 후 초기화
                    }
                });
            });

        })();

    </script>
</body>
</html>
