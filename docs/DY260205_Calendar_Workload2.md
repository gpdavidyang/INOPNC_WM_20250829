# 모바일 출근 현황(캘린더) 바텀시트 개선 요건 (DY260205_Calendar_Workload2)

## 1. 개요

모바일 "출력현황 > 출력정보 > 캘린더" 화면에서 날짜 선택 시 노출되는 **바텀시트(Bottom Sheet)**의 UX 및 기능을 개선한다.  
핵심 목표는 **개인 공수 관리의 집중도 향상(프라이버시)**과 **직관적인 공수 수정(One-Stop UX)**이다.

---

## 2. 핵심 요구사항

### 2.1. 프라이버시 및 데이터 범위 한정

- **My Labor Only**: 바텀시트 내 모든 출력 정보는 **로그인한 본인(작업자)**의 데이터만 노출한다.
- **타인 정보 숨김**: 동료나 다른 작업자의 공수 정보는 급여와 관련된 민감 정보이므로 절대 노출하지 않는다.

### 2.2. 현장별 상세 공수 현황 (View)

- 기존: 각 상태별(승인/제출) 총 공수 합계만 표시됨.
- **변경**: 현장별로 구분된 상세 공수와 상태를 표시해야 함.
  - 예: A현장 (1.0공수 / 승인), B현장 (0.5공수 / 제출)

### 2.3. 인라인 공수 수정 (Edit)

- **화면 이동 최소화**: 별도 모달이나 페이지 이동 없이, 바텀시트 내에서 즉시 수정 가능해야 함.
- **수정 UI**:
  - 각 현장별 공수 값을 직접 변경할 수 있는 컨트롤 제공.
  - **옵션**: `0.5`, `1.0`, `1.5`, `2.0`, `2.5`, `3.0` (공수 단위)
  - **조작 방식**: `-/+` 버튼 또는 탭 선택 방식을 통해 직관적으로 값을 조정.

### 2.4. 미등록 현장 공수 추가 (Add Navigation)

- 리스트에 없는 새로운 현장의 공수를 추가해야 하는 경우, 인라인 입력 대신 **작업일지 작성 페이지로 이동**하는 기능을 제공한다.
- **UI/UX 흐름**:
  - 안내 문구: "다른 현장 내역이 있으신가요?" (예시)
  - **[작업일지 작성하기]** 버튼 제공.
  - 버튼 클릭 시: 캘린더 빈 날짜 선택 시 나오는 '작업일지 작성 안내 바텀시트'의 **[작성하기]** 버튼과 동일한 동작(날짜 컨텍스트 유지하며 이동)을 수행.

### 2.5. 일괄 저장 (Batch Save)

- 개별 항목 수정 시 API를 바로 호출하지 않고, **변경 사항을 일괄 적용**하는 '저장' 버튼 제공.
- 저장 버튼 클릭 시:
  - 수정된 기존 현장 공수 업데이트 (Batch Update)
  - 만약 공수를 0으로 수정한 경우 삭제 처리 (필요 시 정책 확인)

---

## 3. UI/UX 구성안 (제안)

### 3.1. 바텀시트 구조

1.  **헤더 (Header)**
    - 선택된 날짜 표시 (예: 2026.02.05 목)
    - (Option) 본인의 총 공수 합계 요약

2.  **공수 목록 영역 (Labor List)**
    - **기존 기록**: 사용자가 해당 일자에 기록한 현장 목록 나열.
    - **각 행(Row) 구성**:
      - 현장명 (Text)
      - 현재 상태 뱃지 (승인/제출/반려)
      - **공수 조절 컨트롤**: `[-] 1.0 [+]` 형태의 스테퍼(Stepper) 또는 칩(Chip) 선택 UI.
      - _(제약사항)_: '승인(Approved)' 상태인 경우 수정 불가(Disabled) 처리.

3.  **현장 추가 안내 영역 (Add Guidance)**
    - **위치**: 공수 목록 하단에 배치.
    - **구성**:
      - 안내 텍스트: "새로운 현장 작업 내역을 추가하시겠습니까?"
      - **[작업일지 작성]** 버튼 (Ghost or Outline Style)

4.  **푸터 (Footer)**
    - **[저장] 버튼**: 변경 사항이 있을 때만 활성화(또는 상시 노출). 클릭 시 일괄 처리.

---

## 4. 데이터 로직 변경 사항

1.  **조회 (Fetch)**
    - 기존: `selectedDayRecords`에서 `isMe` 필터를 통해 본인 데이터만 추출하여 렌더링.
2.  **상태 관리 (Local State)**
    - 바텀시트 내부에서 편집 중인 공수 데이터(배열)를 관리.
    - `[{ siteId: 'A', hours: 8, status: 'submitted' }, ...]`
3.  **저장 (Submit)**
    - `upsertMyLabor` (단건 처리) 대신, `batchUpsertMyLabor`(가칭) 또는 반복 호출 로직 필요.
4.  **추가 (Navigation)**
    - `handleProceedWithEmptyDate`와 유사한 로직을 사용하여, 현재 선택된 날짜(`selectedDayISO`)를 가지고 `/mobile/worklog?mode=create`로 이동.

---

## 5. 구현 계획

1.  `AttendanceDetailSheet.tsx` 컴포넌트 전면 리팩토링.
    - 타인 공수 리스트 제거.
    - **상시 수정 가능한 리스트 View** 구현.
    - 하단에 '작업일지 작성' 네비게이션 섹션 추가.
2.  공수 조절 UI 컴포넌트 구현.
3.  `use-attendance.ts` 내 일괄 저장 `handleBatchSubmit` 핸들러 구현.
